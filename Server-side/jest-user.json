{"numFailedTestSuites":1,"numFailedTests":5,"numPassedTestSuites":0,"numPassedTests":5,"numPendingTestSuites":0,"numPendingTests":0,"numRuntimeErrorTestSuites":0,"numTodoTests":0,"numTotalTestSuites":1,"numTotalTests":10,"openHandles":[],"snapshot":{"added":0,"didUpdate":false,"failure":false,"filesAdded":0,"filesRemoved":0,"filesRemovedList":[],"filesUnmatched":0,"filesUpdated":0,"matched":0,"total":0,"unchecked":0,"uncheckedKeysByFile":[],"unmatched":0,"updated":0},"startTime":1762152189866,"success":false,"testResults":[{"assertionResults":[{"ancestorTitles":["UserController API测试","POST /api/users/register"],"duration":490,"failureDetails":[],"failureMessages":[],"fullName":"UserController API测试 POST /api/users/register 应该成功注册新用户","invocations":1,"location":null,"numPassingAsserts":5,"retryReasons":[],"status":"passed","title":"应该成功注册新用户"},{"ancestorTitles":["UserController API测试","POST /api/users/register"],"duration":299,"failureDetails":[],"failureMessages":[],"fullName":"UserController API测试 POST /api/users/register 应该在缺少必填字段时返回400错误","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"应该在缺少必填字段时返回400错误"},{"ancestorTitles":["UserController API测试","POST /api/users/register"],"duration":354,"failureDetails":[{"matcherResult":{"actual":201,"expected":409,"message":"expect(received).toBe(expected) // Object.is equality\n\nExpected: 409\nReceived: 201","name":"toBe","pass":false}}],"failureMessages":["Error: expect(received).toBe(expected) // Object.is equality\n\nExpected: 409\nReceived: 201\n    at Object.toBe (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\integration\\user-api.test.js:84:31)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)"],"fullName":"UserController API测试 POST /api/users/register 应该在用户名已存在时返回409错误","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该在用户名已存在时返回409错误"},{"ancestorTitles":["UserController API测试","POST /api/auth/login"],"duration":309,"failureDetails":[{"matcherResult":{"actual":401,"expected":200,"message":"expect(received).toBe(expected) // Object.is equality\n\nExpected: 200\nReceived: 401","name":"toBe","pass":false}}],"failureMessages":["Error: expect(received).toBe(expected) // Object.is equality\n\nExpected: 200\nReceived: 401\n    at Object.toBe (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\integration\\user-api.test.js:99:31)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)"],"fullName":"UserController API测试 POST /api/auth/login 应该成功登录并返回token","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该成功登录并返回token"},{"ancestorTitles":["UserController API测试","POST /api/auth/login"],"duration":304,"failureDetails":[],"failureMessages":[],"fullName":"UserController API测试 POST /api/auth/login 应该在密码错误时返回401错误","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"应该在密码错误时返回401错误"},{"ancestorTitles":["UserController API测试","GET /api/users/profile"],"duration":293,"failureDetails":[{"matcherResult":{"actual":404,"expected":200,"message":"expect(received).toBe(expected) // Object.is equality\n\nExpected: 200\nReceived: 404","name":"toBe","pass":false}}],"failureMessages":["Error: expect(received).toBe(expected) // Object.is equality\n\nExpected: 200\nReceived: 404\n    at Object.toBe (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\integration\\user-api.test.js:127:31)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)"],"fullName":"UserController API测试 GET /api/users/profile 应该成功获取用户资料","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该成功获取用户资料"},{"ancestorTitles":["UserController API测试","GET /api/users/profile"],"duration":282,"failureDetails":[],"failureMessages":[],"fullName":"UserController API测试 GET /api/users/profile 应该在未授权时返回401错误","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"应该在未授权时返回401错误"},{"ancestorTitles":["UserController API测试","PUT /api/users/profile"],"duration":332,"failureDetails":[{"matcherResult":{"actual":404,"expected":200,"message":"expect(received).toBe(expected) // Object.is equality\n\nExpected: 200\nReceived: 404","name":"toBe","pass":false}}],"failureMessages":["Error: expect(received).toBe(expected) // Object.is equality\n\nExpected: 200\nReceived: 404\n    at Object.toBe (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\integration\\user-api.test.js:150:31)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)"],"fullName":"UserController API测试 PUT /api/users/profile 应该成功更新用户资料","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该成功更新用户资料"},{"ancestorTitles":["UserController API测试","PUT /api/users/profile"],"duration":299,"failureDetails":[],"failureMessages":[],"fullName":"UserController API测试 PUT /api/users/profile 没有token时应该无法更新用户资料","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"没有token时应该无法更新用户资料"},{"ancestorTitles":["UserController API测试","POST /api/auth/refresh"],"duration":287,"failureDetails":[{}],"failureMessages":["TypeError: Cannot read properties of undefined (reading 'refreshToken')\n    at Object.refreshToken (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\integration\\user-api.test.js:180:52)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)"],"fullName":"UserController API测试 POST /api/auth/refresh 应该成功刷新token","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该成功刷新token"}],"endTime":1762152195046,"message":"  ● UserController API测试 › POST /api/users/register › 应该在用户名已存在时返回409错误\n\n    expect(received).toBe(expected) // Object.is equality\n\n    Expected: 409\n    Received: 201\n\n      82 |         });\n      83 |\n    > 84 |       expect(response.status).toBe(409);\n         |                               ^\n      85 |       expect(response.body.success).toBe(false);\n      86 |       expect(response.body.message).toBe('用户名已被注册');\n      87 |     });\n\n      at Object.toBe (tests/integration/user-api.test.js:84:31)\n\n  ● UserController API测试 › POST /api/auth/login › 应该成功登录并返回token\n\n    expect(received).toBe(expected) // Object.is equality\n\n    Expected: 200\n    Received: 401\n\n       97 |         });\n       98 |\n    >  99 |       expect(response.status).toBe(200);\n          |                               ^\n      100 |       expect(response.body.success).toBe(true);\n      101 |       expect(response.body.message).toBe('登录成功');\n      102 |       expect(response.body.data.token).toBeDefined();\n\n      at Object.toBe (tests/integration/user-api.test.js:99:31)\n\n  ● UserController API测试 › GET /api/users/profile › 应该成功获取用户资料\n\n    expect(received).toBe(expected) // Object.is equality\n\n    Expected: 200\n    Received: 404\n\n      125 |         .set('Authorization', `Bearer ${authToken}`);\n      126 |\n    > 127 |       expect(response.status).toBe(200);\n          |                               ^\n      128 |       expect(response.body.success).toBe(true);\n      129 |       expect(response.body.data.username).toBe('testuser');\n      130 |     });\n\n      at Object.toBe (tests/integration/user-api.test.js:127:31)\n\n  ● UserController API测试 › PUT /api/users/profile › 应该成功更新用户资料\n\n    expect(received).toBe(expected) // Object.is equality\n\n    Expected: 200\n    Received: 404\n\n      148 |         });\n      149 |\n    > 150 |       expect(response.status).toBe(200);\n          |                               ^\n      151 |       expect(response.body.success).toBe(true);\n      152 |       expect(response.body.message).toBe('用户资料更新成功');\n      153 |       expect(response.body.data.name).toBe('Updated Name');\n\n      at Object.toBe (tests/integration/user-api.test.js:150:31)\n\n  ● UserController API测试 › POST /api/auth/refresh › 应该成功刷新token\n\n    TypeError: Cannot read properties of undefined (reading 'refreshToken')\n\n      178 |         });\n      179 |\n    > 180 |       const refreshToken = loginResponse.body.data.refreshToken;\n          |                                                    ^\n      181 |\n      182 |       const response = await request(app)\n      183 |         .post('/api/auth/refresh')\n\n      at Object.refreshToken (tests/integration/user-api.test.js:180:52)\n","name":"C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\integration\\user-api.test.js","startTime":1762152189909,"status":"failed","summary":""}],"wasInterrupted":false}
