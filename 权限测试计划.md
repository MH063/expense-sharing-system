# 权限测试计划

## 测试目标
验证不同角色用户在系统中的权限控制是否正确实现，确保用户只能访问其角色权限范围内的页面和功能。

## 测试角色
1. 系统管理员 (SYSTEM_ADMIN)
2. 管理员 (ADMIN)
3. 寝室长 (ROOM_OWNER)
4. 普通用户 (USER)

## 测试页面与权限要求

### 公共页面
- 首页 (/) - 无需登录
- 使用指南 (/user-guide) - 无需登录
- 登录页 (/auth/login) - 仅未登录用户
- 注册页 (/auth/register) - 仅未登录用户
- 忘记密码 (/auth/forgot-password) - 仅未登录用户
- 403页面 (/403) - 无需登录
- 404页面 (/*) - 无需登录

### 需要登录的页面
- 仪表盘 (/dashboard) - 需要登录
- 个人资料 (/profile) - 需要 PROFILE_VIEW 权限
- 通知中心 (/notifications/center) - 需要登录
- 加入寝室 (/join-room) - 需要登录
- 设置 (/settings) - 需要登录

### 寝室相关页面
- 寝室列表 (/rooms) - 需要 ROOM_VIEW 权限
- 创建寝室 (/rooms/create) - 需要 ROOM_CREATE 权限
- 寝室详情 (/rooms/:roomId) - 需要寝室 ROOM_VIEW 权限
- 寝室邀请 (/rooms/:roomId/invitations) - 需要寝室 ROOM_INVITE 权限
- 寝室支付规则 (/rooms/:roomId/payment-rules) - 需要寝室 ROOM_EDIT 权限
- 创建寝室支付规则 (/rooms/create/payment-rules) - 需要 ROOM_CREATE 权限

### 费用相关页面
- 费用列表 (/expenses) - 需要 EXPENSE_VIEW 权限
- 创建费用 (/expenses/create) - 需要 EXPENSE_CREATE 权限
- 费用详情 (/expenses/:expenseId) - 需要 EXPENSE_VIEW 权限

### 账单相关页面
- 账单列表 (/bills) - 需要 BILL_VIEW 权限
- 账单列表页 (/bills/list) - 需要 BILL_VIEW 权限
- 创建账单 (/bills/create) - 需要 BILL_CREATE 权限
- 账单详情 (/bills/:billId) - 需要 BILL_VIEW 权限
- 编辑账单 (/bills/:billId/edit) - 需要 BILL_EDIT 权限
- 支付账单 (/bills/:billId/payment) - 需要 BILL_PAY 权限
- 账单转账记录 (/bills/:billId/transfers) - 需要 BILL_VIEW 权限

### 支付相关页面
- 二维码管理 (/qr-codes) - 需要 BILL_PAY 权限
- 扫码支付 (/payments/:billId/scan) - 需要 BILL_PAY 权限
- 支付历史 (/payments/history) - 需要 BILL_PAY 权限

### 邀请码相关页面
- 邀请码管理 (/invite-codes) - 需要 ROOM_INVITE 权限

### 评审相关页面
- 评审列表 (/reviews) - 需要 ROOM_EDIT 权限
- 评审详情 (/reviews/:reviewId) - 需要 ROOM_EDIT 权限

### 争议相关页面
- 争议列表 (/disputes) - 需要 EXPENSE_VIEW 权限
- 争议详情 (/disputes/:disputeId) - 需要 EXPENSE_VIEW 权限

### 分析相关页面
- 数据分析 (/analytics) - 需要 EXPENSE_VIEW 权限
- 活动列表 (/activities) - 需要 EXPENSE_VIEW 权限

### 管理员页面
- 权限测试 (/admin/permissions) - 需要 ADMIN_ACCESS 权限
- 权限映射管理 (/admin/permission-mapping) - 需要 ADMIN_ACCESS 权限

## 测试结果记录

### 系统管理员 (SYSTEM_ADMIN)
| 页面 | 预期结果 | 实际结果 | 状态 |
|------|----------|----------|------|
| 首页 | 可访问 | 待测试 | 待测试 |
| 使用指南 | 可访问 | 待测试 | 待测试 |
| 登录页 | 重定向到仪表盘 | 待测试 | 待测试 |
| 注册页 | 重定向到仪表盘 | 待测试 | 待测试 |
| 忘记密码页 | 重定向到仪表盘 | 待测试 | 待测试 |
| 仪表盘 | 可访问 | 待测试 | 待测试 |
| 个人资料 | 可访问 | 待测试 | 待测试 |
| 通知中心 | 可访问 | 待测试 | 待测试 |
| 加入寝室 | 可访问 | 待测试 | 待测试 |
| 设置 | 可访问 | 待测试 | 待测试 |
| 寝室列表 | 可访问 | 待测试 | 待测试 |
| 创建寝室 | 可访问 | 待测试 | 待测试 |
| 费用列表 | 可访问 | 待测试 | 待测试 |
| 创建费用 | 可访问 | 待测试 | 待测试 |
| 账单列表 | 可访问 | 待测试 | 待测试 |
| 创建账单 | 可访问 | 待测试 | 待测试 |
| 支付账单 | 可访问 | 待测试 | 待测试 |
| 二维码管理 | 可访问 | 待测试 | 待测试 |
| 扫码支付 | 可访问 | 待测试 | 待测试 |
| 支付历史 | 可访问 | 待测试 | 待测试 |
| 邀请码管理 | 可访问 | 待测试 | 待测试 |
| 评审列表 | 可访问 | 待测试 | 待测试 |
| 争议列表 | 可访问 | 待测试 | 待测试 |
| 数据分析 | 可访问 | 待测试 | 待测试 |
| 活动列表 | 可访问 | 待测试 | 待测试 |
| 权限测试 | 可访问 | 待测试 | 待测试 |
| 权限映射管理 | 可访问 | 待测试 | 待测试 |

### 管理员 (ADMIN)
| 页面 | 预期结果 | 实际结果 | 状态 |
|------|----------|----------|------|
| 首页 | 可访问 | 待测试 | 待测试 |
| 使用指南 | 可访问 | 待测试 | 待测试 |
| 登录页 | 重定向到仪表盘 | 待测试 | 待测试 |
| 注册页 | 重定向到仪表盘 | 待测试 | 待测试 |
| 忘记密码页 | 重定向到仪表盘 | 待测试 | 待测试 |
| 仪表盘 | 可访问 | 待测试 | 待测试 |
| 个人资料 | 可访问 | 待测试 | 待测试 |
| 通知中心 | 可访问 | 待测试 | 待测试 |
| 加入寝室 | 可访问 | 待测试 | 待测试 |
| 设置 | 可访问 | 待测试 | 待测试 |
| 寝室列表 | 可访问 | 待测试 | 待测试 |
| 创建寝室 | 可访问 | 待测试 | 待测试 |
| 费用列表 | 可访问 | 待测试 | 待测试 |
| 创建费用 | 可访问 | 待测试 | 待测试 |
| 账单列表 | 可访问 | 待测试 | 待测试 |
| 创建账单 | 可访问 | 待测试 | 待测试 |
| 支付账单 | 可访问 | 待测试 | 待测试 |
| 二维码管理 | 可访问 | 待测试 | 待测试 |
| 扫码支付 | 可访问 | 待测试 | 待测试 |
| 支付历史 | 可访问 | 待测试 | 待测试 |
| 邀请码管理 | 可访问 | 待测试 | 待测试 |
| 评审列表 | 可访问 | 待测试 | 待测试 |
| 争议列表 | 可访问 | 待测试 | 待测试 |
| 数据分析 | 可访问 | 待测试 | 待测试 |
| 活动列表 | 可访问 | 待测试 | 待测试 |
| 权限测试 | 可访问 | 待测试 | 待测试 |
| 权限映射管理 | 可访问 | 待测试 | 待测试 |

### 寝室长 (ROOM_OWNER)
| 页面 | 预期结果 | 实际结果 | 状态 |
|------|----------|----------|------|
| 首页 | 可访问 | 待测试 | 待测试 |
| 使用指南 | 可访问 | 待测试 | 待测试 |
| 登录页 | 重定向到仪表盘 | 待测试 | 待测试 |
| 注册页 | 重定向到仪表盘 | 待测试 | 待测试 |
| 忘记密码页 | 重定向到仪表盘 | 待测试 | 待测试 |
| 仪表盘 | 可访问 | 待测试 | 待测试 |
| 个人资料 | 可访问 | 待测试 | 待测试 |
| 通知中心 | 可访问 | 待测试 | 待测试 |
| 加入寝室 | 可访问 | 待测试 | 待测试 |
| 设置 | 可访问 | 待测试 | 待测试 |
| 寝室列表 | 可访问 | 待测试 | 待测试 |
| 创建寝室 | 可访问 | 待测试 | 待测试 |
| 费用列表 | 可访问 | 待测试 | 待测试 |
| 创建费用 | 可访问 | 待测试 | 待测试 |
| 账单列表 | 可访问 | 待测试 | 待测试 |
| 创建账单 | 可访问 | 待测试 | 待测试 |
| 支付账单 | 可访问 | 待测试 | 待测试 |
| 二维码管理 | 可访问 | 待测试 | 待测试 |
| 扫码支付 | 可访问 | 待测试 | 待测试 |
| 支付历史 | 可访问 | 待测试 | 待测试 |
| 邀请码管理 | 可访问 | 待测试 | 待测试 |
| 评审列表 | 可访问 | 待测试 | 待测试 |
| 争议列表 | 可访问 | 待测试 | 待测试 |
| 数据分析 | 可访问 | 待测试 | 待测试 |
| 活动列表 | 可访问 | 待测试 | 待测试 |
| 权限测试 | 重定向到403 | 待测试 | 待测试 |
| 权限映射管理 | 重定向到403 | 待测试 | 待测试 |

### 普通用户 (USER)
| 页面 | 预期结果 | 实际结果 | 状态 |
|------|----------|----------|------|
| 首页 | 可访问 | 待测试 | 待测试 |
| 使用指南 | 可访问 | 待测试 | 待测试 |
| 登录页 | 重定向到仪表盘 | 待测试 | 待测试 |
| 注册页 | 重定向到仪表盘 | 待测试 | 待测试 |
| 忘记密码页 | 重定向到仪表盘 | 待测试 | 待测试 |
| 仪表盘 | 可访问 | 待测试 | 待测试 |
| 个人资料 | 可访问 | 待测试 | 待测试 |
| 通知中心 | 可访问 | 待测试 | 待测试 |
| 加入寝室 | 可访问 | 待测试 | 待测试 |
| 设置 | 可访问 | 待测试 | 待测试 |
| 寝室列表 | 可访问 | 待测试 | 待测试 |
| 创建寝室 | 重定向到403 | 待测试 | 待测试 |
| 费用列表 | 可访问 | 待测试 | 待测试 |
| 创建费用 | 可访问 | 待测试 | 待测试 |
| 账单列表 | 可访问 | 待测试 | 待测试 |
| 创建账单 | 可访问 | 待测试 | 待测试 |
| 支付账单 | 可访问 | 待测试 | 待测试 |
| 二维码管理 | 可访问 | 待测试 | 待测试 |
| 扫码支付 | 可访问 | 待测试 | 待测试 |
| 支付历史 | 可访问 | 待测试 | 待测试 |
| 邀请码管理 | 重定向到403 | 待测试 | 待测试 |
| 评审列表 | 重定向到403 | 待测试 | 待测试 |
| 争议列表 | 可访问 | 待测试 | 待测试 |
| 数据分析 | 可访问 | 待测试 | 待测试 |
| 活动列表 | 可访问 | 待测试 | 待测试 |
| 权限测试 | 重定向到403 | 待测试 | 待测试 |
| 权限映射管理 | 重定向到403 | 待测试 | 待测试 |

## 测试步骤
1. 使用系统管理员账号登录，测试所有页面的访问权限
2. 使用管理员账号登录，测试所有页面的访问权限
3. 使用寝室长账号登录，测试所有页面的访问权限
4. 使用普通用户账号登录，测试所有页面的访问权限
5. 测试未登录状态下访问需要登录的页面，验证是否重定向到登录页
6. 测试已登录状态下访问登录页，验证是否重定向到仪表盘
7. 测试页面刷新后权限控制是否维持

## 测试账号
- 系统管理员: admin001 / password
- 管理员: admin002 / password
- 寝室长: roomowner001 / password
- 普通用户: user001 / password

## 测试日期
2025-11-12

## 测试人员
AI助手

## 测试结论
待测试完成后填写