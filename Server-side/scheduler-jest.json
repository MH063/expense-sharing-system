{"numFailedTestSuites":1,"numFailedTests":7,"numPassedTestSuites":0,"numPassedTests":16,"numPendingTestSuites":0,"numPendingTests":0,"numRuntimeErrorTestSuites":0,"numTodoTests":0,"numTotalTestSuites":1,"numTotalTests":23,"openHandles":[],"snapshot":{"added":0,"didUpdate":false,"failure":false,"filesAdded":0,"filesRemoved":0,"filesRemovedList":[],"filesUnmatched":0,"filesUpdated":0,"matched":0,"total":0,"unchecked":0,"uncheckedKeysByFile":[],"unmatched":0,"updated":0},"startTime":1762155956484,"success":false,"testResults":[{"assertionResults":[{"ancestorTitles":["定时任务服务测试","startAllTasks"],"duration":378,"failureDetails":[],"failureMessages":[],"fullName":"定时任务服务测试 startAllTasks 应该成功启动所有定时任务","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"应该成功启动所有定时任务"},{"ancestorTitles":["定时任务服务测试","startAllTasks"],"duration":311,"failureDetails":[],"failureMessages":[],"fullName":"定时任务服务测试 startAllTasks 应该在任务已启动时返回相应消息","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"应该在任务已启动时返回相应消息"},{"ancestorTitles":["定时任务服务测试","stopAllTasks"],"duration":278,"failureDetails":[],"failureMessages":[],"fullName":"定时任务服务测试 stopAllTasks 应该成功停止所有定时任务","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"应该成功停止所有定时任务"},{"ancestorTitles":["定时任务服务测试","stopAllTasks"],"duration":287,"failureDetails":[],"failureMessages":[],"fullName":"定时任务服务测试 stopAllTasks 应该在任务未启动时返回相应消息","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"应该在任务未启动时返回相应消息"},{"ancestorTitles":["定时任务服务测试","checkPaymentReminders"],"duration":316,"failureDetails":[],"failureMessages":[],"fullName":"定时任务服务测试 checkPaymentReminders 应该成功检查并发送支付提醒","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"应该成功检查并发送支付提醒"},{"ancestorTitles":["定时任务服务测试","checkPaymentReminders"],"duration":299,"failureDetails":[],"failureMessages":[],"fullName":"定时任务服务测试 checkPaymentReminders 应该处理没有待发送提醒的情况","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"应该处理没有待发送提醒的情况"},{"ancestorTitles":["定时任务服务测试","checkPaymentReminders"],"duration":290,"failureDetails":[],"failureMessages":[],"fullName":"定时任务服务测试 checkPaymentReminders 应该处理发送提醒失败的情况","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"应该处理发送提醒失败的情况"},{"ancestorTitles":["定时任务服务测试","checkPaymentReminders"],"duration":284,"failureDetails":[],"failureMessages":[],"fullName":"定时任务服务测试 checkPaymentReminders 应该处理获取提醒失败的情况","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"应该处理获取提醒失败的情况"},{"ancestorTitles":["定时任务服务测试","syncOfflinePayments"],"duration":285,"failureDetails":[],"failureMessages":[],"fullName":"定时任务服务测试 syncOfflinePayments 应该成功同步离线支付","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"应该成功同步离线支付"},{"ancestorTitles":["定时任务服务测试","syncOfflinePayments"],"duration":299,"failureDetails":[],"failureMessages":[],"fullName":"定时任务服务测试 syncOfflinePayments 应该处理没有待同步支付的情况","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"应该处理没有待同步支付的情况"},{"ancestorTitles":["定时任务服务测试","syncOfflinePayments"],"duration":298,"failureDetails":[],"failureMessages":[],"fullName":"定时任务服务测试 syncOfflinePayments 应该处理部分同步失败的情况","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"应该处理部分同步失败的情况"},{"ancestorTitles":["定时任务服务测试","syncOfflinePayments"],"duration":302,"failureDetails":[],"failureMessages":[],"fullName":"定时任务服务测试 syncOfflinePayments 应该处理获取待同步支付失败的情况","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"应该处理获取待同步支付失败的情况"},{"ancestorTitles":["定时任务服务测试","cleanupExpiredReminders"],"duration":324,"failureDetails":[{"matcherResult":{"message":"\u001b[2mexpect(\u001b[22m\u001b[31mjest.fn()\u001b[39m\u001b[2m).\u001b[22mtoHaveBeenCalledWith\u001b[2m(\u001b[22m\u001b[32m...expected\u001b[39m\u001b[2m)\u001b[22m\n\nExpected: \u001b[32mStringContaining \"UPDATE payment_reminders\"\u001b[39m, \u001b[32mArrayContaining [\"expired\"]\u001b[39m\n\nNumber of calls: \u001b[31m0\u001b[39m","pass":false}}],"failureMessages":["Error: \u001b[2mexpect(\u001b[22m\u001b[31mjest.fn()\u001b[39m\u001b[2m).\u001b[22mtoHaveBeenCalledWith\u001b[2m(\u001b[22m\u001b[32m...expected\u001b[39m\u001b[2m)\u001b[22m\n\nExpected: \u001b[32mStringContaining \"UPDATE payment_reminders\"\u001b[39m, \u001b[32mArrayContaining [\"expired\"]\u001b[39m\n\nNumber of calls: \u001b[31m0\u001b[39m\n    at Object.toHaveBeenCalledWith (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\scheduler.test.js:307:25)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)"],"fullName":"定时任务服务测试 cleanupExpiredReminders 应该成功清理过期提醒","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该成功清理过期提醒"},{"ancestorTitles":["定时任务服务测试","cleanupExpiredReminders"],"duration":397,"failureDetails":[{"matcherResult":{"message":"\u001b[2mexpect(\u001b[22m\u001b[31mjest.fn()\u001b[39m\u001b[2m).\u001b[22mtoHaveBeenCalledWith\u001b[2m(\u001b[22m\u001b[32m...expected\u001b[39m\u001b[2m)\u001b[22m\n\nExpected: \u001b[32mStringContaining \"UPDATE payment_reminders\"\u001b[39m, \u001b[32mArrayContaining [\"expired\"]\u001b[39m\n\nNumber of calls: \u001b[31m0\u001b[39m","pass":false}}],"failureMessages":["Error: \u001b[2mexpect(\u001b[22m\u001b[31mjest.fn()\u001b[39m\u001b[2m).\u001b[22mtoHaveBeenCalledWith\u001b[2m(\u001b[22m\u001b[32m...expected\u001b[39m\u001b[2m)\u001b[22m\n\nExpected: \u001b[32mStringContaining \"UPDATE payment_reminders\"\u001b[39m, \u001b[32mArrayContaining [\"expired\"]\u001b[39m\n\nNumber of calls: \u001b[31m0\u001b[39m\n    at Object.toHaveBeenCalledWith (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\scheduler.test.js:328:25)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)"],"fullName":"定时任务服务测试 cleanupExpiredReminders 应该处理没有过期提醒的情况","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该处理没有过期提醒的情况"},{"ancestorTitles":["定时任务服务测试","cleanupExpiredReminders"],"duration":368,"failureDetails":[{"matcherResult":{"message":"\u001b[2mexpect(\u001b[22m\u001b[31mjest.fn()\u001b[39m\u001b[2m).\u001b[22mtoHaveBeenCalled\u001b[2m()\u001b[22m\n\nExpected number of calls: >= \u001b[32m1\u001b[39m\nReceived number of calls:    \u001b[31m0\u001b[39m","pass":false}}],"failureMessages":["Error: \u001b[2mexpect(\u001b[22m\u001b[31mjest.fn()\u001b[39m\u001b[2m).\u001b[22mtoHaveBeenCalled\u001b[2m()\u001b[22m\n\nExpected number of calls: >= \u001b[32m1\u001b[39m\nReceived number of calls:    \u001b[31m0\u001b[39m\n    at Object.toHaveBeenCalled (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\scheduler.test.js:349:25)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)"],"fullName":"定时任务服务测试 cleanupExpiredReminders 应该处理清理过期提醒失败的情况","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该处理清理过期提醒失败的情况"},{"ancestorTitles":["定时任务服务测试","generatePaymentStats"],"duration":408,"failureDetails":[{"matcherResult":{"message":"\u001b[2mexpect(\u001b[22m\u001b[31mjest.fn()\u001b[39m\u001b[2m).\u001b[22mtoHaveBeenCalledWith\u001b[2m(\u001b[22m\u001b[32m...expected\u001b[39m\u001b[2m)\u001b[22m\n\nExpected: \u001b[32mStringContaining \"INSERT INTO payment_stats\"\u001b[39m, \u001b[32mAny<Array>\u001b[39m\n\nNumber of calls: \u001b[31m0\u001b[39m","pass":false}}],"failureMessages":["Error: \u001b[2mexpect(\u001b[22m\u001b[31mjest.fn()\u001b[39m\u001b[2m).\u001b[22mtoHaveBeenCalledWith\u001b[2m(\u001b[22m\u001b[32m...expected\u001b[39m\u001b[2m)\u001b[22m\n\nExpected: \u001b[32mStringContaining \"INSERT INTO payment_stats\"\u001b[39m, \u001b[32mAny<Array>\u001b[39m\n\nNumber of calls: \u001b[31m0\u001b[39m\n    at Object.toHaveBeenCalledWith (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\scheduler.test.js:380:25)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)"],"fullName":"定时任务服务测试 generatePaymentStats 应该成功生成支付统计报告","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"failed","title":"应该成功生成支付统计报告"},{"ancestorTitles":["定时任务服务测试","generatePaymentStats"],"duration":404,"failureDetails":[{"matcherResult":{"message":"\u001b[2mexpect(\u001b[22m\u001b[31mjest.fn()\u001b[39m\u001b[2m).\u001b[22mtoHaveBeenCalledWith\u001b[2m(\u001b[22m\u001b[32m...expected\u001b[39m\u001b[2m)\u001b[22m\n\nExpected: \u001b[32mStringContaining \"INSERT INTO payment_stats\"\u001b[39m, \u001b[32mAny<Array>\u001b[39m\n\nNumber of calls: \u001b[31m0\u001b[39m","pass":false}}],"failureMessages":["Error: \u001b[2mexpect(\u001b[22m\u001b[31mjest.fn()\u001b[39m\u001b[2m).\u001b[22mtoHaveBeenCalledWith\u001b[2m(\u001b[22m\u001b[32m...expected\u001b[39m\u001b[2m)\u001b[22m\n\nExpected: \u001b[32mStringContaining \"INSERT INTO payment_stats\"\u001b[39m, \u001b[32mAny<Array>\u001b[39m\n\nNumber of calls: \u001b[31m0\u001b[39m\n    at Object.toHaveBeenCalledWith (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\scheduler.test.js:420:25)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)"],"fullName":"定时任务服务测试 generatePaymentStats 应该处理没有支付记录的情况","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"failed","title":"应该处理没有支付记录的情况"},{"ancestorTitles":["定时任务服务测试","generatePaymentStats"],"duration":361,"failureDetails":[],"failureMessages":[],"fullName":"定时任务服务测试 generatePaymentStats 应该处理生成支付统计失败的情况","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"应该处理生成支付统计失败的情况"},{"ancestorTitles":["定时任务服务测试","getTaskStatus"],"duration":315,"failureDetails":[],"failureMessages":[],"fullName":"定时任务服务测试 getTaskStatus 应该返回所有任务状态","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"应该返回所有任务状态"},{"ancestorTitles":["定时任务服务测试","getTaskStatus"],"duration":287,"failureDetails":[],"failureMessages":[],"fullName":"定时任务服务测试 getTaskStatus 应该在任务未启动时返回相应状态","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"应该在任务未启动时返回相应状态"},{"ancestorTitles":["定时任务服务测试","triggerTask"],"duration":278,"failureDetails":[],"failureMessages":[],"fullName":"定时任务服务测试 triggerTask 应该成功触发指定任务","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"应该成功触发指定任务"},{"ancestorTitles":["定时任务服务测试","triggerTask"],"duration":315,"failureDetails":[{"matcherResult":{"actual":{"success":false,"message":"未知的任务名称: nonExistentTask"},"expected":{"success":false,"message":"任务 nonExistentTask 不存在"},"message":"\u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoEqual\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m) // deep equality\u001b[22m\n\n\u001b[32m- Expected  - 1\u001b[39m\n\u001b[31m+ Received  + 1\u001b[39m\n\n\u001b[2m  Object {\u001b[22m\n\u001b[32m-   \"message\": \"任务 nonExistentTask 不存在\",\u001b[39m\n\u001b[31m+   \"message\": \"未知的任务名称: nonExistentTask\",\u001b[39m\n\u001b[2m    \"success\": false,\u001b[22m\n\u001b[2m  }\u001b[22m","name":"toEqual","pass":false}}],"failureMessages":["Error: \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoEqual\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m) // deep equality\u001b[22m\n\n\u001b[32m- Expected  - 1\u001b[39m\n\u001b[31m+ Received  + 1\u001b[39m\n\n\u001b[2m  Object {\u001b[22m\n\u001b[32m-   \"message\": \"任务 nonExistentTask 不存在\",\u001b[39m\n\u001b[31m+   \"message\": \"未知的任务名称: nonExistentTask\",\u001b[39m\n\u001b[2m    \"success\": false,\u001b[22m\n\u001b[2m  }\u001b[22m\n    at Object.toEqual (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\scheduler.test.js:557:22)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)"],"fullName":"定时任务服务测试 triggerTask 应该在任务不存在时返回错误","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该在任务不存在时返回错误"},{"ancestorTitles":["定时任务服务测试","triggerTask"],"duration":301,"failureDetails":[{"matcherResult":{"actual":{"success":false,"message":"任务执行失败: 任务执行失败"},"expected":{"success":false,"message":"任务 paymentReminderCheck 执行失败: 任务执行失败"},"message":"\u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoEqual\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m) // deep equality\u001b[22m\n\n\u001b[32m- Expected  - 1\u001b[39m\n\u001b[31m+ Received  + 1\u001b[39m\n\n\u001b[2m  Object {\u001b[22m\n\u001b[32m-   \"message\": \"任务 paymentReminderCheck 执行失败: 任务执行失败\",\u001b[39m\n\u001b[31m+   \"message\": \"任务执行失败: 任务执行失败\",\u001b[39m\n\u001b[2m    \"success\": false,\u001b[22m\n\u001b[2m  }\u001b[22m","name":"toEqual","pass":false}}],"failureMessages":["Error: \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoEqual\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m) // deep equality\u001b[22m\n\n\u001b[32m- Expected  - 1\u001b[39m\n\u001b[31m+ Received  + 1\u001b[39m\n\n\u001b[2m  Object {\u001b[22m\n\u001b[32m-   \"message\": \"任务 paymentReminderCheck 执行失败: 任务执行失败\",\u001b[39m\n\u001b[31m+   \"message\": \"任务执行失败: 任务执行失败\",\u001b[39m\n\u001b[2m    \"success\": false,\u001b[22m\n\u001b[2m  }\u001b[22m\n    at Object.toEqual (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\scheduler.test.js:575:22)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)"],"fullName":"定时任务服务测试 triggerTask 应该处理任务执行失败的情况","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"failed","title":"应该处理任务执行失败的情况"}],"endTime":1762155965301,"message":"\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m定时任务服务测试 › cleanupExpiredReminders › 应该成功清理过期提醒\u001b[39m\u001b[22m\n\n    \u001b[2mexpect(\u001b[22m\u001b[31mjest.fn()\u001b[39m\u001b[2m).\u001b[22mtoHaveBeenCalledWith\u001b[2m(\u001b[22m\u001b[32m...expected\u001b[39m\u001b[2m)\u001b[22m\n\n    Expected: \u001b[32mStringContaining \"UPDATE payment_reminders\"\u001b[39m, \u001b[32mArrayContaining [\"expired\"]\u001b[39m\n\n    Number of calls: \u001b[31m0\u001b[39m\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 305 |\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 306 |\u001b[39m       \u001b[90m// 验证结果\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 307 |\u001b[39m       expect(mockQuery)\u001b[33m.\u001b[39mtoHaveBeenCalledWith(\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                         \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 308 |\u001b[39m         expect\u001b[33m.\u001b[39mstringContaining(\u001b[32m'UPDATE payment_reminders'\u001b[39m)\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 309 |\u001b[39m         expect\u001b[33m.\u001b[39marrayContaining([\u001b[32m'expired'\u001b[39m])\u001b[22m\n\u001b[2m     \u001b[90m 310 |\u001b[39m       )\u001b[33m;\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.toHaveBeenCalledWith (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/scheduler.test.js\u001b[39m\u001b[0m\u001b[2m:307:25)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m定时任务服务测试 › cleanupExpiredReminders › 应该处理没有过期提醒的情况\u001b[39m\u001b[22m\n\n    \u001b[2mexpect(\u001b[22m\u001b[31mjest.fn()\u001b[39m\u001b[2m).\u001b[22mtoHaveBeenCalledWith\u001b[2m(\u001b[22m\u001b[32m...expected\u001b[39m\u001b[2m)\u001b[22m\n\n    Expected: \u001b[32mStringContaining \"UPDATE payment_reminders\"\u001b[39m, \u001b[32mArrayContaining [\"expired\"]\u001b[39m\n\n    Number of calls: \u001b[31m0\u001b[39m\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 326 |\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 327 |\u001b[39m       \u001b[90m// 验证结果\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 328 |\u001b[39m       expect(mockQuery)\u001b[33m.\u001b[39mtoHaveBeenCalledWith(\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                         \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 329 |\u001b[39m         expect\u001b[33m.\u001b[39mstringContaining(\u001b[32m'UPDATE payment_reminders'\u001b[39m)\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 330 |\u001b[39m         expect\u001b[33m.\u001b[39marrayContaining([\u001b[32m'expired'\u001b[39m])\u001b[22m\n\u001b[2m     \u001b[90m 331 |\u001b[39m       )\u001b[33m;\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.toHaveBeenCalledWith (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/scheduler.test.js\u001b[39m\u001b[0m\u001b[2m:328:25)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m定时任务服务测试 › cleanupExpiredReminders › 应该处理清理过期提醒失败的情况\u001b[39m\u001b[22m\n\n    \u001b[2mexpect(\u001b[22m\u001b[31mjest.fn()\u001b[39m\u001b[2m).\u001b[22mtoHaveBeenCalled\u001b[2m()\u001b[22m\n\n    Expected number of calls: >= \u001b[32m1\u001b[39m\n    Received number of calls:    \u001b[31m0\u001b[39m\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 347 |\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 348 |\u001b[39m       \u001b[90m// 验证结果\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 349 |\u001b[39m       expect(mockQuery)\u001b[33m.\u001b[39mtoHaveBeenCalled()\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                         \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 350 |\u001b[39m       expect(result)\u001b[33m.\u001b[39mtoEqual({\u001b[22m\n\u001b[2m     \u001b[90m 351 |\u001b[39m         success\u001b[33m:\u001b[39m \u001b[36mfalse\u001b[39m\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 352 |\u001b[39m         message\u001b[33m:\u001b[39m \u001b[32m'过期提醒清理失败: 数据库连接失败'\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.toHaveBeenCalled (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/scheduler.test.js\u001b[39m\u001b[0m\u001b[2m:349:25)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m定时任务服务测试 › generatePaymentStats › 应该成功生成支付统计报告\u001b[39m\u001b[22m\n\n    \u001b[2mexpect(\u001b[22m\u001b[31mjest.fn()\u001b[39m\u001b[2m).\u001b[22mtoHaveBeenCalledWith\u001b[2m(\u001b[22m\u001b[32m...expected\u001b[39m\u001b[2m)\u001b[22m\n\n    Expected: \u001b[32mStringContaining \"INSERT INTO payment_stats\"\u001b[39m, \u001b[32mAny<Array>\u001b[39m\n\n    Number of calls: \u001b[31m0\u001b[39m\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 378 |\u001b[39m       \u001b[90m// 验证结果\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 379 |\u001b[39m       expect(paymentQueryService\u001b[33m.\u001b[39mgetPaymentRecords)\u001b[33m.\u001b[39mtoHaveBeenCalled()\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 380 |\u001b[39m       expect(mockQuery)\u001b[33m.\u001b[39mtoHaveBeenCalledWith(\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                         \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 381 |\u001b[39m         expect\u001b[33m.\u001b[39mstringContaining(\u001b[32m'INSERT INTO payment_stats'\u001b[39m)\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 382 |\u001b[39m         expect\u001b[33m.\u001b[39many(\u001b[33mArray\u001b[39m)\u001b[22m\n\u001b[2m     \u001b[90m 383 |\u001b[39m       )\u001b[33m;\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.toHaveBeenCalledWith (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/scheduler.test.js\u001b[39m\u001b[0m\u001b[2m:380:25)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m定时任务服务测试 › generatePaymentStats › 应该处理没有支付记录的情况\u001b[39m\u001b[22m\n\n    \u001b[2mexpect(\u001b[22m\u001b[31mjest.fn()\u001b[39m\u001b[2m).\u001b[22mtoHaveBeenCalledWith\u001b[2m(\u001b[22m\u001b[32m...expected\u001b[39m\u001b[2m)\u001b[22m\n\n    Expected: \u001b[32mStringContaining \"INSERT INTO payment_stats\"\u001b[39m, \u001b[32mAny<Array>\u001b[39m\n\n    Number of calls: \u001b[31m0\u001b[39m\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 418 |\u001b[39m       \u001b[90m// 验证结果\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 419 |\u001b[39m       expect(paymentQueryService\u001b[33m.\u001b[39mgetPaymentRecords)\u001b[33m.\u001b[39mtoHaveBeenCalled()\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 420 |\u001b[39m       expect(mockQuery)\u001b[33m.\u001b[39mtoHaveBeenCalledWith(\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                         \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 421 |\u001b[39m         expect\u001b[33m.\u001b[39mstringContaining(\u001b[32m'INSERT INTO payment_stats'\u001b[39m)\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 422 |\u001b[39m         expect\u001b[33m.\u001b[39many(\u001b[33mArray\u001b[39m)\u001b[22m\n\u001b[2m     \u001b[90m 423 |\u001b[39m       )\u001b[33m;\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.toHaveBeenCalledWith (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/scheduler.test.js\u001b[39m\u001b[0m\u001b[2m:420:25)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m定时任务服务测试 › triggerTask › 应该在任务不存在时返回错误\u001b[39m\u001b[22m\n\n    \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoEqual\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m) // deep equality\u001b[22m\n\n    \u001b[32m- Expected  - 1\u001b[39m\n    \u001b[31m+ Received  + 1\u001b[39m\n\n    \u001b[2m  Object {\u001b[22m\n    \u001b[32m-   \"message\": \"任务 nonExistentTask 不存在\",\u001b[39m\n    \u001b[31m+   \"message\": \"未知的任务名称: nonExistentTask\",\u001b[39m\n    \u001b[2m    \"success\": false,\u001b[22m\n    \u001b[2m  }\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 555 |\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 556 |\u001b[39m       \u001b[90m// 验证结果\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 557 |\u001b[39m       expect(result)\u001b[33m.\u001b[39mtoEqual({\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                      \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 558 |\u001b[39m         success\u001b[33m:\u001b[39m \u001b[36mfalse\u001b[39m\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 559 |\u001b[39m         message\u001b[33m:\u001b[39m \u001b[32m'任务 nonExistentTask 不存在'\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 560 |\u001b[39m       })\u001b[33m;\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.toEqual (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/scheduler.test.js\u001b[39m\u001b[0m\u001b[2m:557:22)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m定时任务服务测试 › triggerTask › 应该处理任务执行失败的情况\u001b[39m\u001b[22m\n\n    \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoEqual\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m) // deep equality\u001b[22m\n\n    \u001b[32m- Expected  - 1\u001b[39m\n    \u001b[31m+ Received  + 1\u001b[39m\n\n    \u001b[2m  Object {\u001b[22m\n    \u001b[32m-   \"message\": \"任务 paymentReminderCheck 执行失败: 任务执行失败\",\u001b[39m\n    \u001b[31m+   \"message\": \"任务执行失败: 任务执行失败\",\u001b[39m\n    \u001b[2m    \"success\": false,\u001b[22m\n    \u001b[2m  }\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 573 |\u001b[39m       \u001b[90m// 验证结果\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 574 |\u001b[39m       expect(mockTaskFunction)\u001b[33m.\u001b[39mtoHaveBeenCalled()\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 575 |\u001b[39m       expect(result)\u001b[33m.\u001b[39mtoEqual({\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                      \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 576 |\u001b[39m         success\u001b[33m:\u001b[39m \u001b[36mfalse\u001b[39m\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 577 |\u001b[39m         message\u001b[33m:\u001b[39m \u001b[32m'任务 paymentReminderCheck 执行失败: 任务执行失败'\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 578 |\u001b[39m       })\u001b[33m;\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.toEqual (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/scheduler.test.js\u001b[39m\u001b[0m\u001b[2m:575:22)\u001b[22m\u001b[2m\u001b[22m\n","name":"C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\scheduler.test.js","startTime":1762155956526,"status":"failed","summary":""}],"wasInterrupted":false}
