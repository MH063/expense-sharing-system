## 一、用户认证与账户管理接口

### 1. 用户登录接口
```json
{
  "接口地址": "/auth/login",
  "请求方法": "POST",
  "请求参数": {
    "username": "string, 用户名",
    "password": "string, 密码",
    "device_id": "string, 可选，设备ID",
    "platform": "string, 可选，平台类型"
  },
  "返回结果": {
    "code": "number, 状态码",
    "message": "string, 返回消息",
    "data": {
      "access_token": "string, 访问令牌",
      "refresh_token": "string, 刷新令牌",
      "expires_in": "number, 过期时间(秒)",
      "user": {
        "id": "number, 用户ID",
        "username": "string, 用户名",
        "email": "string, 邮箱",
        "avatar_url": "string, 头像URL",
        "phone": "string, 手机号",
        "status": "string, 用户状态"
      }
    }
  }
}
```

### 2. 用户注册接口
```json
{
  "接口地址": "/auth/register",
  "请求方法": "POST",
  "请求参数": {
    "username": "string, 用户名",
    "email": "string, 邮箱",
    "password": "string, 密码",
    "confirm_password": "string, 确认密码",
    "phone": "string, 可选，手机号"
  },
  "返回结果": {
    "code": "number, 状态码",
    "message": "string, 返回消息",
    "data": {
      "id": "number, 用户ID",
      "username": "string, 用户名",
      "email": "string, 邮箱",
      "created_at": "string, 创建时间"
    }
  }
}
```

### 3. 获取当前用户信息
```json
{
  "接口地址": "/users/profile",
  "请求方法": "GET",
  "请求参数": {
    "Authorization": "string, Bearer token"
  },
  "返回结果": {
    "code": "number, 状态码",
    "message": "string, 返回消息",
    "data": {
      "id": "number, 用户ID",
      "username": "string, 用户名",
      "email": "string, 邮箱",
      "avatar_url": "string, 头像URL",
      "phone": "string, 手机号",
      "status": "string, 用户状态",
      "email_verified": "boolean, 邮箱验证状态",
      "created_at": "string, 创建时间",
      "profile": {
        "full_name": "string, 全名",
        "nickname": "string, 昵称",
        "gender": "string, 性别",
        "birth_date": "string, 生日",
        "location": "string, 位置",
        "bio": "string, 个人简介"
      },
      "settings": {
        "language": "string, 语言",
        "timezone": "string, 时区",
        "currency": "string, 货币",
        "notification_email": "boolean, 邮件通知",
        "notification_push": "boolean, 推送通知",
        "privacy_level": "string, 隐私级别"
      }
    }
  }
}
```

### 4. 更新用户资料
```json
{
  "接口地址": "/users/profile",
  "请求方法": "PUT",
  "请求参数": {
    "Authorization": "string, Bearer token",
    "Content-Type": "application/json",
    "body": {
      "full_name": "string, 可选，全名",
      "nickname": "string, 可选，昵称",
      "gender": "string, 可选，性别",
      "birth_date": "string, 可选，生日",
      "location": "string, 可选，位置",
      "bio": "string, 可选，个人简介",
      "phone": "string, 可选，手机号"
    }
  },
  "返回结果": {
    "code": "number, 状态码",
    "message": "string, 返回消息",
    "data": {
      "id": "number, 用户ID",
      "username": "string, 用户名",
      "email": "string, 邮箱",
      "updated_at": "string, 更新时间"
    }
  }
}
```

### 5. 忘记密码
```json
{
  "接口地址": "/auth/forgot-password",
  "请求方法": "POST",
  "请求参数": {
    "Content-Type": "application/json",
    "body": {
      "email": "string, 必填，邮箱"
    }
  },
  "返回结果": {
    "code": "number, 状态码",
    "message": "string, 返回消息",
    "data": {
      "email": "string, 邮箱",
      "reset_token_sent": "boolean, 是否发送重置令牌",
      "expires_in": "number, 过期时间(分钟)"
    }
  }
}
```

### 6. 重置密码
```json
{
  "接口地址": "/auth/reset-password",
  "请求方法": "POST",
  "请求参数": {
    "Content-Type": "application/json",
    "body": {
      "token": "string, 必填，重置令牌",
      "new_password": "string, 必填，新密码",
      "confirm_password": "string, 必填，确认密码"
    }
  },
  "返回结果": {
    "code": "number, 状态码",
    "message": "string, 返回消息",
    "data": {
      "email": "string, 邮箱",
      "password_reset": "boolean, 密码是否重置",
      "reset_at": "string, 重置时间"
    }
  }
}
```

### 7. 修改密码
```json
{
  "接口地址": "/auth/change-password",
  "请求方法": "POST",
  "请求参数": {
    "Authorization": "string, Bearer token",
    "Content-Type": "application/json",
    "body": {
      "current_password": "string, 必填，当前密码",
      "new_password": "string, 必填，新密码",
      "confirm_password": "string, 必填，确认密码"
    }
  },
  "返回结果": {
    "code": "number, 状态码",
    "message": "string, 返回消息",
    "data": {
      "password_changed": "boolean, 密码是否修改",
      "changed_at": "string, 修改时间"
    }
  }
}
```

### 8. 登出接口
```json
{
  "接口地址": "/auth/logout",
  "请求方法": "POST",
  "请求参数": {
    "Authorization": "string, Bearer token",
    "Content-Type": "application/json",
    "body": {
      "device_id": "string, 可选，设备ID",
      "logout_all": "boolean, 可选，是否登出所有设备"
    }
  },
  "返回结果": {
    "code": "number, 状态码",
    "message": "string, 返回消息",
    "data": {
      "success": "boolean, 是否成功",
      "logged_out_at": "string, 登出时间"
    }
  }
}
```

### 9. 刷新令牌接口
```json
{
  "接口地址": "/auth/refresh-token",
  "请求方法": "POST",
  "请求参数": {
    "Content-Type": "application/json",
    "body": {
      "refresh_token": "string, 必填，刷新令牌"
    }
  },
  "返回结果": {
    "code": "number, 状态码",
    "message": "string, 返回消息",
    "data": {
      "access_token": "string, 新的访问令牌",
      "refresh_token": "string, 新的刷新令牌",
      "expires_in": "number, 过期时间(秒)"
    }
  }
}
```

### 10. 上传用户头像
```json
{
  "接口地址": "/users/avatar",
  "请求方法": "POST",
  "请求参数": {
    "Authorization": "string, Bearer token",
    "Content-Type": "multipart/form-data",
    "body": {
      "avatar": "file, 必填，头像文件"
    }
  },
  "返回结果": {
    "code": "number, 状态码",
    "message": "string, 返回消息",
    "data": {
      "avatar_url": "string, 头像URL",
      "updated_at": "string, 更新时间"
    }
  }
}
```

### 11. 获取用户设置
```json
{
  "接口地址": "/users/settings",
  "请求方法": "GET",
  "请求参数": {
    "Authorization": "string, Bearer token"
  },
  "返回结果": {
    "code": "number, 状态码",
    "message": "string, 返回消息",
    "data": {
      "language": "string, 语言",
      "timezone": "string, 时区",
      "currency": "string, 货币",
      "notification_email": "boolean, 邮件通知",
      "notification_push": "boolean, 推送通知",
      "privacy_level": "string, 隐私级别"
    }
  }
}
```

### 12. 更新用户设置
```json
{
  "接口地址": "/users/settings",
  "请求方法": "PUT",
  "请求参数": {
    "Authorization": "string, Bearer token",
    "Content-Type": "application/json",
    "body": {
      "language": "string, 可选，语言",
      "timezone": "string, 可选，时区",
      "currency": "string, 可选，货币",
      "notification_email": "boolean, 可选，邮件通知",
      "notification_push": "boolean, 可选，推送通知",
      "privacy_level": "string, 可选，隐私级别"
    }
  },
  "返回结果": {
    "code": "number, 状态码",
    "message": "string, 返回消息",
    "data": {
      "updated_at": "string, 更新时间"
    }
  }
}
```

### 13. 绑定第三方账号
```json
{
  "接口地址": "/users/bind-third-party",
  "请求方法": "POST",
  "请求参数": {
    "Authorization": "string, Bearer token",
    "Content-Type": "application/json",
    "body": {
      "provider": "string, 必填，第三方提供商",
      "provider_user_id": "string, 必填，第三方用户ID",
      "access_token": "string, 必填，第三方访问令牌",
      "refresh_token": "string, 可选，第三方刷新令牌"
    }
  },
  "返回结果": {
    "code": "number, 状态码",
    "message": "string, 返回消息",
    "data": {
      "id": "number, 绑定记录ID",
      "provider": "string, 第三方提供商",
      "provider_user_id": "string, 第三方用户ID",
      "created_at": "string, 绑定时间"
    }
  }
}
```

### 14. 解绑第三方账号
```json
{
  "接口地址": "/users/unbind-third-party",
  "请求方法": "DELETE",
  "请求参数": {
    "Authorization": "string, Bearer token",
    "Content-Type": "application/json",
    "body": {
      "provider": "string, 必填，第三方提供商"
    }
  },
  "返回结果": {
    "code": "number, 状态码",
    "message": "string, 返回消息",
    "data": {
      "success": "boolean, 是否成功",
      "unbound_at": "string, 解绑时间"
    }
  }
}
```

### 15. 获取用户活动日志
```json
{
  "接口地址": "/users/activity-logs",
  "请求方法": "GET",
  "请求参数": {
    "Authorization": "string, Bearer token",
    "查询参数": {
      "page": "number, 可选，页码",
      "page_size": "number, 可选，每页大小",
      "start_date": "string, 可选，开始日期",
      "end_date": "string, 可选，结束日期",
      "action": "string, 可选，操作类型",
      "resource_type": "string, 可选，资源类型"
    }
  },
  "返回结果": {
    "code": "number, 状态码",
    "message": "string, 返回消息",
    "data": {
      "logs": [
        {
          "id": "number, 日志ID",
          "action": "string, 操作类型",
          "resource_type": "string, 资源类型",
          "resource_id": "number, 资源ID",
          "ip_address": "string, IP地址",
          "user_agent": "string, 用户代理",
          "created_at": "string, 创建时间"
        }
      ],
      "pagination": {
        "page": "number, 当前页码",
        "page_size": "number, 每页大小",
        "total": "number, 总记录数",
        "total_pages": "number, 总页数"
      }
    }
  }
}
```

## 二、账单管理接口

### 1. 获取账单列表
```json
{
  "接口地址": "/bills",
  "请求方法": "GET",
  "请求参数": {
    "Authorization": "string, Bearer token",
    "查询参数": {
      "room_id": "number, 可选，房间ID",
      "status": "string, 可选，账单状态",
      "page": "number, 可选，页码",
      "page_size": "number, 可选，每页大小",
      "start_date": "string, 可选，开始日期",
      "end_date": "string, 可选，结束日期"
    }
  },
  "返回结果": {
    "code": "number, 状态码",
    "message": "string, 返回消息",
    "data": {
      "bills": [
        {
          "id": "number, 账单ID",
          "title": "string, 账单标题",
          "description": "string, 账单描述",
          "amount": "number, 账单金额",
          "currency": "string, 货币类型",
          "category_id": "number, 分类ID",
          "category_name": "string, 分类名称",
          "creator_id": "number, 创建者ID",
          "creator_name": "string, 创建者名称",
          "room_id": "number, 房间ID",
          "room_name": "string, 房间名称",
          "status": "string, 账单状态",
          "due_date": "string, 到期日期",
          "settled_at": "string, 结算时间",
          "created_at": "string, 创建时间",
          "updated_at": "string, 更新时间"
        }
      ],
      "pagination": {
        "page": "number, 当前页码",
        "page_size": "number, 每页大小",
        "total": "number, 总记录数",
        "total_pages": "number, 总页数"
      }
    }
  }
}
```

### 2. 创建账单
```json
{
  "接口地址": "/bills",
  "请求方法": "POST",
  "请求参数": {
    "Authorization": "string, Bearer token",
    "Content-Type": "application/json",
    "body": {
      "title": "string, 必填，账单标题",
      "description": "string, 可选，账单描述",
      "amount": "number, 必填，账单金额",
      "currency": "string, 可选，货币类型，默认CNY",
      "category_id": "number, 必填，分类ID",
      "room_id": "number, 必填，房间ID",
      "due_date": "string, 可选，到期日期",
      "splits": [
        {
          "user_id": "number, 必填，用户ID",
          "amount": "number, 可选，分摊金额",
          "percentage": "number, 可选，分摊比例"
        }
      ]
    }
  },
  "返回结果": {
    "code": "number, 状态码",
    "message": "string, 返回消息",
    "data": {
      "id": "number, 账单ID",
      "title": "string, 账单标题",
      "amount": "number, 账单金额",
      "status": "string, 账单状态",
      "created_at": "string, 创建时间"
    }
  }
}
```

### 3. 结算账单
```json
{
  "接口地址": "/bills/{billId}/settle",
  "请求方法": "POST",
  "请求参数": {
    "Authorization": "string, Bearer token",
    "路径参数": {
      "billId": "number, 必填，账单ID"
    },
    "Content-Type": "application/json",
    "body": {
      "payment_method": "string, 可选，支付方式",
      "payment_details": "object, 可选，支付详情",
      "settlement_date": "string, 可选，结算日期"
    }
  },
  "返回结果": {
    "code": "number, 状态码",
    "message": "string, 返回消息",
    "data": {
      "bill_id": "number, 账单ID",
      "status": "string, 结算状态",
      "settled_at": "string, 结算时间",
      "settlement_details": {
        "total_amount": "number, 总金额",
        "settled_amount": "number, 已结算金额",
        "pending_amount": "number, 待结算金额"
      }
    }
  }
}
```

### 6. 获取账单详情
```json
{
  "接口地址": "/bills/{bill_id}",
  "请求方法": "GET",
  "请求参数": {
    "Authorization": "string, Bearer token",
    "路径参数": {
      "bill_id": "number, 必填，账单ID"
    }
  },
  "返回结果": {
    "code": "number, 状态码",
    "message": "string, 返回消息",
    "data": {
      "id": "number, 账单ID",
      "title": "string, 账单标题",
      "description": "string, 账单描述",
      "amount": "number, 金额",
      "currency": "string, 货币",
      "type": "string, 账单类型(expense/income)",
      "category_id": "number, 分类ID",
      "category_name": "string, 分类名称",
      "room_id": "number, 房间ID",
      "room_name": "string, 房间名称",
      "payer_id": "number, 支付者ID",
      "payer_name": "string, 支付者姓名",
      "split_type": "string, 分摊类型(equal/percentage/custom)",
      "split_details": [
        {
          "user_id": "number, 用户ID",
          "user_name": "string, 用户姓名",
          "amount": "number, 分摊金额",
          "percentage": "number, 分摊比例"
        }
      ],
      "status": "string, 状态(pending/paid/cancelled)",
      "due_date": "string, 到期日期",
      "paid_at": "string, 支付时间",
      "created_at": "string, 创建时间",
      "updated_at": "string, 更新时间",
      "attachments": [
        {
          "id": "number, 附件ID",
          "file_name": "string, 文件名",
          "file_url": "string, 文件URL",
          "file_size": "number, 文件大小"
        }
      ],
      "tags": [
        {
          "id": "number, 标签ID",
          "name": "string, 标签名称",
          "color": "string, 标签颜色"
        }
      ]
    }
  }
}
```

### 7. 更新账单
```json
{
  "接口地址": "/bills/{bill_id}",
  "请求方法": "PUT",
  "请求参数": {
    "Authorization": "string, Bearer token",
    "Content-Type": "application/json",
    "路径参数": {
      "bill_id": "number, 必填，账单ID"
    },
    "body": {
      "title": "string, 可选，账单标题",
      "description": "string, 可选，账单描述",
      "amount": "number, 可选，金额",
      "currency": "string, 可选，货币",
      "category_id": "number, 可选，分类ID",
      "split_type": "string, 可选，分摊类型(equal/percentage/custom)",
      "split_details": [
        {
          "user_id": "number, 必填，用户ID",
          "amount": "number, 可选，分摊金额",
          "percentage": "number, 可选，分摊比例"
        }
      ],
      "due_date": "string, 可选，到期日期",
      "tags": [
        {
          "id": "number, 可选，标签ID"
        }
      ]
    }
  },
  "返回结果": {
    "code": "number, 状态码",
    "message": "string, 返回消息",
    "data": {
      "id": "number, 账单ID",
      "updated_at": "string, 更新时间"
    }
  }
}
```

### 8. 删除账单
```json
{
  "接口地址": "/bills/{bill_id}",
  "请求方法": "DELETE",
  "请求参数": {
    "Authorization": "string, Bearer token",
    "路径参数": {
      "bill_id": "number, 必填，账单ID"
    }
  },
  "返回结果": {
    "code": "number, 状态码",
    "message": "string, 返回消息",
    "data": {
      "success": "boolean, 是否成功",
      "deleted_at": "string, 删除时间"
    }
  }
}
```

### 9. 批量操作账单
```json
{
  "接口地址": "/bills/batch",
  "请求方法": "POST",
  "请求参数": {
    "Authorization": "string, Bearer token",
    "Content-Type": "application/json",
    "body": {
      "action": "string, 必填，操作类型(mark_paid/mark_unpaid/delete)",
      "bill_ids": "array, 必填，账单ID列表"
    }
  },
  "返回结果": {
    "code": "number, 状态码",
    "message": "string, 返回消息",
    "data": {
      "success_count": "number, 成功数量",
      "failed_count": "number, 失败数量",
      "failed_ids": "array, 失败的账单ID列表",
      "processed_at": "string, 处理时间"
    }
  }
}
```

### 10. 添加账单附件
```json
{
  "接口地址": "/bills/{bill_id}/attachments",
  "请求方法": "POST",
  "请求参数": {
    "Authorization": "string, Bearer token",
    "Content-Type": "multipart/form-data",
    "路径参数": {
      "bill_id": "number, 必填，账单ID"
    },
    "body": {
      "files": "array, 必填，文件列表"
    }
  },
  "返回结果": {
    "code": "number, 状态码",
    "message": "string, 返回消息",
    "data": {
      "attachments": [
        {
          "id": "number, 附件ID",
          "file_name": "string, 文件名",
          "file_url": "string, 文件URL",
          "file_size": "number, 文件大小",
          "uploaded_at": "string, 上传时间"
        }
      ]
    }
  }
}
```

### 11. 删除账单附件
```json
{
  "接口地址": "/bills/{bill_id}/attachments/{attachment_id}",
  "请求方法": "DELETE",
  "请求参数": {
    "Authorization": "string, Bearer token",
    "路径参数": {
      "bill_id": "number, 必填，账单ID",
      "attachment_id": "number, 必填，附件ID"
    }
  },
  "返回结果": {
    "code": "number, 状态码",
    "message": "string, 返回消息",
    "data": {
      "success": "boolean, 是否成功",
      "deleted_at": "string, 删除时间"
    }
  }
}
```

### 12. 复制账单
```json
{
  "接口地址": "/bills/{bill_id}/copy",
  "请求方法": "POST",
  "请求参数": {
    "Authorization": "string, Bearer token",
    "Content-Type": "application/json",
    "路径参数": {
      "bill_id": "number, 必填，账单ID"
    },
    "body": {
      "title": "string, 可选，新账单标题",
      "due_date": "string, 可选，新到期日期",
      "adjust_amount": "number, 可选，金额调整值"
    }
  },
  "返回结果": {
    "code": "number, 状态码",
    "message": "string, 返回消息",
    "data": {
      "id": "number, 新账单ID",
      "title": "string, 新账单标题",
      "amount": "number, 新账单金额",
      "created_at": "string, 创建时间"
    }
  }
}
```

### 13. 获取账单统计
```json
{
  "接口地址": "/bills/statistics",
  "请求方法": "GET",
  "请求参数": {
    "Authorization": "string, Bearer token",
    "查询参数": {
      "room_id": "number, 可选，房间ID",
      "category_id": "number, 可选，分类ID",
      "start_date": "string, 可选，开始日期",
      "end_date": "string, 可选，结束日期",
      "type": "string, 可选，账单类型(expense/income/all)"
    }
  },
  "返回结果": {
    "code": "number, 状态码",
    "message": "string, 返回消息",
    "data": {
      "total_amount": "number, 总金额",
      "total_expense": "number, 总支出",
      "total_income": "number, 总收入",
      "bill_count": "number, 账单数量",
      "paid_count": "number, 已支付账单数",
      "unpaid_count": "number, 未支付账单数",
      "category_statistics": [
        {
          "category_id": "number, 分类ID",
          "category_name": "string, 分类名称",
          "amount": "number, 金额",
          "percentage": "number, 占比"
        }
      ],
      "monthly_statistics": [
        {
          "month": "string, 月份",
          "expense": "number, 支出",
          "income": "number, 收入"
        }
      ]
    }
  }
}
```

### 14. 导出账单
```json
{
  "接口地址": "/bills/export",
  "请求方法": "GET",
  "请求参数": {
    "Authorization": "string, Bearer token",
    "查询参数": {
      "room_id": "number, 可选，房间ID",
      "category_id": "number, 可选，分类ID",
      "start_date": "string, 可选，开始日期",
      "end_date": "string, 可选，结束日期",
      "format": "string, 可选，导出格式(excel/csv/pdf)"
    }
  },
  "返回结果": {
    "code": "number, 状态码",
    "message": "string, 返回消息",
    "data": {
      "download_url": "string, 下载链接",
      "file_name": "string, 文件名",
      "file_size": "number, 文件大小",
      "expires_at": "string, 链接过期时间"
    }
  }
}
```

## 三、费用管理接口

### 1. 获取费用列表
```json
{
  "接口地址": "/expenses",
  "请求方法": "GET",
  "请求参数": {
    "Authorization": "string, Bearer token",
    "查询参数": {
      "room_id": "number, 可选，房间ID",
      "category_id": "number, 可选，分类ID",
      "payer_id": "number, 可选，支付者ID",
      "calculation_method": "string, 可选，计算方式",
      "start_date": "string, 可选，开始日期",
      "end_date": "string, 可选，结束日期",
      "page": "number, 可选，页码",
      "page_size": "number, 可选，每页大小"
    }
  },
  "返回结果": {
    "code": "number, 状态码",
    "message": "string, 返回消息",
    "data": {
      "expenses": [
        {
          "id": "number, 费用ID",
          "title": "string, 费用标题",
          "description": "string, 费用描述",
          "amount": "number, 费用金额",
          "currency": "string, 货币类型",
          "category_id": "number, 分类ID",
          "category_name": "string, 分类名称",
          "payer_id": "number, 支付者ID",
          "payer_name": "string, 支付者名称",
          "room_id": "number, 房间ID",
          "room_name": "string, 房间名称",
          "expense_date": "string, 费用日期",
          "calculation_method": "string, 计算方式",
          "meter_type": "string, 仪表类型",
          "current_reading": "number, 当前读数",
          "previous_reading": "number, 上次读数",
          "unit_price": "number, 单价",
          "split_method": "string, 分摊方式",
          "receipt_url": "string, 凭证URL",
          "created_at": "string, 创建时间",
          "updated_at": "string, 更新时间"
        }
      ],
      "pagination": {
        "page": "number, 当前页码",
        "page_size": "number, 每页大小",
        "total": "number, 总记录数",
        "total_pages": "number, 总页数"
      }
    }
  }
}
```

### 2. 创建费用记录
```json
{
  "接口地址": "/expenses",
  "请求方法": "POST",
  "请求参数": {
    "Authorization": "string, Bearer token",
    "Content-Type": "application/json",
    "body": {
      "title": "string, 必填，费用标题",
      "description": "string, 可选，费用描述",
      "amount": "number, 必填，费用金额",
      "currency": "string, 可选，货币类型，默认CNY",
      "category_id": "number, 必填，分类ID",
      "payer_id": "number, 必填，支付者ID",
      "room_id": "number, 必填，房间ID",
      "expense_date": "string, 必填，费用日期",
      "calculation_method": "string, 可选，计算方式",
      "meter_type": "string, 可选，仪表类型",
      "current_reading": "number, 可选，当前读数",
      "previous_reading": "number, 可选，上次读数",
      "unit_price": "number, 可选，单价",
      "split_method": "string, 可选，分摊方式",
      "split_members": "array, 可选，分摊成员",
      "split_ratios": "object, 可选，分摊比例",
      "receipt_url": "string, 可选，凭证URL"
    }
  },
  "返回结果": {
    "code": "number, 状态码",
    "message": "string, 返回消息",
    "data": {
      "id": "number, 费用ID",
      "title": "string, 费用标题",
      "amount": "number, 费用金额",
      "expense_date": "string, 费用日期",
      "created_at": "string, 创建时间"
    }
  }
}
```

### 3. 获取费用统计
```json
{
  "接口地址": "/expenses/statistics",
  "请求方法": "GET",
  "请求参数": {
    "Authorization": "string, Bearer token",
    "查询参数": {
      "room_id": "number, 可选，房间ID",
      "start_date": "string, 可选，开始日期",
      "end_date": "string, 可选，结束日期",
      "group_by": "string, 可选，分组方式"
    }
  },
  "返回结果": {
    "code": "number, 状态码",
    "message": "string, 返回消息",
    "data": {
      "total_amount": "number, 总金额",
      "average_amount": "number, 平均金额",
      "expense_count": "number, 费用数量",
      "category_stats": [
        {
          "category_id": "number, 分类ID",
          "category_name": "string, 分类名称",
          "amount": "number, 金额",
          "percentage": "number, 占比",
          "count": "number, 数量"
        }
      ],
      "monthly_trends": [
        {
          "month": "string, 月份",
          "amount": "number, 金额",
          "count": "number, 数量"
        }
      ],
      "user_comparison": [
        {
          "user_id": "number, 用户ID",
          "user_name": "string, 用户名称",
          "total_amount": "number, 总金额",
          "percentage": "number, 占比"
        }
      ]
    }
  }
}
```

### 5. 获取费用分类详情
```json
{
  "接口地址": "/expense-categories/{category_id}",
  "请求方法": "GET",
  "请求参数": {
    "Authorization": "string, Bearer token",
    "路径参数": {
      "category_id": "number, 必填，分类ID"
    }
  },
  "返回结果": {
    "code": "number, 状态码",
    "message": "string, 返回消息",
    "data": {
      "id": "number, 分类ID",
      "name": "string, 分类名称",
      "icon": "string, 图标",
      "color": "string, 颜色",
      "description": "string, 描述",
      "parent_id": "number, 父分类ID",
      "parent_name": "string, 父分类名称",
      "room_id": "number, 房间ID",
      "room_name": "string, 房间名称",
      "is_default": "boolean, 是否默认分类",
      "sort_order": "number, 排序顺序",
      "created_by": "number, 创建者ID",
      "created_by_name": "string, 创建者姓名",
      "created_at": "string, 创建时间",
      "updated_at": "string, 更新时间",
      "bill_count": "number, 关联账单数量",
      "total_amount": "number, 总金额"
    }
  }
}
```

### 6. 创建费用分类
```json
{
  "接口地址": "/expense-categories",
  "请求方法": "POST",
  "请求参数": {
    "Authorization": "string, Bearer token",
    "Content-Type": "application/json",
    "body": {
      "name": "string, 必填，分类名称",
      "icon": "string, 可选，图标",
      "color": "string, 可选，颜色",
      "description": "string, 可选，描述",
      "parent_id": "number, 可选，父分类ID",
      "room_id": "number, 可选，房间ID",
      "sort_order": "number, 可选，排序顺序"
    }
  },
  "返回结果": {
    "code": "number, 状态码",
    "message": "string, 返回消息",
    "data": {
      "id": "number, 分类ID",
      "name": "string, 分类名称",
      "created_at": "string, 创建时间"
    }
  }
}
```

### 7. 更新费用分类
```json
{
  "接口地址": "/expense-categories/{category_id}",
  "请求方法": "PUT",
  "请求参数": {
    "Authorization": "string, Bearer token",
    "Content-Type": "application/json",
    "路径参数": {
      "category_id": "number, 必填，分类ID"
    },
    "body": {
      "name": "string, 可选，分类名称",
      "icon": "string, 可选，图标",
      "color": "string, 可选，颜色",
      "description": "string, 可选，描述",
      "parent_id": "number, 可选，父分类ID",
      "sort_order": "number, 可选，排序顺序"
    }
  },
  "返回结果": {
    "code": "number, 状态码",
    "message": "string, 返回消息",
    "data": {
      "id": "number, 分类ID",
      "updated_at": "string, 更新时间"
    }
  }
}
```

### 8. 删除费用分类
```json
{
  "接口地址": "/expense-categories/{category_id}",
  "请求方法": "DELETE",
  "请求参数": {
    "Authorization": "string, Bearer token",
    "路径参数": {
      "category_id": "number, 必填，分类ID"
    }
  },
  "返回结果": {
    "code": "number, 状态码",
    "message": "string, 返回消息",
    "data": {
      "success": "boolean, 是否成功",
      "deleted_at": "string, 删除时间"
    }
  }
}
```

### 9. 获取费用分摊详情
```json
{
  "接口地址": "/expense-splits/{split_id}",
  "请求方法": "GET",
  "请求参数": {
    "Authorization": "string, Bearer token",
    "路径参数": {
      "split_id": "number, 必填，分摊ID"
    }
  },
  "返回结果": {
    "code": "number, 状态码",
    "message": "string, 返回消息",
    "data": {
      "id": "number, 分摊ID",
      "bill_id": "number, 账单ID",
      "bill_title": "string, 账单标题",
      "room_id": "number, 房间ID",
      "room_name": "string, 房间名称",
      "payer_id": "number, 支付者ID",
      "payer_name": "string, 支付者姓名",
      "split_type": "string, 分摊类型",
      "total_amount": "number, 总金额",
      "currency": "string, 货币",
      "participants": [
        {
          "user_id": "number, 用户ID",
          "user_name": "string, 用户姓名",
          "amount": "number, 分摊金额",
          "percentage": "number, 分摊比例",
          "status": "string, 状态(pending/paid/settled)",
          "paid_at": "string, 支付时间"
        }
      ],
      "created_at": "string, 创建时间",
      "updated_at": "string, 更新时间"
    }
  }
}
```

### 10. 创建费用分摊
```json
{
  "接口地址": "/expense-splits",
  "请求方法": "POST",
  "请求参数": {
    "Authorization": "string, Bearer token",
    "Content-Type": "application/json",
    "body": {
      "bill_id": "number, 必填，账单ID",
      "split_type": "string, 必填，分摊类型(equal/percentage/custom)",
      "participants": [
        {
          "user_id": "number, 必填，用户ID",
          "amount": "number, 可选，分摊金额",
          "percentage": "number, 可选，分摊比例"
        }
      ]
    }
  },
  "返回结果": {
    "code": "number, 状态码",
    "message": "string, 返回消息",
    "data": {
      "id": "number, 分摊ID",
      "bill_id": "number, 账单ID",
      "created_at": "string, 创建时间"
    }
  }
}
```

### 11. 更新费用分摊
```json
{
  "接口地址": "/expense-splits/{split_id}",
  "请求方法": "PUT",
  "请求参数": {
    "Authorization": "string, Bearer token",
    "Content-Type": "application/json",
    "路径参数": {
      "split_id": "number, 必填，分摊ID"
    },
    "body": {
      "split_type": "string, 可选，分摊类型",
      "participants": [
        {
          "user_id": "number, 必填，用户ID",
          "amount": "number, 可选，分摊金额",
          "percentage": "number, 可选，分摊比例"
        }
      ]
    }
  },
  "返回结果": {
    "code": "number, 状态码",
    "message": "string, 返回消息",
    "data": {
      "id": "number, 分摊ID",
      "updated_at": "string, 更新时间"
    }
  }
}
```

### 12. 删除费用分摊
```json
{
  "接口地址": "/expense-splits/{split_id}",
  "请求方法": "DELETE",
  "请求参数": {
    "Authorization": "string, Bearer token",
    "路径参数": {
      "split_id": "number, 必填，分摊ID"
    }
  },
  "返回结果": {
    "code": "number, 状态码",
    "message": "string, 返回消息",
    "data": {
      "success": "boolean, 是否成功",
      "deleted_at": "string, 删除时间"
    }
  }
}
```

### 13. 获取用户费用分摊记录
```json
{
  "接口地址": "/expense-splits/user/{user_id}",
  "请求方法": "GET",
  "请求参数": {
    "Authorization": "string, Bearer token",
    "路径参数": {
      "user_id": "number, 必填，用户ID"
    },
    "查询参数": {
      "room_id": "number, 可选，房间ID",
      "status": "string, 可选，状态(pending/paid/settled)",
      "start_date": "string, 可选，开始日期",
      "end_date": "string, 可选，结束日期",
      "page": "number, 可选，页码",
      "page_size": "number, 可选，每页大小"
    }
  },
  "返回结果": {
    "code": "number, 状态码",
    "message": "string, 返回消息",
    "data": {
      "splits": [
        {
          "id": "number, 分摊ID",
          "bill_id": "number, 账单ID",
          "bill_title": "string, 账单标题",
          "room_id": "number, 房间ID",
          "room_name": "string, 房间名称",
          "payer_id": "number, 支付者ID",
          "payer_name": "string, 支付者姓名",
          "amount": "number, 分摊金额",
          "currency": "string, 货币",
          "status": "string, 状态",
          "due_date": "string, 到期日期",
          "paid_at": "string, 支付时间",
          "created_at": "string, 创建时间"
        }
      ],
      "pagination": {
        "page": "number, 当前页码",
        "page_size": "number, 每页大小",
        "total": "number, 总记录数",
        "total_pages": "number, 总页数"
      },
      "summary": {
        "total_amount": "number, 总金额",
        "paid_amount": "number, 已支付金额",
        "pending_amount": "number, 待支付金额"
      }
    }
  }
}
```

### 14. 获取房间费用分摊统计
```json
{
  "接口地址": "/expense-splits/room/{room_id}/statistics",
  "请求方法": "GET",
  "请求参数": {
    "Authorization": "string, Bearer token",
    "路径参数": {
      "room_id": "number, 必填，房间ID"
    },
    "查询参数": {
      "start_date": "string, 可选，开始日期",
      "end_date": "string, 可选，结束日期"
    }
  },
  "返回结果": {
    "code": "number, 状态码",
    "message": "string, 返回消息",
    "data": {
      "total_amount": "number, 总金额",
      "user_statistics": [
        {
          "user_id": "number, 用户ID",
          "user_name": "string, 用户姓名",
          "total_paid": "number, 总支付金额",
          "total_owed": "number, 总欠款金额",
          "balance": "number, 余额"
        }
      ],
      "monthly_statistics": [
        {
          "month": "string, 月份",
          "total_amount": "number, 总金额",
          "split_count": "number, 分摊数量"
        }
      ]
    }
  }
}
```

## 四、房间管理接口

### 1. 获取用户加入的房间列表
```json
{
  "接口地址": "/rooms/my-rooms",
  "请求方法": "GET",
  "请求参数": {
    "Authorization": "string, Bearer token",
    "查询参数": {
      "page": "number, 可选，页码",
      "page_size": "number, 可选，每页大小",
      "status": "string, 可选，房间状态"
    }
  },
  "返回结果": {
    "code": "number, 状态码",
    "message": "string, 返回消息",
    "data": {
      "rooms": [
        {
          "id": "number, 房间ID",
          "name": "string, 房间名称",
          "description": "string, 房间描述",
          "cover_image": "string, 封面图片",
          "creator_id": "number, 创建者ID",
          "creator_name": "string, 创建者名称",
          "invite_code": "string, 邀请码",
          "status": "string, 房间状态",
          "member_count": "number, 成员数量",
          "role": "string, 当前用户角色",
          "joined_at": "string, 加入时间",
          "created_at": "string, 创建时间",
          "updated_at": "string, 更新时间"
        }
      ],
      "pagination": {
        "page": "number, 当前页码",
        "page_size": "number, 每页大小",
        "total": "number, 总记录数",
        "total_pages": "number, 总页数"
      }
    }
  }
}
```

### 2. 创建房间
```json
{
  "接口地址": "/rooms",
  "请求方法": "POST",
  "请求参数": {
    "Authorization": "string, Bearer token",
    "Content-Type": "application/json",
    "body": {
      "name": "string, 必填，房间名称",
      "description": "string, 可选，房间描述",
      "cover_image": "string, 可选，封面图片",
      "settings": {
        "default_split_method": "string, 可选，默认分摊方式",
        "require_receipt": "boolean, 可选，是否需要凭证",
        "max_monthly_expense": "number, 可选，月费用上限"
      }
    }
  },
  "返回结果": {
    "code": "number, 状态码",
    "message": "string, 返回消息",
    "data": {
      "id": "number, 房间ID",
      "name": "string, 房间名称",
      "description": "string, 房间描述",
      "invite_code": "string, 邀请码",
      "created_at": "string, 创建时间"
    }
  }
}
```

### 3. 邀请成员加入房间
```json
{
  "接口地址": "/rooms/{roomId}/invite",
  "请求方法": "POST",
  "请求参数": {
    "Authorization": "string, Bearer token",
    "路径参数": {
      "roomId": "number, 必填，房间ID"
    },
    "Content-Type": "application/json",
    "body": {
      "invitee_emails": "array, 可选，被邀请人邮箱列表",
      "invitee_ids": "array, 可选，被邀请人ID列表",
      "message": "string, 可选，邀请消息",
      "expires_days": "number, 可选，过期天数"
    }
  },
  "返回结果": {
    "code": "number, 状态码",
    "message": "string, 返回消息",
    "data": {
      "success_count": "number, 成功邀请数量",
      "failed_invites": [
        {
          "email": "string, 邮箱",
          "reason": "string, 失败原因"
        }
      ],
      "invitation_tokens": "array, 邀请令牌列表"
    }
  }
}
```

### 6. 获取房间详情
```json
{
  "接口地址": "/rooms/{room_id}",
  "请求方法": "GET",
  "请求参数": {
    "Authorization": "string, Bearer token",
    "路径参数": {
      "room_id": "number, 必填，房间ID"
    }
  },
  "返回结果": {
    "code": "number, 状态码",
    "message": "string, 返回消息",
    "data": {
      "id": "number, 房间ID",
      "name": "string, 房间名称",
      "description": "string, 房间描述",
      "avatar": "string, 房间头像",
      "type": "string, 房间类型",
      "owner_id": "number, 房主ID",
      "owner_name": "string, 房主姓名",
      "member_count": "number, 成员数量",
      "bill_count": "number, 账单数量",
      "total_amount": "number, 总金额",
      "currency": "string, 货币",
      "is_active": "boolean, 是否活跃",
      "created_at": "string, 创建时间",
      "updated_at": "string, 更新时间",
      "members": [
        {
          "user_id": "number, 用户ID",
          "user_name": "string, 用户姓名",
          "avatar": "string, 用户头像",
          "role": "string, 角色(owner/admin/member)",
          "joined_at": "string, 加入时间",
          "total_paid": "number, 总支付金额",
          "total_owed": "number, 总欠款金额",
          "balance": "number, 余额"
        }
      ],
      "categories": [
        {
          "id": "number, 分类ID",
          "name": "string, 分类名称",
          "icon": "string, 图标",
          "color": "string, 颜色"
        }
      ]
    }
  }
}
```

### 7. 更新房间信息
```json
{
  "接口地址": "/rooms/{room_id}",
  "请求方法": "PUT",
  "请求参数": {
    "Authorization": "string, Bearer token",
    "Content-Type": "application/json",
    "路径参数": {
      "room_id": "number, 必填，房间ID"
    },
    "body": {
      "name": "string, 可选，房间名称",
      "description": "string, 可选，房间描述",
      "avatar": "string, 可选，房间头像",
      "currency": "string, 可选，货币",
      "is_active": "boolean, 可选，是否活跃"
    }
  },
  "返回结果": {
    "code": "number, 状态码",
    "message": "string, 返回消息",
    "data": {
      "id": "number, 房间ID",
      "updated_at": "string, 更新时间"
    }
  }
}
```

### 8. 删除房间
```json
{
  "接口地址": "/rooms/{room_id}",
  "请求方法": "DELETE",
  "请求参数": {
    "Authorization": "string, Bearer token",
    "路径参数": {
      "room_id": "number, 必填，房间ID"
    }
  },
  "返回结果": {
    "code": "number, 状态码",
    "message": "string, 返回消息",
    "data": {
      "success": "boolean, 是否成功",
      "deleted_at": "string, 删除时间"
    }
  }
}
```

### 9. 添加房间成员
```json
{
  "接口地址": "/rooms/{room_id}/members",
  "请求方法": "POST",
  "请求参数": {
    "Authorization": "string, Bearer token",
    "Content-Type": "application/json",
    "路径参数": {
      "room_id": "number, 必填，房间ID"
    },
    "body": {
      "user_ids": "array, 必填，用户ID列表",
      "role": "string, 可选，角色(admin/member)"
    }
  },
  "返回结果": {
    "code": "number, 状态码",
    "message": "string, 返回消息",
    "data": {
      "success_count": "number, 成功添加数量",
      "failed_count": "number, 失败数量",
      "failed_ids": "array, 失败的用户ID列表",
      "added_at": "string, 添加时间"
    }
  }
}
```

### 10. 获取房间成员列表
```json
{
  "接口地址": "/rooms/{room_id}/members",
  "请求方法": "GET",
  "请求参数": {
    "Authorization": "string, Bearer token",
    "路径参数": {
      "room_id": "number, 必填，房间ID"
    },
    "查询参数": {
      "role": "string, 可选，角色过滤",
      "page": "number, 可选，页码",
      "page_size": "number, 可选，每页大小"
    }
  },
  "返回结果": {
    "code": "number, 状态码",
    "message": "string, 返回消息",
    "data": {
      "members": [
        {
          "user_id": "number, 用户ID",
          "user_name": "string, 用户姓名",
          "avatar": "string, 用户头像",
          "role": "string, 角色",
          "joined_at": "string, 加入时间",
          "total_paid": "number, 总支付金额",
          "total_owed": "number, 总欠款金额",
          "balance": "number, 余额",
          "bill_count": "number, 账单数量"
        }
      ],
      "pagination": {
        "page": "number, 当前页码",
        "page_size": "number, 每页大小",
        "total": "number, 总记录数",
        "total_pages": "number, 总页数"
      }
    }
  }
}
```

### 11. 更新成员角色
```json
{
  "接口地址": "/rooms/{room_id}/members/{user_id}/role",
  "请求方法": "PUT",
  "请求参数": {
    "Authorization": "string, Bearer token",
    "Content-Type": "application/json",
    "路径参数": {
      "room_id": "number, 必填，房间ID",
      "user_id": "number, 必填，用户ID"
    },
    "body": {
      "role": "string, 必填，角色(admin/member)"
    }
  },
  "返回结果": {
    "code": "number, 状态码",
    "message": "string, 返回消息",
    "data": {
      "user_id": "number, 用户ID",
      "room_id": "number, 房间ID",
      "role": "string, 新角色",
      "updated_at": "string, 更新时间"
    }
  }
}
```

### 12. 移除房间成员
```json
{
  "接口地址": "/rooms/{room_id}/members/{user_id}",
  "请求方法": "DELETE",
  "请求参数": {
    "Authorization": "string, Bearer token",
    "路径参数": {
      "room_id": "number, 必填，房间ID",
      "user_id": "number, 必填，用户ID"
    }
  },
  "返回结果": {
    "code": "number, 状态码",
    "message": "string, 返回消息",
    "data": {
      "success": "boolean, 是否成功",
      "removed_at": "string, 移除时间"
    }
  }
}
```

### 13. 离开房间
```json
{
  "接口地址": "/rooms/{room_id}/leave",
  "请求方法": "POST",
  "请求参数": {
    "Authorization": "string, Bearer token",
    "路径参数": {
      "room_id": "number, 必填，房间ID"
    }
  },
  "返回结果": {
    "code": "number, 状态码",
    "message": "string, 返回消息",
    "data": {
      "success": "boolean, 是否成功",
      "left_at": "string, 离开时间"
    }
  }
}
```

### 14. 获取房间统计信息
```json
{
  "接口地址": "/rooms/{room_id}/statistics",
  "请求方法": "GET",
  "请求参数": {
    "Authorization": "string, Bearer token",
    "路径参数": {
      "room_id": "number, 必填，房间ID"
    },
    "查询参数": {
      "start_date": "string, 可选，开始日期",
      "end_date": "string, 可选，结束日期"
    }
  },
  "返回结果": {
    "code": "number, 状态码",
    "message": "string, 返回消息",
    "data": {
      "total_amount": "number, 总金额",
      "total_expense": "number, 总支出",
      "total_income": "number, 总收入",
      "bill_count": "number, 账单数量",
      "member_count": "number, 成员数量",
      "category_statistics": [
        {
          "category_id": "number, 分类ID",
          "category_name": "string, 分类名称",
          "amount": "number, 金额",
          "percentage": "number, 占比"
        }
      ],
      "member_statistics": [
        {
          "user_id": "number, 用户ID",
          "user_name": "string, 用户姓名",
          "total_paid": "number, 总支付金额",
          "total_owed": "number, 总欠款金额",
          "balance": "number, 余额"
        }
      ],
      "monthly_statistics": [
        {
          "month": "string, 月份",
          "expense": "number, 支出",
          "income": "number, 收入"
        }
      ]
    }
  }
}
```

### 15. 转让房间所有权
```json
{
  "接口地址": "/rooms/{room_id}/transfer-ownership",
  "请求方法": "POST",
  "请求参数": {
    "Authorization": "string, Bearer token",
    "Content-Type": "application/json",
    "路径参数": {
      "room_id": "number, 必填，房间ID"
    },
    "body": {
      "new_owner_id": "number, 必填，新房主ID"
    }
  },
  "返回结果": {
    "code": "number, 状态码",
    "message": "string, 返回消息",
    "data": {
      "room_id": "number, 房间ID",
      "old_owner_id": "number, 原房主ID",
      "new_owner_id": "number, 新房主ID",
      "transferred_at": "string, 转让时间"
    }
  }
}
```

## 五、支付管理接口

### 1. 获取支付记录列表
```json
{
  "接口地址": "/payments",
  "请求方法": "GET",
  "请求参数": {
    "Authorization": "string, Bearer token",
    "查询参数": {
      "room_id": "number, 可选，房间ID",
      "bill_id": "number, 可选，账单ID",
      "status": "string, 可选，支付状态",
      "payer_id": "number, 可选，支付者ID",
      "payee_id": "number, 可选，收款者ID",
      "page": "number, 可选，页码",
      "page_size": "number, 可选，每页大小"
    }
  },
  "返回结果": {
    "code": "number, 状态码",
    "message": "string, 返回消息",
    "data": {
      "payments": [
        {
          "id": "number, 支付ID",
          "bill_id": "number, 账单ID",
          "bill_title": "string, 账单标题",
          "payer_id": "number, 支付者ID",
          "payer_name": "string, 支付者名称",
          "payee_id": "number, 收款者ID",
          "payee_name": "string, 收款者名称",
          "amount": "number, 支付金额",
          "currency": "string, 货币类型",
          "payment_method": "string, 支付方式",
          "payment_details": "object, 支付详情",
          "status": "string, 支付状态",
          "confirmed_at": "string, 确认时间",
          "cancelled_at": "string, 取消时间",
          "created_at": "string, 创建时间"
        }
      ],
      "pagination": {
        "page": "number, 当前页码",
        "page_size": "number, 每页大小",
        "total": "number, 总记录数",
        "total_pages": "number, 总页数"
      }
    }
  }
}
```

### 2. 确认支付
```json
{
  "接口地址": "/payments/{id}/confirm",
  "请求方法": "POST",
  "请求参数": {
    "Authorization": "string, Bearer token",
    "路径参数": {
      "id": "number, 必填，支付记录ID"
    },
    "Content-Type": "application/json",
    "body": {
      "confirmation_code": "string, 可选，确认码",
      "payment_details": "object, 可选，支付详情"
    }
  },
  "返回结果": {
    "code": "number, 状态码",
    "message": "string, 返回消息",
    "data": {
      "id": "number, 支付ID",
      "status": "string, 支付状态",
      "confirmed_at": "string, 确认时间",
      "confirmed_by": "number, 确认人ID"
    }
  }
}
```

### 1. 获取支付记录详情
```json
{
  "address": "/payments/{payment_id}",
  "method": "GET",
  "description": "获取指定支付记录的详细信息",
  "parameters": {
    "path": {
      "payment_id": {
        "type": "integer",
        "required": true,
        "description": "支付记录ID"
      }
    }
  },
  "response": {
    "success": true,
    "data": {
      "payment_id": 1,
      "bill_id": 5,
      "user_id": 2,
      "amount": 50.00,
      "payment_method": "alipay",
      "payment_status": "completed",
      "payment_time": "2023-06-15 14:30:00",
      "transaction_id": "202306151430001234",
      "remark": "支付备注",
      "created_at": "2023-06-15 14:30:00",
      "updated_at": "2023-06-15 14:30:00"
    }
  },
  "errors": {
    "404": "支付记录不存在",
    "403": "无权访问该支付记录"
  }
}
```

### 2. 创建支付记录
```json
{
  "address": "/payments",
  "method": "POST",
  "description": "创建新的支付记录",
  "parameters": {
    "body": {
      "bill_id": {
        "type": "integer",
        "required": true,
        "description": "账单ID"
      },
      "user_id": {
        "type": "integer",
        "required": true,
        "description": "支付用户ID"
      },
      "amount": {
        "type": "number",
        "required": true,
        "description": "支付金额"
      },
      "payment_method": {
        "type": "string",
        "required": true,
        "description": "支付方式",
        "options": ["alipay", "wechat", "bank_card", "cash"]
      },
      "remark": {
        "type": "string",
        "required": false,
        "description": "支付备注"
      }
    }
  },
  "response": {
    "success": true,
    "data": {
      "payment_id": 15,
      "bill_id": 5,
      "user_id": 2,
      "amount": 50.00,
      "payment_method": "alipay",
      "payment_status": "pending",
      "payment_time": null,
      "transaction_id": null,
      "remark": "支付备注",
      "created_at": "2023-06-15 14:30:00",
      "updated_at": "2023-06-15 14:30:00"
    }
  },
  "errors": {
    "400": "请求参数错误",
    "404": "账单不存在",
    "403": "无权为该账单创建支付记录"
  }
}
```

### 3. 更新支付记录
```json
{
  "address": "/payments/{payment_id}",
  "method": "PUT",
  "description": "更新支付记录信息",
  "parameters": {
    "path": {
      "payment_id": {
        "type": "integer",
        "required": true,
        "description": "支付记录ID"
      }
    },
    "body": {
      "amount": {
        "type": "number",
        "required": false,
        "description": "支付金额"
      },
      "payment_method": {
        "type": "string",
        "required": false,
        "description": "支付方式",
        "options": ["alipay", "wechat", "bank_card", "cash"]
      },
      "payment_status": {
        "type": "string",
        "required": false,
        "description": "支付状态",
        "options": ["pending", "completed", "failed", "cancelled"]
      },
      "transaction_id": {
        "type": "string",
        "required": false,
        "description": "交易流水号"
      },
      "remark": {
        "type": "string",
        "required": false,
        "description": "支付备注"
      }
    }
  },
  "response": {
    "success": true,
    "data": {
      "payment_id": 15,
      "bill_id": 5,
      "user_id": 2,
      "amount": 50.00,
      "payment_method": "alipay",
      "payment_status": "completed",
      "payment_time": "2023-06-15 14:35:00",
      "transaction_id": "202306151435001234",
      "remark": "更新后的支付备注",
      "created_at": "2023-06-15 14:30:00",
      "updated_at": "2023-06-15 14:35:00"
    }
  },
  "errors": {
    "400": "请求参数错误",
    "404": "支付记录不存在",
    "403": "无权更新该支付记录"
  }
}
```

### 4. 删除支付记录
```json
{
  "address": "/payments/{payment_id}",
  "method": "DELETE",
  "description": "删除指定的支付记录",
  "parameters": {
    "path": {
      "payment_id": {
        "type": "integer",
        "required": true,
        "description": "支付记录ID"
      }
    }
  },
  "response": {
    "success": true,
    "data": {
      "message": "支付记录删除成功"
    }
  },
  "errors": {
    "404": "支付记录不存在",
    "403": "无权删除该支付记录",
    "409": "支付记录已关联其他数据，无法删除"
  }
}
```

### 5. 获取支付方式列表
```json
{
  "address": "/payments/methods",
  "method": "GET",
  "description": "获取支持的支付方式列表",
  "parameters": {},
  "response": {
    "success": true,
    "data": [
      {
        "method_code": "alipay",
        "method_name": "支付宝",
        "icon": "https://example.com/icons/alipay.png",
        "enabled": true,
        "description": "支付宝支付"
      },
      {
        "method_code": "wechat",
        "method_name": "微信支付",
        "icon": "https://example.com/icons/wechat.png",
        "enabled": true,
        "description": "微信支付"
      },
      {
        "method_code": "bank_card",
        "method_name": "银行卡",
        "icon": "https://example.com/icons/bank.png",
        "enabled": true,
        "description": "银行卡支付"
      },
      {
        "method_code": "cash",
        "method_name": "现金",
        "icon": "https://example.com/icons/cash.png",
        "enabled": true,
        "description": "现金支付"
      }
    ]
  }
}
```

### 6. 获取用户支付统计
```json
{
  "address": "/payments/statistics",
  "method": "GET",
  "description": "获取用户支付统计数据",
  "parameters": {
    "query": {
      "user_id": {
        "type": "integer",
        "required": false,
        "description": "用户ID，不提供则获取当前用户数据"
      },
      "start_date": {
        "type": "string",
        "required": false,
        "description": "开始日期，格式：YYYY-MM-DD"
      },
      "end_date": {
        "type": "string",
        "required": false,
        "description": "结束日期，格式：YYYY-MM-DD"
      }
    }
  },
  "response": {
    "success": true,
    "data": {
      "total_amount": 1250.50,
      "total_count": 25,
      "completed_amount": 1200.00,
      "completed_count": 23,
      "pending_amount": 50.50,
      "pending_count": 2,
      "payment_methods": [
        {
          "method": "alipay",
          "amount": 750.00,
          "count": 15,
          "percentage": 60.0
        },
        {
          "method": "wechat",
          "amount": 400.00,
          "count": 7,
          "percentage": 32.0
        },
        {
          "method": "cash",
          "amount": 100.50,
          "count": 3,
          "percentage": 8.0
        }
      ],
      "monthly_trend": [
        {
          "month": "2023-05",
          "amount": 450.00,
          "count": 9
        },
        {
          "month": "2023-06",
          "amount": 800.50,
          "count": 16
        }
      ]
    }
  }
}
```

### 7. 批量操作支付记录
```json
{
  "address": "/payments/batch",
  "method": "POST",
  "description": "批量操作支付记录",
  "parameters": {
    "body": {
      "action": {
        "type": "string",
        "required": true,
        "description": "操作类型",
        "options": ["delete", "update_status"]
      },
      "payment_ids": {
        "type": "array",
        "required": true,
        "description": "支付记录ID列表",
        "items": {
          "type": "integer"
        }
      },
      "payment_status": {
        "type": "string",
        "required": false,
        "description": "支付状态（当action为update_status时必需）",
        "options": ["pending", "completed", "failed", "cancelled"]
      }
    }
  },
  "response": {
    "success": true,
    "data": {
      "success_count": 8,
      "failed_count": 2,
      "failed_ids": [15, 23],
      "message": "批量操作完成"
    }
  },
  "errors": {
    "400": "请求参数错误",
    "403": "无权操作部分或全部支付记录"
  }
}
```

## 六、通知管理接口

### 1. 获取通知列表
```json
{
  "接口地址": "/notifications",
  "请求方法": "GET",
  "请求参数": {
    "Authorization": "string, Bearer token",
    "查询参数": {
      "page": "number, 可选，页码",
      "page_size": "number, 可选，每页大小",
      "type": "string, 可选，通知类型",
      "is_read": "boolean, 可选，是否已读",
      "start_date": "string, 可选，开始日期",
      "end_date": "string, 可选，结束日期"
    }
  },
  "返回结果": {
    "code": "number, 状态码",
    "message": "string, 返回消息",
    "data": {
      "notifications": [
        {
          "id": "number, 通知ID",
          "title": "string, 通知标题",
          "content": "string, 通知内容",
          "type": "string, 通知类型",
          "is_read": "boolean, 是否已读",
          "related_entity_type": "string, 相关实体类型",
          "related_entity_id": "number, 相关实体ID",
          "created_at": "string, 创建时间",
          "metadata": "object, 附加数据"
        }
      ],
      "pagination": {
        "page": "number, 当前页码",
        "page_size": "number, 每页大小",
        "total": "number, 总记录数",
        "total_pages": "number, 总页数"
      },
      "unread_count": "number, 未读通知数量"
    }
  }
}
```

### 2. 批量标记通知为已读
```json
{
  "接口地址": "/notifications/mark-all-read",
  "请求方法": "PUT",
  "请求参数": {
    "Authorization": "string, Bearer token",
    "Content-Type": "application/json",
    "body": {
      "notification_ids": "array, 可选，通知ID列表，为空则标记所有",
      "types": "array, 可选，通知类型列表"
    }
  },
  "返回结果": {
    "code": "number, 状态码",
    "message": "string, 返回消息",
    "data": {
      "marked_count": "number, 标记数量",
      "unread_count": "number, 剩余未读数量"
    }
  }
}
```

### 3. 获取未读通知数量
```json
{
  "address": "/notifications/unread-count",
  "method": "GET",
  "description": "获取用户未读通知数量",
  "parameters": {},
  "response": {
    "success": true,
    "data": {
      "unread_count": 5,
      "total_count": 23
    }
  }
}
```

### 4. 删除通知
```json
{
  "address": "/notifications/{notification_id}",
  "method": "DELETE",
  "description": "删除指定通知",
  "parameters": {
    "path": {
      "notification_id": {
        "type": "integer",
        "required": true,
        "description": "通知ID"
      }
    }
  },
  "response": {
    "success": true,
    "data": {
      "message": "通知删除成功"
    }
  },
  "errors": {
    "404": "通知不存在",
    "403": "无权删除该通知"
  }
}
```

### 5. 批量删除通知
```json
{
  "address": "/notifications/batch-delete",
  "method": "POST",
  "description": "批量删除通知",
  "parameters": {
    "body": {
      "notification_ids": {
        "type": "array",
        "required": true,
        "description": "通知ID列表",
        "items": {
          "type": "integer"
        }
      }
    }
  },
  "response": {
    "success": true,
    "data": {
      "success_count": 8,
      "failed_count": 2,
      "failed_ids": [15, 23],
      "message": "批量删除完成"
    }
  },
  "errors": {
    "400": "请求参数错误",
    "403": "无权删除部分或全部通知"
  }
}
```

### 6. 清空所有通知
```json
{
  "address": "/notifications/clear-all",
  "method": "DELETE",
  "description": "清空用户所有通知",
  "parameters": {},
  "response": {
    "success": true,
    "data": {
      "message": "所有通知已清空",
      "deleted_count": 25
    }
  }
}
```

### 7. 获取通知详情
```json
{
  "address": "/notifications/{notification_id}",
  "method": "GET",
  "description": "获取指定通知的详细信息",
  "parameters": {
    "path": {
      "notification_id": {
        "type": "integer",
        "required": true,
        "description": "通知ID"
      }
    }
  },
  "response": {
    "success": true,
    "data": {
      "notification_id": 15,
      "user_id": 2,
      "title": "账单支付提醒",
      "content": "您有一笔账单即将到期，请及时支付",
      "type": "bill_reminder",
      "is_read": false,
      "created_at": "2023-06-15 14:30:00",
      "updated_at": "2023-06-15 14:30:00",
      "related_data": {
        "bill_id": 5,
        "amount": 100.00,
        "due_date": "2023-06-20"
      }
    }
  },
  "errors": {
    "404": "通知不存在",
    "403": "无权访问该通知"
  }
}
```

### 8. 更新通知设置
```json
{
  "address": "/notifications/settings",
  "method": "PUT",
  "description": "更新用户通知设置",
  "parameters": {
    "body": {
      "bill_reminder": {
        "type": "boolean",
        "required": false,
        "description": "账单提醒通知开关"
      },
      "payment_success": {
        "type": "boolean",
        "required": false,
        "description": "支付成功通知开关"
      },
      "room_invitation": {
        "type": "boolean",
        "required": false,
        "description": "房间邀请通知开关"
      },
      "dispute_update": {
        "type": "boolean",
        "required": false,
        "description": "争议更新通知开关"
      },
      "email_enabled": {
        "type": "boolean",
        "required": false,
        "description": "邮件通知开关"
      },
      "push_enabled": {
        "type": "boolean",
        "required": false,
        "description": "推送通知开关"
      }
    }
  },
  "response": {
    "success": true,
    "data": {
      "bill_reminder": true,
      "payment_success": true,
      "room_invitation": true,
      "dispute_update": true,
      "email_enabled": false,
      "push_enabled": true,
      "updated_at": "2023-06-15 14:30:00"
    }
  },
  "errors": {
    "400": "请求参数错误"
  }
}
```

### 9. 获取通知设置
```json
{
  "address": "/notifications/settings",
  "method": "GET",
  "description": "获取用户通知设置",
  "parameters": {},
  "response": {
    "success": true,
    "data": {
      "bill_reminder": true,
      "payment_success": true,
      "room_invitation": true,
      "dispute_update": true,
      "email_enabled": false,
      "push_enabled": true,
      "updated_at": "2023-06-15 14:30:00"
    }
  }
}
```

## 七、邀请码管理接口

### 1. 生成新的邀请码
```json
{
  "接口地址": "/invite-codes",
  "请求方法": "POST",
  "请求参数": {
    "Authorization": "string, Bearer token",
    "Content-Type": "application/json",
    "body": {
      "room_id": "number, 必填，房间ID",
      "max_uses": "number, 可选，最大使用次数",
      "expires_days": "number, 可选，过期天数",
      "description": "string, 可选，描述"
    }
  },
  "返回结果": {
    "code": "number, 状态码",
    "message": "string, 返回消息",
    "data": {
      "id": "number, 邀请码ID",
      "code": "string, 邀请码",
      "room_id": "number, 房间ID",
      "room_name": "string, 房间名称",
      "max_uses": "number, 最大使用次数",
      "used_count": "number, 已使用次数",
      "expires_at": "string, 过期时间",
      "status": "string, 状态",
      "created_at": "string, 创建时间"
    }
  }
}
```

### 2. 验证邀请码
```json
{
  "接口地址": "/invite-codes/verify",
  "请求方法": "POST",
  "请求参数": {
    "Authorization": "string, Bearer token",
    "Content-Type": "application/json",
    "body": {
      "code": "string, 必填，邀请码"
    }
  },
  "返回结果": {
    "code": "number, 状态码",
    "message": "string, 返回消息",
    "data": {
      "is_valid": "boolean, 是否有效",
      "invite_code": {
        "id": "number, 邀请码ID",
        "code": "string, 邀请码",
        "room_id": "number, 房间ID",
        "room_name": "string, 房间名称",
        "room_description": "string, 房间描述",
        "creator_name": "string, 创建者名称",
        "max_uses": "number, 最大使用次数",
        "used_count": "number, 已使用次数",
        "expires_at": "string, 过期时间",
        "status": "string, 状态"
      },
      "reason": "string, 无效原因"
    }
  }
}
```

### 3. 使用邀请码
```json
{
  "接口地址": "/invite-codes/use",
  "请求方法": "POST",
  "请求参数": {
    "Authorization": "string, Bearer token",
    "Content-Type": "application/json",
    "body": {
      "code": "string, 必填，邀请码"
    }
  },
  "返回结果": {
    "code": "number, 状态码",
    "message": "string, 返回消息",
    "data": {
      "success": "boolean, 是否成功",
      "room_id": "number, 房间ID",
      "room_name": "string, 房间名称",
      "role": "string, 成员角色",
      "joined_at": "string, 加入时间"
    }
  }
}
```

### 4. 获取邀请码列表
```json
{
  "address": "/invitation-codes",
  "method": "GET",
  "description": "获取用户创建的邀请码列表",
  "parameters": {
    "query": {
      "page": {
        "type": "integer",
        "required": false,
        "description": "页码，默认为1"
      },
      "limit": {
        "type": "integer",
        "required": false,
        "description": "每页数量，默认为10"
      },
      "status": {
        "type": "string",
        "required": false,
        "description": "邀请码状态筛选",
        "options": ["active", "expired", "used"]
      }
    }
  },
  "response": {
    "success": true,
    "data": {
      "total": 15,
      "page": 1,
      "limit": 10,
      "codes": [
        {
          "code_id": 1,
          "code": "ABC123XYZ",
          "creator_id": 2,
          "status": "active",
          "usage_limit": 10,
          "used_count": 3,
          "expires_at": "2023-12-31 23:59:59",
          "created_at": "2023-06-15 14:30:00",
          "updated_at": "2023-06-15 14:30:00"
        }
      ]
    }
  }
}
```

### 5. 更新邀请码
```json
{
  "address": "/invitation-codes/{code_id}",
  "method": "PUT",
  "description": "更新邀请码信息",
  "parameters": {
    "path": {
      "code_id": {
        "type": "integer",
        "required": true,
        "description": "邀请码ID"
      }
    },
    "body": {
      "usage_limit": {
        "type": "integer",
        "required": false,
        "description": "使用次数限制"
      },
      "expires_at": {
        "type": "string",
        "required": false,
        "description": "过期时间，格式：YYYY-MM-DD HH:MM:SS"
      },
      "status": {
        "type": "string",
        "required": false,
        "description": "邀请码状态",
        "options": ["active", "expired"]
      }
    }
  },
  "response": {
    "success": true,
    "data": {
      "code_id": 1,
      "code": "ABC123XYZ",
      "creator_id": 2,
      "status": "active",
      "usage_limit": 20,
      "used_count": 3,
      "expires_at": "2023-12-31 23:59:59",
      "created_at": "2023-06-15 14:30:00",
      "updated_at": "2023-06-16 10:15:00"
    }
  },
  "errors": {
    "400": "请求参数错误",
    "404": "邀请码不存在",
    "403": "无权更新该邀请码"
  }
}
```

### 6. 删除邀请码
```json
{
  "address": "/invitation-codes/{code_id}",
  "method": "DELETE",
  "description": "删除指定邀请码",
  "parameters": {
    "path": {
      "code_id": {
        "type": "integer",
        "required": true,
        "description": "邀请码ID"
      }
    }
  },
  "response": {
    "success": true,
    "data": {
      "message": "邀请码删除成功"
    }
  },
  "errors": {
    "404": "邀请码不存在",
    "403": "无权删除该邀请码"
  }
}
```

### 7. 获取邀请码使用记录
```json
{
  "address": "/invitation-codes/{code_id}/usage-records",
  "method": "GET",
  "description": "获取邀请码的使用记录",
  "parameters": {
    "path": {
      "code_id": {
        "type": "integer",
        "required": true,
        "description": "邀请码ID"
      }
    },
    "query": {
      "page": {
        "type": "integer",
        "required": false,
        "description": "页码，默认为1"
      },
      "limit": {
        "type": "integer",
        "required": false,
        "description": "每页数量，默认为10"
      }
    }
  },
  "response": {
    "success": true,
    "data": {
      "total": 3,
      "page": 1,
      "limit": 10,
      "records": [
        {
          "record_id": 1,
          "code_id": 1,
          "user_id": 5,
          "used_at": "2023-06-16 10:15:00",
          "ip_address": "192.168.1.100",
          "user_agent": "Mozilla/5.0..."
        }
      ]
    }
  },
  "errors": {
    "404": "邀请码不存在",
    "403": "无权查看该邀请码的使用记录"
  }
}
```

### 8. 获取邀请码统计
```json
{
  "address": "/invitation-codes/statistics",
  "method": "GET",
  "description": "获取用户邀请码统计数据",
  "parameters": {},
  "response": {
    "success": true,
    "data": {
      "total_codes": 5,
      "active_codes": 3,
      "expired_codes": 1,
      "used_codes": 1,
      "total_usage": 15,
      "recent_usage": [
        {
          "date": "2023-06-15",
          "count": 3
        },
        {
          "date": "2023-06-14",
          "count": 2
        }
      ]
    }
  }
}
```

## 八、二维码管理接口

### 1. 获取收款码列表
```json
{
  "接口地址": "/qr-codes",
  "请求方法": "GET",
  "请求参数": {
    "Authorization": "string, Bearer token",
    "查询参数": {
      "page": "number, 可选，页码",
      "page_size": "number, 可选，每页大小",
      "status": "string, 可选，状态",
      "payment_method": "string, 可选，支付方式"
    }
  },
  "返回结果": {
    "code": "number, 状态码",
    "message": "string, 返回消息",
    "data": {
      "qr_codes": [
        {
          "id": "number, 二维码ID",
          "name": "string, 二维码名称",
          "image_url": "string, 图片URL",
          "payment_method": "string, 支付方式",
          "is_default": "boolean, 是否默认",
          "status": "string, 状态",
          "created_at": "string, 创建时间",
          "usage_count": "number, 使用次数",
          "last_used_at": "string, 最后使用时间"
        }
      ],
      "pagination": {
        "page": "number, 当前页码",
        "page_size": "number, 每页大小",
        "total": "number, 总记录数",
        "total_pages": "number, 总页数"
      }
    }
  }
}
```

### 2. 创建收款码
```json
{
  "接口地址": "/qr-codes",
  "请求方法": "POST",
  "请求参数": {
    "Authorization": "string, Bearer token",
    "Content-Type": "application/json",
    "body": {
      "name": "string, 必填，二维码名称",
      "image_url": "string, 必填，图片URL",
      "payment_method": "string, 必填，支付方式",
      "is_default": "boolean, 可选，是否默认"
    }
  },
  "返回结果": {
    "code": "number, 状态码",
    "message": "string, 返回消息",
    "data": {
      "id": "number, 二维码ID",
      "name": "string, 二维码名称",
      "image_url": "string, 图片URL",
      "payment_method": "string, 支付方式",
      "is_default": "boolean, 是否默认",
      "status": "string, 状态",
      "created_at": "string, 创建时间"
    }
  }
}
```

### 3. 设置默认收款码
```json
{
  "接口地址": "/qr-codes/{id}/default",
  "请求方法": "PATCH",
  "请求参数": {
    "Authorization": "string, Bearer token",
    "路径参数": {
      "id": "number, 必填，二维码ID"
    }
  },
  "返回结果": {
    "code": "number, 状态码",
    "message": "string, 返回消息",
    "data": {
      "id": "number, 二维码ID",
      "is_default": "boolean, 是否默认",
      "updated_at": "string, 更新时间"
    }
  }
}
```

### 4. 更新收款码
```json
{
  "address": "/qr-codes/{qr_id}",
  "method": "PUT",
  "description": "更新收款码信息",
  "parameters": {
    "path": {
      "qr_id": {
        "type": "integer",
        "required": true,
        "description": "收款码ID"
      }
    },
    "body": {
      "title": {
        "type": "string",
        "required": false,
        "description": "收款码标题"
      },
      "description": {
        "type": "string",
        "required": false,
        "description": "收款码描述"
      },
      "amount": {
        "type": "number",
        "required": false,
        "description": "收款金额"
      },
      "payment_methods": {
        "type": "array",
        "required": false,
        "description": "支持的支付方式",
        "items": {
          "type": "string"
        }
      }
    }
  },
  "response": {
    "success": true,
    "data": {
      "qr_id": 1,
      "user_id": 2,
      "title": "房租收款码",
      "description": "2023年6月房租",
      "qr_code_url": "https://example.com/qr/abc123.png",
      "amount": 1500.00,
      "payment_methods": ["alipay", "wechat"],
      "is_default": true,
      "is_active": true,
      "usage_count": 5,
      "created_at": "2023-06-01 10:00:00",
      "updated_at": "2023-06-15 14:30:00"
    }
  },
  "errors": {
    "400": "请求参数错误",
    "404": "收款码不存在",
    "403": "无权更新该收款码"
  }
}
```

### 5. 删除收款码
```json
{
  "address": "/qr-codes/{qr_id}",
  "method": "DELETE",
  "description": "删除指定收款码",
  "parameters": {
    "path": {
      "qr_id": {
        "type": "integer",
        "required": true,
        "description": "收款码ID"
      }
    }
  },
  "response": {
    "success": true,
    "data": {
      "message": "收款码删除成功"
    }
  },
  "errors": {
    "404": "收款码不存在",
    "403": "无权删除该收款码"
  }
}
```

### 6. 切换收款码状态
```json
{
  "address": "/qr-codes/{qr_id}/toggle-status",
  "method": "POST",
  "description": "切换收款码的启用/禁用状态",
  "parameters": {
    "path": {
      "qr_id": {
        "type": "integer",
        "required": true,
        "description": "收款码ID"
      }
    }
  },
  "response": {
    "success": true,
    "data": {
      "qr_id": 1,
      "is_active": false,
      "message": "收款码状态已更新为禁用"
    }
  },
  "errors": {
    "404": "收款码不存在",
    "403": "无权修改该收款码状态"
  }
}
```

### 7. 获取收款码使用记录
```json
{
  "address": "/qr-codes/{qr_id}/usage-records",
  "method": "GET",
  "description": "获取收款码的使用记录",
  "parameters": {
    "path": {
      "qr_id": {
        "type": "integer",
        "required": true,
        "description": "收款码ID"
      }
    },
    "query": {
      "page": {
        "type": "integer",
        "required": false,
        "description": "页码，默认为1"
      },
      "limit": {
        "type": "integer",
        "required": false,
        "description": "每页数量，默认为10"
      },
      "start_date": {
        "type": "string",
        "required": false,
        "description": "开始日期，格式：YYYY-MM-DD"
      },
      "end_date": {
        "type": "string",
        "required": false,
        "description": "结束日期，格式：YYYY-MM-DD"
      }
    }
  },
  "response": {
    "success": true,
    "data": {
      "total": 15,
      "page": 1,
      "limit": 10,
      "records": [
        {
          "record_id": 1,
          "qr_id": 1,
          "user_id": 5,
          "amount": 1500.00,
          "payment_method": "alipay",
          "payment_status": "completed",
          "payment_time": "2023-06-15 14:30:00",
          "transaction_id": "202306151430001234"
        }
      ]
    }
  },
  "errors": {
    "404": "收款码不存在",
    "403": "无权查看该收款码的使用记录"
  }
}
```

### 8. 获取收款码统计
```json
{
  "address": "/qr-codes/statistics",
  "method": "GET",
  "description": "获取用户收款码统计数据",
  "parameters": {
    "query": {
      "qr_id": {
        "type": "integer",
        "required": false,
        "description": "指定收款码ID，不提供则获取所有收款码统计"
      },
      "start_date": {
        "type": "string",
        "required": false,
        "description": "开始日期，格式：YYYY-MM-DD"
      },
      "end_date": {
        "type": "string",
        "required": false,
        "description": "结束日期，格式：YYYY-MM-DD"
      }
    }
  },
  "response": {
    "success": true,
    "data": {
      "total_amount": 7500.00,
      "total_count": 15,
      "completed_amount": 7200.00,
      "completed_count": 14,
      "pending_amount": 300.00,
      "pending_count": 1,
      "payment_methods": [
        {
          "method": "alipay",
          "amount": 4500.00,
          "count": 9,
          "percentage": 60.0
        },
        {
          "method": "wechat",
          "amount": 3000.00,
          "count": 6,
          "percentage": 40.0
        }
      ],
      "daily_trend": [
        {
          "date": "2023-06-15",
          "amount": 1500.00,
          "count": 3
        },
        {
          "date": "2023-06-14",
          "amount": 1000.00,
          "count": 2
        }
      ]
    }
  }
}
```

## 九、争议管理接口

### 1. 获取争议列表
```json
{
  "接口地址": "/disputes",
  "请求方法": "GET",
  "请求参数": {
    "Authorization": "string, Bearer token",
    "查询参数": {
      "room_id": "number, 可选，房间ID",
      "status": "string, 可选，争议状态",
      "creator_id": "number, 可选，创建者ID",
      "page": "number, 可选，页码",
      "page_size": "number, 可选，每页大小"
    }
  },
  "返回结果": {
    "code": "number, 状态码",
    "message": "string, 返回消息",
    "data": {
      "disputes": [
        {
          "id": "number, 争议ID",
          "title": "string, 争议标题",
          "description": "string, 争议描述",
          "bill_id": "number, 账单ID",
          "bill_title": "string, 账单标题",
          "expense_id": "number, 费用ID",
          "expense_title": "string, 费用标题",
          "creator_id": "number, 创建者ID",
          "creator_name": "string, 创建者名称",
          "room_id": "number, 房间ID",
          "room_name": "string, 房间名称",
          "status": "string, 争议状态",
          "resolution": "string, 解决方案",
          "resolved_at": "string, 解决时间",
          "participant_count": "number, 参与者数量",
          "evidence_count": "number, 证据数量",
          "created_at": "string, 创建时间"
        }
      ],
      "pagination": {
        "page": "number, 当前页码",
        "page_size": "number, 每页大小",
        "total": "number, 总记录数",
        "total_pages": "number, 总页数"
      }
    }
  }
}
```

### 2. 创建争议
```json
{
  "接口地址": "/disputes",
  "请求方法": "POST",
  "请求参数": {
    "Authorization": "string, Bearer token",
    "Content-Type": "application/json",
    "body": {
      "title": "string, 必填，争议标题",
      "description": "string, 必填，争议描述",
      "bill_id": "number, 可选，账单ID",
      "expense_id": "number, 可选，费用ID",
      "room_id": "number, 必填，房间ID",
      "participant_ids": "array, 可选，参与者ID列表",
      "initial_evidence": "array, 可选，初始证据"
    }
  },
  "返回结果": {
    "code": "number, 状态码",
    "message": "string, 返回消息",
    "data": {
      "id": "number, 争议ID",
      "title": "string, 争议标题",
      "status": "string, 争议状态",
      "created_at": "string, 创建时间",
      "participants": [
        {
          "user_id": "number, 用户ID",
          "user_name": "string, 用户名称",
          "role": "string, 角色"
        }
      ]
    }
  }
}
```

### 3. 解决争议
```json
{
  "接口地址": "/disputes/{id}/resolve",
  "请求方法": "POST",
  "请求参数": {
    "Authorization": "string, Bearer token",
    "路径参数": {
      "id": "number, 必填，争议ID"
    },
    "Content-Type": "application/json",
    "body": {
      "resolution": "string, 必填，解决方案",
      "resolution_details": "object, 可选，解决详情",
      "action_required": "string, 可选，需要采取的行动",
      "compensation_amount": "number, 可选，补偿金额"
    }
  },
  "返回结果": {
    "code": "number, 状态码",
    "message": "string, 返回消息",
    "data": {
      "id": "number, 争议ID",
      "status": "string, 争议状态",
      "resolution": "string, 解决方案",
      "resolved_at": "string, 解决时间",
      "resolved_by": "number, 解决人ID"
    }
  }
}
```

### 4. 获取争议详情
```json
{
  "address": "/disputes/{dispute_id}",
  "method": "GET",
  "description": "获取指定争议的详细信息",
  "parameters": {
    "path": {
      "dispute_id": {
        "type": "integer",
        "required": true,
        "description": "争议ID"
      }
    }
  },
  "response": {
    "success": true,
    "data": {
      "dispute_id": 1,
      "bill_id": 5,
      "initiator_id": 2,
      "respondent_id": 3,
      "title": "房租金额争议",
      "description": "实际房租应为1500元，而非1600元",
      "status": "pending",
      "evidence": [
        {
          "type": "image",
          "url": "https://example.com/evidence/contract.jpg",
          "description": "租房合同截图"
        }
      ],
      "created_at": "2023-06-15 14:30:00",
      "updated_at": "2023-06-15 14:30:00"
    }
  },
  "errors": {
    "404": "争议不存在",
    "403": "无权访问该争议"
  }
}
```

### 5. 更新争议
```json
{
  "address": "/disputes/{dispute_id}",
  "method": "PUT",
  "description": "更新争议信息",
  "parameters": {
    "path": {
      "dispute_id": {
        "type": "integer",
        "required": true,
        "description": "争议ID"
      }
    },
    "body": {
      "title": {
        "type": "string",
        "required": false,
        "description": "争议标题"
      },
      "description": {
        "type": "string",
        "required": false,
        "description": "争议描述"
      },
      "status": {
        "type": "string",
        "required": false,
        "description": "争议状态",
        "options": ["pending", "resolved", "cancelled"]
      },
      "resolution": {
        "type": "string",
        "required": false,
        "description": "解决方案"
      }
    }
  },
  "response": {
    "success": true,
    "data": {
      "dispute_id": 1,
      "bill_id": 5,
      "initiator_id": 2,
      "respondent_id": 3,
      "title": "房租金额争议",
      "description": "实际房租应为1500元，而非1600元",
      "status": "resolved",
      "resolution": "经协商，房租调整为1500元",
      "evidence": [
        {
          "type": "image",
          "url": "https://example.com/evidence/contract.jpg",
          "description": "租房合同截图"
        }
      ],
      "created_at": "2023-06-15 14:30:00",
      "updated_at": "2023-06-16 10:15:00"
    }
  },
  "errors": {
    "400": "请求参数错误",
    "404": "争议不存在",
    "403": "无权更新该争议"
  }
}
```

### 6. 删除争议
```json
{
  "address": "/disputes/{dispute_id}",
  "method": "DELETE",
  "description": "删除指定争议",
  "parameters": {
    "path": {
      "dispute_id": {
        "type": "integer",
        "required": true,
        "description": "争议ID"
      }
    }
  },
  "response": {
    "success": true,
    "data": {
      "message": "争议删除成功"
    }
  },
  "errors": {
    "404": "争议不存在",
    "403": "无权删除该争议",
    "409": "争议已解决，无法删除"
  }
}
```

### 7. 添加争议证据
```json
{
  "address": "/disputes/{dispute_id}/evidence",
  "method": "POST",
  "description": "为争议添加证据",
  "parameters": {
    "path": {
      "dispute_id": {
        "type": "integer",
        "required": true,
        "description": "争议ID"
      }
    },
    "body": {
      "type": {
        "type": "string",
        "required": true,
        "description": "证据类型",
        "options": ["image", "document", "audio", "video"]
      },
      "url": {
        "type": "string",
        "required": true,
        "description": "证据文件URL"
      },
      "description": {
        "type": "string",
        "required": false,
        "description": "证据描述"
      }
    }
  },
  "response": {
    "success": true,
    "data": {
      "evidence_id": 3,
      "dispute_id": 1,
      "type": "image",
      "url": "https://example.com/evidence/payment_screenshot.jpg",
      "description": "支付记录截图",
      "created_at": "2023-06-16 10:15:00"
    }
  },
  "errors": {
    "400": "请求参数错误",
    "404": "争议不存在",
    "403": "无权为该争议添加证据"
  }
}
```

### 8. 删除争议证据
```json
{
  "address": "/disputes/{dispute_id}/evidence/{evidence_id}",
  "method": "DELETE",
  "description": "删除争议证据",
  "parameters": {
    "path": {
      "dispute_id": {
        "type": "integer",
        "required": true,
        "description": "争议ID"
      },
      "evidence_id": {
        "type": "integer",
        "required": true,
        "description": "证据ID"
      }
    }
  },
  "response": {
    "success": true,
    "data": {
      "message": "证据删除成功"
    }
  },
  "errors": {
    "404": "争议或证据不存在",
    "403": "无权删除该证据"
  }
}
```

### 9. 获取争议统计
```json
{
  "address": "/disputes/statistics",
  "method": "GET",
  "description": "获取用户争议统计数据",
  "parameters": {
    "query": {
      "user_id": {
        "type": "integer",
        "required": false,
        "description": "用户ID，不提供则获取当前用户数据"
      },
      "start_date": {
        "type": "string",
        "required": false,
        "description": "开始日期，格式：YYYY-MM-DD"
      },
      "end_date": {
        "type": "string",
        "required": false,
        "description": "结束日期，格式：YYYY-MM-DD"
      }
    }
  },
  "response": {
    "success": true,
    "data": {
      "total_disputes": 8,
      "initiated_disputes": 5,
      "responded_disputes": 3,
      "pending_disputes": 2,
      "resolved_disputes": 5,
      "cancelled_disputes": 1,
      "monthly_trend": [
        {
          "month": "2023-05",
          "count": 3,
          "resolved": 2
        },
        {
          "month": "2023-06",
          "count": 5,
          "resolved": 3
        }
      ]
    }
  }
}
```

## 十、评论管理接口

### 1. 获取评论列表
```json
{
  "接口地址": "/reviews",
  "请求方法": "GET",
  "请求参数": {
    "Authorization": "string, Bearer token",
    "查询参数": {
      "room_id": "number, 可选，房间ID",
      "bill_id": "number, 可选，账单ID",
      "reviewer_id": "number, 可选，评论者ID",
      "status": "string, 可选，评论状态",
      "page": "number, 可选，页码",
      "page_size": "number, 可选，每页大小"
    }
  },
  "返回结果": {
    "code": "number, 状态码",
    "message": "string, 返回消息",
    "data": {
      "reviews": [
        {
          "id": "number, 评论ID",
          "title": "string, 评论标题",
          "content": "string, 评论内容",
          "rating": "number, 评分",
          "bill_id": "number, 账单ID",
          "bill_title": "string, 账单标题",
          "room_id": "number, 房间ID",
          "room_name": "string, 房间名称",
          "reviewer_id": "number, 评论者ID",
          "reviewer_name": "string, 评论者名称",
          "reviewer_avatar": "string, 评论者头像",
          "status": "string, 评论状态",
          "approved_at": "string, 审核通过时间",
          "rejected_at": "string, 审核拒绝时间",
          "image_count": "number, 图片数量",
          "created_at": "string, 创建时间"
        }
      ],
      "pagination": {
        "page": "number, 当前页码",
        "page_size": "number, 每页大小",
        "total": "number, 总记录数",
        "total_pages": "number, 总页数"
      },
      "rating_stats": {
        "average_rating": "number, 平均评分",
        "total_reviews": "number, 总评论数",
        "rating_distribution": "object, 评分分布"
      }
    }
  }
}
```

### 2. 创建评论
```json
{
  "接口地址": "/reviews",
  "请求方法": "POST",
  "请求参数": {
    "Authorization": "string, Bearer token",
    "Content-Type": "application/json",
    "body": {
      "title": "string, 可选，评论标题",
      "content": "string, 必填，评论内容",
      "rating": "number, 必填，评分(1-5)",
      "bill_id": "number, 可选，账单ID",
      "room_id": "number, 可选，房间ID",
      "images": "array, 可选，图片URL列表",
      "anonymous": "boolean, 可选，是否匿名"
    }
  },
  "返回结果": {
    "code": "number, 状态码",
    "message": "string, 返回消息",
    "data": {
      "id": "number, 评论ID",
      "title": "string, 评论标题",
      "content": "string, 评论内容",
      "rating": "number, 评分",
      "status": "string, 评论状态",
      "created_at": "string, 创建时间"
    }
  }
}
```

### 3. 获取评论详情
```json
{
  "接口地址": "/reviews/{reviewId}",
  "请求方法": "GET",
  "请求参数": {
    "Authorization": "string, Bearer token",
    "路径参数": {
      "reviewId": "number, 必填，评论ID"
    }
  },
  "返回结果": {
    "code": "number, 状态码",
    "message": "string, 返回消息",
    "data": {
      "id": "number, 评论ID",
      "title": "string, 评论标题",
      "content": "string, 评论内容",
      "rating": "number, 评分",
      "bill_id": "number, 账单ID",
      "bill_title": "string, 账单标题",
      "room_id": "number, 房间ID",
      "room_name": "string, 房间名称",
      "reviewer_id": "number, 评论者ID",
      "reviewer_name": "string, 评论者名称",
      "reviewer_avatar": "string, 评论者头像",
      "status": "string, 评论状态",
      "images": [
        {
          "id": "number, 图片ID",
          "url": "string, 图片URL",
          "description": "string, 图片描述"
        }
      ],
      "approved_at": "string, 审核通过时间",
      "rejected_at": "string, 审核拒绝时间",
      "created_at": "string, 创建时间",
      "updated_at": "string, 更新时间"
    }
  },
  "错误处理": {
    "404": "评论不存在",
    "403": "无权访问该评论"
  }
}
```

### 4. 更新评论
```json
{
  "接口地址": "/reviews/{reviewId}",
  "请求方法": "PUT",
  "请求参数": {
    "Authorization": "string, Bearer token",
    "路径参数": {
      "reviewId": "number, 必填，评论ID"
    },
    "Content-Type": "application/json",
    "body": {
      "title": "string, 可选，评论标题",
      "content": "string, 可选，评论内容",
      "rating": "number, 可选，评分(1-5)",
      "images": "array, 可选，图片URL列表"
    }
  },
  "返回结果": {
    "code": "number, 状态码",
    "message": "string, 返回消息",
    "data": {
      "id": "number, 评论ID",
      "title": "string, 评论标题",
      "content": "string, 评论内容",
      "rating": "number, 评分",
      "status": "string, 评论状态",
      "updated_at": "string, 更新时间"
    }
  },
  "错误处理": {
    "400": "请求参数错误",
    "404": "评论不存在",
    "403": "无权更新该评论"
  }
}
```

### 5. 删除评论
```json
{
  "接口地址": "/reviews/{reviewId}",
  "请求方法": "DELETE",
  "请求参数": {
    "Authorization": "string, Bearer token",
    "路径参数": {
      "reviewId": "number, 必填，评论ID"
    }
  },
  "返回结果": {
    "code": "number, 状态码",
    "message": "string, 返回消息",
    "data": {
      "message": "string, 删除结果"
    }
  },
  "错误处理": {
    "404": "评论不存在",
    "403": "无权删除该评论"
  }
}
```

### 6. 审核评论
```json
{
  "接口地址": "/reviews/{reviewId}/approve",
  "请求方法": "POST",
  "请求参数": {
    "Authorization": "string, Bearer token",
    "路径参数": {
      "reviewId": "number, 必填，评论ID"
    },
    "Content-Type": "application/json",
    "body": {
      "approved": "boolean, 必填，是否通过审核",
      "reason": "string, 可选，审核意见"
    }
  },
  "返回结果": {
    "code": "number, 状态码",
    "message": "string, 返回消息",
    "data": {
      "id": "number, 评论ID",
      "status": "string, 评论状态",
      "approved_at": "string, 审核时间",
      "approved_by": "number, 审核人ID"
    }
  },
  "错误处理": {
    "404": "评论不存在",
    "403": "无权审核该评论",
    "409": "评论已审核"
  }
}
```

### 7. 获取评论统计
```json
{
  "接口地址": "/reviews/statistics",
  "请求方法": "GET",
  "请求参数": {
    "Authorization": "string, Bearer token",
    "查询参数": {
      "room_id": "number, 可选，房间ID",
      "start_date": "string, 可选，开始日期",
      "end_date": "string, 可选，结束日期"
    }
  },
  "返回结果": {
    "code": "number, 状态码",
    "message": "string, 返回消息",
    "data": {
      "total_reviews": "number, 总评论数",
      "pending_reviews": "number, 待审核评论数",
      "approved_reviews": "number, 已通过评论数",
      "rejected_reviews": "number, 已拒绝评论数",
      "average_rating": "number, 平均评分",
      "rating_distribution": {
        "1": "number, 1星评论数",
        "2": "number, 2星评论数",
        "3": "number, 3星评论数",
        "4": "number, 4星评论数",
        "5": "number, 5星评论数"
      },
      "monthly_trend": [
        {
          "month": "string, 月份",
          "count": "number, 评论数",
          "average_rating": "number, 平均评分"
        }
      ]
    }
  }
}
```

### 8. 上传评论图片
```json
{
  "接口地址": "/reviews/images",
  "请求方法": "POST",
  "请求参数": {
    "Authorization": "string, Bearer token",
    "Content-Type": "multipart/form-data",
    "body": {
      "image": "file, 必填，图片文件"
    }
  },
  "返回结果": {
    "code": "number, 状态码",
    "message": "string, 返回消息",
    "data": {
      "url": "string, 图片URL",
      "filename": "string, 文件名",
      "size": "number, 文件大小"
    }
  },
  "错误处理": {
    "400": "图片格式不支持或文件过大",
    "413": "文件大小超过限制"
  }
}
```

## 十一、特殊支付规则接口

### 1. 获取特殊支付规则
```json
{
  "接口地址": "/special-payments/rooms/{roomId}/rules",
  "请求方法": "GET",
  "请求参数": {
    "Authorization": "string, Bearer token",
    "路径参数": {
      "roomId": "number, 必填，房间ID"
    },
    "查询参数": {
      "is_active": "boolean, 可选，是否激活"
    }
  },
  "返回结果": {
    "code": "number, 状态码",
    "message": "string, 返回消息",
    "data": {
      "rules": [
        {
          "id": "number, 规则ID",
          "name": "string, 规则名称",
          "description": "string, 规则描述",
          "condition_type": "string, 条件类型",
          "condition_value": "object, 条件值",
          "payment_type": "string, 支付类型",
          "payment_config": "object, 支付配置",
          "is_active": "boolean, 是否激活",
          "created_at": "string, 创建时间",
          "applied_count": "number, 应用次数",
          "last_applied": "string, 最后应用时间"
        }
      ]
    }
  }
}
```

### 2. 创建特殊支付规则
```json
{
  "接口地址": "/special-payments/rooms/{roomId}/rules",
  "请求方法": "POST",
  "请求参数": {
    "Authorization": "string, Bearer token",
    "路径参数": {
      "roomId": "number, 必填，房间ID"
    },
    "Content-Type": "application/json",
    "body": {
      "name": "string, 必填，规则名称",
      "description": "string, 可选，规则描述",
      "condition_type": "string, 必填，条件类型",
      "condition_value": "object, 必填，条件值",
      "payment_type": "string, 必填，支付类型",
      "payment_config": "object, 必填，支付配置",
      "is_active": "boolean, 可选，是否激活"
    }
  },
  "返回结果": {
    "code": "number, 状态码",
    "message": "string, 返回消息",
    "data": {
      "id": "number, 规则ID",
      "name": "string, 规则名称",
      "condition_type": "string, 条件类型",
      "payment_type": "string, 支付类型",
      "is_active": "boolean, 是否激活",
      "created_at": "string, 创建时间"
    }
  }
}
```

### 3. 获取特殊支付规则详情
```json
{
  "接口地址": "/special-payments/rules/{ruleId}",
  "请求方法": "GET",
  "请求参数": {
    "Authorization": "string, Bearer token",
    "路径参数": {
      "ruleId": "number, 必填，规则ID"
    }
  },
  "返回结果": {
    "code": "number, 状态码",
    "message": "string, 返回消息",
    "data": {
      "id": "number, 规则ID",
      "room_id": "number, 房间ID",
      "name": "string, 规则名称",
      "description": "string, 规则描述",
      "condition_type": "string, 条件类型",
      "condition_value": "object, 条件值",
      "payment_type": "string, 支付类型",
      "payment_config": "object, 支付配置",
      "is_active": "boolean, 是否激活",
      "created_at": "string, 创建时间",
      "updated_at": "string, 更新时间",
      "applied_count": "number, 应用次数",
      "last_applied": "string, 最后应用时间",
      "creator": {
        "id": "number, 创建者ID",
        "name": "string, 创建者名称"
      }
    }
  },
  "错误处理": {
    "404": "规则不存在",
    "403": "无权访问该规则"
  }
}
```

### 4. 更新特殊支付规则
```json
{
  "接口地址": "/special-payments/rules/{ruleId}",
  "请求方法": "PUT",
  "请求参数": {
    "Authorization": "string, Bearer token",
    "路径参数": {
      "ruleId": "number, 必填，规则ID"
    },
    "Content-Type": "application/json",
    "body": {
      "name": "string, 可选，规则名称",
      "description": "string, 可选，规则描述",
      "condition_type": "string, 可选，条件类型",
      "condition_value": "object, 可选，条件值",
      "payment_type": "string, 可选，支付类型",
      "payment_config": "object, 可选，支付配置",
      "is_active": "boolean, 可选，是否激活"
    }
  },
  "返回结果": {
    "code": "number, 状态码",
    "message": "string, 返回消息",
    "data": {
      "id": "number, 规则ID",
      "name": "string, 规则名称",
      "condition_type": "string, 条件类型",
      "payment_type": "string, 支付类型",
      "is_active": "boolean, 是否激活",
      "updated_at": "string, 更新时间"
    }
  },
  "错误处理": {
    "400": "请求参数错误",
    "404": "规则不存在",
    "403": "无权更新该规则"
  }
}
```

### 5. 删除特殊支付规则
```json
{
  "接口地址": "/special-payments/rules/{ruleId}",
  "请求方法": "DELETE",
  "请求参数": {
    "Authorization": "string, Bearer token",
    "路径参数": {
      "ruleId": "number, 必填，规则ID"
    }
  },
  "返回结果": {
    "code": "number, 状态码",
    "message": "string, 返回消息",
    "data": {
      "message": "string, 删除结果"
    }
  },
  "错误处理": {
    "404": "规则不存在",
    "403": "无权删除该规则",
    "409": "规则正在使用中，无法删除"
  }
}
```

### 6. 启用/禁用特殊支付规则
```json
{
  "接口地址": "/special-payments/rules/{ruleId}/toggle",
  "请求方法": "POST",
  "请求参数": {
    "Authorization": "string, Bearer token",
    "路径参数": {
      "ruleId": "number, 必填，规则ID"
    }
  },
  "返回结果": {
    "code": "number, 状态码",
    "message": "string, 返回消息",
    "data": {
      "id": "number, 规则ID",
      "is_active": "boolean, 当前激活状态",
      "updated_at": "string, 更新时间"
    }
  },
  "错误处理": {
    "404": "规则不存在",
    "403": "无权修改该规则状态"
  }
}
```

### 7. 获取特殊支付规则应用记录
```json
{
  "接口地址": "/special-payments/rules/{ruleId}/applications",
  "请求方法": "GET",
  "请求参数": {
    "Authorization": "string, Bearer token",
    "路径参数": {
      "ruleId": "number, 必填，规则ID"
    },
    "查询参数": {
      "page": "number, 可选，页码",
      "page_size": "number, 可选，每页大小",
      "start_date": "string, 可选，开始日期",
      "end_date": "string, 可选，结束日期"
    }
  },
  "返回结果": {
    "code": "number, 状态码",
    "message": "string, 返回消息",
    "data": {
      "total": "number, 总记录数",
      "page": "number, 当前页码",
      "page_size": "number, 每页大小",
      "applications": [
        {
          "id": "number, 应用记录ID",
          "bill_id": "number, 账单ID",
          "bill_title": "string, 账单标题",
          "user_id": "number, 用户ID",
          "user_name": "string, 用户名称",
          "applied_at": "string, 应用时间",
          "applied_amount": "number, 应用金额",
          "result": "string, 应用结果"
        }
      ]
    }
  },
  "错误处理": {
    "404": "规则不存在",
    "403": "无权查看该规则应用记录"
  }
}
```

## 十二、房间支付规则接口

### 1. 获取房间支付规则
```json
{
  "接口地址": "/rooms/{roomId}/payment-rules",
  "请求方法": "GET",
  "请求参数": {
    "Authorization": "string, Bearer token",
    "路径参数": {
      "roomId": "number, 必填，房间ID"
    },
    "查询参数": {
      "is_active": "boolean, 可选，是否激活"
    }
  },
  "返回结果": {
    "code": "number, 状态码",
    "message": "string, 返回消息",
    "data": {
      "rules": [
        {
          "id": "number, 规则ID",
          "name": "string, 规则名称",
          "description": "string, 规则描述",
          "rule_type": "string, 规则类型",
          "conditions": "object, 规则条件",
          "actions": "object, 规则动作",
          "priority": "number, 优先级",
          "is_active": "boolean, 是否激活",
          "created_at": "string, 创建时间",
          "applied_count": "number, 应用次数",
          "last_applied": "string, 最后应用时间"
        }
      ]
    }
  }
}
```

### 2. 创建房间支付规则
```json
{
  "接口地址": "/rooms/{roomId}/payment-rules",
  "请求方法": "POST",
  "请求参数": {
    "Authorization": "string, Bearer token",
    "路径参数": {
      "roomId": "number, 必填，房间ID"
    },
    "Content-Type": "application/json",
    "body": {
      "name": "string, 必填，规则名称",
      "description": "string, 可选，规则描述",
      "rule_type": "string, 必填，规则类型",
      "conditions": "object, 必填，规则条件",
      "actions": "object, 必填，规则动作",
      "priority": "number, 可选，优先级",
      "is_active": "boolean, 可选，是否激活"
    }
  },
  "返回结果": {
    "code": "number, 状态码",
    "message": "string, 返回消息",
    "data": {
      "id": "number, 规则ID",
      "name": "string, 规则名称",
      "rule_type": "string, 规则类型",
      "priority": "number, 优先级",
      "is_active": "boolean, 是否激活",
      "created_at": "string, 创建时间"
    }
  }
}
```

### 3. 获取房间支付规则详情
```json
{
  "接口地址": "/rooms/{roomId}/payment-rules/{ruleId}",
  "请求方法": "GET",
  "请求参数": {
    "Authorization": "string, Bearer token",
    "路径参数": {
      "roomId": "number, 必填，房间ID",
      "ruleId": "number, 必填，规则ID"
    }
  },
  "返回结果": {
    "code": "number, 状态码",
    "message": "string, 返回消息",
    "data": {
      "id": "number, 规则ID",
      "room_id": "number, 房间ID",
      "name": "string, 规则名称",
      "description": "string, 规则描述",
      "rule_type": "string, 规则类型",
      "conditions": "object, 规则条件",
      "actions": "object, 规则动作",
      "priority": "number, 优先级",
      "is_active": "boolean, 是否激活",
      "created_at": "string, 创建时间",
      "updated_at": "string, 更新时间",
      "applied_count": "number, 应用次数",
      "last_applied": "string, 最后应用时间",
      "creator": {
        "id": "number, 创建者ID",
        "name": "string, 创建者名称"
      }
    }
  },
  "错误处理": {
    "404": "规则不存在",
    "403": "无权访问该规则"
  }
}
```

### 4. 更新房间支付规则
```json
{
  "接口地址": "/rooms/{roomId}/payment-rules/{ruleId}",
  "请求方法": "PUT",
  "请求参数": {
    "Authorization": "string, Bearer token",
    "路径参数": {
      "roomId": "number, 必填，房间ID",
      "ruleId": "number, 必填，规则ID"
    },
    "Content-Type": "application/json",
    "body": {
      "name": "string, 可选，规则名称",
      "description": "string, 可选，规则描述",
      "rule_type": "string, 可选，规则类型",
      "conditions": "object, 可选，规则条件",
      "actions": "object, 可选，规则动作",
      "priority": "number, 可选，优先级",
      "is_active": "boolean, 可选，是否激活"
    }
  },
  "返回结果": {
    "code": "number, 状态码",
    "message": "string, 返回消息",
    "data": {
      "id": "number, 规则ID",
      "name": "string, 规则名称",
      "rule_type": "string, 规则类型",
      "priority": "number, 优先级",
      "is_active": "boolean, 是否激活",
      "updated_at": "string, 更新时间"
    }
  },
  "错误处理": {
    "400": "请求参数错误",
    "404": "规则不存在",
    "403": "无权更新该规则"
  }
}
```

### 5. 删除房间支付规则
```json
{
  "接口地址": "/rooms/{roomId}/payment-rules/{ruleId}",
  "请求方法": "DELETE",
  "请求参数": {
    "Authorization": "string, Bearer token",
    "路径参数": {
      "roomId": "number, 必填，房间ID",
      "ruleId": "number, 必填，规则ID"
    }
  },
  "返回结果": {
    "code": "number, 状态码",
    "message": "string, 返回消息",
    "data": {
      "message": "string, 删除结果"
    }
  },
  "错误处理": {
    "404": "规则不存在",
    "403": "无权删除该规则",
    "409": "规则正在使用中，无法删除"
  }
}
```

### 6. 启用/禁用房间支付规则
```json
{
  "接口地址": "/rooms/{roomId}/payment-rules/{ruleId}/toggle",
  "请求方法": "POST",
  "请求参数": {
    "Authorization": "string, Bearer token",
    "路径参数": {
      "roomId": "number, 必填，房间ID",
      "ruleId": "number, 必填，规则ID"
    }
  },
  "返回结果": {
    "code": "number, 状态码",
    "message": "string, 返回消息",
    "data": {
      "id": "number, 规则ID",
      "is_active": "boolean, 当前激活状态",
      "updated_at": "string, 更新时间"
    }
  },
  "错误处理": {
    "404": "规则不存在",
    "403": "无权修改该规则状态"
  }
}
```

### 7. 获取房间支付规则应用记录
```json
{
  "接口地址": "/rooms/{roomId}/payment-rules/{ruleId}/applications",
  "请求方法": "GET",
  "请求参数": {
    "Authorization": "string, Bearer token",
    "路径参数": {
      "roomId": "number, 必填，房间ID",
      "ruleId": "number, 必填，规则ID"
    },
    "查询参数": {
      "page": "number, 可选，页码",
      "page_size": "number, 可选，每页大小",
      "start_date": "string, 可选，开始日期",
      "end_date": "string, 可选，结束日期"
    }
  },
  "返回结果": {
    "code": "number, 状态码",
    "message": "string, 返回消息",
    "data": {
      "total": "number, 总记录数",
      "page": "number, 当前页码",
      "page_size": "number, 每页大小",
      "applications": [
        {
          "id": "number, 应用记录ID",
          "bill_id": "number, 账单ID",
          "bill_title": "string, 账单标题",
          "user_id": "number, 用户ID",
          "user_name": "string, 用户名称",
          "applied_at": "string, 应用时间",
          "applied_amount": "number, 应用金额",
          "result": "string, 应用结果"
        }
      ]
    }
  },
  "错误处理": {
    "404": "规则不存在",
    "403": "无权查看该规则应用记录"
  }
}
```

### 8. 获取房间支付规则统计
```json
{
  "接口地址": "/rooms/{roomId}/payment-rules/statistics",
  "请求方法": "GET",
  "请求参数": {
    "Authorization": "string, Bearer token",
    "路径参数": {
      "roomId": "number, 必填，房间ID"
    },
    "查询参数": {
      "start_date": "string, 可选，开始日期",
      "end_date": "string, 可选，结束日期"
    }
  },
  "返回结果": {
    "code": "number, 状态码",
    "message": "string, 返回消息",
    "data": {
      "total_rules": "number, 总规则数",
      "active_rules": "number, 激活规则数",
      "total_applications": "number, 总应用次数",
      "success_applications": "number, 成功应用次数",
      "failure_applications": "number, 失败应用次数",
      "monthly_trend": [
        {
          "month": "string, 月份",
          "applications": "number, 应用次数",
          "success_rate": "number, 成功率"
        }
      ],
      "rule_effectiveness": [
        {
          "rule_id": "number, 规则ID",
          "rule_name": "string, 规则名称",
          "applications": "number, 应用次数",
          "success_rate": "number, 成功率"
        }
      ]
    }
  },
  "错误处理": {
    "404": "房间不存在",
    "403": "无权查看该房间支付规则统计"
  }
}
```

## 十三、数据分析接口

### 1. 获取概览数据
```json
{
  "接口地址": "/analytics/overview",
  "请求方法": "GET",
  "请求参数": {
    "Authorization": "string, Bearer token",
    "查询参数": {
      "room_id": "number, 可选，房间ID",
      "start_date": "string, 可选，开始日期",
      "end_date": "string, 可选，结束日期"
    }
  },
  "返回结果": {
    "code": "number, 状态码",
    "message": "string, 返回消息",
    "data": {
      "total_expenses": "number, 总支出",
      "total_bills": "number, 总账单数",
      "active_rooms": "number, 活跃房间数",
      "pending_payments": "number, 待支付数",
      "monthly_expense_trend": "array, 月度支出趋势",
      "category_distribution": "array, 分类分布",
      "recent_activities": [
        {
          "id": "number, 活动ID",
          "type": "string, 活动类型",
          "description": "string, 活动描述",
          "user_name": "string, 用户名称",
          "created_at": "string, 创建时间"
        }
      ]
    }
  }
}
```

### 2. 获取支出趋势数据
```json
{
  "接口地址": "/analytics/expense-trend",
  "请求方法": "GET",
  "请求参数": {
    "Authorization": "string, Bearer token",
    "查询参数": {
      "room_id": "number, 可选，房间ID",
      "start_date": "string, 必填，开始日期",
      "end_date": "string, 必填，结束日期",
      "group_by": "string, 可选，分组方式"
    }
  },
  "返回结果": {
    "code": "number, 状态码",
    "message": "string, 返回消息",
    "data": {
      "period": "string, 统计周期",
      "total_amount": "number, 总金额",
      "average_amount": "number, 平均金额",
      "trend_data": [
        {
          "period": "string, 时间段",
          "amount": "number, 金额",
          "count": "number, 数量",
          "growth_rate": "number, 增长率"
        }
      ],
      "comparison": {
        "previous_period_amount": "number, 上一周期金额",
        "growth_percentage": "number, 增长百分比"
      }
    }
  }
}
```

### 3. 获取支出分类数据
```json
{
  "接口地址": "/analytics/expense-categories",
  "请求方法": "GET",
  "请求参数": {
    "Authorization": "string, Bearer token",
    "查询参数": {
      "room_id": "number, 可选，房间ID",
      "start_date": "string, 可选，开始日期",
      "end_date": "string, 可选，结束日期"
    }
  },
  "返回结果": {
    "code": "number, 状态码",
    "message": "string, 返回消息",
    "data": {
      "total_amount": "number, 总金额",
      "categories": [
        {
          "category_id": "number, 分类ID",
          "category_name": "string, 分类名称",
          "amount": "number, 金额",
          "percentage": "number, 占比",
          "count": "number, 数量",
          "average_amount": "number, 平均金额",
          "subcategories": [
            {
              "subcategory_id": "number, 子分类ID",
              "subcategory_name": "string, 子分类名称",
              "amount": "number, 金额",
              "percentage": "number, 占比",
              "count": "number, 数量"
            }
          ]
        }
      ],
      "monthly_comparison": [
        {
          "month": "string, 月份",
          "categories": [
            {
              "category_id": "number, 分类ID",
              "category_name": "string, 分类名称",
              "amount": "number, 金额",
              "percentage": "number, 占比"
            }
          ]
        }
      ]
    }
  }
}
```

### 4. 获取用户支出统计
```json
{
  "接口地址": "/analytics/user-expenses",
  "请求方法": "GET",
  "请求参数": {
    "Authorization": "string, Bearer token",
    "查询参数": {
      "room_id": "number, 可选，房间ID",
      "start_date": "string, 可选，开始日期",
      "end_date": "string, 可选，结束日期",
      "sort_by": "string, 可选，排序字段",
      "sort_order": "string, 可选，排序方向"
    }
  },
  "返回结果": {
    "code": "number, 状态码",
    "message": "string, 返回消息",
    "data": {
      "total_users": "number, 总用户数",
      "total_amount": "number, 总金额",
      "average_amount": "number, 平均金额",
      "users": [
        {
          "user_id": "number, 用户ID",
          "user_name": "string, 用户名称",
          "avatar": "string, 用户头像",
          "total_amount": "number, 总金额",
          "bill_count": "number, 账单数量",
          "average_amount": "number, 平均金额",
          "percentage": "number, 占比",
          "categories": [
            {
              "category_id": "number, 分类ID",
              "category_name": "string, 分类名称",
              "amount": "number, 金额",
              "percentage": "number, 占比"
            }
          ]
        }
      ],
      "monthly_trend": [
        {
          "month": "string, 月份",
          "user_expenses": [
            {
              "user_id": "number, 用户ID",
              "user_name": "string, 用户名称",
              "amount": "number, 金额"
            }
          ]
        }
      ]
    }
  }
}
```

### 5. 获取房间支出对比
```json
{
  "接口地址": "/analytics/room-comparison",
  "请求方法": "GET",
  "请求参数": {
    "Authorization": "string, Bearer token",
    "查询参数": {
      "room_ids": "string, 必填，房间ID列表，逗号分隔",
      "start_date": "string, 可选，开始日期",
      "end_date": "string, 可选，结束日期",
      "comparison_type": "string, 可选，对比类型"
    }
  },
  "返回结果": {
    "code": "number, 状态码",
    "message": "string, 返回消息",
    "data": {
      "rooms": [
        {
          "room_id": "number, 房间ID",
          "room_name": "string, 房间名称",
          "total_amount": "number, 总金额",
          "bill_count": "number, 账单数量",
          "average_amount": "number, 平均金额",
          "user_count": "number, 用户数量",
          "per_user_average": "number, 人均支出",
          "categories": [
            {
              "category_id": "number, 分类ID",
              "category_name": "string, 分类名称",
              "amount": "number, 金额",
              "percentage": "number, 占比"
            }
          ]
        }
      ],
      "comparison_summary": {
        "highest_expense_room": {
          "room_id": "number, 房间ID",
          "room_name": "string, 房间名称",
          "amount": "number, 金额"
        },
        "lowest_expense_room": {
          "room_id": "number, 房间ID",
          "room_name": "string, 房间名称",
          "amount": "number, 金额"
        },
        "average_room_expense": "number, 平均房间支出"
      }
    }
  }
}
```

### 6. 获取支付方式统计
```json
{
  "接口地址": "/analytics/payment-methods",
  "请求方法": "GET",
  "请求参数": {
    "Authorization": "string, Bearer token",
    "查询参数": {
      "room_id": "number, 可选，房间ID",
      "start_date": "string, 可选，开始日期",
      "end_date": "string, 可选，结束日期"
    }
  },
  "返回结果": {
    "code": "number, 状态码",
    "message": "string, 返回消息",
    "data": {
      "total_amount": "number, 总金额",
      "total_count": "number, 总支付次数",
      "methods": [
        {
          "method_id": "number, 支付方式ID",
          "method_name": "string, 支付方式名称",
          "amount": "number, 金额",
          "count": "number, 次数",
          "percentage": "number, 占比",
          "average_amount": "number, 平均金额",
          "success_rate": "number, 成功率",
          "monthly_trend": [
            {
              "month": "string, 月份",
              "amount": "number, 金额",
              "count": "number, 次数"
            }
          ]
        }
      ]
    }
  }
}
```

### 7. 获取用户增长数据
```json
{
  "接口地址": "/analytics/user-growth",
  "请求方法": "GET",
  "请求参数": {
    "Authorization": "string, Bearer token",
    "查询参数": {
      "start_date": "string, 可选，开始日期",
      "end_date": "string, 可选，结束日期",
      "group_by": "string, 可选，分组方式"
    }
  },
  "返回结果": {
    "code": "number, 状态码",
    "message": "string, 返回消息",
    "data": {
      "total_users": "number, 总用户数",
      "active_users": "number, 活跃用户数",
      "new_users": "number, 新增用户数",
      "growth_rate": "number, 增长率",
      "retention_rate": "number, 留存率",
      "trend_data": [
        {
          "period": "string, 时间段",
          "new_users": "number, 新增用户数",
          "active_users": "number, 活跃用户数",
          "total_users": "number, 总用户数",
          "growth_rate": "number, 增长率"
        }
      ],
      "user_sources": [
        {
          "source": "string, 来源",
          "count": "number, 数量",
          "percentage": "number, 占比"
        }
      ]
    }
  }
}
```

### 8. 获取房间活跃度数据
```json
{
  "接口地址": "/analytics/room-activity",
  "请求方法": "GET",
  "请求参数": {
    "Authorization": "string, Bearer token",
    "查询参数": {
      "start_date": "string, 可选，开始日期",
      "end_date": "string, 可选，结束日期",
      "sort_by": "string, 可选，排序字段",
      "sort_order": "string, 可选，排序方向"
    }
  },
  "返回结果": {
    "code": "number, 状态码",
    "message": "string, 返回消息",
    "data": {
      "total_rooms": "number, 总房间数",
      "active_rooms": "number, 活跃房间数",
      "average_activity": "number, 平均活跃度",
      "rooms": [
        {
          "room_id": "number, 房间ID",
          "room_name": "string, 房间名称",
          "activity_score": "number, 活跃度分数",
          "bill_count": "number, 账单数量",
          "payment_count": "number, 支付数量",
          "user_count": "number, 用户数量",
          "active_users": "number, 活跃用户数",
          "last_activity": "string, 最后活动时间",
          "daily_activities": [
            {
              "date": "string, 日期",
              "bill_count": "number, 账单数量",
              "payment_count": "number, 支付数量",
              "active_users": "number, 活跃用户数"
            }
          ]
        }
      ]
    }
  }
}
```

### 9. 获取账单结算统计
```json
{
  "接口地址": "/analytics/bill-settlement",
  "请求方法": "GET",
  "请求参数": {
    "Authorization": "string, Bearer token",
    "查询参数": {
      "room_id": "number, 可选，房间ID",
      "start_date": "string, 可选，开始日期",
      "end_date": "string, 可选，结束日期"
    }
  },
  "返回结果": {
    "code": "number, 状态码",
    "message": "string, 返回消息",
    "data": {
      "total_bills": "number, 总账单数",
      "settled_bills": "number, 已结算账单数",
      "pending_bills": "number, 待结算账单数",
      "disputed_bills": "number, 争议账单数",
      "settlement_rate": "number, 结算率",
      "average_settlement_time": "number, 平均结算时间(小时)",
      "monthly_trend": [
        {
          "month": "string, 月份",
          "total_bills": "number, 总账单数",
          "settled_bills": "number, 已结算账单数",
          "settlement_rate": "number, 结算率"
        }
      ],
      "settlement_methods": [
        {
          "method": "string, 结算方式",
          "count": "number, 数量",
          "percentage": "number, 占比"
        }
      ]
    }
  }
}
```

### 10. 获取自定义报表
```json
{
  "接口地址": "/analytics/custom-report",
  "请求方法": "POST",
  "请求参数": {
    "Authorization": "string, Bearer token",
    "Content-Type": "application/json",
    "body": {
      "report_name": "string, 必填，报表名称",
      "data_source": "string, 必填，数据源",
      "filters": "object, 可选，过滤条件",
      "dimensions": "array, 必填，维度",
      "measures": "array, 必填，度量",
      "group_by": "string, 可选，分组方式",
      "sort_by": "string, 可选，排序字段",
      "sort_order": "string, 可选，排序方向",
      "limit": "number, 可选，限制条数"
    }
  },
  "返回结果": {
    "code": "number, 状态码",
    "message": "string, 返回消息",
    "data": {
      "report_id": "string, 报表ID",
      "report_name": "string, 报表名称",
      "generated_at": "string, 生成时间",
      "total_records": "number, 总记录数",
      "data": [
        {
          "dimension_values": "object, 维度值",
          "measure_values": "object, 度量值"
        }
      ],
      "summary": {
        "total": "object, 总计",
        "average": "object, 平均值",
        "max": "object, 最大值",
        "min": "object, 最小值"
      }
    }
  },
  "错误处理": {
    "400": "请求参数错误",
    "403": "无权生成该报表",
    "500": "服务器内部错误"
  }
}
```

### 11. 导出数据分析报表
```json
{
  "接口地址": "/analytics/export",
  "请求方法": "POST",
  "请求参数": {
    "Authorization": "string, Bearer token",
    "Content-Type": "application/json",
    "body": {
      "report_type": "string, 必填，报表类型",
      "filters": "object, 可选，过滤条件",
      "format": "string, 可选，导出格式",
      "email": "string, 可选，接收邮箱"
    }
  },
  "返回结果": {
    "code": "number, 状态码",
    "message": "string, 返回消息",
    "data": {
      "export_id": "string, 导出任务ID",
      "status": "string, 导出状态",
      "download_url": "string, 下载链接",
      "expires_at": "string, 过期时间"
    }
  },
  "错误处理": {
    "400": "请求参数错误",
    "403": "无权导出该报表",
    "500": "服务器内部错误"
  }
}
```

## 接口设计说明

### 通用设计规范

1. **认证机制**：所有接口（除登录、注册、忘记密码等公开接口外）都需要在请求头中包含 `Authorization: Bearer {token}`

2. **响应格式**：
   ```json
   {
     "code": "number, 状态码（200-成功，400-客户端错误，500-服务器错误）",
     "message": "string, 返回消息描述",
     "data": "object, 返回数据主体"
   }
   ```

3. **分页规范**：
   ```json
   {
     "pagination": {
       "page": "number, 当前页码",
       "page_size": "number, 每页大小",
       "total": "number, 总记录数",
       "total_pages": "number, 总页数"
     }
   }
   ```

4. **错误处理**：
   - 400: 客户端请求错误
   - 401: 未授权
   - 403: 禁止访问
   - 404: 资源不存在
   - 500: 服务器内部错误

### 业务模块覆盖

本接口文档完整覆盖了以下业务模块：

1. **用户认证与账户管理** - 登录注册、个人信息、密码管理
2. **账单管理** - 账单CRUD、结算、分摊、统计
3. **费用管理** - 费用CRUD、分摊、统计、导出
4. **房间管理** - 房间CRUD、成员管理、邀请系统
5. **支付管理** - 支付记录、确认支付、支付统计
6. **通知管理** - 通知列表、标记已读、批量操作
7. **邀请码管理** - 生成、验证、使用邀请码
8. **二维码管理** - 收款码管理、默认设置
9. **争议管理** - 争议CRUD、解决、证据管理
10. **评论管理** - 评论CRUD、审核、统计
11. **特殊支付规则** - 规则管理、条件配置
12. **数据分析** - 概览数据、趋势分析、统计报表


## 详细设计规范

### 1. 通用设计规范

#### 1.1 认证机制
- **Token认证**：所有接口（除登录、注册、忘记密码等公开接口外）都需要在请求头中包含 `Authorization: Bearer {token}`
- **Token有效期**：访问令牌有效期为24小时，刷新令牌有效期为7天
- **Token刷新**：当访问令牌即将过期时，系统应自动使用刷新令牌获取新的访问令牌
- **多设备登录**：支持同一账号在多个设备同时登录，每个设备有独立的令牌

#### 1.2 请求格式规范
- **Content-Type**：所有POST、PUT请求必须设置 `Content-Type: application/json`
- **字符编码**：所有接口使用UTF-8字符编码
- **时间格式**：所有时间字段使用ISO 8601格式，如 "2023-12-31T23:59:59Z"
- **数字格式**：金额字段使用字符串类型，避免浮点数精度问题
- **ID命名**：所有ID字段使用下划线命名法，如 user_id, room_id

#### 1.3 响应格式规范
- **成功响应**：
  ```json
  {
    "code": 200,
    "message": "操作成功",
    "data": {
      // 具体数据内容
    },
    "timestamp": "2023-12-31T23:59:59Z"
  }
  ```
  
- **分页响应**：
  ```json
  {
    "code": 200,
    "message": "获取成功",
    "data": {
      "items": [
        // 数据项列表
      ],
      "pagination": {
        "page": 1,
        "page_size": 20,
        "total": 100,
        "total_pages": 5,
        "has_next": true,
        "has_prev": false
      }
    },
    "timestamp": "2023-12-31T23:59:59Z"
  }
  ```

#### 1.4 错误响应规范
- **标准错误响应**：
  ```json
  {
    "code": 400,
    "message": "请求参数错误",
    "error": {
      "type": "ValidationError",
      "details": [
        {
          "field": "email",
          "message": "邮箱格式不正确"
        }
      ]
    },
    "timestamp": "2023-12-31T23:59:59Z"
  }
  ```

- **业务错误响应**：
  ```json
  {
    "code": 422,
    "message": "业务逻辑错误",
    "error": {
      "type": "BusinessError",
      "code": "INSUFFICIENT_BALANCE",
      "message": "账户余额不足"
    },
    "timestamp": "2023-12-31T23:59:59Z"
  }
  ```

### 2. 错误处理机制

#### 2.1 HTTP状态码规范
- **200 OK**：请求成功
- **201 Created**：资源创建成功
- **204 No Content**：请求成功，无返回内容
- **400 Bad Request**：请求参数错误
- **401 Unauthorized**：未授权或令牌无效
- **403 Forbidden**：禁止访问，权限不足
- **404 Not Found**：资源不存在
- **409 Conflict**：资源冲突
- **422 Unprocessable Entity**：请求格式正确但语义错误
- **429 Too Many Requests**：请求频率超限
- **500 Internal Server Error**：服务器内部错误
- **502 Bad Gateway**：网关错误
- **503 Service Unavailable**：服务不可用

#### 2.2 业务错误码规范
- **1000-1999**：用户相关错误
  - 1001：用户名或密码错误
  - 1002：用户不存在
  - 1003：用户已被禁用
  - 1004：用户名已存在
  - 1005：邮箱已存在

- **2000-2999**：房间相关错误
  - 2001：房间不存在
  - 2002：房间已满员
  - 2003：无权限访问房间
  - 2004：房间名称已存在

- **3000-3999**：账单相关错误
  - 3001：账单不存在
  - 3002：账单已结算
  - 3003：账单金额不能为负数
  - 3004：账单分摊金额不正确

- **4000-4999**：支付相关错误
  - 4001：支付记录不存在
  - 4002：支付金额不正确
  - 4003：支付方式不支持
  - 4004：支付已超时

- **5000-5999**：系统相关错误
  - 5001：系统维护中
  - 5002：服务暂时不可用
  - 5003：数据库连接失败
  - 5004：第三方服务异常

### 3. 安全性设计

#### 3.1 认证安全
- **密码加密**：用户密码使用bcrypt算法加密存储，盐值长度不少于10位
- **令牌安全**：JWT令牌使用RS256算法签名，私钥安全存储
- **登录保护**：连续登录失败5次后锁定账户30分钟
- **设备管理**：记录用户登录设备信息，支持异地登录提醒

#### 3.2 接口安全
- **HTTPS**：所有接口必须通过HTTPS协议访问
- **CORS**：配置跨域资源共享，仅允许信任的域名
- **请求签名**：对关键接口添加请求签名验证，防止请求篡改
- **防重放攻击**：关键接口添加nonce参数和时间戳验证

#### 3.3 数据安全
- **敏感数据脱敏**：在日志和响应中对敏感数据进行脱敏处理
- **数据传输加密**：敏感数据在传输过程中使用AES-256加密
- **数据存储加密**：敏感数据在数据库中使用字段级加密
- **数据访问控制**：基于角色的访问控制(RBAC)，确保用户只能访问有权限的数据

#### 3.4 接口限流
- **用户级限流**：每个用户每分钟最多请求100次
- **IP级限流**：每个IP每分钟最多请求200次
- **接口级限流**：根据接口的重要性和资源消耗设置不同的限流阈值
- **限流响应**：超过限流阈值时返回429状态码和Retry-After头

### 4. 性能优化建议

#### 4.1 缓存策略
- **Redis缓存**：对热点数据使用Redis缓存，设置合理的过期时间
- **CDN缓存**：静态资源使用CDN加速，设置适当的缓存策略
- **接口缓存**：对查询类接口添加缓存，减少数据库压力
- **缓存更新**：采用缓存旁路模式，确保缓存与数据库的一致性

#### 4.2 数据库优化
- **索引优化**：为常用查询字段添加适当的索引
- **查询优化**：避免N+1查询问题，使用JOIN或预加载
- **分库分表**：对大数据量表进行分库分表处理
- **读写分离**：使用主从复制，读操作使用从库

#### 4.3 接口优化
- **批量操作**：提供批量操作接口，减少请求次数
- **分页优化**：使用游标分页替代偏移分页，提高大数据量查询性能
- **数据压缩**：对大数据响应启用GZIP压缩
- **异步处理**：对耗时操作使用异步处理，立即返回任务ID

### 5. 监控与日志

#### 5.1 接口监控
- **响应时间监控**：监控接口响应时间，设置告警阈值
- **错误率监控**：监控接口错误率，异常时及时告警
- **吞吐量监控**：监控接口请求量，评估系统负载
- **资源使用监控**：监控CPU、内存、磁盘等系统资源使用情况

#### 5.2 日志规范
- **请求日志**：记录所有请求的基本信息，包括时间、IP、用户ID、接口路径
- **错误日志**：详细记录错误信息，包括错误堆栈、请求参数、用户上下文
- **业务日志**：记录关键业务操作，如用户登录、支付、账单创建等
- **审计日志**：记录敏感操作，如数据修改、权限变更等

#### 5.3 告警机制
- **实时告警**：对系统异常设置实时告警，通过短信、邮件等方式通知
- **告警分级**：根据问题严重程度设置不同级别的告警
- **告警收敛**：避免告警风暴，对相似告警进行合并处理
- **告警处理**：建立告警处理流程，确保问题及时解决

### 6. 版本管理

#### 6.1 API版本控制
- **URL版本控制**：在URL中包含版本号，如 `/api/v1/users`
- **Header版本控制**：使用Accept头指定版本，如 `Accept: application/vnd.api+json;version=1`
- **向后兼容**：新版本API保持向后兼容，至少支持两个版本
- **废弃通知**：提前通知API废弃计划，提供迁移指南

#### 6.2 版本发布策略
- **语义化版本**：使用语义化版本号，如 1.0.0
- **变更日志**：维护详细的变更日志，记录每个版本的变更内容
- **灰度发布**：新版本先进行灰度发布，验证稳定性后再全量发布
- **回滚机制**：建立快速回滚机制，确保问题版本能够及时回滚

## 十四、活动管理接口

### 1. 获取活动列表

**接口地址：** `GET /activities`

**接口描述：** 获取活动列表，支持分页和筛选

**请求参数：**
```json
{
  "page": 1,
  "page_size": 20,
  "status": "active|inactive|upcoming|ended",
  "type": "discount|rebate|points|gift",
  "room_id": "房间ID（可选）",
  "start_date": "开始日期（YYYY-MM-DD）",
  "end_date": "结束日期（YYYY-MM-DD）"
}
```

**返回结果：**
```json
{
  "code": 200,
  "message": "获取成功",
  "data": {
    "items": [
      {
        "id": "activity_id",
        "title": "活动标题",
        "description": "活动描述",
        "type": "discount",
        "status": "active",
        "start_time": "2023-12-01T00:00:00Z",
        "end_time": "2023-12-31T23:59:59Z",
        "rules": {
          "discount_rate": "0.8",
          "max_discount": "10.00"
        },
        "room_id": "room_id",
        "room_name": "房间名称",
        "participant_count": 15,
        "created_at": "2023-11-20T10:00:00Z",
        "updated_at": "2023-11-25T15:30:00Z"
      }
    ],
    "pagination": {
      "page": 1,
      "page_size": 20,
      "total": 100,
      "total_pages": 5,
      "has_next": true,
      "has_prev": false
    }
  },
  "timestamp": "2023-12-31T23:59:59Z"
}
```

### 2. 创建活动

**接口地址：** `POST /activities`

**接口描述：** 创建新活动

**请求参数：**
```json
{
  "title": "活动标题",
  "description": "活动描述",
  "type": "discount",
  "start_time": "2023-12-01T00:00:00Z",
  "end_time": "2023-12-31T23:59:59Z",
  "rules": {
    "discount_rate": "0.8",
    "max_discount": "10.00"
  },
  "room_id": "房间ID（可选，为空则为全局活动）",
  "image_url": "活动封面图片URL"
}
```

**返回结果：**
```json
{
  "code": 201,
  "message": "创建成功",
  "data": {
    "id": "activity_id",
    "title": "活动标题",
    "description": "活动描述",
    "type": "discount",
    "status": "inactive",
    "start_time": "2023-12-01T00:00:00Z",
    "end_time": "2023-12-31T23:59:59Z",
    "rules": {
      "discount_rate": "0.8",
      "max_discount": "10.00"
    },
    "room_id": "room_id",
    "room_name": "房间名称",
    "participant_count": 0,
    "image_url": "活动封面图片URL",
    "created_at": "2023-11-20T10:00:00Z",
    "updated_at": "2023-11-20T10:00:00Z"
  },
  "timestamp": "2023-12-31T23:59:59Z"
}
```

### 3. 获取活动详情

**接口地址：** `GET /activities/{activityId}`

**接口描述：** 获取指定活动的详细信息

**返回结果：**
```json
{
  "code": 200,
  "message": "获取成功",
  "data": {
    "id": "activity_id",
    "title": "活动标题",
    "description": "活动描述",
    "type": "discount",
    "status": "active",
    "start_time": "2023-12-01T00:00:00Z",
    "end_time": "2023-12-31T23:59:59Z",
    "rules": {
      "discount_rate": "0.8",
      "max_discount": "10.00"
    },
    "room_id": "room_id",
    "room_name": "房间名称",
    "participant_count": 15,
    "image_url": "活动封面图片URL",
    "creator": {
      "id": "user_id",
      "username": "创建者用户名",
      "avatar": "头像URL"
    },
    "participants": [
      {
        "user_id": "user_id",
        "username": "用户名",
        "avatar": "头像URL",
        "joined_at": "2023-12-05T10:30:00Z"
      }
    ],
    "created_at": "2023-11-20T10:00:00Z",
    "updated_at": "2023-11-25T15:30:00Z"
  },
  "timestamp": "2023-12-31T23:59:59Z"
}
```

### 4. 更新活动

**接口地址：** `PUT /activities/{activityId}`

**接口描述：** 更新活动信息

**请求参数：**
```json
{
  "title": "活动标题",
  "description": "活动描述",
  "type": "discount",
  "start_time": "2023-12-01T00:00:00Z",
  "end_time": "2023-12-31T23:59:59Z",
  "rules": {
    "discount_rate": "0.8",
    "max_discount": "10.00"
  },
  "status": "active",
  "image_url": "活动封面图片URL"
}
```

**返回结果：**
```json
{
  "code": 200,
  "message": "更新成功",
  "data": {
    "id": "activity_id",
    "title": "活动标题",
    "description": "活动描述",
    "type": "discount",
    "status": "active",
    "start_time": "2023-12-01T00:00:00Z",
    "end_time": "2023-12-31T23:59:59Z",
    "rules": {
      "discount_rate": "0.8",
      "max_discount": "10.00"
    },
    "room_id": "room_id",
    "room_name": "房间名称",
    "participant_count": 15,
    "image_url": "活动封面图片URL",
    "updated_at": "2023-11-25T16:00:00Z"
  },
  "timestamp": "2023-12-31T23:59:59Z"
}
```

### 5. 删除活动

**接口地址：** `DELETE /activities/{activityId}`

**接口描述：** 删除指定活动

**返回结果：**
```json
{
  "code": 200,
  "message": "删除成功",
  "data": null,
  "timestamp": "2023-12-31T23:59:59Z"
}
```

### 6. 启用/禁用活动

**接口地址：** `POST /activities/{activityId}/toggle`

**接口描述：** 启用或禁用活动

**请求参数：**
```json
{
  "status": "active|inactive"
}
```

**返回结果：**
```json
{
  "code": 200,
  "message": "操作成功",
  "data": {
    "id": "activity_id",
    "status": "active",
    "updated_at": "2023-11-25T16:30:00Z"
  },
  "timestamp": "2023-12-31T23:59:59Z"
}
```

### 7. 参与活动

**接口地址：** `POST /activities/{activityId}/join`

**接口描述：** 用户参与活动

**返回结果：**
```json
{
  "code": 200,
  "message": "参与成功",
  "data": {
    "activity_id": "activity_id",
    "user_id": "user_id",
    "joined_at": "2023-12-05T10:30:00Z"
  },
  "timestamp": "2023-12-31T23:59:59Z"
}
```

### 8. 退出活动

**接口地址：** `POST /activities/{activityId}/leave`

**接口描述：** 用户退出活动

**返回结果：**
```json
{
  "code": 200,
  "message": "退出成功",
  "data": null,
  "timestamp": "2023-12-31T23:59:59Z"
}
```

### 9. 获取活动统计

**接口地址：** `GET /activities/{activityId}/statistics`

**接口描述：** 获取活动统计信息

**返回结果：**
```json
{
  "code": 200,
  "message": "获取成功",
  "data": {
    "activity_id": "activity_id",
    "participant_count": 15,
    "total_savings": "150.50",
    "total_usage": 45,
    "daily_stats": [
      {
        "date": "2023-12-01",
        "new_participants": 5,
        "usage_count": 12,
        "savings_amount": "35.20"
      }
    ],
    "room_distribution": [
      {
        "room_id": "room_id",
        "room_name": "房间名称",
        "participant_count": 8,
        "usage_count": 25,
        "savings_amount": "85.30"
      }
    ]
  },
  "timestamp": "2023-12-31T23:59:59Z"
}
```

### 10. 上传活动图片

**接口地址：** `POST /activities/images`

**接口描述：** 上传活动相关图片

**请求参数：**
```json
{
  "image": "图片文件",
  "type": "cover|banner"
}
```

**返回结果：**
```json
{
  "code": 200,
  "message": "上传成功",
  "data": {
    "url": "图片URL",
    "filename": "文件名",
    "size": 1024000,
    "type": "image/jpeg"
  },
  "timestamp": "2023-12-31T23:59:59Z"
}
```

## 十五、权限管理接口

### 1. 获取角色列表

**接口地址：** `GET /roles`

**接口描述：** 获取系统角色列表

**请求参数：**
```json
{
  "page": 1,
  "page_size": 20,
  "keyword": "搜索关键词（可选）"
}
```

**返回结果：**
```json
{
  "code": 200,
  "message": "获取成功",
  "data": {
    "items": [
      {
        "id": "role_id",
        "name": "角色名称",
        "description": "角色描述",
        "is_system": false,
        "user_count": 5,
        "permission_count": 12,
        "created_at": "2023-11-20T10:00:00Z",
        "updated_at": "2023-11-25T15:30:00Z"
      }
    ],
    "pagination": {
      "page": 1,
      "page_size": 20,
      "total": 10,
      "total_pages": 1,
      "has_next": false,
      "has_prev": false
    }
  },
  "timestamp": "2023-12-31T23:59:59Z"
}
```

### 2. 创建角色

**接口地址：** `POST /roles`

**接口描述：** 创建新角色

**请求参数：**
```json
{
  "name": "角色名称",
  "description": "角色描述",
  "permission_ids": ["permission_id1", "permission_id2"]
}
```

**返回结果：**
```json
{
  "code": 201,
  "message": "创建成功",
  "data": {
    "id": "role_id",
    "name": "角色名称",
    "description": "角色描述",
    "is_system": false,
    "permissions": [
      {
        "id": "permission_id",
        "name": "权限名称",
        "code": "permission_code"
      }
    ],
    "created_at": "2023-11-20T10:00:00Z"
  },
  "timestamp": "2023-12-31T23:59:59Z"
}
```

### 3. 获取角色详情

**接口地址：** `GET /roles/{roleId}`

**接口描述：** 获取指定角色的详细信息

**返回结果：**
```json
{
  "code": 200,
  "message": "获取成功",
  "data": {
    "id": "role_id",
    "name": "角色名称",
    "description": "角色描述",
    "is_system": false,
    "permissions": [
      {
        "id": "permission_id",
        "name": "权限名称",
        "code": "permission_code",
        "module": "模块名称",
        "description": "权限描述"
      }
    ],
    "users": [
      {
        "id": "user_id",
        "username": "用户名",
        "avatar": "头像URL",
        "assigned_at": "2023-11-20T10:00:00Z"
      }
    ],
    "created_at": "2023-11-20T10:00:00Z",
    "updated_at": "2023-11-25T15:30:00Z"
  },
  "timestamp": "2023-12-31T23:59:59Z"
}
```

### 4. 更新角色

**接口地址：** `PUT /roles/{roleId}`

**接口描述：** 更新角色信息

**请求参数：**
```json
{
  "name": "角色名称",
  "description": "角色描述",
  "permission_ids": ["permission_id1", "permission_id2"]
}
```

**返回结果：**
```json
{
  "code": 200,
  "message": "更新成功",
  "data": {
    "id": "role_id",
    "name": "角色名称",
    "description": "角色描述",
    "is_system": false,
    "updated_at": "2023-11-25T16:00:00Z"
  },
  "timestamp": "2023-12-31T23:59:59Z"
}
```

### 5. 删除角色

**接口地址：** `DELETE /roles/{roleId}`

**接口描述：** 删除指定角色

**返回结果：**
```json
{
  "code": 200,
  "message": "删除成功",
  "data": null,
  "timestamp": "2023-12-31T23:59:59Z"
}
```

### 6. 获取权限列表

**接口地址：** `GET /permissions`

**接口描述：** 获取系统权限列表

**请求参数：**
```json
{
  "module": "模块名称（可选）"
}
```

**返回结果：**
```json
{
  "code": 200,
  "message": "获取成功",
  "data": [
    {
      "id": "permission_id",
      "name": "权限名称",
      "code": "permission_code",
      "module": "模块名称",
      "description": "权限描述",
      "is_system": true
    }
  ],
  "timestamp": "2023-12-31T23:59:59Z"
}
```

### 7. 分配用户角色

**接口地址：** `POST /users/{userId}/roles`

**接口描述：** 为用户分配角色

**请求参数：**
```json
{
  "role_ids": ["role_id1", "role_id2"]
}
```

**返回结果：**
```json
{
  "code": 200,
  "message": "分配成功",
  "data": {
    "user_id": "user_id",
    "roles": [
      {
        "id": "role_id",
        "name": "角色名称"
      }
    ]
  },
  "timestamp": "2023-12-31T23:59:59Z"
}
```

### 8. 移除用户角色

**接口地址：** `DELETE /users/{userId}/roles/{roleId}`

**接口描述：** 移除用户的指定角色

**返回结果：**
```json
{
  "code": 200,
  "message": "移除成功",
  "data": null,
  "timestamp": "2023-12-31T23:59:59Z"
}
```

### 9. 获取用户权限

**接口地址：** `GET /users/{userId}/permissions`

**接口描述：** 获取用户的所有权限

**返回结果：**
```json
{
  "code": 200,
  "message": "获取成功",
  "data": {
    "user_id": "user_id",
    "roles": [
      {
        "id": "role_id",
        "name": "角色名称"
      }
    ],
    "permissions": [
      {
        "id": "permission_id",
        "name": "权限名称",
        "code": "permission_code",
        "module": "模块名称"
      }
    ]
  },
  "timestamp": "2023-12-31T23:59:59Z"
}
```

### 10. 检查权限

**接口地址：** `POST /permissions/check`

**接口描述：** 检查用户是否具有指定权限

**请求参数：**
```json
{
  "user_id": "user_id",
  "permission_codes": ["permission_code1", "permission_code2"]
}
```

**返回结果：**
```json
{
  "code": 200,
  "message": "检查完成",
  "data": {
    "user_id": "user_id",
    "permissions": [
      {
        "code": "permission_code1",
        "has_permission": true
      },
      {
        "code": "permission_code2",
        "has_permission": false
      }
    ]
  },
  "timestamp": "2023-12-31T23:59:59Z"
}
```

## 十六、审核面板接口

### 1. 获取待审核列表

**接口地址：** `GET /audit/pending`

**接口描述：** 获取待审核项目列表

**请求参数：**
```json
{
  "page": 1,
  "page_size": 20,
  "type": "bill|payment|dispute|review|user",
  "priority": "high|medium|low",
  "room_id": "房间ID（可选）"
}
```

**返回结果：**
```json
{
  "code": 200,
  "message": "获取成功",
  "data": {
    "items": [
      {
        "id": "audit_id",
        "type": "bill",
        "type_name": "账单",
        "item_id": "item_id",
        "title": "审核项目标题",
        "description": "审核项目描述",
        "priority": "high",
        "status": "pending",
        "submitter": {
          "id": "user_id",
          "username": "提交者用户名",
          "avatar": "头像URL"
        },
        "room": {
          "id": "room_id",
          "name": "房间名称"
        },
        "submitted_at": "2023-12-05T10:30:00Z",
        "updated_at": "2023-12-05T10:30:00Z"
      }
    ],
    "pagination": {
      "page": 1,
      "page_size": 20,
      "total": 50,
      "total_pages": 3,
      "has_next": true,
      "has_prev": false
    }
  },
  "timestamp": "2023-12-31T23:59:59Z"
}
```

### 2. 获取审核详情

**接口地址：** `GET /audit/{auditId}`

**接口描述：** 获取指定审核项目的详细信息

**返回结果：**
```json
{
  "code": 200,
  "message": "获取成功",
  "data": {
    "id": "audit_id",
    "type": "bill",
    "type_name": "账单",
    "item_id": "item_id",
    "title": "审核项目标题",
    "description": "审核项目描述",
    "priority": "high",
    "status": "pending",
    "content": {
      "amount": "100.00",
      "description": "账单描述",
      "category": "餐饮",
      "date": "2023-12-05",
      "images": ["图片URL1", "图片URL2"]
    },
    "submitter": {
      "id": "user_id",
      "username": "提交者用户名",
      "avatar": "头像URL"
    },
    "room": {
      "id": "room_id",
      "name": "房间名称"
    },
    "history": [
      {
        "action": "submitted",
        "operator": {
          "id": "user_id",
          "username": "操作者用户名",
          "avatar": "头像URL"
        },
        "comment": "提交审核",
        "timestamp": "2023-12-05T10:30:00Z"
      }
    ],
    "submitted_at": "2023-12-05T10:30:00Z",
    "updated_at": "2023-12-05T10:30:00Z"
  },
  "timestamp": "2023-12-31T23:59:59Z"
}
```

### 3. 审核通过

**接口地址：** `POST /audit/{auditId}/approve`

**接口描述：** 审核通过指定项目

**请求参数：**
```json
{
  "comment": "审核意见（可选）"
}
```

**返回结果：**
```json
{
  "code": 200,
  "message": "审核通过",
  "data": {
    "id": "audit_id",
    "status": "approved",
    "approved_by": {
      "id": "user_id",
      "username": "审核者用户名",
      "avatar": "头像URL"
    },
    "approved_at": "2023-12-05T15:30:00Z",
    "comment": "审核意见"
  },
  "timestamp": "2023-12-31T23:59:59Z"
}
```

### 4. 审核拒绝

**接口地址：** `POST /audit/{auditId}/reject`

**接口描述：** 审核拒绝指定项目

**请求参数：**
```json
{
  "reason": "拒绝原因",
  "comment": "详细说明（可选）"
}
```

**返回结果：**
```json
{
  "code": 200,
  "message": "审核拒绝",
  "data": {
    "id": "audit_id",
    "status": "rejected",
    "rejected_by": {
      "id": "user_id",
      "username": "审核者用户名",
      "avatar": "头像URL"
    },
    "rejected_at": "2023-12-05T15:30:00Z",
    "reason": "拒绝原因",
    "comment": "详细说明"
  },
  "timestamp": "2023-12-31T23:59:59Z"
}
```

### 5. 获取审核历史

**接口地址：** `GET /audit/history`

**接口描述：** 获取审核历史记录

**请求参数：**
```json
{
  "page": 1,
  "page_size": 20,
  "type": "bill|payment|dispute|review|user",
  "status": "approved|rejected|pending",
  "start_date": "开始日期（YYYY-MM-DD）",
  "end_date": "结束日期（YYYY-MM-DD）",
  "auditor_id": "审核者ID（可选）",
  "submitter_id": "提交者ID（可选）"
}
```

**返回结果：**
```json
{
  "code": 200,
  "message": "获取成功",
  "data": {
    "items": [
      {
        "id": "audit_id",
        "type": "bill",
        "type_name": "账单",
        "item_id": "item_id",
        "title": "审核项目标题",
        "status": "approved",
        "submitter": {
          "id": "user_id",
          "username": "提交者用户名",
          "avatar": "头像URL"
        },
        "auditor": {
          "id": "user_id",
          "username": "审核者用户名",
          "avatar": "头像URL"
        },
        "room": {
          "id": "room_id",
          "name": "房间名称"
        },
        "submitted_at": "2023-12-05T10:30:00Z",
        "audited_at": "2023-12-05T15:30:00Z",
        "audit_duration": 300
      }
    ],
    "pagination": {
      "page": 1,
      "page_size": 20,
      "total": 100,
      "total_pages": 5,
      "has_next": true,
      "has_prev": false
    }
  },
  "timestamp": "2023-12-31T23:59:59Z"
}
```

### 6. 获取审核统计

**接口地址：** `GET /audit/statistics`

**接口描述：** 获取审核统计数据

**请求参数：**
```json
{
  "start_date": "开始日期（YYYY-MM-DD）",
  "end_date": "结束日期（YYYY-MM-DD）",
  "auditor_id": "审核者ID（可选）"
}
```

**返回结果：**
```json
{
  "code": 200,
  "message": "获取成功",
  "data": {
    "summary": {
      "total_pending": 25,
      "total_approved": 150,
      "total_rejected": 30,
      "avg_approval_time": 1800,
      "avg_rejection_time": 1200
    },
    "by_type": [
      {
        "type": "bill",
        "type_name": "账单",
        "pending": 15,
        "approved": 80,
        "rejected": 10
      }
    ],
    "by_priority": [
      {
        "priority": "high",
        "pending": 5,
        "approved": 30,
        "rejected": 5
      }
    ],
    "daily_stats": [
      {
        "date": "2023-12-01",
        "pending": 10,
        "approved": 25,
        "rejected": 5
      }
    ],
    "top_auditors": [
      {
        "user_id": "user_id",
        "username": "用户名",
        "avatar": "头像URL",
        "approved_count": 50,
        "rejected_count": 10,
        "avg_time": 1500
      }
    ]
  },
  "timestamp": "2023-12-31T23:59:59Z"
}
```

## 十七、请假记录接口

### 1. 获取请假记录列表
```json
{
  "address": "/leave-records",
  "method": "GET",
  "description": "获取当前用户的请假记录列表，支持分页和筛选",
  "parameters": {
    "query": {
      "page": {
        "type": "integer",
        "required": false,
        "description": "页码，默认1"
      },
      "page_size": {
        "type": "integer",
        "required": false,
        "description": "每页数量，默认20"
      },
      "status": {
        "type": "string",
        "required": false,
        "description": "状态筛选：pending/approved/rejected/cancelled",
        "options": ["pending", "approved", "rejected", "cancelled"]
      },
      "start_date": {
        "type": "string",
        "required": false,
        "description": "开始日期，格式：YYYY-MM-DD"
      },
      "end_date": {
        "type": "string",
        "required": false,
        "description": "结束日期，格式：YYYY-MM-DD"
      }
    }
  },
  "response": {
    "success": true,
    "data": {
      "leave_records": [
        {
          "id": 1,
          "user_id": 1,
          "username": "张三",
          "leave_type": "annual",
          "leave_type_name": "年假",
          "start_date": "2024-01-01",
          "end_date": "2024-01-03",
          "days": 3,
          "reason": "回家过年",
          "status": "approved",
          "status_name": "已批准",
          "approved_by": 2,
          "approved_by_name": "李四",
          "approved_at": "2023-12-20T10:30:00Z",
          "created_at": "2023-12-15T09:15:00Z",
          "updated_at": "2023-12-20T10:30:00Z"
        }
      ],
      "pagination": {
        "page": 1,
        "page_size": 20,
        "total": 1,
        "total_pages": 1
      }
    }
  },
  "errors": {
    "401": "未授权访问",
    "500": "服务器内部错误"
  }
}
```

### 2. 获取请假记录详情
```json
{
  "address": "/leave-records/{id}",
  "method": "GET",
  "description": "获取指定请假记录的详细信息",
  "parameters": {
    "path": {
      "id": {
        "type": "integer",
        "required": true,
        "description": "请假记录ID"
      }
    }
  },
  "response": {
    "success": true,
    "data": {
      "leave_record": {
        "id": 1,
        "user_id": 1,
        "username": "张三",
        "employee_id": "EMP001",
        "department": "技术部",
        "position": "前端工程师",
        "leave_type": "annual",
        "leave_type_name": "年假",
        "start_date": "2024-01-01",
        "end_date": "2024-01-03",
        "days": 3,
        "reason": "回家过年",
        "attachments": [
          {
            "id": 1,
            "name": "请假申请.docx",
            "url": "https://example.com/attachments/1.docx"
          }
        ],
        "status": "approved",
        "status_name": "已批准",
        "approver_id": 2,
        "approver_name": "李四",
        "approved_at": "2023-12-20T10:30:00Z",
        "approval_notes": "同意申请，祝旅途愉快",
        "created_at": "2023-12-15T09:15:00Z",
        "updated_at": "2023-12-20T10:30:00Z"
      }
    }
  },
  "errors": {
    "401": "未授权访问",
    "403": "无权查看该请假记录",
    "404": "请假记录不存在",
    "500": "服务器内部错误"
  }
}
```

### 3. 创建请假记录
```json
{
  "address": "/leave-records",
  "method": "POST",
  "description": "创建新的请假记录",
  "parameters": {
    "body": {
      "leave_type": {
        "type": "string",
        "required": true,
        "description": "请假类型",
        "options": ["annual", "sick", "personal", "maternity", "paternity", "others"]
      },
      "start_date": {
        "type": "string",
        "required": true,
        "description": "开始日期，格式：YYYY-MM-DD"
      },
      "end_date": {
        "type": "string",
        "required": true,
        "description": "结束日期，格式：YYYY-MM-DD"
      },
      "reason": {
        "type": "string",
        "required": true,
        "description": "请假原因"
      },
      "attachments": {
        "type": "array",
        "required": false,
        "description": "附件URL列表",
        "items": {
          "type": "string"
        }
      }
    }
  },
  "response": {
    "success": true,
    "data": {
      "leave_record": {
        "id": 2,
        "user_id": 1,
        "username": "张三",
        "leave_type": "sick",
        "leave_type_name": "病假",
        "start_date": "2024-01-10",
        "end_date": "2024-01-12",
        "days": 3,
        "reason": "感冒发烧",
        "status": "pending",
        "status_name": "待审批",
        "created_at": "2024-01-05T14:20:00Z",
        "updated_at": "2024-01-05T14:20:00Z"
      }
    }
  },
  "errors": {
    "400": "请求参数错误",
    "401": "未授权访问",
    "500": "服务器内部错误"
  }
}
```

### 4. 更新请假记录
```json
{
  "address": "/leave-records/{id}",
  "method": "PUT",
  "description": "更新请假记录信息（仅限状态为pending的记录）",
  "parameters": {
    "path": {
      "id": {
        "type": "integer",
        "required": true,
        "description": "请假记录ID"
      }
    },
    "body": {
      "leave_type": {
        "type": "string",
        "required": false,
        "description": "请假类型",
        "options": ["annual", "sick", "personal", "maternity", "paternity", "others"]
      },
      "start_date": {
        "type": "string",
        "required": false,
        "description": "开始日期，格式：YYYY-MM-DD"
      },
      "end_date": {
        "type": "string",
        "required": false,
        "description": "结束日期，格式：YYYY-MM-DD"
      },
      "reason": {
        "type": "string",
        "required": false,
        "description": "请假原因"
      },
      "attachments": {
        "type": "array",
        "required": false,
        "description": "附件URL列表",
        "items": {
          "type": "string"
        }
      }
    }
  },
  "response": {
    "success": true,
    "data": {
      "leave_record": {
        "id": 2,
        "user_id": 1,
        "username": "张三",
        "leave_type": "sick",
        "leave_type_name": "病假",
        "start_date": "2024-01-10",
        "end_date": "2024-01-12",
        "days": 3,
        "reason": "感冒发烧，需要休息",
        "status": "pending",
        "status_name": "待审批",
        "created_at": "2024-01-05T14:20:00Z",
        "updated_at": "2024-01-05T15:30:00Z"
      }
    }
  },
  "errors": {
    "400": "请求参数错误",
    "401": "未授权访问",
    "403": "无权更新该请假记录",
    "404": "请假记录不存在",
    "409": "请假记录状态不是pending，无法更新",
    "500": "服务器内部错误"
  }
}
```

### 5. 删除请假记录
```json
{
  "address": "/leave-records/{id}",
  "method": "DELETE",
  "description": "删除请假记录（仅限状态为pending的记录）",
  "parameters": {
    "path": {
      "id": {
        "type": "integer",
        "required": true,
        "description": "请假记录ID"
      }
    }
  },
  "response": {
    "success": true,
    "data": {
      "message": "请假记录删除成功"
    }
  },
  "errors": {
    "401": "未授权访问",
    "403": "无权删除该请假记录",
    "404": "请假记录不存在",
    "409": "请假记录状态不是pending，无法删除",
    "500": "服务器内部错误"
  }
}
```

### 6. 获取请假类型列表
```json
{
  "address": "/leave-records/types",
  "method": "GET",
  "description": "获取系统支持的请假类型列表",
  "parameters": {},
  "response": {
    "success": true,
    "data": {
      "leave_types": [
        {
          "key": "annual",
          "name": "年假",
          "description": "年度带薪休假"
        },
        {
          "key": "sick",
          "name": "病假",
          "description": "因病需要休息的假期"
        },
        {
          "key": "personal",
          "name": "事假",
          "description": "处理个人事务的假期"
        },
        {
          "key": "maternity",
          "name": "产假",
          "description": "女性员工生育期间的假期"
        },
        {
          "key": "paternity",
          "name": "陪产假",
          "description": "男性员工配偶生育期间的假期"
        },
        {
          "key": "others",
          "name": "其他",
          "description": "其他类型的假期"
        }
      ]
    }
  },
  "errors": {
    "401": "未授权访问",
    "500": "服务器内部错误"
  }
}
```

### 7. 获取请假统计
```json
{
  "address": "/leave-records/stats",
  "method": "GET",
  "description": "获取当前用户的请假统计数据",
  "parameters": {
    "query": {
      "start_date": {
        "type": "string",
        "required": false,
        "description": "开始日期，格式：YYYY-MM-DD"
      },
      "end_date": {
        "type": "string",
        "required": false,
        "description": "结束日期，格式：YYYY-MM-DD"
      }
    }
  },
  "response": {
    "success": true,
    "data": {
      "total_records": 5,
      "pending_count": 1,
      "approved_count": 3,
      "rejected_count": 1,
      "cancelled_count": 0,
      "leave_type_stats": [
        {
          "type": "annual",
          "type_name": "年假",
          "count": 2,
          "days": 7
        },
        {
          "type": "sick",
          "type_name": "病假",
          "count": 2,
          "days": 5
        },
        {
          "type": "personal",
          "type_name": "事假",
          "count": 1,
          "days": 2
        }
      ],
      "monthly_stats": [
        {
          "month": "2023-12",
          "count": 2,
          "days": 5
        },
        {
          "month": "2024-01",
          "count": 3,
          "days": 9
        }
      ]
    }
  },
  "errors": {
    "401": "未授权访问",
    "500": "服务器内部错误"
  }
}
```

### 7. 批量审核

**接口地址：** `POST /audit/batch`

**接口描述：** 批量审核多个项目

**请求参数：**
```json
{
  "audit_ids": ["audit_id1", "audit_id2"],
  "action": "approve|reject",
  "reason": "拒绝原因（拒绝时必填）",
  "comment": "审核意见（可选）"
}
```

**返回结果：**
```json
{
  "code": 200,
  "message": "批量审核完成",
  "data": {
    "success_count": 2,
    "failed_count": 0,
    "results": [
      {
        "audit_id": "audit_id1",
        "status": "approved",
        "success": true
      },
      {
        "audit_id": "audit_id2",
        "status": "approved",
        "success": true
      }
    ]
  },
  "timestamp": "2023-12-31T23:59:59Z"
}
```

### 8. 转交审核

**接口地址：** `POST /audit/{auditId}/transfer`

**接口描述：** 将审核项目转交给其他审核者

**请求参数：**
```json
{
  "target_auditor_id": "目标审核者ID",
  "reason": "转交原因"
}
```

**返回结果：**
```json
{
  "code": 200,
  "message": "转交成功",
  "data": {
    "id": "audit_id",
    "transferred_by": {
      "id": "user_id",
      "username": "转交者用户名",
      "avatar": "头像URL"
    },
    "transferred_to": {
      "id": "user_id",
      "username": "接收者用户名",
      "avatar": "头像URL"
    },
    "transferred_at": "2023-12-05T16:00:00Z",
    "reason": "转交原因"
  },
  "timestamp": "2023-12-31T23:59:59Z"
}
```
