{"numFailedTestSuites":19,"numFailedTests":234,"numPassedTestSuites":11,"numPassedTests":96,"numPendingTestSuites":1,"numPendingTests":10,"numRuntimeErrorTestSuites":6,"numTodoTests":0,"numTotalTestSuites":31,"numTotalTests":340,"openHandles":[],"snapshot":{"added":0,"didUpdate":false,"failure":false,"filesAdded":0,"filesRemoved":0,"filesRemovedList":[],"filesUnmatched":0,"filesUpdated":0,"matched":0,"total":0,"unchecked":0,"uncheckedKeysByFile":[],"unmatched":0,"updated":0},"startTime":1762159254061,"success":false,"testResults":[{"assertionResults":[{"ancestorTitles":["离线支付服务测试 - 真实数据库","createOfflinePayment"],"duration":378,"failureDetails":[{}],"failureMessages":["TypeError: Cannot read properties of undefined (reading 'User')\n    at Object.User (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\offline-payment-service-real-db.test.js:27:29)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)"],"fullName":"离线支付服务测试 - 真实数据库 createOfflinePayment 应该成功创建离线支付记录","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该成功创建离线支付记录"},{"ancestorTitles":["离线支付服务测试 - 真实数据库","createOfflinePayment"],"duration":301,"failureDetails":[{}],"failureMessages":["TypeError: Cannot read properties of undefined (reading 'User')\n    at Object.User (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\offline-payment-service-real-db.test.js:27:29)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)"],"fullName":"离线支付服务测试 - 真实数据库 createOfflinePayment 应该在缺少必要参数时抛出错误","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该在缺少必要参数时抛出错误"},{"ancestorTitles":["离线支付服务测试 - 真实数据库","createOfflinePayment"],"duration":300,"failureDetails":[{}],"failureMessages":["TypeError: Cannot read properties of undefined (reading 'User')\n    at Object.User (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\offline-payment-service-real-db.test.js:27:29)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)"],"fullName":"离线支付服务测试 - 真实数据库 createOfflinePayment 应该在账单不存在时抛出错误","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该在账单不存在时抛出错误"},{"ancestorTitles":["离线支付服务测试 - 真实数据库","createOfflinePayment"],"duration":299,"failureDetails":[{}],"failureMessages":["TypeError: Cannot read properties of undefined (reading 'User')\n    at Object.User (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\offline-payment-service-real-db.test.js:27:29)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)"],"fullName":"离线支付服务测试 - 真实数据库 createOfflinePayment 应该在用户不存在时抛出错误","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该在用户不存在时抛出错误"},{"ancestorTitles":["离线支付服务测试 - 真实数据库","syncOfflinePayment"],"duration":316,"failureDetails":[{}],"failureMessages":["TypeError: Cannot read properties of undefined (reading 'User')\n    at Object.User (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\offline-payment-service-real-db.test.js:27:29)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)"],"fullName":"离线支付服务测试 - 真实数据库 syncOfflinePayment 应该成功同步离线支付记录","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该成功同步离线支付记录"},{"ancestorTitles":["离线支付服务测试 - 真实数据库","syncOfflinePayment"],"duration":319,"failureDetails":[{}],"failureMessages":["TypeError: Cannot read properties of undefined (reading 'User')\n    at Object.User (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\offline-payment-service-real-db.test.js:27:29)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)"],"fullName":"离线支付服务测试 - 真实数据库 syncOfflinePayment 应该在支付记录不存在时抛出错误","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该在支付记录不存在时抛出错误"},{"ancestorTitles":["离线支付服务测试 - 真实数据库","syncOfflinePayment"],"duration":308,"failureDetails":[{}],"failureMessages":["TypeError: Cannot read properties of undefined (reading 'User')\n    at Object.User (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\offline-payment-service-real-db.test.js:27:29)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)"],"fullName":"离线支付服务测试 - 真实数据库 syncOfflinePayment 应该在支付记录状态不正确时抛出错误","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该在支付记录状态不正确时抛出错误"},{"ancestorTitles":["离线支付服务测试 - 真实数据库","getUserOfflinePayments"],"duration":312,"failureDetails":[{}],"failureMessages":["TypeError: Cannot read properties of undefined (reading 'User')\n    at Object.User (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\offline-payment-service-real-db.test.js:27:29)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)"],"fullName":"离线支付服务测试 - 真实数据库 getUserOfflinePayments 应该成功获取用户离线支付记录","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该成功获取用户离线支付记录"},{"ancestorTitles":["离线支付服务测试 - 真实数据库","getUserOfflinePayments"],"duration":377,"failureDetails":[{}],"failureMessages":["TypeError: Cannot read properties of undefined (reading 'User')\n    at Object.User (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\offline-payment-service-real-db.test.js:27:29)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)"],"fullName":"离线支付服务测试 - 真实数据库 getUserOfflinePayments 应该正确处理分页","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该正确处理分页"},{"ancestorTitles":["离线支付服务测试 - 真实数据库","getUserOfflinePayments"],"duration":305,"failureDetails":[{}],"failureMessages":["TypeError: Cannot read properties of undefined (reading 'User')\n    at Object.User (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\offline-payment-service-real-db.test.js:27:29)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)"],"fullName":"离线支付服务测试 - 真实数据库 getUserOfflinePayments 应该根据状态筛选支付记录","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该根据状态筛选支付记录"}],"coverage":{},"endTime":1762159288876,"message":"\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m离线支付服务测试 - 真实数据库 › createOfflinePayment › 应该成功创建离线支付记录\u001b[39m\u001b[22m\n\n    TypeError: Cannot read properties of undefined (reading 'User')\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 25 |\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 26 |\u001b[39m     \u001b[90m// 创建测试用户\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 27 |\u001b[39m     testUser \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m models\u001b[33m.\u001b[39m\u001b[33mUser\u001b[39m\u001b[33m.\u001b[39mcreate({\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m                             \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 28 |\u001b[39m       username\u001b[33m:\u001b[39m \u001b[32m'testuser'\u001b[39m\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 29 |\u001b[39m       email\u001b[33m:\u001b[39m \u001b[32m'test@example.com'\u001b[39m\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 30 |\u001b[39m       password\u001b[33m:\u001b[39m \u001b[32m'password123'\u001b[39m\u001b[33m,\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.User (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/offline-payment-service-real-db.test.js\u001b[39m\u001b[0m\u001b[2m:27:29)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m离线支付服务测试 - 真实数据库 › createOfflinePayment › 应该在缺少必要参数时抛出错误\u001b[39m\u001b[22m\n\n    TypeError: Cannot read properties of undefined (reading 'User')\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 25 |\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 26 |\u001b[39m     \u001b[90m// 创建测试用户\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 27 |\u001b[39m     testUser \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m models\u001b[33m.\u001b[39m\u001b[33mUser\u001b[39m\u001b[33m.\u001b[39mcreate({\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m                             \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 28 |\u001b[39m       username\u001b[33m:\u001b[39m \u001b[32m'testuser'\u001b[39m\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 29 |\u001b[39m       email\u001b[33m:\u001b[39m \u001b[32m'test@example.com'\u001b[39m\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 30 |\u001b[39m       password\u001b[33m:\u001b[39m \u001b[32m'password123'\u001b[39m\u001b[33m,\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.User (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/offline-payment-service-real-db.test.js\u001b[39m\u001b[0m\u001b[2m:27:29)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m离线支付服务测试 - 真实数据库 › createOfflinePayment › 应该在账单不存在时抛出错误\u001b[39m\u001b[22m\n\n    TypeError: Cannot read properties of undefined (reading 'User')\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 25 |\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 26 |\u001b[39m     \u001b[90m// 创建测试用户\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 27 |\u001b[39m     testUser \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m models\u001b[33m.\u001b[39m\u001b[33mUser\u001b[39m\u001b[33m.\u001b[39mcreate({\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m                             \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 28 |\u001b[39m       username\u001b[33m:\u001b[39m \u001b[32m'testuser'\u001b[39m\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 29 |\u001b[39m       email\u001b[33m:\u001b[39m \u001b[32m'test@example.com'\u001b[39m\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 30 |\u001b[39m       password\u001b[33m:\u001b[39m \u001b[32m'password123'\u001b[39m\u001b[33m,\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.User (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/offline-payment-service-real-db.test.js\u001b[39m\u001b[0m\u001b[2m:27:29)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m离线支付服务测试 - 真实数据库 › createOfflinePayment › 应该在用户不存在时抛出错误\u001b[39m\u001b[22m\n\n    TypeError: Cannot read properties of undefined (reading 'User')\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 25 |\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 26 |\u001b[39m     \u001b[90m// 创建测试用户\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 27 |\u001b[39m     testUser \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m models\u001b[33m.\u001b[39m\u001b[33mUser\u001b[39m\u001b[33m.\u001b[39mcreate({\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m                             \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 28 |\u001b[39m       username\u001b[33m:\u001b[39m \u001b[32m'testuser'\u001b[39m\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 29 |\u001b[39m       email\u001b[33m:\u001b[39m \u001b[32m'test@example.com'\u001b[39m\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 30 |\u001b[39m       password\u001b[33m:\u001b[39m \u001b[32m'password123'\u001b[39m\u001b[33m,\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.User (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/offline-payment-service-real-db.test.js\u001b[39m\u001b[0m\u001b[2m:27:29)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m离线支付服务测试 - 真实数据库 › syncOfflinePayment › 应该成功同步离线支付记录\u001b[39m\u001b[22m\n\n    TypeError: Cannot read properties of undefined (reading 'User')\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 25 |\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 26 |\u001b[39m     \u001b[90m// 创建测试用户\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 27 |\u001b[39m     testUser \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m models\u001b[33m.\u001b[39m\u001b[33mUser\u001b[39m\u001b[33m.\u001b[39mcreate({\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m                             \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 28 |\u001b[39m       username\u001b[33m:\u001b[39m \u001b[32m'testuser'\u001b[39m\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 29 |\u001b[39m       email\u001b[33m:\u001b[39m \u001b[32m'test@example.com'\u001b[39m\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 30 |\u001b[39m       password\u001b[33m:\u001b[39m \u001b[32m'password123'\u001b[39m\u001b[33m,\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.User (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/offline-payment-service-real-db.test.js\u001b[39m\u001b[0m\u001b[2m:27:29)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m离线支付服务测试 - 真实数据库 › syncOfflinePayment › 应该在支付记录不存在时抛出错误\u001b[39m\u001b[22m\n\n    TypeError: Cannot read properties of undefined (reading 'User')\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 25 |\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 26 |\u001b[39m     \u001b[90m// 创建测试用户\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 27 |\u001b[39m     testUser \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m models\u001b[33m.\u001b[39m\u001b[33mUser\u001b[39m\u001b[33m.\u001b[39mcreate({\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m                             \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 28 |\u001b[39m       username\u001b[33m:\u001b[39m \u001b[32m'testuser'\u001b[39m\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 29 |\u001b[39m       email\u001b[33m:\u001b[39m \u001b[32m'test@example.com'\u001b[39m\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 30 |\u001b[39m       password\u001b[33m:\u001b[39m \u001b[32m'password123'\u001b[39m\u001b[33m,\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.User (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/offline-payment-service-real-db.test.js\u001b[39m\u001b[0m\u001b[2m:27:29)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m离线支付服务测试 - 真实数据库 › syncOfflinePayment › 应该在支付记录状态不正确时抛出错误\u001b[39m\u001b[22m\n\n    TypeError: Cannot read properties of undefined (reading 'User')\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 25 |\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 26 |\u001b[39m     \u001b[90m// 创建测试用户\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 27 |\u001b[39m     testUser \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m models\u001b[33m.\u001b[39m\u001b[33mUser\u001b[39m\u001b[33m.\u001b[39mcreate({\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m                             \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 28 |\u001b[39m       username\u001b[33m:\u001b[39m \u001b[32m'testuser'\u001b[39m\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 29 |\u001b[39m       email\u001b[33m:\u001b[39m \u001b[32m'test@example.com'\u001b[39m\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 30 |\u001b[39m       password\u001b[33m:\u001b[39m \u001b[32m'password123'\u001b[39m\u001b[33m,\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.User (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/offline-payment-service-real-db.test.js\u001b[39m\u001b[0m\u001b[2m:27:29)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m离线支付服务测试 - 真实数据库 › getUserOfflinePayments › 应该成功获取用户离线支付记录\u001b[39m\u001b[22m\n\n    TypeError: Cannot read properties of undefined (reading 'User')\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 25 |\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 26 |\u001b[39m     \u001b[90m// 创建测试用户\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 27 |\u001b[39m     testUser \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m models\u001b[33m.\u001b[39m\u001b[33mUser\u001b[39m\u001b[33m.\u001b[39mcreate({\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m                             \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 28 |\u001b[39m       username\u001b[33m:\u001b[39m \u001b[32m'testuser'\u001b[39m\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 29 |\u001b[39m       email\u001b[33m:\u001b[39m \u001b[32m'test@example.com'\u001b[39m\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 30 |\u001b[39m       password\u001b[33m:\u001b[39m \u001b[32m'password123'\u001b[39m\u001b[33m,\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.User (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/offline-payment-service-real-db.test.js\u001b[39m\u001b[0m\u001b[2m:27:29)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m离线支付服务测试 - 真实数据库 › getUserOfflinePayments › 应该正确处理分页\u001b[39m\u001b[22m\n\n    TypeError: Cannot read properties of undefined (reading 'User')\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 25 |\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 26 |\u001b[39m     \u001b[90m// 创建测试用户\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 27 |\u001b[39m     testUser \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m models\u001b[33m.\u001b[39m\u001b[33mUser\u001b[39m\u001b[33m.\u001b[39mcreate({\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m                             \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 28 |\u001b[39m       username\u001b[33m:\u001b[39m \u001b[32m'testuser'\u001b[39m\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 29 |\u001b[39m       email\u001b[33m:\u001b[39m \u001b[32m'test@example.com'\u001b[39m\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 30 |\u001b[39m       password\u001b[33m:\u001b[39m \u001b[32m'password123'\u001b[39m\u001b[33m,\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.User (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/offline-payment-service-real-db.test.js\u001b[39m\u001b[0m\u001b[2m:27:29)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m离线支付服务测试 - 真实数据库 › getUserOfflinePayments › 应该根据状态筛选支付记录\u001b[39m\u001b[22m\n\n    TypeError: Cannot read properties of undefined (reading 'User')\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 25 |\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 26 |\u001b[39m     \u001b[90m// 创建测试用户\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 27 |\u001b[39m     testUser \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m models\u001b[33m.\u001b[39m\u001b[33mUser\u001b[39m\u001b[33m.\u001b[39mcreate({\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m                             \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 28 |\u001b[39m       username\u001b[33m:\u001b[39m \u001b[32m'testuser'\u001b[39m\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 29 |\u001b[39m       email\u001b[33m:\u001b[39m \u001b[32m'test@example.com'\u001b[39m\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 30 |\u001b[39m       password\u001b[33m:\u001b[39m \u001b[32m'password123'\u001b[39m\u001b[33m,\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.User (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/offline-payment-service-real-db.test.js\u001b[39m\u001b[0m\u001b[2m:27:29)\u001b[22m\u001b[2m\u001b[22m\n\n\n  \u001b[1m● \u001b[22mTest suite failed to run\n\n    Called end on pool more than once\n\n    \u001b[0m \u001b[90m 81 |\u001b[39m \u001b[36masync\u001b[39m \u001b[36mfunction\u001b[39m closeTestDatabase() {\n     \u001b[90m 82 |\u001b[39m   \u001b[36mtry\u001b[39m {\n    \u001b[31m\u001b[1m>\u001b[22m\u001b[39m\u001b[90m 83 |\u001b[39m     \u001b[36mawait\u001b[39m pool\u001b[33m.\u001b[39mend()\u001b[33m;\u001b[39m\n     \u001b[90m    |\u001b[39m                \u001b[31m\u001b[1m^\u001b[22m\u001b[39m\n     \u001b[90m 84 |\u001b[39m     console\u001b[33m.\u001b[39mlog(\u001b[32m'测试数据库连接池已关闭'\u001b[39m)\u001b[33m;\u001b[39m\n     \u001b[90m 85 |\u001b[39m   } \u001b[36mcatch\u001b[39m (e) {\n     \u001b[90m 86 |\u001b[39m     console\u001b[33m.\u001b[39merror(\u001b[32m'关闭测试数据库连接池失败:'\u001b[39m\u001b[33m,\u001b[39m e\u001b[33m.\u001b[39mmessage)\u001b[33m;\u001b[39m\u001b[0m\n\n      \u001b[2mat BoundPool.end (\u001b[22mnode_modules/pg-pool/index.js\u001b[2m:453:19)\u001b[22m\n      \u001b[2mat end (\u001b[22mtests/setup/test-database.js\u001b[2m:83:16)\u001b[22m\n      \u001b[2mat Object.closeTestDatabase (\u001b[22mtests/setup/jest.setup.js\u001b[2m:58:9)\u001b[22m\n","name":"C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\offline-payment-service-real-db.test.js","startTime":1762159288876,"status":"failed","summary":""},{"assertionResults":[{"ancestorTitles":["支付流程优化控制器测试 - 真实数据库","createOfflinePayment"],"duration":528,"failureDetails":[{}],"failureMessages":["TypeError: Cannot read properties of undefined (reading 'User')\n    at Object.User (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\payment-optimization-controller-real-db.test.js:27:29)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)"],"fullName":"支付流程优化控制器测试 - 真实数据库 createOfflinePayment 应该成功创建离线支付","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该成功创建离线支付"},{"ancestorTitles":["支付流程优化控制器测试 - 真实数据库","createOfflinePayment"],"duration":338,"failureDetails":[{}],"failureMessages":["TypeError: Cannot read properties of undefined (reading 'User')\n    at Object.User (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\payment-optimization-controller-real-db.test.js:27:29)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)"],"fullName":"支付流程优化控制器测试 - 真实数据库 createOfflinePayment 应该在缺少必要参数时返回错误","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该在缺少必要参数时返回错误"},{"ancestorTitles":["支付流程优化控制器测试 - 真实数据库","createOfflinePayment"],"duration":330,"failureDetails":[{}],"failureMessages":["TypeError: Cannot read properties of undefined (reading 'User')\n    at Object.User (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\payment-optimization-controller-real-db.test.js:27:29)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)"],"fullName":"支付流程优化控制器测试 - 真实数据库 createOfflinePayment 应该在账单不存在时返回错误","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该在账单不存在时返回错误"},{"ancestorTitles":["支付流程优化控制器测试 - 真实数据库","syncOfflinePayment"],"duration":296,"failureDetails":[{}],"failureMessages":["TypeError: Cannot read properties of undefined (reading 'User')\n    at Object.User (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\payment-optimization-controller-real-db.test.js:27:29)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)"],"fullName":"支付流程优化控制器测试 - 真实数据库 syncOfflinePayment 应该成功同步离线支付","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该成功同步离线支付"},{"ancestorTitles":["支付流程优化控制器测试 - 真实数据库","syncOfflinePayment"],"duration":318,"failureDetails":[{}],"failureMessages":["TypeError: Cannot read properties of undefined (reading 'User')\n    at Object.User (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\payment-optimization-controller-real-db.test.js:27:29)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)"],"fullName":"支付流程优化控制器测试 - 真实数据库 syncOfflinePayment 应该在ID无效时返回错误","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该在ID无效时返回错误"},{"ancestorTitles":["支付流程优化控制器测试 - 真实数据库","syncOfflinePayment"],"duration":323,"failureDetails":[{}],"failureMessages":["TypeError: Cannot read properties of undefined (reading 'User')\n    at Object.User (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\payment-optimization-controller-real-db.test.js:27:29)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)"],"fullName":"支付流程优化控制器测试 - 真实数据库 syncOfflinePayment 应该在支付记录不存在时返回错误","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该在支付记录不存在时返回错误"},{"ancestorTitles":["支付流程优化控制器测试 - 真实数据库","getUserOfflinePayments"],"duration":313,"failureDetails":[{}],"failureMessages":["TypeError: Cannot read properties of undefined (reading 'User')\n    at Object.User (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\payment-optimization-controller-real-db.test.js:27:29)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)"],"fullName":"支付流程优化控制器测试 - 真实数据库 getUserOfflinePayments 应该成功获取用户离线支付记录","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该成功获取用户离线支付记录"},{"ancestorTitles":["支付流程优化控制器测试 - 真实数据库","getUserOfflinePayments"],"duration":304,"failureDetails":[{}],"failureMessages":["TypeError: Cannot read properties of undefined (reading 'User')\n    at Object.User (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\payment-optimization-controller-real-db.test.js:27:29)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)"],"fullName":"支付流程优化控制器测试 - 真实数据库 getUserOfflinePayments 应该正确处理分页","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该正确处理分页"},{"ancestorTitles":["支付流程优化控制器测试 - 真实数据库","getUserOfflinePayments"],"duration":284,"failureDetails":[{}],"failureMessages":["TypeError: Cannot read properties of undefined (reading 'User')\n    at Object.User (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\payment-optimization-controller-real-db.test.js:27:29)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)"],"fullName":"支付流程优化控制器测试 - 真实数据库 getUserOfflinePayments 应该根据状态筛选支付记录","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该根据状态筛选支付记录"}],"coverage":{},"endTime":1762159288876,"message":"\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m支付流程优化控制器测试 - 真实数据库 › createOfflinePayment › 应该成功创建离线支付\u001b[39m\u001b[22m\n\n    TypeError: Cannot read properties of undefined (reading 'User')\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 25 |\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 26 |\u001b[39m     \u001b[90m// 创建测试用户\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 27 |\u001b[39m     testUser \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m models\u001b[33m.\u001b[39m\u001b[33mUser\u001b[39m\u001b[33m.\u001b[39mcreate({\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m                             \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 28 |\u001b[39m       username\u001b[33m:\u001b[39m \u001b[32m'testuser'\u001b[39m\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 29 |\u001b[39m       email\u001b[33m:\u001b[39m \u001b[32m'test@example.com'\u001b[39m\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 30 |\u001b[39m       password\u001b[33m:\u001b[39m \u001b[32m'password123'\u001b[39m\u001b[33m,\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.User (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/payment-optimization-controller-real-db.test.js\u001b[39m\u001b[0m\u001b[2m:27:29)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m支付流程优化控制器测试 - 真实数据库 › createOfflinePayment › 应该在缺少必要参数时返回错误\u001b[39m\u001b[22m\n\n    TypeError: Cannot read properties of undefined (reading 'User')\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 25 |\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 26 |\u001b[39m     \u001b[90m// 创建测试用户\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 27 |\u001b[39m     testUser \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m models\u001b[33m.\u001b[39m\u001b[33mUser\u001b[39m\u001b[33m.\u001b[39mcreate({\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m                             \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 28 |\u001b[39m       username\u001b[33m:\u001b[39m \u001b[32m'testuser'\u001b[39m\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 29 |\u001b[39m       email\u001b[33m:\u001b[39m \u001b[32m'test@example.com'\u001b[39m\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 30 |\u001b[39m       password\u001b[33m:\u001b[39m \u001b[32m'password123'\u001b[39m\u001b[33m,\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.User (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/payment-optimization-controller-real-db.test.js\u001b[39m\u001b[0m\u001b[2m:27:29)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m支付流程优化控制器测试 - 真实数据库 › createOfflinePayment › 应该在账单不存在时返回错误\u001b[39m\u001b[22m\n\n    TypeError: Cannot read properties of undefined (reading 'User')\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 25 |\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 26 |\u001b[39m     \u001b[90m// 创建测试用户\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 27 |\u001b[39m     testUser \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m models\u001b[33m.\u001b[39m\u001b[33mUser\u001b[39m\u001b[33m.\u001b[39mcreate({\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m                             \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 28 |\u001b[39m       username\u001b[33m:\u001b[39m \u001b[32m'testuser'\u001b[39m\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 29 |\u001b[39m       email\u001b[33m:\u001b[39m \u001b[32m'test@example.com'\u001b[39m\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 30 |\u001b[39m       password\u001b[33m:\u001b[39m \u001b[32m'password123'\u001b[39m\u001b[33m,\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.User (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/payment-optimization-controller-real-db.test.js\u001b[39m\u001b[0m\u001b[2m:27:29)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m支付流程优化控制器测试 - 真实数据库 › syncOfflinePayment › 应该成功同步离线支付\u001b[39m\u001b[22m\n\n    TypeError: Cannot read properties of undefined (reading 'User')\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 25 |\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 26 |\u001b[39m     \u001b[90m// 创建测试用户\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 27 |\u001b[39m     testUser \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m models\u001b[33m.\u001b[39m\u001b[33mUser\u001b[39m\u001b[33m.\u001b[39mcreate({\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m                             \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 28 |\u001b[39m       username\u001b[33m:\u001b[39m \u001b[32m'testuser'\u001b[39m\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 29 |\u001b[39m       email\u001b[33m:\u001b[39m \u001b[32m'test@example.com'\u001b[39m\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 30 |\u001b[39m       password\u001b[33m:\u001b[39m \u001b[32m'password123'\u001b[39m\u001b[33m,\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.User (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/payment-optimization-controller-real-db.test.js\u001b[39m\u001b[0m\u001b[2m:27:29)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m支付流程优化控制器测试 - 真实数据库 › syncOfflinePayment › 应该在ID无效时返回错误\u001b[39m\u001b[22m\n\n    TypeError: Cannot read properties of undefined (reading 'User')\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 25 |\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 26 |\u001b[39m     \u001b[90m// 创建测试用户\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 27 |\u001b[39m     testUser \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m models\u001b[33m.\u001b[39m\u001b[33mUser\u001b[39m\u001b[33m.\u001b[39mcreate({\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m                             \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 28 |\u001b[39m       username\u001b[33m:\u001b[39m \u001b[32m'testuser'\u001b[39m\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 29 |\u001b[39m       email\u001b[33m:\u001b[39m \u001b[32m'test@example.com'\u001b[39m\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 30 |\u001b[39m       password\u001b[33m:\u001b[39m \u001b[32m'password123'\u001b[39m\u001b[33m,\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.User (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/payment-optimization-controller-real-db.test.js\u001b[39m\u001b[0m\u001b[2m:27:29)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m支付流程优化控制器测试 - 真实数据库 › syncOfflinePayment › 应该在支付记录不存在时返回错误\u001b[39m\u001b[22m\n\n    TypeError: Cannot read properties of undefined (reading 'User')\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 25 |\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 26 |\u001b[39m     \u001b[90m// 创建测试用户\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 27 |\u001b[39m     testUser \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m models\u001b[33m.\u001b[39m\u001b[33mUser\u001b[39m\u001b[33m.\u001b[39mcreate({\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m                             \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 28 |\u001b[39m       username\u001b[33m:\u001b[39m \u001b[32m'testuser'\u001b[39m\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 29 |\u001b[39m       email\u001b[33m:\u001b[39m \u001b[32m'test@example.com'\u001b[39m\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 30 |\u001b[39m       password\u001b[33m:\u001b[39m \u001b[32m'password123'\u001b[39m\u001b[33m,\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.User (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/payment-optimization-controller-real-db.test.js\u001b[39m\u001b[0m\u001b[2m:27:29)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m支付流程优化控制器测试 - 真实数据库 › getUserOfflinePayments › 应该成功获取用户离线支付记录\u001b[39m\u001b[22m\n\n    TypeError: Cannot read properties of undefined (reading 'User')\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 25 |\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 26 |\u001b[39m     \u001b[90m// 创建测试用户\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 27 |\u001b[39m     testUser \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m models\u001b[33m.\u001b[39m\u001b[33mUser\u001b[39m\u001b[33m.\u001b[39mcreate({\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m                             \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 28 |\u001b[39m       username\u001b[33m:\u001b[39m \u001b[32m'testuser'\u001b[39m\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 29 |\u001b[39m       email\u001b[33m:\u001b[39m \u001b[32m'test@example.com'\u001b[39m\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 30 |\u001b[39m       password\u001b[33m:\u001b[39m \u001b[32m'password123'\u001b[39m\u001b[33m,\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.User (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/payment-optimization-controller-real-db.test.js\u001b[39m\u001b[0m\u001b[2m:27:29)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m支付流程优化控制器测试 - 真实数据库 › getUserOfflinePayments › 应该正确处理分页\u001b[39m\u001b[22m\n\n    TypeError: Cannot read properties of undefined (reading 'User')\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 25 |\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 26 |\u001b[39m     \u001b[90m// 创建测试用户\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 27 |\u001b[39m     testUser \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m models\u001b[33m.\u001b[39m\u001b[33mUser\u001b[39m\u001b[33m.\u001b[39mcreate({\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m                             \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 28 |\u001b[39m       username\u001b[33m:\u001b[39m \u001b[32m'testuser'\u001b[39m\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 29 |\u001b[39m       email\u001b[33m:\u001b[39m \u001b[32m'test@example.com'\u001b[39m\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 30 |\u001b[39m       password\u001b[33m:\u001b[39m \u001b[32m'password123'\u001b[39m\u001b[33m,\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.User (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/payment-optimization-controller-real-db.test.js\u001b[39m\u001b[0m\u001b[2m:27:29)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m支付流程优化控制器测试 - 真实数据库 › getUserOfflinePayments › 应该根据状态筛选支付记录\u001b[39m\u001b[22m\n\n    TypeError: Cannot read properties of undefined (reading 'User')\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 25 |\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 26 |\u001b[39m     \u001b[90m// 创建测试用户\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 27 |\u001b[39m     testUser \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m models\u001b[33m.\u001b[39m\u001b[33mUser\u001b[39m\u001b[33m.\u001b[39mcreate({\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m                             \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 28 |\u001b[39m       username\u001b[33m:\u001b[39m \u001b[32m'testuser'\u001b[39m\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 29 |\u001b[39m       email\u001b[33m:\u001b[39m \u001b[32m'test@example.com'\u001b[39m\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 30 |\u001b[39m       password\u001b[33m:\u001b[39m \u001b[32m'password123'\u001b[39m\u001b[33m,\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.User (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/payment-optimization-controller-real-db.test.js\u001b[39m\u001b[0m\u001b[2m:27:29)\u001b[22m\u001b[2m\u001b[22m\n\n\n  \u001b[1m● \u001b[22mTest suite failed to run\n\n    Called end on pool more than once\n\n    \u001b[0m \u001b[90m 81 |\u001b[39m \u001b[36masync\u001b[39m \u001b[36mfunction\u001b[39m closeTestDatabase() {\n     \u001b[90m 82 |\u001b[39m   \u001b[36mtry\u001b[39m {\n    \u001b[31m\u001b[1m>\u001b[22m\u001b[39m\u001b[90m 83 |\u001b[39m     \u001b[36mawait\u001b[39m pool\u001b[33m.\u001b[39mend()\u001b[33m;\u001b[39m\n     \u001b[90m    |\u001b[39m                \u001b[31m\u001b[1m^\u001b[22m\u001b[39m\n     \u001b[90m 84 |\u001b[39m     console\u001b[33m.\u001b[39mlog(\u001b[32m'测试数据库连接池已关闭'\u001b[39m)\u001b[33m;\u001b[39m\n     \u001b[90m 85 |\u001b[39m   } \u001b[36mcatch\u001b[39m (e) {\n     \u001b[90m 86 |\u001b[39m     console\u001b[33m.\u001b[39merror(\u001b[32m'关闭测试数据库连接池失败:'\u001b[39m\u001b[33m,\u001b[39m e\u001b[33m.\u001b[39mmessage)\u001b[33m;\u001b[39m\u001b[0m\n\n      \u001b[2mat BoundPool.end (\u001b[22mnode_modules/pg-pool/index.js\u001b[2m:453:19)\u001b[22m\n      \u001b[2mat end (\u001b[22mtests/setup/test-database.js\u001b[2m:83:16)\u001b[22m\n      \u001b[2mat Object.closeTestDatabase (\u001b[22mtests/setup/jest.setup.js\u001b[2m:58:9)\u001b[22m\n","name":"C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\payment-optimization-controller-real-db.test.js","startTime":1762159288876,"status":"failed","summary":""},{"assertionResults":[{"ancestorTitles":["简单API集成测试","变量初始化测试"],"duration":3,"failureDetails":[{"matcherResult":{"message":"\u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoBeDefined\u001b[2m()\u001b[22m\n\nReceived: \u001b[31mundefined\u001b[39m","pass":false}}],"failureMessages":["Error: \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoBeDefined\u001b[2m()\u001b[22m\n\nReceived: \u001b[31mundefined\u001b[39m\n    at Object.toBeDefined (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\integration\\simple.test.js:140:24)\n    at Promise.then.completed (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:444:34)"],"fullName":"简单API集成测试 变量初始化测试 应该正确初始化所有测试变量","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"failed","title":"应该正确初始化所有测试变量"},{"ancestorTitles":["简单API集成测试","GET /api/rooms/:id"],"duration":0,"failureDetails":[],"failureMessages":[],"fullName":"简单API集成测试 GET /api/rooms/:id 应该成功获取寝室详情","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"passed","title":"应该成功获取寝室详情"}],"endTime":1762159263670,"message":"\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m简单API集成测试 › 变量初始化测试 › 应该正确初始化所有测试变量\u001b[39m\u001b[22m\n\n    \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoBeDefined\u001b[2m()\u001b[22m\n\n    Received: \u001b[31mundefined\u001b[39m\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 138 |\u001b[39m       expect(testUser)\u001b[33m.\u001b[39mtoBeDefined()\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 139 |\u001b[39m       expect(testUser\u001b[33m.\u001b[39mid)\u001b[33m.\u001b[39mtoBeDefined()\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 140 |\u001b[39m       expect(testRoom)\u001b[33m.\u001b[39mtoBeDefined()\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                        \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 141 |\u001b[39m       expect(testRoom\u001b[33m.\u001b[39mid)\u001b[33m.\u001b[39mtoBeDefined()\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 142 |\u001b[39m       expect(testRoomCode)\u001b[33m.\u001b[39mtoBeDefined()\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 143 |\u001b[39m       expect(authToken)\u001b[33m.\u001b[39mtoBeDefined()\u001b[33m;\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.toBeDefined (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/integration/simple.test.js\u001b[39m\u001b[0m\u001b[2m:140:24)\u001b[22m\u001b[2m\u001b[22m\n","name":"C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\integration\\simple.test.js","startTime":1762159262518,"status":"failed","summary":""},{"assertionResults":[{"ancestorTitles":["寝室API集成测试 - 简化版","变量初始化测试"],"duration":0,"failureDetails":[{}],"failureMessages":["Error: 寝室创建失败: 服务器内部错误\n    at createTestRoom (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\integration\\simple-rooms.test.js:91:11)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at Object.<anonymous> (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\integration\\simple-rooms.test.js:120:18)"],"fullName":"寝室API集成测试 - 简化版 变量初始化测试 应该正确初始化所有测试变量","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该正确初始化所有测试变量"},{"ancestorTitles":["寝室API集成测试 - 简化版","GET /api/rooms"],"duration":1,"failureDetails":[{}],"failureMessages":["Error: 寝室创建失败: 服务器内部错误\n    at createTestRoom (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\integration\\simple-rooms.test.js:91:11)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at Object.<anonymous> (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\integration\\simple-rooms.test.js:120:18)"],"fullName":"寝室API集成测试 - 简化版 GET /api/rooms 应该成功获取用户寝室列表","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该成功获取用户寝室列表"},{"ancestorTitles":["寝室API集成测试 - 简化版","GET /api/rooms/:id"],"duration":0,"failureDetails":[{}],"failureMessages":["Error: 寝室创建失败: 服务器内部错误\n    at createTestRoom (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\integration\\simple-rooms.test.js:91:11)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at Object.<anonymous> (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\integration\\simple-rooms.test.js:120:18)"],"fullName":"寝室API集成测试 - 简化版 GET /api/rooms/:id 应该成功获取寝室详情","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该成功获取寝室详情"}],"endTime":1762159264677,"message":"\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m寝室API集成测试 - 简化版 › 变量初始化测试 › 应该正确初始化所有测试变量\u001b[39m\u001b[22m\n\n    寝室创建失败: 服务器内部错误\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 89 |\u001b[39m   \u001b[36mif\u001b[39m (response\u001b[33m.\u001b[39mstatus \u001b[33m!==\u001b[39m \u001b[35m201\u001b[39m) {\u001b[22m\n\u001b[2m     \u001b[90m 90 |\u001b[39m     console\u001b[33m.\u001b[39merror(\u001b[32m'寝室创建失败:'\u001b[39m\u001b[33m,\u001b[39m response\u001b[33m.\u001b[39mbody)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 91 |\u001b[39m     \u001b[36mthrow\u001b[39m \u001b[36mnew\u001b[39m \u001b[33mError\u001b[39m(\u001b[32m`寝室创建失败: ${response.body.message}`\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m           \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 92 |\u001b[39m   }\u001b[22m\n\u001b[2m     \u001b[90m 93 |\u001b[39m   \u001b[22m\n\u001b[2m     \u001b[90m 94 |\u001b[39m   console\u001b[33m.\u001b[39mlog(\u001b[32m'寝室创建成功:'\u001b[39m\u001b[33m,\u001b[39m response\u001b[33m.\u001b[39mbody\u001b[33m.\u001b[39mdata)\u001b[33m;\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat createTestRoom (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/integration/simple-rooms.test.js\u001b[39m\u001b[0m\u001b[2m:91:11)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous> (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/integration/simple-rooms.test.js\u001b[39m\u001b[0m\u001b[2m:120:18)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m寝室API集成测试 - 简化版 › GET /api/rooms › 应该成功获取用户寝室列表\u001b[39m\u001b[22m\n\n    寝室创建失败: 服务器内部错误\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 89 |\u001b[39m   \u001b[36mif\u001b[39m (response\u001b[33m.\u001b[39mstatus \u001b[33m!==\u001b[39m \u001b[35m201\u001b[39m) {\u001b[22m\n\u001b[2m     \u001b[90m 90 |\u001b[39m     console\u001b[33m.\u001b[39merror(\u001b[32m'寝室创建失败:'\u001b[39m\u001b[33m,\u001b[39m response\u001b[33m.\u001b[39mbody)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 91 |\u001b[39m     \u001b[36mthrow\u001b[39m \u001b[36mnew\u001b[39m \u001b[33mError\u001b[39m(\u001b[32m`寝室创建失败: ${response.body.message}`\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m           \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 92 |\u001b[39m   }\u001b[22m\n\u001b[2m     \u001b[90m 93 |\u001b[39m   \u001b[22m\n\u001b[2m     \u001b[90m 94 |\u001b[39m   console\u001b[33m.\u001b[39mlog(\u001b[32m'寝室创建成功:'\u001b[39m\u001b[33m,\u001b[39m response\u001b[33m.\u001b[39mbody\u001b[33m.\u001b[39mdata)\u001b[33m;\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat createTestRoom (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/integration/simple-rooms.test.js\u001b[39m\u001b[0m\u001b[2m:91:11)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous> (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/integration/simple-rooms.test.js\u001b[39m\u001b[0m\u001b[2m:120:18)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m寝室API集成测试 - 简化版 › GET /api/rooms/:id › 应该成功获取寝室详情\u001b[39m\u001b[22m\n\n    寝室创建失败: 服务器内部错误\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 89 |\u001b[39m   \u001b[36mif\u001b[39m (response\u001b[33m.\u001b[39mstatus \u001b[33m!==\u001b[39m \u001b[35m201\u001b[39m) {\u001b[22m\n\u001b[2m     \u001b[90m 90 |\u001b[39m     console\u001b[33m.\u001b[39merror(\u001b[32m'寝室创建失败:'\u001b[39m\u001b[33m,\u001b[39m response\u001b[33m.\u001b[39mbody)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 91 |\u001b[39m     \u001b[36mthrow\u001b[39m \u001b[36mnew\u001b[39m \u001b[33mError\u001b[39m(\u001b[32m`寝室创建失败: ${response.body.message}`\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m           \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 92 |\u001b[39m   }\u001b[22m\n\u001b[2m     \u001b[90m 93 |\u001b[39m   \u001b[22m\n\u001b[2m     \u001b[90m 94 |\u001b[39m   console\u001b[33m.\u001b[39mlog(\u001b[32m'寝室创建成功:'\u001b[39m\u001b[33m,\u001b[39m response\u001b[33m.\u001b[39mbody\u001b[33m.\u001b[39mdata)\u001b[33m;\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat createTestRoom (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/integration/simple-rooms.test.js\u001b[39m\u001b[0m\u001b[2m:91:11)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous> (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/integration/simple-rooms.test.js\u001b[39m\u001b[0m\u001b[2m:120:18)\u001b[22m\u001b[2m\u001b[22m\n","name":"C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\integration\\simple-rooms.test.js","startTime":1762159263683,"status":"failed","summary":""},{"assertionResults":[{"ancestorTitles":["支付流程优化集成测试","离线支付流程"],"duration":188,"failureDetails":[{}],"failureMessages":["TypeError: Cannot read properties of undefined (reading 'authenticate')\n    at Object.authenticate (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\integration\\payment-optimization.test.js:15:21)\n    at Promise.then.completed (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusHook (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:281:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:95:7)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:444:34)"],"fullName":"支付流程优化集成测试 离线支付流程 应该完成完整的离线支付流程","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该完成完整的离线支付流程"},{"ancestorTitles":["支付流程优化集成测试","支付提醒流程"],"duration":3,"failureDetails":[{}],"failureMessages":["TypeError: Cannot read properties of undefined (reading 'authenticate')\n    at Object.authenticate (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\integration\\payment-optimization.test.js:15:21)\n    at Promise.then.completed (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusHook (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:281:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:95:7)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:444:34)"],"fullName":"支付流程优化集成测试 支付提醒流程 应该完成完整的支付提醒流程","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该完成完整的支付提醒流程"},{"ancestorTitles":["支付流程优化集成测试","支付记录查询流程"],"duration":3,"failureDetails":[{}],"failureMessages":["TypeError: Cannot read properties of undefined (reading 'authenticate')\n    at Object.authenticate (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\integration\\payment-optimization.test.js:15:21)\n    at Promise.then.completed (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusHook (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:281:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:95:7)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:444:34)"],"fullName":"支付流程优化集成测试 支付记录查询流程 应该完成支付记录查询流程","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该完成支付记录查询流程"},{"ancestorTitles":["支付流程优化集成测试","定时任务管理"],"duration":2,"failureDetails":[{}],"failureMessages":["TypeError: Cannot read properties of undefined (reading 'authenticate')\n    at Object.authenticate (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\integration\\payment-optimization.test.js:15:21)\n    at Promise.then.completed (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusHook (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:281:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:95:7)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:444:34)"],"fullName":"支付流程优化集成测试 定时任务管理 应该完成定时任务管理流程","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该完成定时任务管理流程"},{"ancestorTitles":["支付流程优化集成测试","错误处理"],"duration":2,"failureDetails":[{}],"failureMessages":["TypeError: Cannot read properties of undefined (reading 'authenticate')\n    at Object.authenticate (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\integration\\payment-optimization.test.js:15:21)\n    at Promise.then.completed (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusHook (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:281:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:95:7)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:444:34)"],"fullName":"支付流程优化集成测试 错误处理 应该处理无效的认证","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该处理无效的认证"},{"ancestorTitles":["支付流程优化集成测试","错误处理"],"duration":2,"failureDetails":[{}],"failureMessages":["TypeError: Cannot read properties of undefined (reading 'authenticate')\n    at Object.authenticate (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\integration\\payment-optimization.test.js:15:21)\n    at Promise.then.completed (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusHook (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:281:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:95:7)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:444:34)"],"fullName":"支付流程优化集成测试 错误处理 应该处理无效的支付ID","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该处理无效的支付ID"},{"ancestorTitles":["支付流程优化集成测试","错误处理"],"duration":2,"failureDetails":[{}],"failureMessages":["TypeError: Cannot read properties of undefined (reading 'authenticate')\n    at Object.authenticate (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\integration\\payment-optimization.test.js:15:21)\n    at Promise.then.completed (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusHook (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:281:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:95:7)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:444:34)"],"fullName":"支付流程优化集成测试 错误处理 应该处理无效的任务名称","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该处理无效的任务名称"},{"ancestorTitles":["支付流程优化集成测试","错误处理"],"duration":2,"failureDetails":[{}],"failureMessages":["TypeError: Cannot read properties of undefined (reading 'authenticate')\n    at Object.authenticate (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\integration\\payment-optimization.test.js:15:21)\n    at Promise.then.completed (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusHook (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:281:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:95:7)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:444:34)"],"fullName":"支付流程优化集成测试 错误处理 应该处理缺少必要参数的请求","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该处理缺少必要参数的请求"}],"coverage":{},"endTime":1762159288876,"message":"\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m支付流程优化集成测试 › 离线支付流程 › 应该完成完整的离线支付流程\u001b[39m\u001b[22m\n\n    TypeError: Cannot read properties of undefined (reading 'authenticate')\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 13 |\u001b[39m   beforeAll(\u001b[36masync\u001b[39m () \u001b[33m=>\u001b[39m {\u001b[22m\n\u001b[2m     \u001b[90m 14 |\u001b[39m     \u001b[90m// 确保数据库连接\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 15 |\u001b[39m     \u001b[36mawait\u001b[39m sequelize\u001b[33m.\u001b[39mauthenticate()\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m                     \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 16 |\u001b[39m   })\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 17 |\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 18 |\u001b[39m   afterAll(\u001b[36masync\u001b[39m () \u001b[33m=>\u001b[39m {\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.authenticate (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/integration/payment-optimization.test.js\u001b[39m\u001b[0m\u001b[2m:15:21)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m支付流程优化集成测试 › 支付提醒流程 › 应该完成完整的支付提醒流程\u001b[39m\u001b[22m\n\n    TypeError: Cannot read properties of undefined (reading 'authenticate')\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 13 |\u001b[39m   beforeAll(\u001b[36masync\u001b[39m () \u001b[33m=>\u001b[39m {\u001b[22m\n\u001b[2m     \u001b[90m 14 |\u001b[39m     \u001b[90m// 确保数据库连接\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 15 |\u001b[39m     \u001b[36mawait\u001b[39m sequelize\u001b[33m.\u001b[39mauthenticate()\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m                     \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 16 |\u001b[39m   })\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 17 |\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 18 |\u001b[39m   afterAll(\u001b[36masync\u001b[39m () \u001b[33m=>\u001b[39m {\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.authenticate (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/integration/payment-optimization.test.js\u001b[39m\u001b[0m\u001b[2m:15:21)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m支付流程优化集成测试 › 支付记录查询流程 › 应该完成支付记录查询流程\u001b[39m\u001b[22m\n\n    TypeError: Cannot read properties of undefined (reading 'authenticate')\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 13 |\u001b[39m   beforeAll(\u001b[36masync\u001b[39m () \u001b[33m=>\u001b[39m {\u001b[22m\n\u001b[2m     \u001b[90m 14 |\u001b[39m     \u001b[90m// 确保数据库连接\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 15 |\u001b[39m     \u001b[36mawait\u001b[39m sequelize\u001b[33m.\u001b[39mauthenticate()\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m                     \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 16 |\u001b[39m   })\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 17 |\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 18 |\u001b[39m   afterAll(\u001b[36masync\u001b[39m () \u001b[33m=>\u001b[39m {\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.authenticate (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/integration/payment-optimization.test.js\u001b[39m\u001b[0m\u001b[2m:15:21)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m支付流程优化集成测试 › 定时任务管理 › 应该完成定时任务管理流程\u001b[39m\u001b[22m\n\n    TypeError: Cannot read properties of undefined (reading 'authenticate')\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 13 |\u001b[39m   beforeAll(\u001b[36masync\u001b[39m () \u001b[33m=>\u001b[39m {\u001b[22m\n\u001b[2m     \u001b[90m 14 |\u001b[39m     \u001b[90m// 确保数据库连接\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 15 |\u001b[39m     \u001b[36mawait\u001b[39m sequelize\u001b[33m.\u001b[39mauthenticate()\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m                     \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 16 |\u001b[39m   })\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 17 |\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 18 |\u001b[39m   afterAll(\u001b[36masync\u001b[39m () \u001b[33m=>\u001b[39m {\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.authenticate (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/integration/payment-optimization.test.js\u001b[39m\u001b[0m\u001b[2m:15:21)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m支付流程优化集成测试 › 错误处理 › 应该处理无效的认证\u001b[39m\u001b[22m\n\n    TypeError: Cannot read properties of undefined (reading 'authenticate')\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 13 |\u001b[39m   beforeAll(\u001b[36masync\u001b[39m () \u001b[33m=>\u001b[39m {\u001b[22m\n\u001b[2m     \u001b[90m 14 |\u001b[39m     \u001b[90m// 确保数据库连接\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 15 |\u001b[39m     \u001b[36mawait\u001b[39m sequelize\u001b[33m.\u001b[39mauthenticate()\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m                     \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 16 |\u001b[39m   })\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 17 |\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 18 |\u001b[39m   afterAll(\u001b[36masync\u001b[39m () \u001b[33m=>\u001b[39m {\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.authenticate (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/integration/payment-optimization.test.js\u001b[39m\u001b[0m\u001b[2m:15:21)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m支付流程优化集成测试 › 错误处理 › 应该处理无效的支付ID\u001b[39m\u001b[22m\n\n    TypeError: Cannot read properties of undefined (reading 'authenticate')\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 13 |\u001b[39m   beforeAll(\u001b[36masync\u001b[39m () \u001b[33m=>\u001b[39m {\u001b[22m\n\u001b[2m     \u001b[90m 14 |\u001b[39m     \u001b[90m// 确保数据库连接\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 15 |\u001b[39m     \u001b[36mawait\u001b[39m sequelize\u001b[33m.\u001b[39mauthenticate()\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m                     \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 16 |\u001b[39m   })\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 17 |\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 18 |\u001b[39m   afterAll(\u001b[36masync\u001b[39m () \u001b[33m=>\u001b[39m {\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.authenticate (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/integration/payment-optimization.test.js\u001b[39m\u001b[0m\u001b[2m:15:21)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m支付流程优化集成测试 › 错误处理 › 应该处理无效的任务名称\u001b[39m\u001b[22m\n\n    TypeError: Cannot read properties of undefined (reading 'authenticate')\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 13 |\u001b[39m   beforeAll(\u001b[36masync\u001b[39m () \u001b[33m=>\u001b[39m {\u001b[22m\n\u001b[2m     \u001b[90m 14 |\u001b[39m     \u001b[90m// 确保数据库连接\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 15 |\u001b[39m     \u001b[36mawait\u001b[39m sequelize\u001b[33m.\u001b[39mauthenticate()\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m                     \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 16 |\u001b[39m   })\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 17 |\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 18 |\u001b[39m   afterAll(\u001b[36masync\u001b[39m () \u001b[33m=>\u001b[39m {\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.authenticate (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/integration/payment-optimization.test.js\u001b[39m\u001b[0m\u001b[2m:15:21)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m支付流程优化集成测试 › 错误处理 › 应该处理缺少必要参数的请求\u001b[39m\u001b[22m\n\n    TypeError: Cannot read properties of undefined (reading 'authenticate')\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 13 |\u001b[39m   beforeAll(\u001b[36masync\u001b[39m () \u001b[33m=>\u001b[39m {\u001b[22m\n\u001b[2m     \u001b[90m 14 |\u001b[39m     \u001b[90m// 确保数据库连接\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 15 |\u001b[39m     \u001b[36mawait\u001b[39m sequelize\u001b[33m.\u001b[39mauthenticate()\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m                     \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 16 |\u001b[39m   })\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 17 |\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 18 |\u001b[39m   afterAll(\u001b[36masync\u001b[39m () \u001b[33m=>\u001b[39m {\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.authenticate (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/integration/payment-optimization.test.js\u001b[39m\u001b[0m\u001b[2m:15:21)\u001b[22m\u001b[2m\u001b[22m\n\n\n  \u001b[1m● \u001b[22mTest suite failed to run\n\n    TypeError: Cannot read properties of undefined (reading 'close')\n\n    \u001b[0m \u001b[90m 18 |\u001b[39m   afterAll(\u001b[36masync\u001b[39m () \u001b[33m=>\u001b[39m {\n     \u001b[90m 19 |\u001b[39m     \u001b[90m// 关闭数据库连接\u001b[39m\n    \u001b[31m\u001b[1m>\u001b[22m\u001b[39m\u001b[90m 20 |\u001b[39m     \u001b[36mawait\u001b[39m sequelize\u001b[33m.\u001b[39mclose()\u001b[33m;\u001b[39m\n     \u001b[90m    |\u001b[39m                     \u001b[31m\u001b[1m^\u001b[22m\u001b[39m\n     \u001b[90m 21 |\u001b[39m   })\u001b[33m;\u001b[39m\n     \u001b[90m 22 |\u001b[39m\n     \u001b[90m 23 |\u001b[39m   beforeEach(\u001b[36masync\u001b[39m () \u001b[33m=>\u001b[39m {\u001b[0m\n\n      \u001b[2mat Object.close (\u001b[22mtests/integration/payment-optimization.test.js\u001b[2m:20:21)\u001b[22m\n","name":"C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\integration\\payment-optimization.test.js","startTime":1762159288876,"status":"failed","summary":""},{"assertionResults":[{"ancestorTitles":["离线支付功能集成测试","创建离线支付记录"],"duration":1,"failureDetails":[{}],"failureMessages":["Error: 房间创建失败，状态码: 500\n    at Object.<anonymous> (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\integration\\offline-payments.test.js:69:13)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)"],"fullName":"离线支付功能集成测试 创建离线支付记录 应该成功创建离线支付记录","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该成功创建离线支付记录"},{"ancestorTitles":["离线支付功能集成测试","创建离线支付记录"],"duration":0,"failureDetails":[{}],"failureMessages":["Error: 房间创建失败，状态码: 500\n    at Object.<anonymous> (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\integration\\offline-payments.test.js:69:13)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)"],"fullName":"离线支付功能集成测试 创建离线支付记录 应该在缺少必要参数时返回错误","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该在缺少必要参数时返回错误"},{"ancestorTitles":["离线支付功能集成测试","创建离线支付记录"],"duration":0,"failureDetails":[{}],"failureMessages":["Error: 房间创建失败，状态码: 500\n    at Object.<anonymous> (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\integration\\offline-payments.test.js:69:13)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)"],"fullName":"离线支付功能集成测试 创建离线支付记录 应该在账单不存在时返回错误","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该在账单不存在时返回错误"},{"ancestorTitles":["离线支付功能集成测试","获取用户离线支付记录"],"duration":0,"failureDetails":[{},{}],"failureMessages":["Error: 房间创建失败，状态码: 500\n    at Object.<anonymous> (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\integration\\offline-payments.test.js:69:13)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)","TypeError: Cannot read properties of undefined (reading 'id')\n    at Object.id (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\integration\\offline-payments.test.js:227:26)\n    at Promise.then.completed (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusHook (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:281:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:95:7)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:444:34)"],"fullName":"离线支付功能集成测试 获取用户离线支付记录 应该成功获取用户离线支付记录","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该成功获取用户离线支付记录"},{"ancestorTitles":["离线支付功能集成测试","获取用户离线支付记录"],"duration":0,"failureDetails":[{},{}],"failureMessages":["Error: 房间创建失败，状态码: 500\n    at Object.<anonymous> (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\integration\\offline-payments.test.js:69:13)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)","TypeError: Cannot read properties of undefined (reading 'id')\n    at Object.id (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\integration\\offline-payments.test.js:227:26)\n    at Promise.then.completed (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusHook (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:281:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:95:7)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:444:34)"],"fullName":"离线支付功能集成测试 获取用户离线支付记录 应该支持按状态筛选离线支付记录","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该支持按状态筛选离线支付记录"},{"ancestorTitles":["离线支付功能集成测试","获取待同步的离线支付记录"],"duration":0,"failureDetails":[{}],"failureMessages":["Error: 房间创建失败，状态码: 500\n    at Object.<anonymous> (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\integration\\offline-payments.test.js:69:13)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)"],"fullName":"离线支付功能集成测试 获取待同步的离线支付记录 应该成功获取待同步的离线支付记录","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该成功获取待同步的离线支付记录"},{"ancestorTitles":["离线支付功能集成测试","标记支付同步失败"],"duration":0,"failureDetails":[{},{}],"failureMessages":["Error: 房间创建失败，状态码: 500\n    at Object.<anonymous> (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\integration\\offline-payments.test.js:69:13)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)","TypeError: Cannot read properties of undefined (reading 'id')\n    at Object.id (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\integration\\offline-payments.test.js:329:26)\n    at Promise.then.completed (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusHook (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:281:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:95:7)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:444:34)"],"fullName":"离线支付功能集成测试 标记支付同步失败 应该成功标记支付同步失败","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该成功标记支付同步失败"},{"ancestorTitles":["离线支付功能集成测试","标记支付同步失败"],"duration":0,"failureDetails":[{},{}],"failureMessages":["Error: 房间创建失败，状态码: 500\n    at Object.<anonymous> (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\integration\\offline-payments.test.js:69:13)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)","TypeError: Cannot read properties of undefined (reading 'id')\n    at Object.id (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\integration\\offline-payments.test.js:329:26)\n    at Promise.then.completed (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusHook (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:281:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:95:7)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:444:34)"],"fullName":"离线支付功能集成测试 标记支付同步失败 应该在支付记录不存在时返回错误","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该在支付记录不存在时返回错误"},{"ancestorTitles":["离线支付功能集成测试","重试同步失败的支付记录"],"duration":0,"failureDetails":[{},{}],"failureMessages":["Error: 房间创建失败，状态码: 500\n    at Object.<anonymous> (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\integration\\offline-payments.test.js:69:13)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)","TypeError: Cannot read properties of undefined (reading 'id')\n    at Object.id (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\integration\\offline-payments.test.js:387:26)\n    at Promise.then.completed (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusHook (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:281:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:95:7)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:444:34)"],"fullName":"离线支付功能集成测试 重试同步失败的支付记录 应该成功重试同步失败的支付记录","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该成功重试同步失败的支付记录"},{"ancestorTitles":["离线支付功能集成测试","重试同步失败的支付记录"],"duration":0,"failureDetails":[{},{}],"failureMessages":["Error: 房间创建失败，状态码: 500\n    at Object.<anonymous> (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\integration\\offline-payments.test.js:69:13)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)","TypeError: Cannot read properties of undefined (reading 'id')\n    at Object.id (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\integration\\offline-payments.test.js:387:26)\n    at Promise.then.completed (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusHook (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:281:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:95:7)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:444:34)"],"fullName":"离线支付功能集成测试 重试同步失败的支付记录 应该在支付记录不存在时返回错误","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该在支付记录不存在时返回错误"},{"ancestorTitles":["离线支付功能集成测试","重试同步失败的支付记录"],"duration":0,"failureDetails":[{},{}],"failureMessages":["Error: 房间创建失败，状态码: 500\n    at Object.<anonymous> (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\integration\\offline-payments.test.js:69:13)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)","TypeError: Cannot read properties of undefined (reading 'id')\n    at Object.id (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\integration\\offline-payments.test.js:387:26)\n    at Promise.then.completed (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusHook (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:281:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:95:7)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:444:34)"],"fullName":"离线支付功能集成测试 重试同步失败的支付记录 应该在支付记录状态不正确时返回错误","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该在支付记录状态不正确时返回错误"},{"ancestorTitles":["离线支付功能集成测试","同步离线支付记录"],"duration":0,"failureDetails":[{},{}],"failureMessages":["Error: 房间创建失败，状态码: 500\n    at Object.<anonymous> (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\integration\\offline-payments.test.js:69:13)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)","TypeError: Cannot read properties of undefined (reading 'id')\n    at Object.id (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\integration\\offline-payments.test.js:480:26)\n    at Promise.then.completed (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusHook (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:281:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:95:7)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:444:34)"],"fullName":"离线支付功能集成测试 同步离线支付记录 应该成功同步离线支付记录","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该成功同步离线支付记录"},{"ancestorTitles":["离线支付功能集成测试","同步离线支付记录"],"duration":0,"failureDetails":[{},{}],"failureMessages":["Error: 房间创建失败，状态码: 500\n    at Object.<anonymous> (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\integration\\offline-payments.test.js:69:13)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)","TypeError: Cannot read properties of undefined (reading 'id')\n    at Object.id (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\integration\\offline-payments.test.js:480:26)\n    at Promise.then.completed (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusHook (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:281:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:95:7)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:444:34)"],"fullName":"离线支付功能集成测试 同步离线支付记录 应该在支付记录不存在时返回错误","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该在支付记录不存在时返回错误"}],"endTime":1762159266359,"message":"\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m离线支付功能集成测试 › 创建离线支付记录 › 应该成功创建离线支付记录\u001b[39m\u001b[22m\n\n    房间创建失败，状态码: 500\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 67 |\u001b[39m     \u001b[22m\n\u001b[2m     \u001b[90m 68 |\u001b[39m     \u001b[36mif\u001b[39m (roomResponse\u001b[33m.\u001b[39mstatus \u001b[33m!==\u001b[39m \u001b[35m201\u001b[39m) {\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 69 |\u001b[39m       \u001b[36mthrow\u001b[39m \u001b[36mnew\u001b[39m \u001b[33mError\u001b[39m(\u001b[32m`房间创建失败，状态码: ${roomResponse.status}`\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m             \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 70 |\u001b[39m     }\u001b[22m\n\u001b[2m     \u001b[90m 71 |\u001b[39m     \u001b[22m\n\u001b[2m     \u001b[90m 72 |\u001b[39m     testRoom \u001b[33m=\u001b[39m roomResponse\u001b[33m.\u001b[39mbody\u001b[33m.\u001b[39mdata\u001b[33m;\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous> (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/integration/offline-payments.test.js\u001b[39m\u001b[0m\u001b[2m:69:13)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m离线支付功能集成测试 › 创建离线支付记录 › 应该在缺少必要参数时返回错误\u001b[39m\u001b[22m\n\n    房间创建失败，状态码: 500\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 67 |\u001b[39m     \u001b[22m\n\u001b[2m     \u001b[90m 68 |\u001b[39m     \u001b[36mif\u001b[39m (roomResponse\u001b[33m.\u001b[39mstatus \u001b[33m!==\u001b[39m \u001b[35m201\u001b[39m) {\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 69 |\u001b[39m       \u001b[36mthrow\u001b[39m \u001b[36mnew\u001b[39m \u001b[33mError\u001b[39m(\u001b[32m`房间创建失败，状态码: ${roomResponse.status}`\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m             \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 70 |\u001b[39m     }\u001b[22m\n\u001b[2m     \u001b[90m 71 |\u001b[39m     \u001b[22m\n\u001b[2m     \u001b[90m 72 |\u001b[39m     testRoom \u001b[33m=\u001b[39m roomResponse\u001b[33m.\u001b[39mbody\u001b[33m.\u001b[39mdata\u001b[33m;\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous> (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/integration/offline-payments.test.js\u001b[39m\u001b[0m\u001b[2m:69:13)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m离线支付功能集成测试 › 创建离线支付记录 › 应该在账单不存在时返回错误\u001b[39m\u001b[22m\n\n    房间创建失败，状态码: 500\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 67 |\u001b[39m     \u001b[22m\n\u001b[2m     \u001b[90m 68 |\u001b[39m     \u001b[36mif\u001b[39m (roomResponse\u001b[33m.\u001b[39mstatus \u001b[33m!==\u001b[39m \u001b[35m201\u001b[39m) {\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 69 |\u001b[39m       \u001b[36mthrow\u001b[39m \u001b[36mnew\u001b[39m \u001b[33mError\u001b[39m(\u001b[32m`房间创建失败，状态码: ${roomResponse.status}`\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m             \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 70 |\u001b[39m     }\u001b[22m\n\u001b[2m     \u001b[90m 71 |\u001b[39m     \u001b[22m\n\u001b[2m     \u001b[90m 72 |\u001b[39m     testRoom \u001b[33m=\u001b[39m roomResponse\u001b[33m.\u001b[39mbody\u001b[33m.\u001b[39mdata\u001b[33m;\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous> (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/integration/offline-payments.test.js\u001b[39m\u001b[0m\u001b[2m:69:13)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m离线支付功能集成测试 › 获取用户离线支付记录 › 应该成功获取用户离线支付记录\u001b[39m\u001b[22m\n\n    房间创建失败，状态码: 500\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 67 |\u001b[39m     \u001b[22m\n\u001b[2m     \u001b[90m 68 |\u001b[39m     \u001b[36mif\u001b[39m (roomResponse\u001b[33m.\u001b[39mstatus \u001b[33m!==\u001b[39m \u001b[35m201\u001b[39m) {\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 69 |\u001b[39m       \u001b[36mthrow\u001b[39m \u001b[36mnew\u001b[39m \u001b[33mError\u001b[39m(\u001b[32m`房间创建失败，状态码: ${roomResponse.status}`\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m             \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 70 |\u001b[39m     }\u001b[22m\n\u001b[2m     \u001b[90m 71 |\u001b[39m     \u001b[22m\n\u001b[2m     \u001b[90m 72 |\u001b[39m     testRoom \u001b[33m=\u001b[39m roomResponse\u001b[33m.\u001b[39mbody\u001b[33m.\u001b[39mdata\u001b[33m;\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous> (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/integration/offline-payments.test.js\u001b[39m\u001b[0m\u001b[2m:69:13)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m离线支付功能集成测试 › 获取用户离线支付记录 › 应该成功获取用户离线支付记录\u001b[39m\u001b[22m\n\n    TypeError: Cannot read properties of undefined (reading 'id')\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 225 |\u001b[39m       \u001b[90m// 创建一个离线支付记录用于测试\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 226 |\u001b[39m       \u001b[36mconst\u001b[39m paymentData \u001b[33m=\u001b[39m {\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 227 |\u001b[39m         billId\u001b[33m:\u001b[39m testBill\u001b[33m.\u001b[39mid\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                          \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 228 |\u001b[39m         amount\u001b[33m:\u001b[39m \u001b[35m50.00\u001b[39m\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 229 |\u001b[39m         paymentMethod\u001b[33m:\u001b[39m \u001b[32m'alipay'\u001b[39m\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 230 |\u001b[39m         note\u001b[33m:\u001b[39m \u001b[32m'获取记录测试'\u001b[39m\u001b[33m,\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.id (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/integration/offline-payments.test.js\u001b[39m\u001b[0m\u001b[2m:227:26)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m离线支付功能集成测试 › 获取用户离线支付记录 › 应该支持按状态筛选离线支付记录\u001b[39m\u001b[22m\n\n    房间创建失败，状态码: 500\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 67 |\u001b[39m     \u001b[22m\n\u001b[2m     \u001b[90m 68 |\u001b[39m     \u001b[36mif\u001b[39m (roomResponse\u001b[33m.\u001b[39mstatus \u001b[33m!==\u001b[39m \u001b[35m201\u001b[39m) {\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 69 |\u001b[39m       \u001b[36mthrow\u001b[39m \u001b[36mnew\u001b[39m \u001b[33mError\u001b[39m(\u001b[32m`房间创建失败，状态码: ${roomResponse.status}`\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m             \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 70 |\u001b[39m     }\u001b[22m\n\u001b[2m     \u001b[90m 71 |\u001b[39m     \u001b[22m\n\u001b[2m     \u001b[90m 72 |\u001b[39m     testRoom \u001b[33m=\u001b[39m roomResponse\u001b[33m.\u001b[39mbody\u001b[33m.\u001b[39mdata\u001b[33m;\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous> (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/integration/offline-payments.test.js\u001b[39m\u001b[0m\u001b[2m:69:13)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m离线支付功能集成测试 › 获取用户离线支付记录 › 应该支持按状态筛选离线支付记录\u001b[39m\u001b[22m\n\n    TypeError: Cannot read properties of undefined (reading 'id')\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 225 |\u001b[39m       \u001b[90m// 创建一个离线支付记录用于测试\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 226 |\u001b[39m       \u001b[36mconst\u001b[39m paymentData \u001b[33m=\u001b[39m {\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 227 |\u001b[39m         billId\u001b[33m:\u001b[39m testBill\u001b[33m.\u001b[39mid\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                          \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 228 |\u001b[39m         amount\u001b[33m:\u001b[39m \u001b[35m50.00\u001b[39m\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 229 |\u001b[39m         paymentMethod\u001b[33m:\u001b[39m \u001b[32m'alipay'\u001b[39m\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 230 |\u001b[39m         note\u001b[33m:\u001b[39m \u001b[32m'获取记录测试'\u001b[39m\u001b[33m,\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.id (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/integration/offline-payments.test.js\u001b[39m\u001b[0m\u001b[2m:227:26)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m离线支付功能集成测试 › 获取待同步的离线支付记录 › 应该成功获取待同步的离线支付记录\u001b[39m\u001b[22m\n\n    房间创建失败，状态码: 500\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 67 |\u001b[39m     \u001b[22m\n\u001b[2m     \u001b[90m 68 |\u001b[39m     \u001b[36mif\u001b[39m (roomResponse\u001b[33m.\u001b[39mstatus \u001b[33m!==\u001b[39m \u001b[35m201\u001b[39m) {\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 69 |\u001b[39m       \u001b[36mthrow\u001b[39m \u001b[36mnew\u001b[39m \u001b[33mError\u001b[39m(\u001b[32m`房间创建失败，状态码: ${roomResponse.status}`\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m             \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 70 |\u001b[39m     }\u001b[22m\n\u001b[2m     \u001b[90m 71 |\u001b[39m     \u001b[22m\n\u001b[2m     \u001b[90m 72 |\u001b[39m     testRoom \u001b[33m=\u001b[39m roomResponse\u001b[33m.\u001b[39mbody\u001b[33m.\u001b[39mdata\u001b[33m;\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous> (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/integration/offline-payments.test.js\u001b[39m\u001b[0m\u001b[2m:69:13)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m离线支付功能集成测试 › 标记支付同步失败 › 应该成功标记支付同步失败\u001b[39m\u001b[22m\n\n    房间创建失败，状态码: 500\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 67 |\u001b[39m     \u001b[22m\n\u001b[2m     \u001b[90m 68 |\u001b[39m     \u001b[36mif\u001b[39m (roomResponse\u001b[33m.\u001b[39mstatus \u001b[33m!==\u001b[39m \u001b[35m201\u001b[39m) {\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 69 |\u001b[39m       \u001b[36mthrow\u001b[39m \u001b[36mnew\u001b[39m \u001b[33mError\u001b[39m(\u001b[32m`房间创建失败，状态码: ${roomResponse.status}`\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m             \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 70 |\u001b[39m     }\u001b[22m\n\u001b[2m     \u001b[90m 71 |\u001b[39m     \u001b[22m\n\u001b[2m     \u001b[90m 72 |\u001b[39m     testRoom \u001b[33m=\u001b[39m roomResponse\u001b[33m.\u001b[39mbody\u001b[33m.\u001b[39mdata\u001b[33m;\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous> (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/integration/offline-payments.test.js\u001b[39m\u001b[0m\u001b[2m:69:13)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m离线支付功能集成测试 › 标记支付同步失败 › 应该成功标记支付同步失败\u001b[39m\u001b[22m\n\n    TypeError: Cannot read properties of undefined (reading 'id')\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 327 |\u001b[39m       \u001b[90m// 创建一个离线支付记录用于测试\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 328 |\u001b[39m       \u001b[36mconst\u001b[39m paymentData \u001b[33m=\u001b[39m {\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 329 |\u001b[39m         billId\u001b[33m:\u001b[39m testBill\u001b[33m.\u001b[39mid\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                          \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 330 |\u001b[39m         amount\u001b[33m:\u001b[39m \u001b[35m75.00\u001b[39m\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 331 |\u001b[39m         paymentMethod\u001b[33m:\u001b[39m \u001b[32m'wechat'\u001b[39m\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 332 |\u001b[39m         note\u001b[33m:\u001b[39m \u001b[32m'同步失败测试'\u001b[39m\u001b[33m,\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.id (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/integration/offline-payments.test.js\u001b[39m\u001b[0m\u001b[2m:329:26)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m离线支付功能集成测试 › 标记支付同步失败 › 应该在支付记录不存在时返回错误\u001b[39m\u001b[22m\n\n    房间创建失败，状态码: 500\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 67 |\u001b[39m     \u001b[22m\n\u001b[2m     \u001b[90m 68 |\u001b[39m     \u001b[36mif\u001b[39m (roomResponse\u001b[33m.\u001b[39mstatus \u001b[33m!==\u001b[39m \u001b[35m201\u001b[39m) {\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 69 |\u001b[39m       \u001b[36mthrow\u001b[39m \u001b[36mnew\u001b[39m \u001b[33mError\u001b[39m(\u001b[32m`房间创建失败，状态码: ${roomResponse.status}`\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m             \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 70 |\u001b[39m     }\u001b[22m\n\u001b[2m     \u001b[90m 71 |\u001b[39m     \u001b[22m\n\u001b[2m     \u001b[90m 72 |\u001b[39m     testRoom \u001b[33m=\u001b[39m roomResponse\u001b[33m.\u001b[39mbody\u001b[33m.\u001b[39mdata\u001b[33m;\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous> (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/integration/offline-payments.test.js\u001b[39m\u001b[0m\u001b[2m:69:13)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m离线支付功能集成测试 › 标记支付同步失败 › 应该在支付记录不存在时返回错误\u001b[39m\u001b[22m\n\n    TypeError: Cannot read properties of undefined (reading 'id')\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 327 |\u001b[39m       \u001b[90m// 创建一个离线支付记录用于测试\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 328 |\u001b[39m       \u001b[36mconst\u001b[39m paymentData \u001b[33m=\u001b[39m {\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 329 |\u001b[39m         billId\u001b[33m:\u001b[39m testBill\u001b[33m.\u001b[39mid\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                          \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 330 |\u001b[39m         amount\u001b[33m:\u001b[39m \u001b[35m75.00\u001b[39m\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 331 |\u001b[39m         paymentMethod\u001b[33m:\u001b[39m \u001b[32m'wechat'\u001b[39m\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 332 |\u001b[39m         note\u001b[33m:\u001b[39m \u001b[32m'同步失败测试'\u001b[39m\u001b[33m,\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.id (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/integration/offline-payments.test.js\u001b[39m\u001b[0m\u001b[2m:329:26)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m离线支付功能集成测试 › 重试同步失败的支付记录 › 应该成功重试同步失败的支付记录\u001b[39m\u001b[22m\n\n    房间创建失败，状态码: 500\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 67 |\u001b[39m     \u001b[22m\n\u001b[2m     \u001b[90m 68 |\u001b[39m     \u001b[36mif\u001b[39m (roomResponse\u001b[33m.\u001b[39mstatus \u001b[33m!==\u001b[39m \u001b[35m201\u001b[39m) {\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 69 |\u001b[39m       \u001b[36mthrow\u001b[39m \u001b[36mnew\u001b[39m \u001b[33mError\u001b[39m(\u001b[32m`房间创建失败，状态码: ${roomResponse.status}`\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m             \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 70 |\u001b[39m     }\u001b[22m\n\u001b[2m     \u001b[90m 71 |\u001b[39m     \u001b[22m\n\u001b[2m     \u001b[90m 72 |\u001b[39m     testRoom \u001b[33m=\u001b[39m roomResponse\u001b[33m.\u001b[39mbody\u001b[33m.\u001b[39mdata\u001b[33m;\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous> (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/integration/offline-payments.test.js\u001b[39m\u001b[0m\u001b[2m:69:13)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m离线支付功能集成测试 › 重试同步失败的支付记录 › 应该成功重试同步失败的支付记录\u001b[39m\u001b[22m\n\n    TypeError: Cannot read properties of undefined (reading 'id')\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 385 |\u001b[39m       \u001b[90m// 创建一个离线支付记录并标记为同步失败\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 386 |\u001b[39m       \u001b[36mconst\u001b[39m paymentData \u001b[33m=\u001b[39m {\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 387 |\u001b[39m         billId\u001b[33m:\u001b[39m testBill\u001b[33m.\u001b[39mid\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                          \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 388 |\u001b[39m         amount\u001b[33m:\u001b[39m \u001b[35m25.00\u001b[39m\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 389 |\u001b[39m         paymentMethod\u001b[33m:\u001b[39m \u001b[32m'bank_transfer'\u001b[39m\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 390 |\u001b[39m         note\u001b[33m:\u001b[39m \u001b[32m'重试同步测试'\u001b[39m\u001b[33m,\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.id (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/integration/offline-payments.test.js\u001b[39m\u001b[0m\u001b[2m:387:26)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m离线支付功能集成测试 › 重试同步失败的支付记录 › 应该在支付记录不存在时返回错误\u001b[39m\u001b[22m\n\n    房间创建失败，状态码: 500\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 67 |\u001b[39m     \u001b[22m\n\u001b[2m     \u001b[90m 68 |\u001b[39m     \u001b[36mif\u001b[39m (roomResponse\u001b[33m.\u001b[39mstatus \u001b[33m!==\u001b[39m \u001b[35m201\u001b[39m) {\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 69 |\u001b[39m       \u001b[36mthrow\u001b[39m \u001b[36mnew\u001b[39m \u001b[33mError\u001b[39m(\u001b[32m`房间创建失败，状态码: ${roomResponse.status}`\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m             \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 70 |\u001b[39m     }\u001b[22m\n\u001b[2m     \u001b[90m 71 |\u001b[39m     \u001b[22m\n\u001b[2m     \u001b[90m 72 |\u001b[39m     testRoom \u001b[33m=\u001b[39m roomResponse\u001b[33m.\u001b[39mbody\u001b[33m.\u001b[39mdata\u001b[33m;\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous> (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/integration/offline-payments.test.js\u001b[39m\u001b[0m\u001b[2m:69:13)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m离线支付功能集成测试 › 重试同步失败的支付记录 › 应该在支付记录不存在时返回错误\u001b[39m\u001b[22m\n\n    TypeError: Cannot read properties of undefined (reading 'id')\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 385 |\u001b[39m       \u001b[90m// 创建一个离线支付记录并标记为同步失败\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 386 |\u001b[39m       \u001b[36mconst\u001b[39m paymentData \u001b[33m=\u001b[39m {\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 387 |\u001b[39m         billId\u001b[33m:\u001b[39m testBill\u001b[33m.\u001b[39mid\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                          \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 388 |\u001b[39m         amount\u001b[33m:\u001b[39m \u001b[35m25.00\u001b[39m\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 389 |\u001b[39m         paymentMethod\u001b[33m:\u001b[39m \u001b[32m'bank_transfer'\u001b[39m\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 390 |\u001b[39m         note\u001b[33m:\u001b[39m \u001b[32m'重试同步测试'\u001b[39m\u001b[33m,\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.id (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/integration/offline-payments.test.js\u001b[39m\u001b[0m\u001b[2m:387:26)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m离线支付功能集成测试 › 重试同步失败的支付记录 › 应该在支付记录状态不正确时返回错误\u001b[39m\u001b[22m\n\n    房间创建失败，状态码: 500\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 67 |\u001b[39m     \u001b[22m\n\u001b[2m     \u001b[90m 68 |\u001b[39m     \u001b[36mif\u001b[39m (roomResponse\u001b[33m.\u001b[39mstatus \u001b[33m!==\u001b[39m \u001b[35m201\u001b[39m) {\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 69 |\u001b[39m       \u001b[36mthrow\u001b[39m \u001b[36mnew\u001b[39m \u001b[33mError\u001b[39m(\u001b[32m`房间创建失败，状态码: ${roomResponse.status}`\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m             \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 70 |\u001b[39m     }\u001b[22m\n\u001b[2m     \u001b[90m 71 |\u001b[39m     \u001b[22m\n\u001b[2m     \u001b[90m 72 |\u001b[39m     testRoom \u001b[33m=\u001b[39m roomResponse\u001b[33m.\u001b[39mbody\u001b[33m.\u001b[39mdata\u001b[33m;\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous> (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/integration/offline-payments.test.js\u001b[39m\u001b[0m\u001b[2m:69:13)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m离线支付功能集成测试 › 重试同步失败的支付记录 › 应该在支付记录状态不正确时返回错误\u001b[39m\u001b[22m\n\n    TypeError: Cannot read properties of undefined (reading 'id')\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 385 |\u001b[39m       \u001b[90m// 创建一个离线支付记录并标记为同步失败\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 386 |\u001b[39m       \u001b[36mconst\u001b[39m paymentData \u001b[33m=\u001b[39m {\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 387 |\u001b[39m         billId\u001b[33m:\u001b[39m testBill\u001b[33m.\u001b[39mid\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                          \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 388 |\u001b[39m         amount\u001b[33m:\u001b[39m \u001b[35m25.00\u001b[39m\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 389 |\u001b[39m         paymentMethod\u001b[33m:\u001b[39m \u001b[32m'bank_transfer'\u001b[39m\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 390 |\u001b[39m         note\u001b[33m:\u001b[39m \u001b[32m'重试同步测试'\u001b[39m\u001b[33m,\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.id (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/integration/offline-payments.test.js\u001b[39m\u001b[0m\u001b[2m:387:26)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m离线支付功能集成测试 › 同步离线支付记录 › 应该成功同步离线支付记录\u001b[39m\u001b[22m\n\n    房间创建失败，状态码: 500\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 67 |\u001b[39m     \u001b[22m\n\u001b[2m     \u001b[90m 68 |\u001b[39m     \u001b[36mif\u001b[39m (roomResponse\u001b[33m.\u001b[39mstatus \u001b[33m!==\u001b[39m \u001b[35m201\u001b[39m) {\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 69 |\u001b[39m       \u001b[36mthrow\u001b[39m \u001b[36mnew\u001b[39m \u001b[33mError\u001b[39m(\u001b[32m`房间创建失败，状态码: ${roomResponse.status}`\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m             \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 70 |\u001b[39m     }\u001b[22m\n\u001b[2m     \u001b[90m 71 |\u001b[39m     \u001b[22m\n\u001b[2m     \u001b[90m 72 |\u001b[39m     testRoom \u001b[33m=\u001b[39m roomResponse\u001b[33m.\u001b[39mbody\u001b[33m.\u001b[39mdata\u001b[33m;\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous> (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/integration/offline-payments.test.js\u001b[39m\u001b[0m\u001b[2m:69:13)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m离线支付功能集成测试 › 同步离线支付记录 › 应该成功同步离线支付记录\u001b[39m\u001b[22m\n\n    TypeError: Cannot read properties of undefined (reading 'id')\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 478 |\u001b[39m       \u001b[90m// 创建一个离线支付记录用于测试\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 479 |\u001b[39m       \u001b[36mconst\u001b[39m paymentData \u001b[33m=\u001b[39m {\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 480 |\u001b[39m         billId\u001b[33m:\u001b[39m testBill\u001b[33m.\u001b[39mid\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                          \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 481 |\u001b[39m         amount\u001b[33m:\u001b[39m \u001b[35m35.00\u001b[39m\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 482 |\u001b[39m         paymentMethod\u001b[33m:\u001b[39m \u001b[32m'cash'\u001b[39m\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 483 |\u001b[39m         note\u001b[33m:\u001b[39m \u001b[32m'同步测试'\u001b[39m\u001b[33m,\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.id (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/integration/offline-payments.test.js\u001b[39m\u001b[0m\u001b[2m:480:26)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m离线支付功能集成测试 › 同步离线支付记录 › 应该在支付记录不存在时返回错误\u001b[39m\u001b[22m\n\n    房间创建失败，状态码: 500\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 67 |\u001b[39m     \u001b[22m\n\u001b[2m     \u001b[90m 68 |\u001b[39m     \u001b[36mif\u001b[39m (roomResponse\u001b[33m.\u001b[39mstatus \u001b[33m!==\u001b[39m \u001b[35m201\u001b[39m) {\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 69 |\u001b[39m       \u001b[36mthrow\u001b[39m \u001b[36mnew\u001b[39m \u001b[33mError\u001b[39m(\u001b[32m`房间创建失败，状态码: ${roomResponse.status}`\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m             \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 70 |\u001b[39m     }\u001b[22m\n\u001b[2m     \u001b[90m 71 |\u001b[39m     \u001b[22m\n\u001b[2m     \u001b[90m 72 |\u001b[39m     testRoom \u001b[33m=\u001b[39m roomResponse\u001b[33m.\u001b[39mbody\u001b[33m.\u001b[39mdata\u001b[33m;\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous> (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/integration/offline-payments.test.js\u001b[39m\u001b[0m\u001b[2m:69:13)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m离线支付功能集成测试 › 同步离线支付记录 › 应该在支付记录不存在时返回错误\u001b[39m\u001b[22m\n\n    TypeError: Cannot read properties of undefined (reading 'id')\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 478 |\u001b[39m       \u001b[90m// 创建一个离线支付记录用于测试\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 479 |\u001b[39m       \u001b[36mconst\u001b[39m paymentData \u001b[33m=\u001b[39m {\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 480 |\u001b[39m         billId\u001b[33m:\u001b[39m testBill\u001b[33m.\u001b[39mid\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                          \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 481 |\u001b[39m         amount\u001b[33m:\u001b[39m \u001b[35m35.00\u001b[39m\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 482 |\u001b[39m         paymentMethod\u001b[33m:\u001b[39m \u001b[32m'cash'\u001b[39m\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 483 |\u001b[39m         note\u001b[33m:\u001b[39m \u001b[32m'同步测试'\u001b[39m\u001b[33m,\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.id (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/integration/offline-payments.test.js\u001b[39m\u001b[0m\u001b[2m:480:26)\u001b[22m\u001b[2m\u001b[22m\n","name":"C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\integration\\offline-payments.test.js","startTime":1762159265496,"status":"failed","summary":""},{"assertionResults":[{"ancestorTitles":["账单管理API测试","POST /api/bills"],"duration":1,"failureDetails":[{"length":126,"name":"error","severity":"ERROR","code":"42703","position":"37","file":"parse_target.c","line":"1073","routine":"checkInsertTargets"}],"failureMessages":["error: column \"password\" of relation \"users\" does not exist\n    at C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\pg-pool\\index.js:45:11\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at Object.<anonymous> (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\integration\\bills.test.js:20:24)"],"fullName":"账单管理API测试 POST /api/bills 应该成功创建账单","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该成功创建账单"},{"ancestorTitles":["账单管理API测试","POST /api/bills"],"duration":0,"failureDetails":[{"length":126,"name":"error","severity":"ERROR","code":"42703","position":"37","file":"parse_target.c","line":"1073","routine":"checkInsertTargets"}],"failureMessages":["error: column \"password\" of relation \"users\" does not exist\n    at C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\pg-pool\\index.js:45:11\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at Object.<anonymous> (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\integration\\bills.test.js:20:24)"],"fullName":"账单管理API测试 POST /api/bills 应该在未提供认证令牌时返回401","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该在未提供认证令牌时返回401"},{"ancestorTitles":["账单管理API测试","POST /api/bills"],"duration":0,"failureDetails":[{"length":126,"name":"error","severity":"ERROR","code":"42703","position":"37","file":"parse_target.c","line":"1073","routine":"checkInsertTargets"}],"failureMessages":["error: column \"password\" of relation \"users\" does not exist\n    at C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\pg-pool\\index.js:45:11\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at Object.<anonymous> (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\integration\\bills.test.js:20:24)"],"fullName":"账单管理API测试 POST /api/bills 应该在缺少必填字段时返回400","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该在缺少必填字段时返回400"},{"ancestorTitles":["账单管理API测试","GET /api/bills"],"duration":0,"failureDetails":[{"length":126,"name":"error","severity":"ERROR","code":"42703","position":"37","file":"parse_target.c","line":"1073","routine":"checkInsertTargets"}],"failureMessages":["error: column \"password\" of relation \"users\" does not exist\n    at C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\pg-pool\\index.js:45:11\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at Object.<anonymous> (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\integration\\bills.test.js:20:24)"],"fullName":"账单管理API测试 GET /api/bills 应该成功获取账单列表","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该成功获取账单列表"},{"ancestorTitles":["账单管理API测试","GET /api/bills"],"duration":0,"failureDetails":[{"length":126,"name":"error","severity":"ERROR","code":"42703","position":"37","file":"parse_target.c","line":"1073","routine":"checkInsertTargets"}],"failureMessages":["error: column \"password\" of relation \"users\" does not exist\n    at C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\pg-pool\\index.js:45:11\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at Object.<anonymous> (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\integration\\bills.test.js:20:24)"],"fullName":"账单管理API测试 GET /api/bills 应该支持按寝室筛选账单","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该支持按寝室筛选账单"},{"ancestorTitles":["账单管理API测试","GET /api/bills/:id"],"duration":0,"failureDetails":[{"length":126,"name":"error","severity":"ERROR","code":"42703","position":"37","file":"parse_target.c","line":"1073","routine":"checkInsertTargets"}],"failureMessages":["error: column \"password\" of relation \"users\" does not exist\n    at C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\pg-pool\\index.js:45:11\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at Object.<anonymous> (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\integration\\bills.test.js:20:24)"],"fullName":"账单管理API测试 GET /api/bills/:id 应该成功获取特定账单详情","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该成功获取特定账单详情"},{"ancestorTitles":["账单管理API测试","GET /api/bills/:id"],"duration":0,"failureDetails":[{"length":126,"name":"error","severity":"ERROR","code":"42703","position":"37","file":"parse_target.c","line":"1073","routine":"checkInsertTargets"}],"failureMessages":["error: column \"password\" of relation \"users\" does not exist\n    at C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\pg-pool\\index.js:45:11\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at Object.<anonymous> (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\integration\\bills.test.js:20:24)"],"fullName":"账单管理API测试 GET /api/bills/:id 应该在账单不存在时返回404","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该在账单不存在时返回404"},{"ancestorTitles":["账单管理API测试","PUT /api/bills/:id"],"duration":0,"failureDetails":[{"length":126,"name":"error","severity":"ERROR","code":"42703","position":"37","file":"parse_target.c","line":"1073","routine":"checkInsertTargets"}],"failureMessages":["error: column \"password\" of relation \"users\" does not exist\n    at C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\pg-pool\\index.js:45:11\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at Object.<anonymous> (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\integration\\bills.test.js:20:24)"],"fullName":"账单管理API测试 PUT /api/bills/:id 应该成功更新账单","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该成功更新账单"},{"ancestorTitles":["账单管理API测试","PUT /api/bills/:id"],"duration":0,"failureDetails":[{"length":126,"name":"error","severity":"ERROR","code":"42703","position":"37","file":"parse_target.c","line":"1073","routine":"checkInsertTargets"}],"failureMessages":["error: column \"password\" of relation \"users\" does not exist\n    at C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\pg-pool\\index.js:45:11\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at Object.<anonymous> (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\integration\\bills.test.js:20:24)"],"fullName":"账单管理API测试 PUT /api/bills/:id 应该在账单不存在时返回404","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该在账单不存在时返回404"},{"ancestorTitles":["账单管理API测试","POST /api/bills/:id/review"],"duration":0,"failureDetails":[{"length":126,"name":"error","severity":"ERROR","code":"42703","position":"37","file":"parse_target.c","line":"1073","routine":"checkInsertTargets"}],"failureMessages":["error: column \"password\" of relation \"users\" does not exist\n    at C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\pg-pool\\index.js:45:11\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at Object.<anonymous> (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\integration\\bills.test.js:20:24)"],"fullName":"账单管理API测试 POST /api/bills/:id/review 应该成功审核账单","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该成功审核账单"},{"ancestorTitles":["账单管理API测试","POST /api/bills/:id/review"],"duration":0,"failureDetails":[{"length":126,"name":"error","severity":"ERROR","code":"42703","position":"37","file":"parse_target.c","line":"1073","routine":"checkInsertTargets"}],"failureMessages":["error: column \"password\" of relation \"users\" does not exist\n    at C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\pg-pool\\index.js:45:11\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at Object.<anonymous> (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\integration\\bills.test.js:20:24)"],"fullName":"账单管理API测试 POST /api/bills/:id/review 应该在账单不存在时返回404","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该在账单不存在时返回404"},{"ancestorTitles":["账单管理API测试","POST /api/bills/:id/confirm-payment"],"duration":0,"failureDetails":[{"length":126,"name":"error","severity":"ERROR","code":"42703","position":"37","file":"parse_target.c","line":"1073","routine":"checkInsertTargets"}],"failureMessages":["error: column \"password\" of relation \"users\" does not exist\n    at C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\pg-pool\\index.js:45:11\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at Object.<anonymous> (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\integration\\bills.test.js:20:24)"],"fullName":"账单管理API测试 POST /api/bills/:id/confirm-payment 应该成功确认账单支付","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该成功确认账单支付"},{"ancestorTitles":["账单管理API测试","POST /api/bills/:id/confirm-payment"],"duration":0,"failureDetails":[{"length":126,"name":"error","severity":"ERROR","code":"42703","position":"37","file":"parse_target.c","line":"1073","routine":"checkInsertTargets"}],"failureMessages":["error: column \"password\" of relation \"users\" does not exist\n    at C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\pg-pool\\index.js:45:11\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at Object.<anonymous> (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\integration\\bills.test.js:20:24)"],"fullName":"账单管理API测试 POST /api/bills/:id/confirm-payment 应该在分摊ID不存在时返回400","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该在分摊ID不存在时返回400"},{"ancestorTitles":["账单管理API测试","GET /api/bills/user-stats"],"duration":0,"failureDetails":[{"length":126,"name":"error","severity":"ERROR","code":"42703","position":"37","file":"parse_target.c","line":"1073","routine":"checkInsertTargets"}],"failureMessages":["error: column \"password\" of relation \"users\" does not exist\n    at C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\pg-pool\\index.js:45:11\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at Object.<anonymous> (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\integration\\bills.test.js:20:24)"],"fullName":"账单管理API测试 GET /api/bills/user-stats 应该成功获取用户账单统计","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该成功获取用户账单统计"},{"ancestorTitles":["账单管理API测试","DELETE /api/bills/:id"],"duration":0,"failureDetails":[{"length":126,"name":"error","severity":"ERROR","code":"42703","position":"37","file":"parse_target.c","line":"1073","routine":"checkInsertTargets"}],"failureMessages":["error: column \"password\" of relation \"users\" does not exist\n    at C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\pg-pool\\index.js:45:11\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at Object.<anonymous> (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\integration\\bills.test.js:20:24)"],"fullName":"账单管理API测试 DELETE /api/bills/:id 应该成功删除账单","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该成功删除账单"},{"ancestorTitles":["账单管理API测试","DELETE /api/bills/:id"],"duration":0,"failureDetails":[{"length":126,"name":"error","severity":"ERROR","code":"42703","position":"37","file":"parse_target.c","line":"1073","routine":"checkInsertTargets"}],"failureMessages":["error: column \"password\" of relation \"users\" does not exist\n    at C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\pg-pool\\index.js:45:11\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at Object.<anonymous> (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\integration\\bills.test.js:20:24)"],"fullName":"账单管理API测试 DELETE /api/bills/:id 应该在账单不存在时返回404","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该在账单不存在时返回404"}],"endTime":1762159267141,"message":"\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m账单管理API测试 › POST /api/bills › 应该成功创建账单\u001b[39m\u001b[22m\n\n    error: column \"password\" of relation \"users\" does not exist\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 18 |\u001b[39m   beforeAll(\u001b[36masync\u001b[39m () \u001b[33m=>\u001b[39m {\u001b[22m\n\u001b[2m     \u001b[90m 19 |\u001b[39m     \u001b[90m// 创建测试用户\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 20 |\u001b[39m     \u001b[36mconst\u001b[39m userResult \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m pool\u001b[33m.\u001b[39mquery(\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m                        \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 21 |\u001b[39m       \u001b[32m'INSERT INTO users (username, email, password, role) VALUES ($1, $2, $3, $4) RETURNING *'\u001b[39m\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 22 |\u001b[39m       [\u001b[32m'testuser'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'test@example.com'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'password123'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'user'\u001b[39m]\u001b[22m\n\u001b[2m     \u001b[90m 23 |\u001b[39m     )\u001b[33m;\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat \u001b[22m\u001b[2mnode_modules/pg-pool/index.js\u001b[2m:45:11\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous> (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/integration/bills.test.js\u001b[39m\u001b[0m\u001b[2m:20:24)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m账单管理API测试 › POST /api/bills › 应该在未提供认证令牌时返回401\u001b[39m\u001b[22m\n\n    error: column \"password\" of relation \"users\" does not exist\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 18 |\u001b[39m   beforeAll(\u001b[36masync\u001b[39m () \u001b[33m=>\u001b[39m {\u001b[22m\n\u001b[2m     \u001b[90m 19 |\u001b[39m     \u001b[90m// 创建测试用户\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 20 |\u001b[39m     \u001b[36mconst\u001b[39m userResult \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m pool\u001b[33m.\u001b[39mquery(\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m                        \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 21 |\u001b[39m       \u001b[32m'INSERT INTO users (username, email, password, role) VALUES ($1, $2, $3, $4) RETURNING *'\u001b[39m\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 22 |\u001b[39m       [\u001b[32m'testuser'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'test@example.com'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'password123'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'user'\u001b[39m]\u001b[22m\n\u001b[2m     \u001b[90m 23 |\u001b[39m     )\u001b[33m;\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat \u001b[22m\u001b[2mnode_modules/pg-pool/index.js\u001b[2m:45:11\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous> (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/integration/bills.test.js\u001b[39m\u001b[0m\u001b[2m:20:24)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m账单管理API测试 › POST /api/bills › 应该在缺少必填字段时返回400\u001b[39m\u001b[22m\n\n    error: column \"password\" of relation \"users\" does not exist\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 18 |\u001b[39m   beforeAll(\u001b[36masync\u001b[39m () \u001b[33m=>\u001b[39m {\u001b[22m\n\u001b[2m     \u001b[90m 19 |\u001b[39m     \u001b[90m// 创建测试用户\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 20 |\u001b[39m     \u001b[36mconst\u001b[39m userResult \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m pool\u001b[33m.\u001b[39mquery(\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m                        \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 21 |\u001b[39m       \u001b[32m'INSERT INTO users (username, email, password, role) VALUES ($1, $2, $3, $4) RETURNING *'\u001b[39m\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 22 |\u001b[39m       [\u001b[32m'testuser'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'test@example.com'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'password123'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'user'\u001b[39m]\u001b[22m\n\u001b[2m     \u001b[90m 23 |\u001b[39m     )\u001b[33m;\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat \u001b[22m\u001b[2mnode_modules/pg-pool/index.js\u001b[2m:45:11\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous> (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/integration/bills.test.js\u001b[39m\u001b[0m\u001b[2m:20:24)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m账单管理API测试 › GET /api/bills › 应该成功获取账单列表\u001b[39m\u001b[22m\n\n    error: column \"password\" of relation \"users\" does not exist\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 18 |\u001b[39m   beforeAll(\u001b[36masync\u001b[39m () \u001b[33m=>\u001b[39m {\u001b[22m\n\u001b[2m     \u001b[90m 19 |\u001b[39m     \u001b[90m// 创建测试用户\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 20 |\u001b[39m     \u001b[36mconst\u001b[39m userResult \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m pool\u001b[33m.\u001b[39mquery(\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m                        \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 21 |\u001b[39m       \u001b[32m'INSERT INTO users (username, email, password, role) VALUES ($1, $2, $3, $4) RETURNING *'\u001b[39m\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 22 |\u001b[39m       [\u001b[32m'testuser'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'test@example.com'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'password123'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'user'\u001b[39m]\u001b[22m\n\u001b[2m     \u001b[90m 23 |\u001b[39m     )\u001b[33m;\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat \u001b[22m\u001b[2mnode_modules/pg-pool/index.js\u001b[2m:45:11\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous> (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/integration/bills.test.js\u001b[39m\u001b[0m\u001b[2m:20:24)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m账单管理API测试 › GET /api/bills › 应该支持按寝室筛选账单\u001b[39m\u001b[22m\n\n    error: column \"password\" of relation \"users\" does not exist\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 18 |\u001b[39m   beforeAll(\u001b[36masync\u001b[39m () \u001b[33m=>\u001b[39m {\u001b[22m\n\u001b[2m     \u001b[90m 19 |\u001b[39m     \u001b[90m// 创建测试用户\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 20 |\u001b[39m     \u001b[36mconst\u001b[39m userResult \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m pool\u001b[33m.\u001b[39mquery(\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m                        \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 21 |\u001b[39m       \u001b[32m'INSERT INTO users (username, email, password, role) VALUES ($1, $2, $3, $4) RETURNING *'\u001b[39m\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 22 |\u001b[39m       [\u001b[32m'testuser'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'test@example.com'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'password123'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'user'\u001b[39m]\u001b[22m\n\u001b[2m     \u001b[90m 23 |\u001b[39m     )\u001b[33m;\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat \u001b[22m\u001b[2mnode_modules/pg-pool/index.js\u001b[2m:45:11\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous> (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/integration/bills.test.js\u001b[39m\u001b[0m\u001b[2m:20:24)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m账单管理API测试 › GET /api/bills/:id › 应该成功获取特定账单详情\u001b[39m\u001b[22m\n\n    error: column \"password\" of relation \"users\" does not exist\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 18 |\u001b[39m   beforeAll(\u001b[36masync\u001b[39m () \u001b[33m=>\u001b[39m {\u001b[22m\n\u001b[2m     \u001b[90m 19 |\u001b[39m     \u001b[90m// 创建测试用户\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 20 |\u001b[39m     \u001b[36mconst\u001b[39m userResult \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m pool\u001b[33m.\u001b[39mquery(\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m                        \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 21 |\u001b[39m       \u001b[32m'INSERT INTO users (username, email, password, role) VALUES ($1, $2, $3, $4) RETURNING *'\u001b[39m\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 22 |\u001b[39m       [\u001b[32m'testuser'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'test@example.com'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'password123'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'user'\u001b[39m]\u001b[22m\n\u001b[2m     \u001b[90m 23 |\u001b[39m     )\u001b[33m;\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat \u001b[22m\u001b[2mnode_modules/pg-pool/index.js\u001b[2m:45:11\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous> (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/integration/bills.test.js\u001b[39m\u001b[0m\u001b[2m:20:24)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m账单管理API测试 › GET /api/bills/:id › 应该在账单不存在时返回404\u001b[39m\u001b[22m\n\n    error: column \"password\" of relation \"users\" does not exist\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 18 |\u001b[39m   beforeAll(\u001b[36masync\u001b[39m () \u001b[33m=>\u001b[39m {\u001b[22m\n\u001b[2m     \u001b[90m 19 |\u001b[39m     \u001b[90m// 创建测试用户\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 20 |\u001b[39m     \u001b[36mconst\u001b[39m userResult \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m pool\u001b[33m.\u001b[39mquery(\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m                        \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 21 |\u001b[39m       \u001b[32m'INSERT INTO users (username, email, password, role) VALUES ($1, $2, $3, $4) RETURNING *'\u001b[39m\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 22 |\u001b[39m       [\u001b[32m'testuser'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'test@example.com'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'password123'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'user'\u001b[39m]\u001b[22m\n\u001b[2m     \u001b[90m 23 |\u001b[39m     )\u001b[33m;\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat \u001b[22m\u001b[2mnode_modules/pg-pool/index.js\u001b[2m:45:11\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous> (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/integration/bills.test.js\u001b[39m\u001b[0m\u001b[2m:20:24)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m账单管理API测试 › PUT /api/bills/:id › 应该成功更新账单\u001b[39m\u001b[22m\n\n    error: column \"password\" of relation \"users\" does not exist\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 18 |\u001b[39m   beforeAll(\u001b[36masync\u001b[39m () \u001b[33m=>\u001b[39m {\u001b[22m\n\u001b[2m     \u001b[90m 19 |\u001b[39m     \u001b[90m// 创建测试用户\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 20 |\u001b[39m     \u001b[36mconst\u001b[39m userResult \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m pool\u001b[33m.\u001b[39mquery(\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m                        \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 21 |\u001b[39m       \u001b[32m'INSERT INTO users (username, email, password, role) VALUES ($1, $2, $3, $4) RETURNING *'\u001b[39m\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 22 |\u001b[39m       [\u001b[32m'testuser'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'test@example.com'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'password123'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'user'\u001b[39m]\u001b[22m\n\u001b[2m     \u001b[90m 23 |\u001b[39m     )\u001b[33m;\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat \u001b[22m\u001b[2mnode_modules/pg-pool/index.js\u001b[2m:45:11\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous> (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/integration/bills.test.js\u001b[39m\u001b[0m\u001b[2m:20:24)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m账单管理API测试 › PUT /api/bills/:id › 应该在账单不存在时返回404\u001b[39m\u001b[22m\n\n    error: column \"password\" of relation \"users\" does not exist\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 18 |\u001b[39m   beforeAll(\u001b[36masync\u001b[39m () \u001b[33m=>\u001b[39m {\u001b[22m\n\u001b[2m     \u001b[90m 19 |\u001b[39m     \u001b[90m// 创建测试用户\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 20 |\u001b[39m     \u001b[36mconst\u001b[39m userResult \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m pool\u001b[33m.\u001b[39mquery(\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m                        \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 21 |\u001b[39m       \u001b[32m'INSERT INTO users (username, email, password, role) VALUES ($1, $2, $3, $4) RETURNING *'\u001b[39m\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 22 |\u001b[39m       [\u001b[32m'testuser'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'test@example.com'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'password123'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'user'\u001b[39m]\u001b[22m\n\u001b[2m     \u001b[90m 23 |\u001b[39m     )\u001b[33m;\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat \u001b[22m\u001b[2mnode_modules/pg-pool/index.js\u001b[2m:45:11\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous> (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/integration/bills.test.js\u001b[39m\u001b[0m\u001b[2m:20:24)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m账单管理API测试 › POST /api/bills/:id/review › 应该成功审核账单\u001b[39m\u001b[22m\n\n    error: column \"password\" of relation \"users\" does not exist\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 18 |\u001b[39m   beforeAll(\u001b[36masync\u001b[39m () \u001b[33m=>\u001b[39m {\u001b[22m\n\u001b[2m     \u001b[90m 19 |\u001b[39m     \u001b[90m// 创建测试用户\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 20 |\u001b[39m     \u001b[36mconst\u001b[39m userResult \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m pool\u001b[33m.\u001b[39mquery(\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m                        \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 21 |\u001b[39m       \u001b[32m'INSERT INTO users (username, email, password, role) VALUES ($1, $2, $3, $4) RETURNING *'\u001b[39m\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 22 |\u001b[39m       [\u001b[32m'testuser'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'test@example.com'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'password123'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'user'\u001b[39m]\u001b[22m\n\u001b[2m     \u001b[90m 23 |\u001b[39m     )\u001b[33m;\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat \u001b[22m\u001b[2mnode_modules/pg-pool/index.js\u001b[2m:45:11\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous> (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/integration/bills.test.js\u001b[39m\u001b[0m\u001b[2m:20:24)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m账单管理API测试 › POST /api/bills/:id/review › 应该在账单不存在时返回404\u001b[39m\u001b[22m\n\n    error: column \"password\" of relation \"users\" does not exist\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 18 |\u001b[39m   beforeAll(\u001b[36masync\u001b[39m () \u001b[33m=>\u001b[39m {\u001b[22m\n\u001b[2m     \u001b[90m 19 |\u001b[39m     \u001b[90m// 创建测试用户\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 20 |\u001b[39m     \u001b[36mconst\u001b[39m userResult \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m pool\u001b[33m.\u001b[39mquery(\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m                        \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 21 |\u001b[39m       \u001b[32m'INSERT INTO users (username, email, password, role) VALUES ($1, $2, $3, $4) RETURNING *'\u001b[39m\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 22 |\u001b[39m       [\u001b[32m'testuser'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'test@example.com'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'password123'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'user'\u001b[39m]\u001b[22m\n\u001b[2m     \u001b[90m 23 |\u001b[39m     )\u001b[33m;\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat \u001b[22m\u001b[2mnode_modules/pg-pool/index.js\u001b[2m:45:11\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous> (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/integration/bills.test.js\u001b[39m\u001b[0m\u001b[2m:20:24)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m账单管理API测试 › POST /api/bills/:id/confirm-payment › 应该成功确认账单支付\u001b[39m\u001b[22m\n\n    error: column \"password\" of relation \"users\" does not exist\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 18 |\u001b[39m   beforeAll(\u001b[36masync\u001b[39m () \u001b[33m=>\u001b[39m {\u001b[22m\n\u001b[2m     \u001b[90m 19 |\u001b[39m     \u001b[90m// 创建测试用户\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 20 |\u001b[39m     \u001b[36mconst\u001b[39m userResult \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m pool\u001b[33m.\u001b[39mquery(\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m                        \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 21 |\u001b[39m       \u001b[32m'INSERT INTO users (username, email, password, role) VALUES ($1, $2, $3, $4) RETURNING *'\u001b[39m\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 22 |\u001b[39m       [\u001b[32m'testuser'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'test@example.com'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'password123'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'user'\u001b[39m]\u001b[22m\n\u001b[2m     \u001b[90m 23 |\u001b[39m     )\u001b[33m;\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat \u001b[22m\u001b[2mnode_modules/pg-pool/index.js\u001b[2m:45:11\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous> (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/integration/bills.test.js\u001b[39m\u001b[0m\u001b[2m:20:24)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m账单管理API测试 › POST /api/bills/:id/confirm-payment › 应该在分摊ID不存在时返回400\u001b[39m\u001b[22m\n\n    error: column \"password\" of relation \"users\" does not exist\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 18 |\u001b[39m   beforeAll(\u001b[36masync\u001b[39m () \u001b[33m=>\u001b[39m {\u001b[22m\n\u001b[2m     \u001b[90m 19 |\u001b[39m     \u001b[90m// 创建测试用户\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 20 |\u001b[39m     \u001b[36mconst\u001b[39m userResult \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m pool\u001b[33m.\u001b[39mquery(\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m                        \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 21 |\u001b[39m       \u001b[32m'INSERT INTO users (username, email, password, role) VALUES ($1, $2, $3, $4) RETURNING *'\u001b[39m\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 22 |\u001b[39m       [\u001b[32m'testuser'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'test@example.com'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'password123'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'user'\u001b[39m]\u001b[22m\n\u001b[2m     \u001b[90m 23 |\u001b[39m     )\u001b[33m;\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat \u001b[22m\u001b[2mnode_modules/pg-pool/index.js\u001b[2m:45:11\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous> (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/integration/bills.test.js\u001b[39m\u001b[0m\u001b[2m:20:24)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m账单管理API测试 › GET /api/bills/user-stats › 应该成功获取用户账单统计\u001b[39m\u001b[22m\n\n    error: column \"password\" of relation \"users\" does not exist\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 18 |\u001b[39m   beforeAll(\u001b[36masync\u001b[39m () \u001b[33m=>\u001b[39m {\u001b[22m\n\u001b[2m     \u001b[90m 19 |\u001b[39m     \u001b[90m// 创建测试用户\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 20 |\u001b[39m     \u001b[36mconst\u001b[39m userResult \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m pool\u001b[33m.\u001b[39mquery(\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m                        \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 21 |\u001b[39m       \u001b[32m'INSERT INTO users (username, email, password, role) VALUES ($1, $2, $3, $4) RETURNING *'\u001b[39m\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 22 |\u001b[39m       [\u001b[32m'testuser'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'test@example.com'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'password123'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'user'\u001b[39m]\u001b[22m\n\u001b[2m     \u001b[90m 23 |\u001b[39m     )\u001b[33m;\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat \u001b[22m\u001b[2mnode_modules/pg-pool/index.js\u001b[2m:45:11\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous> (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/integration/bills.test.js\u001b[39m\u001b[0m\u001b[2m:20:24)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m账单管理API测试 › DELETE /api/bills/:id › 应该成功删除账单\u001b[39m\u001b[22m\n\n    error: column \"password\" of relation \"users\" does not exist\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 18 |\u001b[39m   beforeAll(\u001b[36masync\u001b[39m () \u001b[33m=>\u001b[39m {\u001b[22m\n\u001b[2m     \u001b[90m 19 |\u001b[39m     \u001b[90m// 创建测试用户\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 20 |\u001b[39m     \u001b[36mconst\u001b[39m userResult \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m pool\u001b[33m.\u001b[39mquery(\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m                        \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 21 |\u001b[39m       \u001b[32m'INSERT INTO users (username, email, password, role) VALUES ($1, $2, $3, $4) RETURNING *'\u001b[39m\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 22 |\u001b[39m       [\u001b[32m'testuser'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'test@example.com'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'password123'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'user'\u001b[39m]\u001b[22m\n\u001b[2m     \u001b[90m 23 |\u001b[39m     )\u001b[33m;\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat \u001b[22m\u001b[2mnode_modules/pg-pool/index.js\u001b[2m:45:11\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous> (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/integration/bills.test.js\u001b[39m\u001b[0m\u001b[2m:20:24)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m账单管理API测试 › DELETE /api/bills/:id › 应该在账单不存在时返回404\u001b[39m\u001b[22m\n\n    error: column \"password\" of relation \"users\" does not exist\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 18 |\u001b[39m   beforeAll(\u001b[36masync\u001b[39m () \u001b[33m=>\u001b[39m {\u001b[22m\n\u001b[2m     \u001b[90m 19 |\u001b[39m     \u001b[90m// 创建测试用户\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 20 |\u001b[39m     \u001b[36mconst\u001b[39m userResult \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m pool\u001b[33m.\u001b[39mquery(\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m                        \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 21 |\u001b[39m       \u001b[32m'INSERT INTO users (username, email, password, role) VALUES ($1, $2, $3, $4) RETURNING *'\u001b[39m\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 22 |\u001b[39m       [\u001b[32m'testuser'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'test@example.com'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'password123'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'user'\u001b[39m]\u001b[22m\n\u001b[2m     \u001b[90m 23 |\u001b[39m     )\u001b[33m;\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat \u001b[22m\u001b[2mnode_modules/pg-pool/index.js\u001b[2m:45:11\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous> (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/integration/bills.test.js\u001b[39m\u001b[0m\u001b[2m:20:24)\u001b[22m\u001b[2m\u001b[22m\n","name":"C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\integration\\bills.test.js","startTime":1762159266376,"status":"failed","summary":""},{"assertionResults":[{"ancestorTitles":["用户管理API集成测试","POST /api/auth/register"],"duration":0,"failureDetails":[{"length":420,"name":"error","severity":"ERROR","code":"23514","detail":"Failing row contains (4cbaf8aa-f8e2-4725-94ab-7b344caedfd2, testuser, test@example.com, null, $2a$10$XyiiOjRm85V4t290VnL/9eHSKDvT5V5Ccz6FIgECSDMOrDkxoRvHO, Test User, null, user, active, null, 2025-11-03 16:41:07.899206, 2025-11-03 16:41:07.899206).","schema":"public","table":"users","constraint":"users_role_check","file":"execMain.c","line":"2067","routine":"ExecConstraints"}],"failureMessages":["error: new row for relation \"users\" violates check constraint \"users_role_check\"\n    at C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\pg-pool\\index.js:45:11\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at Object.<anonymous> (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\integration\\users.test.js:22:24)"],"fullName":"用户管理API集成测试 POST /api/auth/register 应该成功注册新用户","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该成功注册新用户"},{"ancestorTitles":["用户管理API集成测试","POST /api/auth/register"],"duration":1,"failureDetails":[{"length":420,"name":"error","severity":"ERROR","code":"23514","detail":"Failing row contains (4cbaf8aa-f8e2-4725-94ab-7b344caedfd2, testuser, test@example.com, null, $2a$10$XyiiOjRm85V4t290VnL/9eHSKDvT5V5Ccz6FIgECSDMOrDkxoRvHO, Test User, null, user, active, null, 2025-11-03 16:41:07.899206, 2025-11-03 16:41:07.899206).","schema":"public","table":"users","constraint":"users_role_check","file":"execMain.c","line":"2067","routine":"ExecConstraints"}],"failureMessages":["error: new row for relation \"users\" violates check constraint \"users_role_check\"\n    at C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\pg-pool\\index.js:45:11\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at Object.<anonymous> (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\integration\\users.test.js:22:24)"],"fullName":"用户管理API集成测试 POST /api/auth/register 应该在缺少必填字段时返回400","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该在缺少必填字段时返回400"},{"ancestorTitles":["用户管理API集成测试","POST /api/auth/register"],"duration":0,"failureDetails":[{"length":420,"name":"error","severity":"ERROR","code":"23514","detail":"Failing row contains (4cbaf8aa-f8e2-4725-94ab-7b344caedfd2, testuser, test@example.com, null, $2a$10$XyiiOjRm85V4t290VnL/9eHSKDvT5V5Ccz6FIgECSDMOrDkxoRvHO, Test User, null, user, active, null, 2025-11-03 16:41:07.899206, 2025-11-03 16:41:07.899206).","schema":"public","table":"users","constraint":"users_role_check","file":"execMain.c","line":"2067","routine":"ExecConstraints"}],"failureMessages":["error: new row for relation \"users\" violates check constraint \"users_role_check\"\n    at C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\pg-pool\\index.js:45:11\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at Object.<anonymous> (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\integration\\users.test.js:22:24)"],"fullName":"用户管理API集成测试 POST /api/auth/register 应该在用户名已存在时返回409","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该在用户名已存在时返回409"},{"ancestorTitles":["用户管理API集成测试","POST /api/auth/register"],"duration":0,"failureDetails":[{"length":420,"name":"error","severity":"ERROR","code":"23514","detail":"Failing row contains (4cbaf8aa-f8e2-4725-94ab-7b344caedfd2, testuser, test@example.com, null, $2a$10$XyiiOjRm85V4t290VnL/9eHSKDvT5V5Ccz6FIgECSDMOrDkxoRvHO, Test User, null, user, active, null, 2025-11-03 16:41:07.899206, 2025-11-03 16:41:07.899206).","schema":"public","table":"users","constraint":"users_role_check","file":"execMain.c","line":"2067","routine":"ExecConstraints"}],"failureMessages":["error: new row for relation \"users\" violates check constraint \"users_role_check\"\n    at C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\pg-pool\\index.js:45:11\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at Object.<anonymous> (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\integration\\users.test.js:22:24)"],"fullName":"用户管理API集成测试 POST /api/auth/register 应该在邮箱已存在时返回409","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该在邮箱已存在时返回409"},{"ancestorTitles":["用户管理API集成测试","POST /api/auth/login"],"duration":0,"failureDetails":[{"length":420,"name":"error","severity":"ERROR","code":"23514","detail":"Failing row contains (4cbaf8aa-f8e2-4725-94ab-7b344caedfd2, testuser, test@example.com, null, $2a$10$XyiiOjRm85V4t290VnL/9eHSKDvT5V5Ccz6FIgECSDMOrDkxoRvHO, Test User, null, user, active, null, 2025-11-03 16:41:07.899206, 2025-11-03 16:41:07.899206).","schema":"public","table":"users","constraint":"users_role_check","file":"execMain.c","line":"2067","routine":"ExecConstraints"}],"failureMessages":["error: new row for relation \"users\" violates check constraint \"users_role_check\"\n    at C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\pg-pool\\index.js:45:11\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at Object.<anonymous> (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\integration\\users.test.js:22:24)"],"fullName":"用户管理API集成测试 POST /api/auth/login 应该成功登录并返回token","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该成功登录并返回token"},{"ancestorTitles":["用户管理API集成测试","POST /api/auth/login"],"duration":0,"failureDetails":[{"length":420,"name":"error","severity":"ERROR","code":"23514","detail":"Failing row contains (4cbaf8aa-f8e2-4725-94ab-7b344caedfd2, testuser, test@example.com, null, $2a$10$XyiiOjRm85V4t290VnL/9eHSKDvT5V5Ccz6FIgECSDMOrDkxoRvHO, Test User, null, user, active, null, 2025-11-03 16:41:07.899206, 2025-11-03 16:41:07.899206).","schema":"public","table":"users","constraint":"users_role_check","file":"execMain.c","line":"2067","routine":"ExecConstraints"}],"failureMessages":["error: new row for relation \"users\" violates check constraint \"users_role_check\"\n    at C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\pg-pool\\index.js:45:11\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at Object.<anonymous> (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\integration\\users.test.js:22:24)"],"fullName":"用户管理API集成测试 POST /api/auth/login 应该在缺少必填字段时返回400","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该在缺少必填字段时返回400"},{"ancestorTitles":["用户管理API集成测试","POST /api/auth/login"],"duration":0,"failureDetails":[{"length":420,"name":"error","severity":"ERROR","code":"23514","detail":"Failing row contains (4cbaf8aa-f8e2-4725-94ab-7b344caedfd2, testuser, test@example.com, null, $2a$10$XyiiOjRm85V4t290VnL/9eHSKDvT5V5Ccz6FIgECSDMOrDkxoRvHO, Test User, null, user, active, null, 2025-11-03 16:41:07.899206, 2025-11-03 16:41:07.899206).","schema":"public","table":"users","constraint":"users_role_check","file":"execMain.c","line":"2067","routine":"ExecConstraints"}],"failureMessages":["error: new row for relation \"users\" violates check constraint \"users_role_check\"\n    at C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\pg-pool\\index.js:45:11\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at Object.<anonymous> (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\integration\\users.test.js:22:24)"],"fullName":"用户管理API集成测试 POST /api/auth/login 应该在用户不存在时返回401","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该在用户不存在时返回401"},{"ancestorTitles":["用户管理API集成测试","POST /api/auth/refresh"],"duration":0,"failureDetails":[{"length":420,"name":"error","severity":"ERROR","code":"23514","detail":"Failing row contains (4cbaf8aa-f8e2-4725-94ab-7b344caedfd2, testuser, test@example.com, null, $2a$10$XyiiOjRm85V4t290VnL/9eHSKDvT5V5Ccz6FIgECSDMOrDkxoRvHO, Test User, null, user, active, null, 2025-11-03 16:41:07.899206, 2025-11-03 16:41:07.899206).","schema":"public","table":"users","constraint":"users_role_check","file":"execMain.c","line":"2067","routine":"ExecConstraints"}],"failureMessages":["error: new row for relation \"users\" violates check constraint \"users_role_check\"\n    at C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\pg-pool\\index.js:45:11\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at Object.<anonymous> (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\integration\\users.test.js:22:24)"],"fullName":"用户管理API集成测试 POST /api/auth/refresh 应该成功刷新token","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该成功刷新token"},{"ancestorTitles":["用户管理API集成测试","POST /api/auth/refresh"],"duration":0,"failureDetails":[{"length":420,"name":"error","severity":"ERROR","code":"23514","detail":"Failing row contains (4cbaf8aa-f8e2-4725-94ab-7b344caedfd2, testuser, test@example.com, null, $2a$10$XyiiOjRm85V4t290VnL/9eHSKDvT5V5Ccz6FIgECSDMOrDkxoRvHO, Test User, null, user, active, null, 2025-11-03 16:41:07.899206, 2025-11-03 16:41:07.899206).","schema":"public","table":"users","constraint":"users_role_check","file":"execMain.c","line":"2067","routine":"ExecConstraints"}],"failureMessages":["error: new row for relation \"users\" violates check constraint \"users_role_check\"\n    at C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\pg-pool\\index.js:45:11\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at Object.<anonymous> (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\integration\\users.test.js:22:24)"],"fullName":"用户管理API集成测试 POST /api/auth/refresh 应该在缺少刷新token时返回400","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该在缺少刷新token时返回400"},{"ancestorTitles":["用户管理API集成测试","GET /api/users/profile"],"duration":0,"failureDetails":[{"length":420,"name":"error","severity":"ERROR","code":"23514","detail":"Failing row contains (4cbaf8aa-f8e2-4725-94ab-7b344caedfd2, testuser, test@example.com, null, $2a$10$XyiiOjRm85V4t290VnL/9eHSKDvT5V5Ccz6FIgECSDMOrDkxoRvHO, Test User, null, user, active, null, 2025-11-03 16:41:07.899206, 2025-11-03 16:41:07.899206).","schema":"public","table":"users","constraint":"users_role_check","file":"execMain.c","line":"2067","routine":"ExecConstraints"}],"failureMessages":["error: new row for relation \"users\" violates check constraint \"users_role_check\"\n    at C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\pg-pool\\index.js:45:11\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at Object.<anonymous> (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\integration\\users.test.js:22:24)"],"fullName":"用户管理API集成测试 GET /api/users/profile 应该成功获取用户资料","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该成功获取用户资料"},{"ancestorTitles":["用户管理API集成测试","GET /api/users/profile"],"duration":0,"failureDetails":[{"length":420,"name":"error","severity":"ERROR","code":"23514","detail":"Failing row contains (4cbaf8aa-f8e2-4725-94ab-7b344caedfd2, testuser, test@example.com, null, $2a$10$XyiiOjRm85V4t290VnL/9eHSKDvT5V5Ccz6FIgECSDMOrDkxoRvHO, Test User, null, user, active, null, 2025-11-03 16:41:07.899206, 2025-11-03 16:41:07.899206).","schema":"public","table":"users","constraint":"users_role_check","file":"execMain.c","line":"2067","routine":"ExecConstraints"}],"failureMessages":["error: new row for relation \"users\" violates check constraint \"users_role_check\"\n    at C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\pg-pool\\index.js:45:11\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at Object.<anonymous> (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\integration\\users.test.js:22:24)"],"fullName":"用户管理API集成测试 GET /api/users/profile 应该在未提供认证令牌时返回401","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该在未提供认证令牌时返回401"},{"ancestorTitles":["用户管理API集成测试","PUT /api/users/profile"],"duration":0,"failureDetails":[{"length":420,"name":"error","severity":"ERROR","code":"23514","detail":"Failing row contains (4cbaf8aa-f8e2-4725-94ab-7b344caedfd2, testuser, test@example.com, null, $2a$10$XyiiOjRm85V4t290VnL/9eHSKDvT5V5Ccz6FIgECSDMOrDkxoRvHO, Test User, null, user, active, null, 2025-11-03 16:41:07.899206, 2025-11-03 16:41:07.899206).","schema":"public","table":"users","constraint":"users_role_check","file":"execMain.c","line":"2067","routine":"ExecConstraints"}],"failureMessages":["error: new row for relation \"users\" violates check constraint \"users_role_check\"\n    at C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\pg-pool\\index.js:45:11\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at Object.<anonymous> (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\integration\\users.test.js:22:24)"],"fullName":"用户管理API集成测试 PUT /api/users/profile 应该成功更新用户资料","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该成功更新用户资料"},{"ancestorTitles":["用户管理API集成测试","PUT /api/users/profile"],"duration":0,"failureDetails":[{"length":420,"name":"error","severity":"ERROR","code":"23514","detail":"Failing row contains (4cbaf8aa-f8e2-4725-94ab-7b344caedfd2, testuser, test@example.com, null, $2a$10$XyiiOjRm85V4t290VnL/9eHSKDvT5V5Ccz6FIgECSDMOrDkxoRvHO, Test User, null, user, active, null, 2025-11-03 16:41:07.899206, 2025-11-03 16:41:07.899206).","schema":"public","table":"users","constraint":"users_role_check","file":"execMain.c","line":"2067","routine":"ExecConstraints"}],"failureMessages":["error: new row for relation \"users\" violates check constraint \"users_role_check\"\n    at C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\pg-pool\\index.js:45:11\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at Object.<anonymous> (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\integration\\users.test.js:22:24)"],"fullName":"用户管理API集成测试 PUT /api/users/profile 应该在未提供认证令牌时返回401","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该在未提供认证令牌时返回401"},{"ancestorTitles":["用户管理API集成测试","PUT /api/users/password"],"duration":0,"failureDetails":[{"length":420,"name":"error","severity":"ERROR","code":"23514","detail":"Failing row contains (4cbaf8aa-f8e2-4725-94ab-7b344caedfd2, testuser, test@example.com, null, $2a$10$XyiiOjRm85V4t290VnL/9eHSKDvT5V5Ccz6FIgECSDMOrDkxoRvHO, Test User, null, user, active, null, 2025-11-03 16:41:07.899206, 2025-11-03 16:41:07.899206).","schema":"public","table":"users","constraint":"users_role_check","file":"execMain.c","line":"2067","routine":"ExecConstraints"}],"failureMessages":["error: new row for relation \"users\" violates check constraint \"users_role_check\"\n    at C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\pg-pool\\index.js:45:11\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at Object.<anonymous> (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\integration\\users.test.js:22:24)"],"fullName":"用户管理API集成测试 PUT /api/users/password 应该成功修改密码","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该成功修改密码"},{"ancestorTitles":["用户管理API集成测试","PUT /api/users/password"],"duration":0,"failureDetails":[{"length":420,"name":"error","severity":"ERROR","code":"23514","detail":"Failing row contains (4cbaf8aa-f8e2-4725-94ab-7b344caedfd2, testuser, test@example.com, null, $2a$10$XyiiOjRm85V4t290VnL/9eHSKDvT5V5Ccz6FIgECSDMOrDkxoRvHO, Test User, null, user, active, null, 2025-11-03 16:41:07.899206, 2025-11-03 16:41:07.899206).","schema":"public","table":"users","constraint":"users_role_check","file":"execMain.c","line":"2067","routine":"ExecConstraints"}],"failureMessages":["error: new row for relation \"users\" violates check constraint \"users_role_check\"\n    at C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\pg-pool\\index.js:45:11\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at Object.<anonymous> (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\integration\\users.test.js:22:24)"],"fullName":"用户管理API集成测试 PUT /api/users/password 应该在当前密码错误时返回400","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该在当前密码错误时返回400"},{"ancestorTitles":["用户管理API集成测试","PUT /api/users/password"],"duration":0,"failureDetails":[{"length":420,"name":"error","severity":"ERROR","code":"23514","detail":"Failing row contains (4cbaf8aa-f8e2-4725-94ab-7b344caedfd2, testuser, test@example.com, null, $2a$10$XyiiOjRm85V4t290VnL/9eHSKDvT5V5Ccz6FIgECSDMOrDkxoRvHO, Test User, null, user, active, null, 2025-11-03 16:41:07.899206, 2025-11-03 16:41:07.899206).","schema":"public","table":"users","constraint":"users_role_check","file":"execMain.c","line":"2067","routine":"ExecConstraints"}],"failureMessages":["error: new row for relation \"users\" violates check constraint \"users_role_check\"\n    at C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\pg-pool\\index.js:45:11\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at Object.<anonymous> (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\integration\\users.test.js:22:24)"],"fullName":"用户管理API集成测试 PUT /api/users/password 应该在未提供认证令牌时返回401","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该在未提供认证令牌时返回401"}],"endTime":1762159268068,"message":"\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m用户管理API集成测试 › POST /api/auth/register › 应该成功注册新用户\u001b[39m\u001b[22m\n\n    error: new row for relation \"users\" violates check constraint \"users_role_check\"\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 20 |\u001b[39m     \u001b[22m\n\u001b[2m     \u001b[90m 21 |\u001b[39m     \u001b[90m// 创建测试用户\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 22 |\u001b[39m     \u001b[36mconst\u001b[39m userResult \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m pool\u001b[33m.\u001b[39mquery(\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m                        \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 23 |\u001b[39m       \u001b[32m'INSERT INTO users (username, email, password_hash, name, role) VALUES ($1, $2, $3, $4, $5) RETURNING *'\u001b[39m\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 24 |\u001b[39m       [\u001b[32m'testuser'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'test@example.com'\u001b[39m\u001b[33m,\u001b[39m hashedPassword\u001b[33m,\u001b[39m \u001b[32m'Test User'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'user'\u001b[39m]\u001b[22m\n\u001b[2m     \u001b[90m 25 |\u001b[39m     )\u001b[33m;\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat \u001b[22m\u001b[2mnode_modules/pg-pool/index.js\u001b[2m:45:11\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous> (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/integration/users.test.js\u001b[39m\u001b[0m\u001b[2m:22:24)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m用户管理API集成测试 › POST /api/auth/register › 应该在缺少必填字段时返回400\u001b[39m\u001b[22m\n\n    error: new row for relation \"users\" violates check constraint \"users_role_check\"\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 20 |\u001b[39m     \u001b[22m\n\u001b[2m     \u001b[90m 21 |\u001b[39m     \u001b[90m// 创建测试用户\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 22 |\u001b[39m     \u001b[36mconst\u001b[39m userResult \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m pool\u001b[33m.\u001b[39mquery(\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m                        \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 23 |\u001b[39m       \u001b[32m'INSERT INTO users (username, email, password_hash, name, role) VALUES ($1, $2, $3, $4, $5) RETURNING *'\u001b[39m\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 24 |\u001b[39m       [\u001b[32m'testuser'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'test@example.com'\u001b[39m\u001b[33m,\u001b[39m hashedPassword\u001b[33m,\u001b[39m \u001b[32m'Test User'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'user'\u001b[39m]\u001b[22m\n\u001b[2m     \u001b[90m 25 |\u001b[39m     )\u001b[33m;\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat \u001b[22m\u001b[2mnode_modules/pg-pool/index.js\u001b[2m:45:11\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous> (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/integration/users.test.js\u001b[39m\u001b[0m\u001b[2m:22:24)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m用户管理API集成测试 › POST /api/auth/register › 应该在用户名已存在时返回409\u001b[39m\u001b[22m\n\n    error: new row for relation \"users\" violates check constraint \"users_role_check\"\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 20 |\u001b[39m     \u001b[22m\n\u001b[2m     \u001b[90m 21 |\u001b[39m     \u001b[90m// 创建测试用户\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 22 |\u001b[39m     \u001b[36mconst\u001b[39m userResult \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m pool\u001b[33m.\u001b[39mquery(\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m                        \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 23 |\u001b[39m       \u001b[32m'INSERT INTO users (username, email, password_hash, name, role) VALUES ($1, $2, $3, $4, $5) RETURNING *'\u001b[39m\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 24 |\u001b[39m       [\u001b[32m'testuser'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'test@example.com'\u001b[39m\u001b[33m,\u001b[39m hashedPassword\u001b[33m,\u001b[39m \u001b[32m'Test User'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'user'\u001b[39m]\u001b[22m\n\u001b[2m     \u001b[90m 25 |\u001b[39m     )\u001b[33m;\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat \u001b[22m\u001b[2mnode_modules/pg-pool/index.js\u001b[2m:45:11\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous> (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/integration/users.test.js\u001b[39m\u001b[0m\u001b[2m:22:24)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m用户管理API集成测试 › POST /api/auth/register › 应该在邮箱已存在时返回409\u001b[39m\u001b[22m\n\n    error: new row for relation \"users\" violates check constraint \"users_role_check\"\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 20 |\u001b[39m     \u001b[22m\n\u001b[2m     \u001b[90m 21 |\u001b[39m     \u001b[90m// 创建测试用户\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 22 |\u001b[39m     \u001b[36mconst\u001b[39m userResult \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m pool\u001b[33m.\u001b[39mquery(\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m                        \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 23 |\u001b[39m       \u001b[32m'INSERT INTO users (username, email, password_hash, name, role) VALUES ($1, $2, $3, $4, $5) RETURNING *'\u001b[39m\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 24 |\u001b[39m       [\u001b[32m'testuser'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'test@example.com'\u001b[39m\u001b[33m,\u001b[39m hashedPassword\u001b[33m,\u001b[39m \u001b[32m'Test User'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'user'\u001b[39m]\u001b[22m\n\u001b[2m     \u001b[90m 25 |\u001b[39m     )\u001b[33m;\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat \u001b[22m\u001b[2mnode_modules/pg-pool/index.js\u001b[2m:45:11\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous> (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/integration/users.test.js\u001b[39m\u001b[0m\u001b[2m:22:24)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m用户管理API集成测试 › POST /api/auth/login › 应该成功登录并返回token\u001b[39m\u001b[22m\n\n    error: new row for relation \"users\" violates check constraint \"users_role_check\"\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 20 |\u001b[39m     \u001b[22m\n\u001b[2m     \u001b[90m 21 |\u001b[39m     \u001b[90m// 创建测试用户\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 22 |\u001b[39m     \u001b[36mconst\u001b[39m userResult \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m pool\u001b[33m.\u001b[39mquery(\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m                        \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 23 |\u001b[39m       \u001b[32m'INSERT INTO users (username, email, password_hash, name, role) VALUES ($1, $2, $3, $4, $5) RETURNING *'\u001b[39m\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 24 |\u001b[39m       [\u001b[32m'testuser'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'test@example.com'\u001b[39m\u001b[33m,\u001b[39m hashedPassword\u001b[33m,\u001b[39m \u001b[32m'Test User'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'user'\u001b[39m]\u001b[22m\n\u001b[2m     \u001b[90m 25 |\u001b[39m     )\u001b[33m;\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat \u001b[22m\u001b[2mnode_modules/pg-pool/index.js\u001b[2m:45:11\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous> (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/integration/users.test.js\u001b[39m\u001b[0m\u001b[2m:22:24)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m用户管理API集成测试 › POST /api/auth/login › 应该在缺少必填字段时返回400\u001b[39m\u001b[22m\n\n    error: new row for relation \"users\" violates check constraint \"users_role_check\"\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 20 |\u001b[39m     \u001b[22m\n\u001b[2m     \u001b[90m 21 |\u001b[39m     \u001b[90m// 创建测试用户\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 22 |\u001b[39m     \u001b[36mconst\u001b[39m userResult \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m pool\u001b[33m.\u001b[39mquery(\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m                        \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 23 |\u001b[39m       \u001b[32m'INSERT INTO users (username, email, password_hash, name, role) VALUES ($1, $2, $3, $4, $5) RETURNING *'\u001b[39m\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 24 |\u001b[39m       [\u001b[32m'testuser'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'test@example.com'\u001b[39m\u001b[33m,\u001b[39m hashedPassword\u001b[33m,\u001b[39m \u001b[32m'Test User'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'user'\u001b[39m]\u001b[22m\n\u001b[2m     \u001b[90m 25 |\u001b[39m     )\u001b[33m;\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat \u001b[22m\u001b[2mnode_modules/pg-pool/index.js\u001b[2m:45:11\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous> (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/integration/users.test.js\u001b[39m\u001b[0m\u001b[2m:22:24)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m用户管理API集成测试 › POST /api/auth/login › 应该在用户不存在时返回401\u001b[39m\u001b[22m\n\n    error: new row for relation \"users\" violates check constraint \"users_role_check\"\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 20 |\u001b[39m     \u001b[22m\n\u001b[2m     \u001b[90m 21 |\u001b[39m     \u001b[90m// 创建测试用户\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 22 |\u001b[39m     \u001b[36mconst\u001b[39m userResult \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m pool\u001b[33m.\u001b[39mquery(\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m                        \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 23 |\u001b[39m       \u001b[32m'INSERT INTO users (username, email, password_hash, name, role) VALUES ($1, $2, $3, $4, $5) RETURNING *'\u001b[39m\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 24 |\u001b[39m       [\u001b[32m'testuser'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'test@example.com'\u001b[39m\u001b[33m,\u001b[39m hashedPassword\u001b[33m,\u001b[39m \u001b[32m'Test User'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'user'\u001b[39m]\u001b[22m\n\u001b[2m     \u001b[90m 25 |\u001b[39m     )\u001b[33m;\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat \u001b[22m\u001b[2mnode_modules/pg-pool/index.js\u001b[2m:45:11\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous> (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/integration/users.test.js\u001b[39m\u001b[0m\u001b[2m:22:24)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m用户管理API集成测试 › POST /api/auth/refresh › 应该成功刷新token\u001b[39m\u001b[22m\n\n    error: new row for relation \"users\" violates check constraint \"users_role_check\"\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 20 |\u001b[39m     \u001b[22m\n\u001b[2m     \u001b[90m 21 |\u001b[39m     \u001b[90m// 创建测试用户\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 22 |\u001b[39m     \u001b[36mconst\u001b[39m userResult \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m pool\u001b[33m.\u001b[39mquery(\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m                        \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 23 |\u001b[39m       \u001b[32m'INSERT INTO users (username, email, password_hash, name, role) VALUES ($1, $2, $3, $4, $5) RETURNING *'\u001b[39m\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 24 |\u001b[39m       [\u001b[32m'testuser'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'test@example.com'\u001b[39m\u001b[33m,\u001b[39m hashedPassword\u001b[33m,\u001b[39m \u001b[32m'Test User'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'user'\u001b[39m]\u001b[22m\n\u001b[2m     \u001b[90m 25 |\u001b[39m     )\u001b[33m;\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat \u001b[22m\u001b[2mnode_modules/pg-pool/index.js\u001b[2m:45:11\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous> (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/integration/users.test.js\u001b[39m\u001b[0m\u001b[2m:22:24)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m用户管理API集成测试 › POST /api/auth/refresh › 应该在缺少刷新token时返回400\u001b[39m\u001b[22m\n\n    error: new row for relation \"users\" violates check constraint \"users_role_check\"\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 20 |\u001b[39m     \u001b[22m\n\u001b[2m     \u001b[90m 21 |\u001b[39m     \u001b[90m// 创建测试用户\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 22 |\u001b[39m     \u001b[36mconst\u001b[39m userResult \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m pool\u001b[33m.\u001b[39mquery(\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m                        \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 23 |\u001b[39m       \u001b[32m'INSERT INTO users (username, email, password_hash, name, role) VALUES ($1, $2, $3, $4, $5) RETURNING *'\u001b[39m\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 24 |\u001b[39m       [\u001b[32m'testuser'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'test@example.com'\u001b[39m\u001b[33m,\u001b[39m hashedPassword\u001b[33m,\u001b[39m \u001b[32m'Test User'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'user'\u001b[39m]\u001b[22m\n\u001b[2m     \u001b[90m 25 |\u001b[39m     )\u001b[33m;\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat \u001b[22m\u001b[2mnode_modules/pg-pool/index.js\u001b[2m:45:11\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous> (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/integration/users.test.js\u001b[39m\u001b[0m\u001b[2m:22:24)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m用户管理API集成测试 › GET /api/users/profile › 应该成功获取用户资料\u001b[39m\u001b[22m\n\n    error: new row for relation \"users\" violates check constraint \"users_role_check\"\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 20 |\u001b[39m     \u001b[22m\n\u001b[2m     \u001b[90m 21 |\u001b[39m     \u001b[90m// 创建测试用户\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 22 |\u001b[39m     \u001b[36mconst\u001b[39m userResult \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m pool\u001b[33m.\u001b[39mquery(\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m                        \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 23 |\u001b[39m       \u001b[32m'INSERT INTO users (username, email, password_hash, name, role) VALUES ($1, $2, $3, $4, $5) RETURNING *'\u001b[39m\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 24 |\u001b[39m       [\u001b[32m'testuser'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'test@example.com'\u001b[39m\u001b[33m,\u001b[39m hashedPassword\u001b[33m,\u001b[39m \u001b[32m'Test User'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'user'\u001b[39m]\u001b[22m\n\u001b[2m     \u001b[90m 25 |\u001b[39m     )\u001b[33m;\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat \u001b[22m\u001b[2mnode_modules/pg-pool/index.js\u001b[2m:45:11\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous> (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/integration/users.test.js\u001b[39m\u001b[0m\u001b[2m:22:24)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m用户管理API集成测试 › GET /api/users/profile › 应该在未提供认证令牌时返回401\u001b[39m\u001b[22m\n\n    error: new row for relation \"users\" violates check constraint \"users_role_check\"\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 20 |\u001b[39m     \u001b[22m\n\u001b[2m     \u001b[90m 21 |\u001b[39m     \u001b[90m// 创建测试用户\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 22 |\u001b[39m     \u001b[36mconst\u001b[39m userResult \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m pool\u001b[33m.\u001b[39mquery(\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m                        \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 23 |\u001b[39m       \u001b[32m'INSERT INTO users (username, email, password_hash, name, role) VALUES ($1, $2, $3, $4, $5) RETURNING *'\u001b[39m\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 24 |\u001b[39m       [\u001b[32m'testuser'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'test@example.com'\u001b[39m\u001b[33m,\u001b[39m hashedPassword\u001b[33m,\u001b[39m \u001b[32m'Test User'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'user'\u001b[39m]\u001b[22m\n\u001b[2m     \u001b[90m 25 |\u001b[39m     )\u001b[33m;\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat \u001b[22m\u001b[2mnode_modules/pg-pool/index.js\u001b[2m:45:11\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous> (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/integration/users.test.js\u001b[39m\u001b[0m\u001b[2m:22:24)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m用户管理API集成测试 › PUT /api/users/profile › 应该成功更新用户资料\u001b[39m\u001b[22m\n\n    error: new row for relation \"users\" violates check constraint \"users_role_check\"\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 20 |\u001b[39m     \u001b[22m\n\u001b[2m     \u001b[90m 21 |\u001b[39m     \u001b[90m// 创建测试用户\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 22 |\u001b[39m     \u001b[36mconst\u001b[39m userResult \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m pool\u001b[33m.\u001b[39mquery(\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m                        \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 23 |\u001b[39m       \u001b[32m'INSERT INTO users (username, email, password_hash, name, role) VALUES ($1, $2, $3, $4, $5) RETURNING *'\u001b[39m\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 24 |\u001b[39m       [\u001b[32m'testuser'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'test@example.com'\u001b[39m\u001b[33m,\u001b[39m hashedPassword\u001b[33m,\u001b[39m \u001b[32m'Test User'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'user'\u001b[39m]\u001b[22m\n\u001b[2m     \u001b[90m 25 |\u001b[39m     )\u001b[33m;\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat \u001b[22m\u001b[2mnode_modules/pg-pool/index.js\u001b[2m:45:11\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous> (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/integration/users.test.js\u001b[39m\u001b[0m\u001b[2m:22:24)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m用户管理API集成测试 › PUT /api/users/profile › 应该在未提供认证令牌时返回401\u001b[39m\u001b[22m\n\n    error: new row for relation \"users\" violates check constraint \"users_role_check\"\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 20 |\u001b[39m     \u001b[22m\n\u001b[2m     \u001b[90m 21 |\u001b[39m     \u001b[90m// 创建测试用户\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 22 |\u001b[39m     \u001b[36mconst\u001b[39m userResult \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m pool\u001b[33m.\u001b[39mquery(\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m                        \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 23 |\u001b[39m       \u001b[32m'INSERT INTO users (username, email, password_hash, name, role) VALUES ($1, $2, $3, $4, $5) RETURNING *'\u001b[39m\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 24 |\u001b[39m       [\u001b[32m'testuser'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'test@example.com'\u001b[39m\u001b[33m,\u001b[39m hashedPassword\u001b[33m,\u001b[39m \u001b[32m'Test User'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'user'\u001b[39m]\u001b[22m\n\u001b[2m     \u001b[90m 25 |\u001b[39m     )\u001b[33m;\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat \u001b[22m\u001b[2mnode_modules/pg-pool/index.js\u001b[2m:45:11\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous> (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/integration/users.test.js\u001b[39m\u001b[0m\u001b[2m:22:24)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m用户管理API集成测试 › PUT /api/users/password › 应该成功修改密码\u001b[39m\u001b[22m\n\n    error: new row for relation \"users\" violates check constraint \"users_role_check\"\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 20 |\u001b[39m     \u001b[22m\n\u001b[2m     \u001b[90m 21 |\u001b[39m     \u001b[90m// 创建测试用户\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 22 |\u001b[39m     \u001b[36mconst\u001b[39m userResult \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m pool\u001b[33m.\u001b[39mquery(\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m                        \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 23 |\u001b[39m       \u001b[32m'INSERT INTO users (username, email, password_hash, name, role) VALUES ($1, $2, $3, $4, $5) RETURNING *'\u001b[39m\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 24 |\u001b[39m       [\u001b[32m'testuser'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'test@example.com'\u001b[39m\u001b[33m,\u001b[39m hashedPassword\u001b[33m,\u001b[39m \u001b[32m'Test User'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'user'\u001b[39m]\u001b[22m\n\u001b[2m     \u001b[90m 25 |\u001b[39m     )\u001b[33m;\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat \u001b[22m\u001b[2mnode_modules/pg-pool/index.js\u001b[2m:45:11\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous> (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/integration/users.test.js\u001b[39m\u001b[0m\u001b[2m:22:24)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m用户管理API集成测试 › PUT /api/users/password › 应该在当前密码错误时返回400\u001b[39m\u001b[22m\n\n    error: new row for relation \"users\" violates check constraint \"users_role_check\"\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 20 |\u001b[39m     \u001b[22m\n\u001b[2m     \u001b[90m 21 |\u001b[39m     \u001b[90m// 创建测试用户\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 22 |\u001b[39m     \u001b[36mconst\u001b[39m userResult \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m pool\u001b[33m.\u001b[39mquery(\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m                        \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 23 |\u001b[39m       \u001b[32m'INSERT INTO users (username, email, password_hash, name, role) VALUES ($1, $2, $3, $4, $5) RETURNING *'\u001b[39m\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 24 |\u001b[39m       [\u001b[32m'testuser'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'test@example.com'\u001b[39m\u001b[33m,\u001b[39m hashedPassword\u001b[33m,\u001b[39m \u001b[32m'Test User'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'user'\u001b[39m]\u001b[22m\n\u001b[2m     \u001b[90m 25 |\u001b[39m     )\u001b[33m;\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat \u001b[22m\u001b[2mnode_modules/pg-pool/index.js\u001b[2m:45:11\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous> (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/integration/users.test.js\u001b[39m\u001b[0m\u001b[2m:22:24)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m用户管理API集成测试 › PUT /api/users/password › 应该在未提供认证令牌时返回401\u001b[39m\u001b[22m\n\n    error: new row for relation \"users\" violates check constraint \"users_role_check\"\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 20 |\u001b[39m     \u001b[22m\n\u001b[2m     \u001b[90m 21 |\u001b[39m     \u001b[90m// 创建测试用户\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 22 |\u001b[39m     \u001b[36mconst\u001b[39m userResult \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m pool\u001b[33m.\u001b[39mquery(\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m                        \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 23 |\u001b[39m       \u001b[32m'INSERT INTO users (username, email, password_hash, name, role) VALUES ($1, $2, $3, $4, $5) RETURNING *'\u001b[39m\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 24 |\u001b[39m       [\u001b[32m'testuser'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'test@example.com'\u001b[39m\u001b[33m,\u001b[39m hashedPassword\u001b[33m,\u001b[39m \u001b[32m'Test User'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'user'\u001b[39m]\u001b[22m\n\u001b[2m     \u001b[90m 25 |\u001b[39m     )\u001b[33m;\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat \u001b[22m\u001b[2mnode_modules/pg-pool/index.js\u001b[2m:45:11\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous> (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/integration/users.test.js\u001b[39m\u001b[0m\u001b[2m:22:24)\u001b[22m\u001b[2m\u001b[22m\n","name":"C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\integration\\users.test.js","startTime":1762159267160,"status":"failed","summary":""},{"assertionResults":[{"ancestorTitles":["费用管理API测试","POST /api/expenses"],"duration":0,"failureDetails":[{"length":126,"name":"error","severity":"ERROR","code":"42703","position":"37","file":"parse_target.c","line":"1073","routine":"checkInsertTargets"}],"failureMessages":["error: column \"password\" of relation \"users\" does not exist\n    at C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\pg-pool\\index.js:45:11\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at Object.<anonymous> (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\integration\\expenses.test.js:19:24)"],"fullName":"费用管理API测试 POST /api/expenses 应该成功创建费用记录","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该成功创建费用记录"},{"ancestorTitles":["费用管理API测试","POST /api/expenses"],"duration":0,"failureDetails":[{"length":126,"name":"error","severity":"ERROR","code":"42703","position":"37","file":"parse_target.c","line":"1073","routine":"checkInsertTargets"}],"failureMessages":["error: column \"password\" of relation \"users\" does not exist\n    at C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\pg-pool\\index.js:45:11\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at Object.<anonymous> (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\integration\\expenses.test.js:19:24)"],"fullName":"费用管理API测试 POST /api/expenses 应该在未提供认证令牌时返回401","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该在未提供认证令牌时返回401"},{"ancestorTitles":["费用管理API测试","POST /api/expenses"],"duration":0,"failureDetails":[{"length":126,"name":"error","severity":"ERROR","code":"42703","position":"37","file":"parse_target.c","line":"1073","routine":"checkInsertTargets"}],"failureMessages":["error: column \"password\" of relation \"users\" does not exist\n    at C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\pg-pool\\index.js:45:11\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at Object.<anonymous> (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\integration\\expenses.test.js:19:24)"],"fullName":"费用管理API测试 POST /api/expenses 应该在缺少必填字段时返回400","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该在缺少必填字段时返回400"},{"ancestorTitles":["费用管理API测试","GET /api/expenses"],"duration":0,"failureDetails":[{"length":126,"name":"error","severity":"ERROR","code":"42703","position":"37","file":"parse_target.c","line":"1073","routine":"checkInsertTargets"}],"failureMessages":["error: column \"password\" of relation \"users\" does not exist\n    at C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\pg-pool\\index.js:45:11\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at Object.<anonymous> (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\integration\\expenses.test.js:19:24)"],"fullName":"费用管理API测试 GET /api/expenses 应该成功获取费用列表","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该成功获取费用列表"},{"ancestorTitles":["费用管理API测试","GET /api/expenses"],"duration":0,"failureDetails":[{"length":126,"name":"error","severity":"ERROR","code":"42703","position":"37","file":"parse_target.c","line":"1073","routine":"checkInsertTargets"}],"failureMessages":["error: column \"password\" of relation \"users\" does not exist\n    at C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\pg-pool\\index.js:45:11\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at Object.<anonymous> (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\integration\\expenses.test.js:19:24)"],"fullName":"费用管理API测试 GET /api/expenses 应该支持按寝室筛选费用","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该支持按寝室筛选费用"},{"ancestorTitles":["费用管理API测试","GET /api/expenses/:id"],"duration":0,"failureDetails":[{"length":126,"name":"error","severity":"ERROR","code":"42703","position":"37","file":"parse_target.c","line":"1073","routine":"checkInsertTargets"}],"failureMessages":["error: column \"password\" of relation \"users\" does not exist\n    at C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\pg-pool\\index.js:45:11\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at Object.<anonymous> (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\integration\\expenses.test.js:19:24)"],"fullName":"费用管理API测试 GET /api/expenses/:id 应该成功获取特定费用详情","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该成功获取特定费用详情"},{"ancestorTitles":["费用管理API测试","GET /api/expenses/:id"],"duration":0,"failureDetails":[{"length":126,"name":"error","severity":"ERROR","code":"42703","position":"37","file":"parse_target.c","line":"1073","routine":"checkInsertTargets"}],"failureMessages":["error: column \"password\" of relation \"users\" does not exist\n    at C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\pg-pool\\index.js:45:11\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at Object.<anonymous> (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\integration\\expenses.test.js:19:24)"],"fullName":"费用管理API测试 GET /api/expenses/:id 应该在费用不存在时返回404","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该在费用不存在时返回404"},{"ancestorTitles":["费用管理API测试","PUT /api/expenses/:id"],"duration":0,"failureDetails":[{"length":126,"name":"error","severity":"ERROR","code":"42703","position":"37","file":"parse_target.c","line":"1073","routine":"checkInsertTargets"}],"failureMessages":["error: column \"password\" of relation \"users\" does not exist\n    at C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\pg-pool\\index.js:45:11\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at Object.<anonymous> (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\integration\\expenses.test.js:19:24)"],"fullName":"费用管理API测试 PUT /api/expenses/:id 应该成功更新费用记录","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该成功更新费用记录"},{"ancestorTitles":["费用管理API测试","PUT /api/expenses/:id"],"duration":0,"failureDetails":[{"length":126,"name":"error","severity":"ERROR","code":"42703","position":"37","file":"parse_target.c","line":"1073","routine":"checkInsertTargets"}],"failureMessages":["error: column \"password\" of relation \"users\" does not exist\n    at C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\pg-pool\\index.js:45:11\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at Object.<anonymous> (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\integration\\expenses.test.js:19:24)"],"fullName":"费用管理API测试 PUT /api/expenses/:id 应该在费用不存在时返回404","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该在费用不存在时返回404"},{"ancestorTitles":["费用管理API测试","POST /api/expenses/:id/confirm-split"],"duration":0,"failureDetails":[{"length":126,"name":"error","severity":"ERROR","code":"42703","position":"37","file":"parse_target.c","line":"1073","routine":"checkInsertTargets"}],"failureMessages":["error: column \"password\" of relation \"users\" does not exist\n    at C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\pg-pool\\index.js:45:11\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at Object.<anonymous> (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\integration\\expenses.test.js:19:24)"],"fullName":"费用管理API测试 POST /api/expenses/:id/confirm-split 应该成功确认分摊支付","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该成功确认分摊支付"},{"ancestorTitles":["费用管理API测试","POST /api/expenses/:id/confirm-split"],"duration":0,"failureDetails":[{"length":126,"name":"error","severity":"ERROR","code":"42703","position":"37","file":"parse_target.c","line":"1073","routine":"checkInsertTargets"}],"failureMessages":["error: column \"password\" of relation \"users\" does not exist\n    at C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\pg-pool\\index.js:45:11\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at Object.<anonymous> (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\integration\\expenses.test.js:19:24)"],"fullName":"费用管理API测试 POST /api/expenses/:id/confirm-split 应该在分摊ID不存在时返回400","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该在分摊ID不存在时返回400"},{"ancestorTitles":["费用管理API测试","DELETE /api/expenses/:id"],"duration":0,"failureDetails":[{"length":126,"name":"error","severity":"ERROR","code":"42703","position":"37","file":"parse_target.c","line":"1073","routine":"checkInsertTargets"}],"failureMessages":["error: column \"password\" of relation \"users\" does not exist\n    at C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\pg-pool\\index.js:45:11\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at Object.<anonymous> (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\integration\\expenses.test.js:19:24)"],"fullName":"费用管理API测试 DELETE /api/expenses/:id 应该成功删除费用记录","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该成功删除费用记录"},{"ancestorTitles":["费用管理API测试","DELETE /api/expenses/:id"],"duration":0,"failureDetails":[{"length":126,"name":"error","severity":"ERROR","code":"42703","position":"37","file":"parse_target.c","line":"1073","routine":"checkInsertTargets"}],"failureMessages":["error: column \"password\" of relation \"users\" does not exist\n    at C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\pg-pool\\index.js:45:11\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at Object.<anonymous> (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\integration\\expenses.test.js:19:24)"],"fullName":"费用管理API测试 DELETE /api/expenses/:id 应该在费用不存在时返回404","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该在费用不存在时返回404"}],"endTime":1762159268797,"message":"\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m费用管理API测试 › POST /api/expenses › 应该成功创建费用记录\u001b[39m\u001b[22m\n\n    error: column \"password\" of relation \"users\" does not exist\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 17 |\u001b[39m   beforeAll(\u001b[36masync\u001b[39m () \u001b[33m=>\u001b[39m {\u001b[22m\n\u001b[2m     \u001b[90m 18 |\u001b[39m     \u001b[90m// 创建测试用户\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 19 |\u001b[39m     \u001b[36mconst\u001b[39m userResult \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m pool\u001b[33m.\u001b[39mquery(\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m                        \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 20 |\u001b[39m       \u001b[32m'INSERT INTO users (username, email, password, role) VALUES ($1, $2, $3, $4) RETURNING *'\u001b[39m\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 21 |\u001b[39m       [\u001b[32m'testuser'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'test@example.com'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'password123'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'user'\u001b[39m]\u001b[22m\n\u001b[2m     \u001b[90m 22 |\u001b[39m     )\u001b[33m;\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat \u001b[22m\u001b[2mnode_modules/pg-pool/index.js\u001b[2m:45:11\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous> (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/integration/expenses.test.js\u001b[39m\u001b[0m\u001b[2m:19:24)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m费用管理API测试 › POST /api/expenses › 应该在未提供认证令牌时返回401\u001b[39m\u001b[22m\n\n    error: column \"password\" of relation \"users\" does not exist\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 17 |\u001b[39m   beforeAll(\u001b[36masync\u001b[39m () \u001b[33m=>\u001b[39m {\u001b[22m\n\u001b[2m     \u001b[90m 18 |\u001b[39m     \u001b[90m// 创建测试用户\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 19 |\u001b[39m     \u001b[36mconst\u001b[39m userResult \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m pool\u001b[33m.\u001b[39mquery(\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m                        \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 20 |\u001b[39m       \u001b[32m'INSERT INTO users (username, email, password, role) VALUES ($1, $2, $3, $4) RETURNING *'\u001b[39m\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 21 |\u001b[39m       [\u001b[32m'testuser'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'test@example.com'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'password123'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'user'\u001b[39m]\u001b[22m\n\u001b[2m     \u001b[90m 22 |\u001b[39m     )\u001b[33m;\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat \u001b[22m\u001b[2mnode_modules/pg-pool/index.js\u001b[2m:45:11\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous> (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/integration/expenses.test.js\u001b[39m\u001b[0m\u001b[2m:19:24)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m费用管理API测试 › POST /api/expenses › 应该在缺少必填字段时返回400\u001b[39m\u001b[22m\n\n    error: column \"password\" of relation \"users\" does not exist\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 17 |\u001b[39m   beforeAll(\u001b[36masync\u001b[39m () \u001b[33m=>\u001b[39m {\u001b[22m\n\u001b[2m     \u001b[90m 18 |\u001b[39m     \u001b[90m// 创建测试用户\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 19 |\u001b[39m     \u001b[36mconst\u001b[39m userResult \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m pool\u001b[33m.\u001b[39mquery(\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m                        \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 20 |\u001b[39m       \u001b[32m'INSERT INTO users (username, email, password, role) VALUES ($1, $2, $3, $4) RETURNING *'\u001b[39m\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 21 |\u001b[39m       [\u001b[32m'testuser'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'test@example.com'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'password123'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'user'\u001b[39m]\u001b[22m\n\u001b[2m     \u001b[90m 22 |\u001b[39m     )\u001b[33m;\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat \u001b[22m\u001b[2mnode_modules/pg-pool/index.js\u001b[2m:45:11\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous> (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/integration/expenses.test.js\u001b[39m\u001b[0m\u001b[2m:19:24)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m费用管理API测试 › GET /api/expenses › 应该成功获取费用列表\u001b[39m\u001b[22m\n\n    error: column \"password\" of relation \"users\" does not exist\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 17 |\u001b[39m   beforeAll(\u001b[36masync\u001b[39m () \u001b[33m=>\u001b[39m {\u001b[22m\n\u001b[2m     \u001b[90m 18 |\u001b[39m     \u001b[90m// 创建测试用户\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 19 |\u001b[39m     \u001b[36mconst\u001b[39m userResult \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m pool\u001b[33m.\u001b[39mquery(\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m                        \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 20 |\u001b[39m       \u001b[32m'INSERT INTO users (username, email, password, role) VALUES ($1, $2, $3, $4) RETURNING *'\u001b[39m\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 21 |\u001b[39m       [\u001b[32m'testuser'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'test@example.com'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'password123'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'user'\u001b[39m]\u001b[22m\n\u001b[2m     \u001b[90m 22 |\u001b[39m     )\u001b[33m;\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat \u001b[22m\u001b[2mnode_modules/pg-pool/index.js\u001b[2m:45:11\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous> (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/integration/expenses.test.js\u001b[39m\u001b[0m\u001b[2m:19:24)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m费用管理API测试 › GET /api/expenses › 应该支持按寝室筛选费用\u001b[39m\u001b[22m\n\n    error: column \"password\" of relation \"users\" does not exist\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 17 |\u001b[39m   beforeAll(\u001b[36masync\u001b[39m () \u001b[33m=>\u001b[39m {\u001b[22m\n\u001b[2m     \u001b[90m 18 |\u001b[39m     \u001b[90m// 创建测试用户\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 19 |\u001b[39m     \u001b[36mconst\u001b[39m userResult \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m pool\u001b[33m.\u001b[39mquery(\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m                        \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 20 |\u001b[39m       \u001b[32m'INSERT INTO users (username, email, password, role) VALUES ($1, $2, $3, $4) RETURNING *'\u001b[39m\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 21 |\u001b[39m       [\u001b[32m'testuser'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'test@example.com'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'password123'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'user'\u001b[39m]\u001b[22m\n\u001b[2m     \u001b[90m 22 |\u001b[39m     )\u001b[33m;\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat \u001b[22m\u001b[2mnode_modules/pg-pool/index.js\u001b[2m:45:11\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous> (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/integration/expenses.test.js\u001b[39m\u001b[0m\u001b[2m:19:24)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m费用管理API测试 › GET /api/expenses/:id › 应该成功获取特定费用详情\u001b[39m\u001b[22m\n\n    error: column \"password\" of relation \"users\" does not exist\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 17 |\u001b[39m   beforeAll(\u001b[36masync\u001b[39m () \u001b[33m=>\u001b[39m {\u001b[22m\n\u001b[2m     \u001b[90m 18 |\u001b[39m     \u001b[90m// 创建测试用户\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 19 |\u001b[39m     \u001b[36mconst\u001b[39m userResult \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m pool\u001b[33m.\u001b[39mquery(\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m                        \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 20 |\u001b[39m       \u001b[32m'INSERT INTO users (username, email, password, role) VALUES ($1, $2, $3, $4) RETURNING *'\u001b[39m\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 21 |\u001b[39m       [\u001b[32m'testuser'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'test@example.com'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'password123'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'user'\u001b[39m]\u001b[22m\n\u001b[2m     \u001b[90m 22 |\u001b[39m     )\u001b[33m;\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat \u001b[22m\u001b[2mnode_modules/pg-pool/index.js\u001b[2m:45:11\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous> (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/integration/expenses.test.js\u001b[39m\u001b[0m\u001b[2m:19:24)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m费用管理API测试 › GET /api/expenses/:id › 应该在费用不存在时返回404\u001b[39m\u001b[22m\n\n    error: column \"password\" of relation \"users\" does not exist\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 17 |\u001b[39m   beforeAll(\u001b[36masync\u001b[39m () \u001b[33m=>\u001b[39m {\u001b[22m\n\u001b[2m     \u001b[90m 18 |\u001b[39m     \u001b[90m// 创建测试用户\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 19 |\u001b[39m     \u001b[36mconst\u001b[39m userResult \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m pool\u001b[33m.\u001b[39mquery(\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m                        \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 20 |\u001b[39m       \u001b[32m'INSERT INTO users (username, email, password, role) VALUES ($1, $2, $3, $4) RETURNING *'\u001b[39m\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 21 |\u001b[39m       [\u001b[32m'testuser'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'test@example.com'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'password123'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'user'\u001b[39m]\u001b[22m\n\u001b[2m     \u001b[90m 22 |\u001b[39m     )\u001b[33m;\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat \u001b[22m\u001b[2mnode_modules/pg-pool/index.js\u001b[2m:45:11\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous> (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/integration/expenses.test.js\u001b[39m\u001b[0m\u001b[2m:19:24)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m费用管理API测试 › PUT /api/expenses/:id › 应该成功更新费用记录\u001b[39m\u001b[22m\n\n    error: column \"password\" of relation \"users\" does not exist\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 17 |\u001b[39m   beforeAll(\u001b[36masync\u001b[39m () \u001b[33m=>\u001b[39m {\u001b[22m\n\u001b[2m     \u001b[90m 18 |\u001b[39m     \u001b[90m// 创建测试用户\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 19 |\u001b[39m     \u001b[36mconst\u001b[39m userResult \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m pool\u001b[33m.\u001b[39mquery(\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m                        \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 20 |\u001b[39m       \u001b[32m'INSERT INTO users (username, email, password, role) VALUES ($1, $2, $3, $4) RETURNING *'\u001b[39m\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 21 |\u001b[39m       [\u001b[32m'testuser'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'test@example.com'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'password123'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'user'\u001b[39m]\u001b[22m\n\u001b[2m     \u001b[90m 22 |\u001b[39m     )\u001b[33m;\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat \u001b[22m\u001b[2mnode_modules/pg-pool/index.js\u001b[2m:45:11\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous> (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/integration/expenses.test.js\u001b[39m\u001b[0m\u001b[2m:19:24)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m费用管理API测试 › PUT /api/expenses/:id › 应该在费用不存在时返回404\u001b[39m\u001b[22m\n\n    error: column \"password\" of relation \"users\" does not exist\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 17 |\u001b[39m   beforeAll(\u001b[36masync\u001b[39m () \u001b[33m=>\u001b[39m {\u001b[22m\n\u001b[2m     \u001b[90m 18 |\u001b[39m     \u001b[90m// 创建测试用户\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 19 |\u001b[39m     \u001b[36mconst\u001b[39m userResult \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m pool\u001b[33m.\u001b[39mquery(\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m                        \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 20 |\u001b[39m       \u001b[32m'INSERT INTO users (username, email, password, role) VALUES ($1, $2, $3, $4) RETURNING *'\u001b[39m\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 21 |\u001b[39m       [\u001b[32m'testuser'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'test@example.com'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'password123'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'user'\u001b[39m]\u001b[22m\n\u001b[2m     \u001b[90m 22 |\u001b[39m     )\u001b[33m;\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat \u001b[22m\u001b[2mnode_modules/pg-pool/index.js\u001b[2m:45:11\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous> (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/integration/expenses.test.js\u001b[39m\u001b[0m\u001b[2m:19:24)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m费用管理API测试 › POST /api/expenses/:id/confirm-split › 应该成功确认分摊支付\u001b[39m\u001b[22m\n\n    error: column \"password\" of relation \"users\" does not exist\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 17 |\u001b[39m   beforeAll(\u001b[36masync\u001b[39m () \u001b[33m=>\u001b[39m {\u001b[22m\n\u001b[2m     \u001b[90m 18 |\u001b[39m     \u001b[90m// 创建测试用户\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 19 |\u001b[39m     \u001b[36mconst\u001b[39m userResult \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m pool\u001b[33m.\u001b[39mquery(\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m                        \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 20 |\u001b[39m       \u001b[32m'INSERT INTO users (username, email, password, role) VALUES ($1, $2, $3, $4) RETURNING *'\u001b[39m\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 21 |\u001b[39m       [\u001b[32m'testuser'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'test@example.com'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'password123'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'user'\u001b[39m]\u001b[22m\n\u001b[2m     \u001b[90m 22 |\u001b[39m     )\u001b[33m;\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat \u001b[22m\u001b[2mnode_modules/pg-pool/index.js\u001b[2m:45:11\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous> (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/integration/expenses.test.js\u001b[39m\u001b[0m\u001b[2m:19:24)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m费用管理API测试 › POST /api/expenses/:id/confirm-split › 应该在分摊ID不存在时返回400\u001b[39m\u001b[22m\n\n    error: column \"password\" of relation \"users\" does not exist\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 17 |\u001b[39m   beforeAll(\u001b[36masync\u001b[39m () \u001b[33m=>\u001b[39m {\u001b[22m\n\u001b[2m     \u001b[90m 18 |\u001b[39m     \u001b[90m// 创建测试用户\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 19 |\u001b[39m     \u001b[36mconst\u001b[39m userResult \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m pool\u001b[33m.\u001b[39mquery(\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m                        \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 20 |\u001b[39m       \u001b[32m'INSERT INTO users (username, email, password, role) VALUES ($1, $2, $3, $4) RETURNING *'\u001b[39m\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 21 |\u001b[39m       [\u001b[32m'testuser'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'test@example.com'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'password123'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'user'\u001b[39m]\u001b[22m\n\u001b[2m     \u001b[90m 22 |\u001b[39m     )\u001b[33m;\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat \u001b[22m\u001b[2mnode_modules/pg-pool/index.js\u001b[2m:45:11\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous> (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/integration/expenses.test.js\u001b[39m\u001b[0m\u001b[2m:19:24)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m费用管理API测试 › DELETE /api/expenses/:id › 应该成功删除费用记录\u001b[39m\u001b[22m\n\n    error: column \"password\" of relation \"users\" does not exist\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 17 |\u001b[39m   beforeAll(\u001b[36masync\u001b[39m () \u001b[33m=>\u001b[39m {\u001b[22m\n\u001b[2m     \u001b[90m 18 |\u001b[39m     \u001b[90m// 创建测试用户\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 19 |\u001b[39m     \u001b[36mconst\u001b[39m userResult \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m pool\u001b[33m.\u001b[39mquery(\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m                        \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 20 |\u001b[39m       \u001b[32m'INSERT INTO users (username, email, password, role) VALUES ($1, $2, $3, $4) RETURNING *'\u001b[39m\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 21 |\u001b[39m       [\u001b[32m'testuser'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'test@example.com'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'password123'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'user'\u001b[39m]\u001b[22m\n\u001b[2m     \u001b[90m 22 |\u001b[39m     )\u001b[33m;\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat \u001b[22m\u001b[2mnode_modules/pg-pool/index.js\u001b[2m:45:11\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous> (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/integration/expenses.test.js\u001b[39m\u001b[0m\u001b[2m:19:24)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m费用管理API测试 › DELETE /api/expenses/:id › 应该在费用不存在时返回404\u001b[39m\u001b[22m\n\n    error: column \"password\" of relation \"users\" does not exist\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 17 |\u001b[39m   beforeAll(\u001b[36masync\u001b[39m () \u001b[33m=>\u001b[39m {\u001b[22m\n\u001b[2m     \u001b[90m 18 |\u001b[39m     \u001b[90m// 创建测试用户\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 19 |\u001b[39m     \u001b[36mconst\u001b[39m userResult \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m pool\u001b[33m.\u001b[39mquery(\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m                        \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 20 |\u001b[39m       \u001b[32m'INSERT INTO users (username, email, password, role) VALUES ($1, $2, $3, $4) RETURNING *'\u001b[39m\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 21 |\u001b[39m       [\u001b[32m'testuser'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'test@example.com'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'password123'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'user'\u001b[39m]\u001b[22m\n\u001b[2m     \u001b[90m 22 |\u001b[39m     )\u001b[33m;\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat \u001b[22m\u001b[2mnode_modules/pg-pool/index.js\u001b[2m:45:11\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous> (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/integration/expenses.test.js\u001b[39m\u001b[0m\u001b[2m:19:24)\u001b[22m\u001b[2m\u001b[22m\n","name":"C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\integration\\expenses.test.js","startTime":1762159268084,"status":"failed","summary":""},{"assertionResults":[{"ancestorTitles":["统计控制器集成测试","GET /api/stats/user"],"duration":0,"failureDetails":[{"length":107,"name":"error","severity":"ERROR","code":"42703","position":"28","file":"parse_relation.c","line":"3827","routine":"errorMissingColumn"}],"failureMessages":["error: column \"bill_id\" does not exist\n    at C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\pg-pool\\index.js:45:11\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at Object.<anonymous> (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\integration\\stats.test.js:22:5)"],"fullName":"统计控制器集成测试 GET /api/stats/user 应该成功获取用户统计信息","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该成功获取用户统计信息"},{"ancestorTitles":["统计控制器集成测试","GET /api/stats/user"],"duration":0,"failureDetails":[{"length":107,"name":"error","severity":"ERROR","code":"42703","position":"28","file":"parse_relation.c","line":"3827","routine":"errorMissingColumn"}],"failureMessages":["error: column \"bill_id\" does not exist\n    at C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\pg-pool\\index.js:45:11\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at Object.<anonymous> (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\integration\\stats.test.js:22:5)"],"fullName":"统计控制器集成测试 GET /api/stats/user 应该在未认证时返回401错误","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该在未认证时返回401错误"},{"ancestorTitles":["统计控制器集成测试","GET /api/stats/user"],"duration":0,"failureDetails":[{"length":107,"name":"error","severity":"ERROR","code":"42703","position":"28","file":"parse_relation.c","line":"3827","routine":"errorMissingColumn"}],"failureMessages":["error: column \"bill_id\" does not exist\n    at C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\pg-pool\\index.js:45:11\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at Object.<anonymous> (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\integration\\stats.test.js:22:5)"],"fullName":"统计控制器集成测试 GET /api/stats/user 应该在缺少日期参数时返回400错误","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该在缺少日期参数时返回400错误"},{"ancestorTitles":["统计控制器集成测试","GET /api/stats/expense-types"],"duration":0,"failureDetails":[{"length":107,"name":"error","severity":"ERROR","code":"42703","position":"28","file":"parse_relation.c","line":"3827","routine":"errorMissingColumn"}],"failureMessages":["error: column \"bill_id\" does not exist\n    at C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\pg-pool\\index.js:45:11\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at Object.<anonymous> (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\integration\\stats.test.js:22:5)"],"fullName":"统计控制器集成测试 GET /api/stats/expense-types 应该成功获取费用类型分布","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该成功获取费用类型分布"},{"ancestorTitles":["统计控制器集成测试","GET /api/stats/expense-types"],"duration":0,"failureDetails":[{"length":107,"name":"error","severity":"ERROR","code":"42703","position":"28","file":"parse_relation.c","line":"3827","routine":"errorMissingColumn"}],"failureMessages":["error: column \"bill_id\" does not exist\n    at C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\pg-pool\\index.js:45:11\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at Object.<anonymous> (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\integration\\stats.test.js:22:5)"],"fullName":"统计控制器集成测试 GET /api/stats/expense-types 应该在未认证时返回401错误","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该在未认证时返回401错误"},{"ancestorTitles":["统计控制器集成测试","GET /api/stats/daily-trend"],"duration":0,"failureDetails":[{"length":107,"name":"error","severity":"ERROR","code":"42703","position":"28","file":"parse_relation.c","line":"3827","routine":"errorMissingColumn"}],"failureMessages":["error: column \"bill_id\" does not exist\n    at C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\pg-pool\\index.js:45:11\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at Object.<anonymous> (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\integration\\stats.test.js:22:5)"],"fullName":"统计控制器集成测试 GET /api/stats/daily-trend 应该成功获取每日费用趋势","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该成功获取每日费用趋势"},{"ancestorTitles":["统计控制器集成测试","GET /api/stats/daily-trend"],"duration":0,"failureDetails":[{"length":107,"name":"error","severity":"ERROR","code":"42703","position":"28","file":"parse_relation.c","line":"3827","routine":"errorMissingColumn"}],"failureMessages":["error: column \"bill_id\" does not exist\n    at C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\pg-pool\\index.js:45:11\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at Object.<anonymous> (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\integration\\stats.test.js:22:5)"],"fullName":"统计控制器集成测试 GET /api/stats/daily-trend 应该在日期范围过大时返回400错误","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该在日期范围过大时返回400错误"},{"ancestorTitles":["统计控制器集成测试","GET /api/stats/monthly-trend"],"duration":1,"failureDetails":[{"length":107,"name":"error","severity":"ERROR","code":"42703","position":"28","file":"parse_relation.c","line":"3827","routine":"errorMissingColumn"}],"failureMessages":["error: column \"bill_id\" does not exist\n    at C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\pg-pool\\index.js:45:11\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at Object.<anonymous> (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\integration\\stats.test.js:22:5)"],"fullName":"统计控制器集成测试 GET /api/stats/monthly-trend 应该成功获取每月费用趋势","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该成功获取每月费用趋势"},{"ancestorTitles":["统计控制器集成测试","GET /api/stats/monthly-trend"],"duration":0,"failureDetails":[{"length":107,"name":"error","severity":"ERROR","code":"42703","position":"28","file":"parse_relation.c","line":"3827","routine":"errorMissingColumn"}],"failureMessages":["error: column \"bill_id\" does not exist\n    at C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\pg-pool\\index.js:45:11\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at Object.<anonymous> (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\integration\\stats.test.js:22:5)"],"fullName":"统计控制器集成测试 GET /api/stats/monthly-trend 应该在日期范围过大时返回400错误","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该在日期范围过大时返回400错误"},{"ancestorTitles":["统计控制器集成测试","GET /api/stats/room/:roomId"],"duration":0,"failureDetails":[{"length":107,"name":"error","severity":"ERROR","code":"42703","position":"28","file":"parse_relation.c","line":"3827","routine":"errorMissingColumn"}],"failureMessages":["error: column \"bill_id\" does not exist\n    at C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\pg-pool\\index.js:45:11\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at Object.<anonymous> (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\integration\\stats.test.js:22:5)"],"fullName":"统计控制器集成测试 GET /api/stats/room/:roomId 应该成功获取寝室统计信息","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该成功获取寝室统计信息"},{"ancestorTitles":["统计控制器集成测试","GET /api/stats/room/:roomId"],"duration":0,"failureDetails":[{"length":107,"name":"error","severity":"ERROR","code":"42703","position":"28","file":"parse_relation.c","line":"3827","routine":"errorMissingColumn"}],"failureMessages":["error: column \"bill_id\" does not exist\n    at C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\pg-pool\\index.js:45:11\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at Object.<anonymous> (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\integration\\stats.test.js:22:5)"],"fullName":"统计控制器集成测试 GET /api/stats/room/:roomId 应该在用户不是寝室成员时返回403错误","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该在用户不是寝室成员时返回403错误"},{"ancestorTitles":["统计控制器集成测试","GET /api/stats/room/:roomId/expense-types"],"duration":0,"failureDetails":[{"length":107,"name":"error","severity":"ERROR","code":"42703","position":"28","file":"parse_relation.c","line":"3827","routine":"errorMissingColumn"}],"failureMessages":["error: column \"bill_id\" does not exist\n    at C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\pg-pool\\index.js:45:11\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at Object.<anonymous> (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\integration\\stats.test.js:22:5)"],"fullName":"统计控制器集成测试 GET /api/stats/room/:roomId/expense-types 应该成功获取寝室费用类型分布","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该成功获取寝室费用类型分布"},{"ancestorTitles":["统计控制器集成测试","GET /api/stats/room/:roomId/monthly-trend"],"duration":0,"failureDetails":[{"length":107,"name":"error","severity":"ERROR","code":"42703","position":"28","file":"parse_relation.c","line":"3827","routine":"errorMissingColumn"}],"failureMessages":["error: column \"bill_id\" does not exist\n    at C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\pg-pool\\index.js:45:11\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at Object.<anonymous> (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\integration\\stats.test.js:22:5)"],"fullName":"统计控制器集成测试 GET /api/stats/room/:roomId/monthly-trend 应该成功获取寝室每月费用趋势","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该成功获取寝室每月费用趋势"}],"coverage":{},"endTime":1762159288876,"message":"\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m统计控制器集成测试 › GET /api/stats/user › 应该成功获取用户统计信息\u001b[39m\u001b[22m\n\n    error: column \"bill_id\" does not exist\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 20 |\u001b[39m     \u001b[22m\n\u001b[2m     \u001b[90m 21 |\u001b[39m     \u001b[90m// 清理测试数据\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 22 |\u001b[39m     \u001b[36mawait\u001b[39m pool\u001b[33m.\u001b[39mquery(\u001b[32m'DELETE FROM expenses WHERE bill_id IN (SELECT id FROM bills WHERE created_by = $1)'\u001b[39m\u001b[33m,\u001b[39m [\u001b[35m1\u001b[39m])\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m     \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 23 |\u001b[39m     \u001b[36mawait\u001b[39m pool\u001b[33m.\u001b[39mquery(\u001b[32m'DELETE FROM bill_participants WHERE bill_id IN (SELECT id FROM bills WHERE created_by = $1)'\u001b[39m\u001b[33m,\u001b[39m [\u001b[35m1\u001b[39m])\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 24 |\u001b[39m     \u001b[36mawait\u001b[39m pool\u001b[33m.\u001b[39mquery(\u001b[32m'DELETE FROM bills WHERE created_by = $1'\u001b[39m\u001b[33m,\u001b[39m [\u001b[35m1\u001b[39m])\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 25 |\u001b[39m     \u001b[36mawait\u001b[39m pool\u001b[33m.\u001b[39mquery(\u001b[32m'DELETE FROM room_members WHERE user_id = $1'\u001b[39m\u001b[33m,\u001b[39m [\u001b[35m1\u001b[39m])\u001b[33m;\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat \u001b[22m\u001b[2mnode_modules/pg-pool/index.js\u001b[2m:45:11\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous> (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/integration/stats.test.js\u001b[39m\u001b[0m\u001b[2m:22:5)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m统计控制器集成测试 › GET /api/stats/user › 应该在未认证时返回401错误\u001b[39m\u001b[22m\n\n    error: column \"bill_id\" does not exist\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 20 |\u001b[39m     \u001b[22m\n\u001b[2m     \u001b[90m 21 |\u001b[39m     \u001b[90m// 清理测试数据\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 22 |\u001b[39m     \u001b[36mawait\u001b[39m pool\u001b[33m.\u001b[39mquery(\u001b[32m'DELETE FROM expenses WHERE bill_id IN (SELECT id FROM bills WHERE created_by = $1)'\u001b[39m\u001b[33m,\u001b[39m [\u001b[35m1\u001b[39m])\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m     \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 23 |\u001b[39m     \u001b[36mawait\u001b[39m pool\u001b[33m.\u001b[39mquery(\u001b[32m'DELETE FROM bill_participants WHERE bill_id IN (SELECT id FROM bills WHERE created_by = $1)'\u001b[39m\u001b[33m,\u001b[39m [\u001b[35m1\u001b[39m])\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 24 |\u001b[39m     \u001b[36mawait\u001b[39m pool\u001b[33m.\u001b[39mquery(\u001b[32m'DELETE FROM bills WHERE created_by = $1'\u001b[39m\u001b[33m,\u001b[39m [\u001b[35m1\u001b[39m])\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 25 |\u001b[39m     \u001b[36mawait\u001b[39m pool\u001b[33m.\u001b[39mquery(\u001b[32m'DELETE FROM room_members WHERE user_id = $1'\u001b[39m\u001b[33m,\u001b[39m [\u001b[35m1\u001b[39m])\u001b[33m;\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat \u001b[22m\u001b[2mnode_modules/pg-pool/index.js\u001b[2m:45:11\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous> (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/integration/stats.test.js\u001b[39m\u001b[0m\u001b[2m:22:5)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m统计控制器集成测试 › GET /api/stats/user › 应该在缺少日期参数时返回400错误\u001b[39m\u001b[22m\n\n    error: column \"bill_id\" does not exist\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 20 |\u001b[39m     \u001b[22m\n\u001b[2m     \u001b[90m 21 |\u001b[39m     \u001b[90m// 清理测试数据\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 22 |\u001b[39m     \u001b[36mawait\u001b[39m pool\u001b[33m.\u001b[39mquery(\u001b[32m'DELETE FROM expenses WHERE bill_id IN (SELECT id FROM bills WHERE created_by = $1)'\u001b[39m\u001b[33m,\u001b[39m [\u001b[35m1\u001b[39m])\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m     \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 23 |\u001b[39m     \u001b[36mawait\u001b[39m pool\u001b[33m.\u001b[39mquery(\u001b[32m'DELETE FROM bill_participants WHERE bill_id IN (SELECT id FROM bills WHERE created_by = $1)'\u001b[39m\u001b[33m,\u001b[39m [\u001b[35m1\u001b[39m])\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 24 |\u001b[39m     \u001b[36mawait\u001b[39m pool\u001b[33m.\u001b[39mquery(\u001b[32m'DELETE FROM bills WHERE created_by = $1'\u001b[39m\u001b[33m,\u001b[39m [\u001b[35m1\u001b[39m])\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 25 |\u001b[39m     \u001b[36mawait\u001b[39m pool\u001b[33m.\u001b[39mquery(\u001b[32m'DELETE FROM room_members WHERE user_id = $1'\u001b[39m\u001b[33m,\u001b[39m [\u001b[35m1\u001b[39m])\u001b[33m;\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat \u001b[22m\u001b[2mnode_modules/pg-pool/index.js\u001b[2m:45:11\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous> (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/integration/stats.test.js\u001b[39m\u001b[0m\u001b[2m:22:5)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m统计控制器集成测试 › GET /api/stats/expense-types › 应该成功获取费用类型分布\u001b[39m\u001b[22m\n\n    error: column \"bill_id\" does not exist\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 20 |\u001b[39m     \u001b[22m\n\u001b[2m     \u001b[90m 21 |\u001b[39m     \u001b[90m// 清理测试数据\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 22 |\u001b[39m     \u001b[36mawait\u001b[39m pool\u001b[33m.\u001b[39mquery(\u001b[32m'DELETE FROM expenses WHERE bill_id IN (SELECT id FROM bills WHERE created_by = $1)'\u001b[39m\u001b[33m,\u001b[39m [\u001b[35m1\u001b[39m])\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m     \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 23 |\u001b[39m     \u001b[36mawait\u001b[39m pool\u001b[33m.\u001b[39mquery(\u001b[32m'DELETE FROM bill_participants WHERE bill_id IN (SELECT id FROM bills WHERE created_by = $1)'\u001b[39m\u001b[33m,\u001b[39m [\u001b[35m1\u001b[39m])\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 24 |\u001b[39m     \u001b[36mawait\u001b[39m pool\u001b[33m.\u001b[39mquery(\u001b[32m'DELETE FROM bills WHERE created_by = $1'\u001b[39m\u001b[33m,\u001b[39m [\u001b[35m1\u001b[39m])\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 25 |\u001b[39m     \u001b[36mawait\u001b[39m pool\u001b[33m.\u001b[39mquery(\u001b[32m'DELETE FROM room_members WHERE user_id = $1'\u001b[39m\u001b[33m,\u001b[39m [\u001b[35m1\u001b[39m])\u001b[33m;\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat \u001b[22m\u001b[2mnode_modules/pg-pool/index.js\u001b[2m:45:11\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous> (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/integration/stats.test.js\u001b[39m\u001b[0m\u001b[2m:22:5)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m统计控制器集成测试 › GET /api/stats/expense-types › 应该在未认证时返回401错误\u001b[39m\u001b[22m\n\n    error: column \"bill_id\" does not exist\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 20 |\u001b[39m     \u001b[22m\n\u001b[2m     \u001b[90m 21 |\u001b[39m     \u001b[90m// 清理测试数据\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 22 |\u001b[39m     \u001b[36mawait\u001b[39m pool\u001b[33m.\u001b[39mquery(\u001b[32m'DELETE FROM expenses WHERE bill_id IN (SELECT id FROM bills WHERE created_by = $1)'\u001b[39m\u001b[33m,\u001b[39m [\u001b[35m1\u001b[39m])\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m     \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 23 |\u001b[39m     \u001b[36mawait\u001b[39m pool\u001b[33m.\u001b[39mquery(\u001b[32m'DELETE FROM bill_participants WHERE bill_id IN (SELECT id FROM bills WHERE created_by = $1)'\u001b[39m\u001b[33m,\u001b[39m [\u001b[35m1\u001b[39m])\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 24 |\u001b[39m     \u001b[36mawait\u001b[39m pool\u001b[33m.\u001b[39mquery(\u001b[32m'DELETE FROM bills WHERE created_by = $1'\u001b[39m\u001b[33m,\u001b[39m [\u001b[35m1\u001b[39m])\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 25 |\u001b[39m     \u001b[36mawait\u001b[39m pool\u001b[33m.\u001b[39mquery(\u001b[32m'DELETE FROM room_members WHERE user_id = $1'\u001b[39m\u001b[33m,\u001b[39m [\u001b[35m1\u001b[39m])\u001b[33m;\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat \u001b[22m\u001b[2mnode_modules/pg-pool/index.js\u001b[2m:45:11\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous> (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/integration/stats.test.js\u001b[39m\u001b[0m\u001b[2m:22:5)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m统计控制器集成测试 › GET /api/stats/daily-trend › 应该成功获取每日费用趋势\u001b[39m\u001b[22m\n\n    error: column \"bill_id\" does not exist\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 20 |\u001b[39m     \u001b[22m\n\u001b[2m     \u001b[90m 21 |\u001b[39m     \u001b[90m// 清理测试数据\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 22 |\u001b[39m     \u001b[36mawait\u001b[39m pool\u001b[33m.\u001b[39mquery(\u001b[32m'DELETE FROM expenses WHERE bill_id IN (SELECT id FROM bills WHERE created_by = $1)'\u001b[39m\u001b[33m,\u001b[39m [\u001b[35m1\u001b[39m])\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m     \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 23 |\u001b[39m     \u001b[36mawait\u001b[39m pool\u001b[33m.\u001b[39mquery(\u001b[32m'DELETE FROM bill_participants WHERE bill_id IN (SELECT id FROM bills WHERE created_by = $1)'\u001b[39m\u001b[33m,\u001b[39m [\u001b[35m1\u001b[39m])\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 24 |\u001b[39m     \u001b[36mawait\u001b[39m pool\u001b[33m.\u001b[39mquery(\u001b[32m'DELETE FROM bills WHERE created_by = $1'\u001b[39m\u001b[33m,\u001b[39m [\u001b[35m1\u001b[39m])\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 25 |\u001b[39m     \u001b[36mawait\u001b[39m pool\u001b[33m.\u001b[39mquery(\u001b[32m'DELETE FROM room_members WHERE user_id = $1'\u001b[39m\u001b[33m,\u001b[39m [\u001b[35m1\u001b[39m])\u001b[33m;\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat \u001b[22m\u001b[2mnode_modules/pg-pool/index.js\u001b[2m:45:11\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous> (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/integration/stats.test.js\u001b[39m\u001b[0m\u001b[2m:22:5)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m统计控制器集成测试 › GET /api/stats/daily-trend › 应该在日期范围过大时返回400错误\u001b[39m\u001b[22m\n\n    error: column \"bill_id\" does not exist\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 20 |\u001b[39m     \u001b[22m\n\u001b[2m     \u001b[90m 21 |\u001b[39m     \u001b[90m// 清理测试数据\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 22 |\u001b[39m     \u001b[36mawait\u001b[39m pool\u001b[33m.\u001b[39mquery(\u001b[32m'DELETE FROM expenses WHERE bill_id IN (SELECT id FROM bills WHERE created_by = $1)'\u001b[39m\u001b[33m,\u001b[39m [\u001b[35m1\u001b[39m])\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m     \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 23 |\u001b[39m     \u001b[36mawait\u001b[39m pool\u001b[33m.\u001b[39mquery(\u001b[32m'DELETE FROM bill_participants WHERE bill_id IN (SELECT id FROM bills WHERE created_by = $1)'\u001b[39m\u001b[33m,\u001b[39m [\u001b[35m1\u001b[39m])\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 24 |\u001b[39m     \u001b[36mawait\u001b[39m pool\u001b[33m.\u001b[39mquery(\u001b[32m'DELETE FROM bills WHERE created_by = $1'\u001b[39m\u001b[33m,\u001b[39m [\u001b[35m1\u001b[39m])\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 25 |\u001b[39m     \u001b[36mawait\u001b[39m pool\u001b[33m.\u001b[39mquery(\u001b[32m'DELETE FROM room_members WHERE user_id = $1'\u001b[39m\u001b[33m,\u001b[39m [\u001b[35m1\u001b[39m])\u001b[33m;\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat \u001b[22m\u001b[2mnode_modules/pg-pool/index.js\u001b[2m:45:11\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous> (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/integration/stats.test.js\u001b[39m\u001b[0m\u001b[2m:22:5)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m统计控制器集成测试 › GET /api/stats/monthly-trend › 应该成功获取每月费用趋势\u001b[39m\u001b[22m\n\n    error: column \"bill_id\" does not exist\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 20 |\u001b[39m     \u001b[22m\n\u001b[2m     \u001b[90m 21 |\u001b[39m     \u001b[90m// 清理测试数据\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 22 |\u001b[39m     \u001b[36mawait\u001b[39m pool\u001b[33m.\u001b[39mquery(\u001b[32m'DELETE FROM expenses WHERE bill_id IN (SELECT id FROM bills WHERE created_by = $1)'\u001b[39m\u001b[33m,\u001b[39m [\u001b[35m1\u001b[39m])\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m     \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 23 |\u001b[39m     \u001b[36mawait\u001b[39m pool\u001b[33m.\u001b[39mquery(\u001b[32m'DELETE FROM bill_participants WHERE bill_id IN (SELECT id FROM bills WHERE created_by = $1)'\u001b[39m\u001b[33m,\u001b[39m [\u001b[35m1\u001b[39m])\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 24 |\u001b[39m     \u001b[36mawait\u001b[39m pool\u001b[33m.\u001b[39mquery(\u001b[32m'DELETE FROM bills WHERE created_by = $1'\u001b[39m\u001b[33m,\u001b[39m [\u001b[35m1\u001b[39m])\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 25 |\u001b[39m     \u001b[36mawait\u001b[39m pool\u001b[33m.\u001b[39mquery(\u001b[32m'DELETE FROM room_members WHERE user_id = $1'\u001b[39m\u001b[33m,\u001b[39m [\u001b[35m1\u001b[39m])\u001b[33m;\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat \u001b[22m\u001b[2mnode_modules/pg-pool/index.js\u001b[2m:45:11\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous> (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/integration/stats.test.js\u001b[39m\u001b[0m\u001b[2m:22:5)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m统计控制器集成测试 › GET /api/stats/monthly-trend › 应该在日期范围过大时返回400错误\u001b[39m\u001b[22m\n\n    error: column \"bill_id\" does not exist\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 20 |\u001b[39m     \u001b[22m\n\u001b[2m     \u001b[90m 21 |\u001b[39m     \u001b[90m// 清理测试数据\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 22 |\u001b[39m     \u001b[36mawait\u001b[39m pool\u001b[33m.\u001b[39mquery(\u001b[32m'DELETE FROM expenses WHERE bill_id IN (SELECT id FROM bills WHERE created_by = $1)'\u001b[39m\u001b[33m,\u001b[39m [\u001b[35m1\u001b[39m])\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m     \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 23 |\u001b[39m     \u001b[36mawait\u001b[39m pool\u001b[33m.\u001b[39mquery(\u001b[32m'DELETE FROM bill_participants WHERE bill_id IN (SELECT id FROM bills WHERE created_by = $1)'\u001b[39m\u001b[33m,\u001b[39m [\u001b[35m1\u001b[39m])\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 24 |\u001b[39m     \u001b[36mawait\u001b[39m pool\u001b[33m.\u001b[39mquery(\u001b[32m'DELETE FROM bills WHERE created_by = $1'\u001b[39m\u001b[33m,\u001b[39m [\u001b[35m1\u001b[39m])\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 25 |\u001b[39m     \u001b[36mawait\u001b[39m pool\u001b[33m.\u001b[39mquery(\u001b[32m'DELETE FROM room_members WHERE user_id = $1'\u001b[39m\u001b[33m,\u001b[39m [\u001b[35m1\u001b[39m])\u001b[33m;\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat \u001b[22m\u001b[2mnode_modules/pg-pool/index.js\u001b[2m:45:11\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous> (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/integration/stats.test.js\u001b[39m\u001b[0m\u001b[2m:22:5)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m统计控制器集成测试 › GET /api/stats/room/:roomId › 应该成功获取寝室统计信息\u001b[39m\u001b[22m\n\n    error: column \"bill_id\" does not exist\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 20 |\u001b[39m     \u001b[22m\n\u001b[2m     \u001b[90m 21 |\u001b[39m     \u001b[90m// 清理测试数据\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 22 |\u001b[39m     \u001b[36mawait\u001b[39m pool\u001b[33m.\u001b[39mquery(\u001b[32m'DELETE FROM expenses WHERE bill_id IN (SELECT id FROM bills WHERE created_by = $1)'\u001b[39m\u001b[33m,\u001b[39m [\u001b[35m1\u001b[39m])\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m     \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 23 |\u001b[39m     \u001b[36mawait\u001b[39m pool\u001b[33m.\u001b[39mquery(\u001b[32m'DELETE FROM bill_participants WHERE bill_id IN (SELECT id FROM bills WHERE created_by = $1)'\u001b[39m\u001b[33m,\u001b[39m [\u001b[35m1\u001b[39m])\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 24 |\u001b[39m     \u001b[36mawait\u001b[39m pool\u001b[33m.\u001b[39mquery(\u001b[32m'DELETE FROM bills WHERE created_by = $1'\u001b[39m\u001b[33m,\u001b[39m [\u001b[35m1\u001b[39m])\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 25 |\u001b[39m     \u001b[36mawait\u001b[39m pool\u001b[33m.\u001b[39mquery(\u001b[32m'DELETE FROM room_members WHERE user_id = $1'\u001b[39m\u001b[33m,\u001b[39m [\u001b[35m1\u001b[39m])\u001b[33m;\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat \u001b[22m\u001b[2mnode_modules/pg-pool/index.js\u001b[2m:45:11\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous> (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/integration/stats.test.js\u001b[39m\u001b[0m\u001b[2m:22:5)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m统计控制器集成测试 › GET /api/stats/room/:roomId › 应该在用户不是寝室成员时返回403错误\u001b[39m\u001b[22m\n\n    error: column \"bill_id\" does not exist\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 20 |\u001b[39m     \u001b[22m\n\u001b[2m     \u001b[90m 21 |\u001b[39m     \u001b[90m// 清理测试数据\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 22 |\u001b[39m     \u001b[36mawait\u001b[39m pool\u001b[33m.\u001b[39mquery(\u001b[32m'DELETE FROM expenses WHERE bill_id IN (SELECT id FROM bills WHERE created_by = $1)'\u001b[39m\u001b[33m,\u001b[39m [\u001b[35m1\u001b[39m])\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m     \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 23 |\u001b[39m     \u001b[36mawait\u001b[39m pool\u001b[33m.\u001b[39mquery(\u001b[32m'DELETE FROM bill_participants WHERE bill_id IN (SELECT id FROM bills WHERE created_by = $1)'\u001b[39m\u001b[33m,\u001b[39m [\u001b[35m1\u001b[39m])\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 24 |\u001b[39m     \u001b[36mawait\u001b[39m pool\u001b[33m.\u001b[39mquery(\u001b[32m'DELETE FROM bills WHERE created_by = $1'\u001b[39m\u001b[33m,\u001b[39m [\u001b[35m1\u001b[39m])\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 25 |\u001b[39m     \u001b[36mawait\u001b[39m pool\u001b[33m.\u001b[39mquery(\u001b[32m'DELETE FROM room_members WHERE user_id = $1'\u001b[39m\u001b[33m,\u001b[39m [\u001b[35m1\u001b[39m])\u001b[33m;\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat \u001b[22m\u001b[2mnode_modules/pg-pool/index.js\u001b[2m:45:11\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous> (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/integration/stats.test.js\u001b[39m\u001b[0m\u001b[2m:22:5)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m统计控制器集成测试 › GET /api/stats/room/:roomId/expense-types › 应该成功获取寝室费用类型分布\u001b[39m\u001b[22m\n\n    error: column \"bill_id\" does not exist\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 20 |\u001b[39m     \u001b[22m\n\u001b[2m     \u001b[90m 21 |\u001b[39m     \u001b[90m// 清理测试数据\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 22 |\u001b[39m     \u001b[36mawait\u001b[39m pool\u001b[33m.\u001b[39mquery(\u001b[32m'DELETE FROM expenses WHERE bill_id IN (SELECT id FROM bills WHERE created_by = $1)'\u001b[39m\u001b[33m,\u001b[39m [\u001b[35m1\u001b[39m])\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m     \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 23 |\u001b[39m     \u001b[36mawait\u001b[39m pool\u001b[33m.\u001b[39mquery(\u001b[32m'DELETE FROM bill_participants WHERE bill_id IN (SELECT id FROM bills WHERE created_by = $1)'\u001b[39m\u001b[33m,\u001b[39m [\u001b[35m1\u001b[39m])\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 24 |\u001b[39m     \u001b[36mawait\u001b[39m pool\u001b[33m.\u001b[39mquery(\u001b[32m'DELETE FROM bills WHERE created_by = $1'\u001b[39m\u001b[33m,\u001b[39m [\u001b[35m1\u001b[39m])\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 25 |\u001b[39m     \u001b[36mawait\u001b[39m pool\u001b[33m.\u001b[39mquery(\u001b[32m'DELETE FROM room_members WHERE user_id = $1'\u001b[39m\u001b[33m,\u001b[39m [\u001b[35m1\u001b[39m])\u001b[33m;\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat \u001b[22m\u001b[2mnode_modules/pg-pool/index.js\u001b[2m:45:11\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous> (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/integration/stats.test.js\u001b[39m\u001b[0m\u001b[2m:22:5)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m统计控制器集成测试 › GET /api/stats/room/:roomId/monthly-trend › 应该成功获取寝室每月费用趋势\u001b[39m\u001b[22m\n\n    error: column \"bill_id\" does not exist\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 20 |\u001b[39m     \u001b[22m\n\u001b[2m     \u001b[90m 21 |\u001b[39m     \u001b[90m// 清理测试数据\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 22 |\u001b[39m     \u001b[36mawait\u001b[39m pool\u001b[33m.\u001b[39mquery(\u001b[32m'DELETE FROM expenses WHERE bill_id IN (SELECT id FROM bills WHERE created_by = $1)'\u001b[39m\u001b[33m,\u001b[39m [\u001b[35m1\u001b[39m])\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m     \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 23 |\u001b[39m     \u001b[36mawait\u001b[39m pool\u001b[33m.\u001b[39mquery(\u001b[32m'DELETE FROM bill_participants WHERE bill_id IN (SELECT id FROM bills WHERE created_by = $1)'\u001b[39m\u001b[33m,\u001b[39m [\u001b[35m1\u001b[39m])\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 24 |\u001b[39m     \u001b[36mawait\u001b[39m pool\u001b[33m.\u001b[39mquery(\u001b[32m'DELETE FROM bills WHERE created_by = $1'\u001b[39m\u001b[33m,\u001b[39m [\u001b[35m1\u001b[39m])\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 25 |\u001b[39m     \u001b[36mawait\u001b[39m pool\u001b[33m.\u001b[39mquery(\u001b[32m'DELETE FROM room_members WHERE user_id = $1'\u001b[39m\u001b[33m,\u001b[39m [\u001b[35m1\u001b[39m])\u001b[33m;\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat \u001b[22m\u001b[2mnode_modules/pg-pool/index.js\u001b[2m:45:11\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous> (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/integration/stats.test.js\u001b[39m\u001b[0m\u001b[2m:22:5)\u001b[22m\u001b[2m\u001b[22m\n\n\n  \u001b[1m● \u001b[22mTest suite failed to run\n\n    TypeError: Cannot read properties of undefined (reading 'id')\n\n    \u001b[0m \u001b[90m 129 |\u001b[39m     \n     \u001b[90m 130 |\u001b[39m     \u001b[90m// 清理测试数据\u001b[39m\n    \u001b[31m\u001b[1m>\u001b[22m\u001b[39m\u001b[90m 131 |\u001b[39m     \u001b[36mawait\u001b[39m pool\u001b[33m.\u001b[39mquery(\u001b[32m'DELETE FROM expenses WHERE bill_id IN (SELECT id FROM bills WHERE created_by = $1)'\u001b[39m\u001b[33m,\u001b[39m [testUser\u001b[33m.\u001b[39mid])\u001b[33m;\u001b[39m\n     \u001b[90m     |\u001b[39m                                                                                                                      \u001b[31m\u001b[1m^\u001b[22m\u001b[39m\n     \u001b[90m 132 |\u001b[39m     \u001b[36mawait\u001b[39m pool\u001b[33m.\u001b[39mquery(\u001b[32m'DELETE FROM bill_participants WHERE bill_id IN (SELECT id FROM bills WHERE created_by = $1)'\u001b[39m\u001b[33m,\u001b[39m [testUser\u001b[33m.\u001b[39mid])\u001b[33m;\u001b[39m\n     \u001b[90m 133 |\u001b[39m     \u001b[36mawait\u001b[39m pool\u001b[33m.\u001b[39mquery(\u001b[32m'DELETE FROM bills WHERE created_by = $1'\u001b[39m\u001b[33m,\u001b[39m [testUser\u001b[33m.\u001b[39mid])\u001b[33m;\u001b[39m\n     \u001b[90m 134 |\u001b[39m     \u001b[36mawait\u001b[39m pool\u001b[33m.\u001b[39mquery(\u001b[32m'DELETE FROM room_members WHERE user_id = $1'\u001b[39m\u001b[33m,\u001b[39m [testUser\u001b[33m.\u001b[39mid])\u001b[33m;\u001b[39m\u001b[0m\n\n      \u001b[2mat Object.id (\u001b[22mtests/integration/stats.test.js\u001b[2m:131:118)\u001b[22m\n","name":"C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\integration\\stats.test.js","startTime":1762159288876,"status":"failed","summary":""},{"assertionResults":[{"ancestorTitles":["支付记录查询服务测试","getPaymentRecords"],"duration":5,"failureDetails":[{"matcherResult":{"message":"\u001b[2mexpect(\u001b[22m\u001b[31mjest.fn()\u001b[39m\u001b[2m).\u001b[22mtoHaveBeenCalledWith\u001b[2m(\u001b[22m\u001b[32m...expected\u001b[39m\u001b[2m)\u001b[22m\n\nExpected: \u001b[32mObjectContaining {\"include\": ArrayContaining [ObjectContaining {\"model\": {\"findByPk\": [Function mockConstructor]}}, ObjectContaining {\"model\": {\"findByPk\": [Function mockConstructor]}}], \"limit\": 20, \"offset\": 0, \"order\": [[\"created_at\", \"DESC\"]], \"where\": ObjectContaining {\"bill_id\": 1, \"created_at\": ObjectContaining {\"Any\": Any<Object>}, \"status\": \"completed\", \"user_id\": 1}}\u001b[39m\nReceived: \u001b[31m{\"include\": [{\"as\": \"bill\", \"attributes\": [\"id\", \"title\", \"amount\", \"dueDate\", \"status\"], \"model\": {\"findByPk\": [Function mockConstructor]}}, {\"as\": \"user\", \"attributes\": [\"id\", \"name\", \"email\", \"avatar\"], \"model\": {\"findByPk\": [Function mockConstructor]}}], \"limit\": 10, \"offset\": 0, \"order\": [[\"createdAt\", \"DESC\"]], \"where\": {\"billId\": 1, \"paymentTime\": {Symbol(gte): 2023-01-01T00:00:00.000Z, Symbol(lte): 2023-12-31T15:59:59.000Z}, \"status\": \"completed\", \"userId\": 1}}\u001b[39m\n\nNumber of calls: \u001b[31m1\u001b[39m","pass":false}}],"failureMessages":["Error: \u001b[2mexpect(\u001b[22m\u001b[31mjest.fn()\u001b[39m\u001b[2m).\u001b[22mtoHaveBeenCalledWith\u001b[2m(\u001b[22m\u001b[32m...expected\u001b[39m\u001b[2m)\u001b[22m\n\nExpected: \u001b[32mObjectContaining {\"include\": ArrayContaining [ObjectContaining {\"model\": {\"findByPk\": [Function mockConstructor]}}, ObjectContaining {\"model\": {\"findByPk\": [Function mockConstructor]}}], \"limit\": 20, \"offset\": 0, \"order\": [[\"created_at\", \"DESC\"]], \"where\": ObjectContaining {\"bill_id\": 1, \"created_at\": ObjectContaining {\"Any\": Any<Object>}, \"status\": \"completed\", \"user_id\": 1}}\u001b[39m\nReceived: \u001b[31m{\"include\": [{\"as\": \"bill\", \"attributes\": [\"id\", \"title\", \"amount\", \"dueDate\", \"status\"], \"model\": {\"findByPk\": [Function mockConstructor]}}, {\"as\": \"user\", \"attributes\": [\"id\", \"name\", \"email\", \"avatar\"], \"model\": {\"findByPk\": [Function mockConstructor]}}], \"limit\": 10, \"offset\": 0, \"order\": [[\"createdAt\", \"DESC\"]], \"where\": {\"billId\": 1, \"paymentTime\": {Symbol(gte): 2023-01-01T00:00:00.000Z, Symbol(lte): 2023-12-31T15:59:59.000Z}, \"status\": \"completed\", \"userId\": 1}}\u001b[39m\n\nNumber of calls: \u001b[31m1\u001b[39m\n    at Object.toHaveBeenCalledWith (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\payment-query-service.test.js:100:39)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)"],"fullName":"支付记录查询服务测试 getPaymentRecords 应该成功获取支付记录列表","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该成功获取支付记录列表"},{"ancestorTitles":["支付记录查询服务测试","getPaymentRecords"],"duration":1,"failureDetails":[{"matcherResult":{"message":"\u001b[2mexpect(\u001b[22m\u001b[31mjest.fn()\u001b[39m\u001b[2m).\u001b[22mtoHaveBeenCalledWith\u001b[2m(\u001b[22m\u001b[32m...expected\u001b[39m\u001b[2m)\u001b[22m\n\nExpected: \u001b[32mObjectContaining {\"offset\": 0}\u001b[39m\nReceived: \u001b[31m{\"include\": [{\"as\": \"bill\", \"attributes\": [\"id\", \"title\", \"amount\", \"dueDate\", \"status\"], \"model\": {\"findByPk\": [Function mockConstructor]}}, {\"as\": \"user\", \"attributes\": [\"id\", \"name\", \"email\", \"avatar\"], \"model\": {\"findByPk\": [Function mockConstructor]}}], \"limit\": 10, \"offset\": -20, \"order\": [[\"createdAt\", \"DESC\"]], \"where\": {}}\u001b[39m\n\nNumber of calls: \u001b[31m1\u001b[39m","pass":false}}],"failureMessages":["Error: \u001b[2mexpect(\u001b[22m\u001b[31mjest.fn()\u001b[39m\u001b[2m).\u001b[22mtoHaveBeenCalledWith\u001b[2m(\u001b[22m\u001b[32m...expected\u001b[39m\u001b[2m)\u001b[22m\n\nExpected: \u001b[32mObjectContaining {\"offset\": 0}\u001b[39m\nReceived: \u001b[31m{\"include\": [{\"as\": \"bill\", \"attributes\": [\"id\", \"title\", \"amount\", \"dueDate\", \"status\"], \"model\": {\"findByPk\": [Function mockConstructor]}}, {\"as\": \"user\", \"attributes\": [\"id\", \"name\", \"email\", \"avatar\"], \"model\": {\"findByPk\": [Function mockConstructor]}}], \"limit\": 10, \"offset\": -20, \"order\": [[\"createdAt\", \"DESC\"]], \"where\": {}}\u001b[39m\n\nNumber of calls: \u001b[31m1\u001b[39m\n    at Object.toHaveBeenCalledWith (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\payment-query-service.test.js:189:39)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)"],"fullName":"支付记录查询服务测试 getPaymentRecords 应该在页码无效时使用默认值","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该在页码无效时使用默认值"},{"ancestorTitles":["支付记录查询服务测试","getPaymentRecords"],"duration":1,"failureDetails":[{"matcherResult":{"message":"\u001b[2mexpect(\u001b[22m\u001b[31mjest.fn()\u001b[39m\u001b[2m).\u001b[22mtoHaveBeenCalledWith\u001b[2m(\u001b[22m\u001b[32m...expected\u001b[39m\u001b[2m)\u001b[22m\n\nExpected: \u001b[32mObjectContaining {\"limit\": 20}\u001b[39m\nReceived: \u001b[31m{\"include\": [{\"as\": \"bill\", \"attributes\": [\"id\", \"title\", \"amount\", \"dueDate\", \"status\"], \"model\": {\"findByPk\": [Function mockConstructor]}}, {\"as\": \"user\", \"attributes\": [\"id\", \"name\", \"email\", \"avatar\"], \"model\": {\"findByPk\": [Function mockConstructor]}}], \"limit\": 10, \"offset\": 0, \"order\": [[\"createdAt\", \"DESC\"]], \"where\": {}}\u001b[39m\n\nNumber of calls: \u001b[31m1\u001b[39m","pass":false}}],"failureMessages":["Error: \u001b[2mexpect(\u001b[22m\u001b[31mjest.fn()\u001b[39m\u001b[2m).\u001b[22mtoHaveBeenCalledWith\u001b[2m(\u001b[22m\u001b[32m...expected\u001b[39m\u001b[2m)\u001b[22m\n\nExpected: \u001b[32mObjectContaining {\"limit\": 20}\u001b[39m\nReceived: \u001b[31m{\"include\": [{\"as\": \"bill\", \"attributes\": [\"id\", \"title\", \"amount\", \"dueDate\", \"status\"], \"model\": {\"findByPk\": [Function mockConstructor]}}, {\"as\": \"user\", \"attributes\": [\"id\", \"name\", \"email\", \"avatar\"], \"model\": {\"findByPk\": [Function mockConstructor]}}], \"limit\": 10, \"offset\": 0, \"order\": [[\"createdAt\", \"DESC\"]], \"where\": {}}\u001b[39m\n\nNumber of calls: \u001b[31m1\u001b[39m\n    at Object.toHaveBeenCalledWith (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\payment-query-service.test.js:215:39)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)"],"fullName":"支付记录查询服务测试 getPaymentRecords 应该在每页数量无效时使用默认值","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该在每页数量无效时使用默认值"},{"ancestorTitles":["支付记录查询服务测试","getPaymentRecords"],"duration":8,"failureDetails":[],"failureMessages":[],"fullName":"支付记录查询服务测试 getPaymentRecords 应该在数据库查询失败时抛出错误","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"应该在数据库查询失败时抛出错误"},{"ancestorTitles":["支付记录查询服务测试","getPaymentRecordById"],"duration":4,"failureDetails":[{"matcherResult":{"actual":{"id":1,"bill_id":1,"user_id":1,"amount":100.5,"status":"completed","payment_method":"alipay","created_at":{},"updated_at":{},"Bill":{"id":1,"title":"测试账单","description":"测试账单描述"},"User":{"id":1,"username":"testuser","email":"test@example.com"}},"expected":{"id":1,"billId":1,"userId":1,"amount":100.5,"status":"completed","paymentMethod":"alipay","createdAt":{"inverse":false},"updatedAt":{"inverse":false},"Bill":{"id":1,"title":"测试账单","description":"测试账单描述"},"User":{"id":1,"username":"testuser","email":"test@example.com"}},"message":"\u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoEqual\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m) // deep equality\u001b[22m\n\n\u001b[32m- Expected  - 5\u001b[39m\n\u001b[31m+ Received  + 5\u001b[39m\n\n\u001b[33m@@ -8,13 +8,13 @@\u001b[39m\n\u001b[2m      \"email\": \"test@example.com\",\u001b[22m\n\u001b[2m      \"id\": 1,\u001b[22m\n\u001b[2m      \"username\": \"testuser\",\u001b[22m\n\u001b[2m    },\u001b[22m\n\u001b[2m    \"amount\": 100.5,\u001b[22m\n\u001b[32m-   \"billId\": 1,\u001b[39m\n\u001b[32m-   \"createdAt\": Any<Date>,\u001b[39m\n\u001b[31m+   \"bill_id\": 1,\u001b[39m\n\u001b[31m+   \"created_at\": 2023-06-15T00:00:00.000Z,\u001b[39m\n\u001b[2m    \"id\": 1,\u001b[22m\n\u001b[32m-   \"paymentMethod\": \"alipay\",\u001b[39m\n\u001b[31m+   \"payment_method\": \"alipay\",\u001b[39m\n\u001b[2m    \"status\": \"completed\",\u001b[22m\n\u001b[32m-   \"updatedAt\": Any<Date>,\u001b[39m\n\u001b[32m-   \"userId\": 1,\u001b[39m\n\u001b[31m+   \"updated_at\": 2023-06-15T00:00:00.000Z,\u001b[39m\n\u001b[31m+   \"user_id\": 1,\u001b[39m\n\u001b[2m  }\u001b[22m","name":"toEqual","pass":false}}],"failureMessages":["Error: \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoEqual\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m) // deep equality\u001b[22m\n\n\u001b[32m- Expected  - 5\u001b[39m\n\u001b[31m+ Received  + 5\u001b[39m\n\n\u001b[33m@@ -8,13 +8,13 @@\u001b[39m\n\u001b[2m      \"email\": \"test@example.com\",\u001b[22m\n\u001b[2m      \"id\": 1,\u001b[22m\n\u001b[2m      \"username\": \"testuser\",\u001b[22m\n\u001b[2m    },\u001b[22m\n\u001b[2m    \"amount\": 100.5,\u001b[22m\n\u001b[32m-   \"billId\": 1,\u001b[39m\n\u001b[32m-   \"createdAt\": Any<Date>,\u001b[39m\n\u001b[31m+   \"bill_id\": 1,\u001b[39m\n\u001b[31m+   \"created_at\": 2023-06-15T00:00:00.000Z,\u001b[39m\n\u001b[2m    \"id\": 1,\u001b[22m\n\u001b[32m-   \"paymentMethod\": \"alipay\",\u001b[39m\n\u001b[31m+   \"payment_method\": \"alipay\",\u001b[39m\n\u001b[2m    \"status\": \"completed\",\u001b[22m\n\u001b[32m-   \"updatedAt\": Any<Date>,\u001b[39m\n\u001b[32m-   \"userId\": 1,\u001b[39m\n\u001b[31m+   \"updated_at\": 2023-06-15T00:00:00.000Z,\u001b[39m\n\u001b[31m+   \"user_id\": 1,\u001b[39m\n\u001b[2m  }\u001b[22m\n    at Object.toEqual (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\payment-query-service.test.js:281:22)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)"],"fullName":"支付记录查询服务测试 getPaymentRecordById 应该成功获取支付记录详情","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"failed","title":"应该成功获取支付记录详情"},{"ancestorTitles":["支付记录查询服务测试","getPaymentRecordById"],"duration":0,"failureDetails":[],"failureMessages":[],"fullName":"支付记录查询服务测试 getPaymentRecordById 应该在支付记录不存在时返回null","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"应该在支付记录不存在时返回null"},{"ancestorTitles":["支付记录查询服务测试","getPaymentRecordById"],"duration":1,"failureDetails":[{"message":"\u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mrejects\u001b[2m.\u001b[22mtoThrow\u001b[2m()\u001b[22m\n\nReceived promise resolved instead of rejected\nResolved to value: \u001b[31mnull\u001b[39m"}],"failureMessages":["Error: \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mrejects\u001b[2m.\u001b[22mtoThrow\u001b[2m()\u001b[22m\n\nReceived promise resolved instead of rejected\nResolved to value: \u001b[31mnull\u001b[39m\n    at expect (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\expect\\build\\index.js:113:15)\n    at Object.expect (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\payment-query-service.test.js:322:13)\n    at Promise.then.completed (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:444:34)"],"fullName":"支付记录查询服务测试 getPaymentRecordById 应该在支付ID无效时抛出错误","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该在支付ID无效时抛出错误"},{"ancestorTitles":["支付记录查询服务测试","getUserPaymentStats"],"duration":8,"failureDetails":[{}],"failureMessages":["TypeError: Payment.findAll is not a function\n    at Object.findAll [as getUserPaymentStats] (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\services\\payment-query-service.js:228:36)\n    at Object.getUserPaymentStats (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\payment-query-service.test.js:365:48)\n    at Promise.then.completed (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:444:34)"],"fullName":"支付记录查询服务测试 getUserPaymentStats 应该成功获取用户支付统计","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该成功获取用户支付统计"},{"ancestorTitles":["支付记录查询服务测试","getUserPaymentStats"],"duration":10,"failureDetails":[{"matcherResult":{"message":"\u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mrejects\u001b[2m.\u001b[22mtoThrow\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m)\u001b[22m\n\nExpected substring: \u001b[32m\"用户ID无效\"\u001b[39m\nReceived message:   \u001b[31m\"Cannot destructure property 'userId' of 'queryParams' as it is null.\"\u001b[39m\n\n    \u001b[0m \u001b[90m 187 |\u001b[39m     \n     \u001b[90m 188 |\u001b[39m     \u001b[36mconst\u001b[39m {\n    \u001b[31m\u001b[1m>\u001b[22m\u001b[39m\u001b[90m 189 |\u001b[39m       userId\u001b[33m,\u001b[39m\n     \u001b[90m     |\u001b[39m       \u001b[31m\u001b[1m^\u001b[22m\u001b[39m\n     \u001b[90m 190 |\u001b[39m       startDate\u001b[33m,\u001b[39m\n     \u001b[90m 191 |\u001b[39m       endDate\u001b[33m,\u001b[39m\n     \u001b[90m 192 |\u001b[39m       roomId\u001b[0m\n\n      \u001b[2mat Object.userId [as getUserPaymentStats] (\u001b[22mservices/payment-query-service.js\u001b[2m:189:7)\u001b[22m\n      \u001b[2mat Object.getUserPaymentStats (\u001b[22mtests/unit/payment-query-service.test.js\u001b[2m:398:40)\u001b[22m","pass":false},"message":"\u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mrejects\u001b[2m.\u001b[22mtoThrow\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m)\u001b[22m\n\nExpected substring: \u001b[32m\"用户ID无效\"\u001b[39m\nReceived message:   \u001b[31m\"Cannot destructure property 'userId' of 'queryParams' as it is null.\"\u001b[39m\n\n    \u001b[0m \u001b[90m 187 |\u001b[39m     \n     \u001b[90m 188 |\u001b[39m     \u001b[36mconst\u001b[39m {\n    \u001b[31m\u001b[1m>\u001b[22m\u001b[39m\u001b[90m 189 |\u001b[39m       userId\u001b[33m,\u001b[39m\n     \u001b[90m     |\u001b[39m       \u001b[31m\u001b[1m^\u001b[22m\u001b[39m\n     \u001b[90m 190 |\u001b[39m       startDate\u001b[33m,\u001b[39m\n     \u001b[90m 191 |\u001b[39m       endDate\u001b[33m,\u001b[39m\n     \u001b[90m 192 |\u001b[39m       roomId\u001b[0m\n\n      \u001b[2mat Object.userId [as getUserPaymentStats] (\u001b[22mservices/payment-query-service.js\u001b[2m:189:7)\u001b[22m\n      \u001b[2mat Object.getUserPaymentStats (\u001b[22mtests/unit/payment-query-service.test.js\u001b[2m:398:40)\u001b[22m"}],"failureMessages":["Error: \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mrejects\u001b[2m.\u001b[22mtoThrow\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m)\u001b[22m\n\nExpected substring: \u001b[32m\"用户ID无效\"\u001b[39m\nReceived message:   \u001b[31m\"Cannot destructure property 'userId' of 'queryParams' as it is null.\"\u001b[39m\n\n    \u001b[0m \u001b[90m 187 |\u001b[39m     \n     \u001b[90m 188 |\u001b[39m     \u001b[36mconst\u001b[39m {\n    \u001b[31m\u001b[1m>\u001b[22m\u001b[39m\u001b[90m 189 |\u001b[39m       userId\u001b[33m,\u001b[39m\n     \u001b[90m     |\u001b[39m       \u001b[31m\u001b[1m^\u001b[22m\u001b[39m\n     \u001b[90m 190 |\u001b[39m       startDate\u001b[33m,\u001b[39m\n     \u001b[90m 191 |\u001b[39m       endDate\u001b[33m,\u001b[39m\n     \u001b[90m 192 |\u001b[39m       roomId\u001b[0m\n\n      \u001b[2mat Object.userId [as getUserPaymentStats] (\u001b[22mservices/payment-query-service.js\u001b[2m:189:7)\u001b[22m\n      \u001b[2mat Object.getUserPaymentStats (\u001b[22mtests/unit/payment-query-service.test.js\u001b[2m:398:40)\u001b[22m\n    at Object.toThrow (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\expect\\build\\index.js:218:22)\n    at Object.toThrow (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\payment-query-service.test.js:399:18)\n    at Promise.then.completed (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:444:34)"],"fullName":"支付记录查询服务测试 getUserPaymentStats 应该在用户ID无效时抛出错误","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该在用户ID无效时抛出错误"},{"ancestorTitles":["支付记录查询服务测试","getBillPayments"],"duration":1,"failureDetails":[{"matcherResult":{"message":"\u001b[2mexpect(\u001b[22m\u001b[31mjest.fn()\u001b[39m\u001b[2m).\u001b[22mtoHaveBeenCalledWith\u001b[2m(\u001b[22m\u001b[32m...expected\u001b[39m\u001b[2m)\u001b[22m\n\nExpected: \u001b[32mObjectContaining {\"include\": ArrayContaining [ObjectContaining {\"model\": {\"findByPk\": [Function mockConstructor]}}], \"limit\": 20, \"offset\": 0, \"order\": [[\"created_at\", \"DESC\"]], \"where\": ObjectContaining {\"bill_id\": 1}}\u001b[39m\nReceived: \u001b[31m{\"include\": [{\"as\": \"user\", \"attributes\": [\"id\", \"name\", \"email\", \"avatar\"], \"model\": {\"findByPk\": [Function mockConstructor]}}], \"limit\": 10, \"offset\": 0, \"order\": [[\"paymentTime\", \"DESC\"]], \"where\": {\"billId\": 1}}\u001b[39m\n\nNumber of calls: \u001b[31m1\u001b[39m","pass":false}}],"failureMessages":["Error: \u001b[2mexpect(\u001b[22m\u001b[31mjest.fn()\u001b[39m\u001b[2m).\u001b[22mtoHaveBeenCalledWith\u001b[2m(\u001b[22m\u001b[32m...expected\u001b[39m\u001b[2m)\u001b[22m\n\nExpected: \u001b[32mObjectContaining {\"include\": ArrayContaining [ObjectContaining {\"model\": {\"findByPk\": [Function mockConstructor]}}], \"limit\": 20, \"offset\": 0, \"order\": [[\"created_at\", \"DESC\"]], \"where\": ObjectContaining {\"bill_id\": 1}}\u001b[39m\nReceived: \u001b[31m{\"include\": [{\"as\": \"user\", \"attributes\": [\"id\", \"name\", \"email\", \"avatar\"], \"model\": {\"findByPk\": [Function mockConstructor]}}], \"limit\": 10, \"offset\": 0, \"order\": [[\"paymentTime\", \"DESC\"]], \"where\": {\"billId\": 1}}\u001b[39m\n\nNumber of calls: \u001b[31m1\u001b[39m\n    at Object.toHaveBeenCalledWith (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\payment-query-service.test.js:451:39)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)"],"fullName":"支付记录查询服务测试 getBillPayments 应该成功获取账单支付记录","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该成功获取账单支付记录"},{"ancestorTitles":["支付记录查询服务测试","getBillPayments"],"duration":1,"failureDetails":[{"message":"\u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mrejects\u001b[2m.\u001b[22mtoThrow\u001b[2m()\u001b[22m\n\nReceived promise resolved instead of rejected\nResolved to value: \u001b[31m{\"items\": [{\"User\": {\"email\": \"test@example.com\", \"id\": 1, \"username\": \"testuser\"}, \"amount\": 100.5, \"bill_id\": 1, \"created_at\": 2023-06-15T00:00:00.000Z, \"id\": 1, \"payment_method\": \"alipay\", \"status\": \"completed\", \"user_id\": 1}, {\"User\": {\"email\": \"test2@example.com\", \"id\": 2, \"username\": \"testuser2\"}, \"amount\": 50, \"bill_id\": 1, \"created_at\": 2023-06-20T00:00:00.000Z, \"id\": 2, \"payment_method\": \"wechat\", \"status\": \"pending\", \"user_id\": 2}], \"page\": 1, \"pageSize\": 10, \"total\": 2, \"totalPages\": 1}\u001b[39m"}],"failureMessages":["Error: \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mrejects\u001b[2m.\u001b[22mtoThrow\u001b[2m()\u001b[22m\n\nReceived promise resolved instead of rejected\nResolved to value: \u001b[31m{\"items\": [{\"User\": {\"email\": \"test@example.com\", \"id\": 1, \"username\": \"testuser\"}, \"amount\": 100.5, \"bill_id\": 1, \"created_at\": 2023-06-15T00:00:00.000Z, \"id\": 1, \"payment_method\": \"alipay\", \"status\": \"completed\", \"user_id\": 1}, {\"User\": {\"email\": \"test2@example.com\", \"id\": 2, \"username\": \"testuser2\"}, \"amount\": 50, \"bill_id\": 1, \"created_at\": 2023-06-20T00:00:00.000Z, \"id\": 2, \"payment_method\": \"wechat\", \"status\": \"pending\", \"user_id\": 2}], \"page\": 1, \"pageSize\": 10, \"total\": 2, \"totalPages\": 1}\u001b[39m\n    at expect (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\expect\\build\\index.js:113:15)\n    at Object.expect (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\payment-query-service.test.js:508:13)\n    at Promise.then.completed (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:444:34)"],"fullName":"支付记录查询服务测试 getBillPayments 应该在账单ID无效时抛出错误","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该在账单ID无效时抛出错误"},{"ancestorTitles":["支付记录查询服务测试","getUserPaymentTransfers"],"duration":1,"failureDetails":[{"matcherResult":{"message":"\u001b[2mexpect(\u001b[22m\u001b[31mjest.fn()\u001b[39m\u001b[2m).\u001b[22mtoHaveBeenCalledWith\u001b[2m(\u001b[22m\u001b[32m...expected\u001b[39m\u001b[2m)\u001b[22m\n\nExpected: \u001b[32mObjectContaining {\"include\": ArrayContaining [ObjectContaining {\"as\": \"FromPayment\", \"include\": ArrayContaining [ObjectContaining {\"model\": {\"findByPk\": [Function mockConstructor]}}], \"model\": {\"findAndCountAll\": [Function mockConstructor], \"findByPk\": [Function mockConstructor]}}, ObjectContaining {\"as\": \"ToPayment\", \"include\": ArrayContaining [ObjectContaining {\"model\": {\"findByPk\": [Function mockConstructor]}}], \"model\": {\"findAndCountAll\": [Function mockConstructor], \"findByPk\": [Function mockConstructor]}}], \"limit\": 20, \"offset\": 0, \"order\": [[\"created_at\", \"DESC\"]], \"where\": ObjectContaining {\"Any\": ObjectContaining {\"Any\": 1}}}\u001b[39m\nReceived: \u001b[31m{\"include\": [{\"as\": \"bill\", \"attributes\": [\"id\", \"title\", \"amount\", \"status\"], \"model\": {\"findByPk\": [Function mockConstructor]}}, {\"as\": \"fromUser\", \"attributes\": [\"id\", \"name\", \"email\", \"avatar\"], \"model\": {\"findByPk\": [Function mockConstructor]}}, {\"as\": \"toUser\", \"attributes\": [\"id\", \"name\", \"email\", \"avatar\"], \"model\": {\"findByPk\": [Function mockConstructor]}}], \"limit\": 10, \"offset\": 0, \"order\": [[\"createdAt\", \"DESC\"]], \"where\": {Symbol(or): [{\"fromUserId\": 1}, {\"toUserId\": 1}]}}\u001b[39m\n\nNumber of calls: \u001b[31m1\u001b[39m","pass":false}}],"failureMessages":["Error: \u001b[2mexpect(\u001b[22m\u001b[31mjest.fn()\u001b[39m\u001b[2m).\u001b[22mtoHaveBeenCalledWith\u001b[2m(\u001b[22m\u001b[32m...expected\u001b[39m\u001b[2m)\u001b[22m\n\nExpected: \u001b[32mObjectContaining {\"include\": ArrayContaining [ObjectContaining {\"as\": \"FromPayment\", \"include\": ArrayContaining [ObjectContaining {\"model\": {\"findByPk\": [Function mockConstructor]}}], \"model\": {\"findAndCountAll\": [Function mockConstructor], \"findByPk\": [Function mockConstructor]}}, ObjectContaining {\"as\": \"ToPayment\", \"include\": ArrayContaining [ObjectContaining {\"model\": {\"findByPk\": [Function mockConstructor]}}], \"model\": {\"findAndCountAll\": [Function mockConstructor], \"findByPk\": [Function mockConstructor]}}], \"limit\": 20, \"offset\": 0, \"order\": [[\"created_at\", \"DESC\"]], \"where\": ObjectContaining {\"Any\": ObjectContaining {\"Any\": 1}}}\u001b[39m\nReceived: \u001b[31m{\"include\": [{\"as\": \"bill\", \"attributes\": [\"id\", \"title\", \"amount\", \"status\"], \"model\": {\"findByPk\": [Function mockConstructor]}}, {\"as\": \"fromUser\", \"attributes\": [\"id\", \"name\", \"email\", \"avatar\"], \"model\": {\"findByPk\": [Function mockConstructor]}}, {\"as\": \"toUser\", \"attributes\": [\"id\", \"name\", \"email\", \"avatar\"], \"model\": {\"findByPk\": [Function mockConstructor]}}], \"limit\": 10, \"offset\": 0, \"order\": [[\"createdAt\", \"DESC\"]], \"where\": {Symbol(or): [{\"fromUserId\": 1}, {\"toUserId\": 1}]}}\u001b[39m\n\nNumber of calls: \u001b[31m1\u001b[39m\n    at Object.toHaveBeenCalledWith (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\payment-query-service.test.js:559:47)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)"],"fullName":"支付记录查询服务测试 getUserPaymentTransfers 应该成功获取用户支付转移记录","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该成功获取用户支付转移记录"},{"ancestorTitles":["支付记录查询服务测试","getUserPaymentTransfers"],"duration":1,"failureDetails":[{"message":"\u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mrejects\u001b[2m.\u001b[22mtoThrow\u001b[2m()\u001b[22m\n\nReceived promise resolved instead of rejected\nResolved to value: \u001b[31m{\"items\": [{\"FromPayment\": {\"Bill\": {\"id\": 1, \"title\": \"测试账单\"}, \"amount\": 100.5, \"bill_id\": 1, \"id\": 1}, \"ToPayment\": {\"Bill\": {\"id\": 2, \"title\": \"测试账单2\"}, \"amount\": 150, \"bill_id\": 2, \"id\": 2}, \"amount\": 50, \"created_at\": 2023-06-15T00:00:00.000Z, \"from_payment_id\": 1, \"id\": 1, \"status\": \"completed\", \"to_payment_id\": 2}], \"page\": 1, \"pageSize\": 10, \"total\": 1, \"totalPages\": 1}\u001b[39m"}],"failureMessages":["Error: \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mrejects\u001b[2m.\u001b[22mtoThrow\u001b[2m()\u001b[22m\n\nReceived promise resolved instead of rejected\nResolved to value: \u001b[31m{\"items\": [{\"FromPayment\": {\"Bill\": {\"id\": 1, \"title\": \"测试账单\"}, \"amount\": 100.5, \"bill_id\": 1, \"id\": 1}, \"ToPayment\": {\"Bill\": {\"id\": 2, \"title\": \"测试账单2\"}, \"amount\": 150, \"bill_id\": 2, \"id\": 2}, \"amount\": 50, \"created_at\": 2023-06-15T00:00:00.000Z, \"from_payment_id\": 1, \"id\": 1, \"status\": \"completed\", \"to_payment_id\": 2}], \"page\": 1, \"pageSize\": 10, \"total\": 1, \"totalPages\": 1}\u001b[39m\n    at expect (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\expect\\build\\index.js:113:15)\n    at Object.expect (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\payment-query-service.test.js:629:13)\n    at Promise.then.completed (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:444:34)"],"fullName":"支付记录查询服务测试 getUserPaymentTransfers 应该在用户ID无效时抛出错误","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该在用户ID无效时抛出错误"},{"ancestorTitles":["支付记录查询服务测试","getRoomPaymentStats"],"duration":3,"failureDetails":[{}],"failureMessages":["TypeError: Payment.findAll is not a function\n    at Object.findAll [as getRoomPaymentStats] (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\services\\payment-query-service.js:495:36)\n    at Object.getRoomPaymentStats (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\payment-query-service.test.js:673:48)\n    at Promise.then.completed (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:444:34)"],"fullName":"支付记录查询服务测试 getRoomPaymentStats 应该成功获取房间支付统计","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该成功获取房间支付统计"},{"ancestorTitles":["支付记录查询服务测试","getRoomPaymentStats"],"duration":6,"failureDetails":[{"matcherResult":{"message":"\u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mrejects\u001b[2m.\u001b[22mtoThrow\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m)\u001b[22m\n\nExpected substring: \u001b[32m\"房间ID无效\"\u001b[39m\nReceived message:   \u001b[31m\"Cannot destructure property 'roomId' of 'queryParams' as it is null.\"\u001b[39m\n\n    \u001b[0m \u001b[90m 473 |\u001b[39m     \n     \u001b[90m 474 |\u001b[39m     \u001b[36mconst\u001b[39m {\n    \u001b[31m\u001b[1m>\u001b[22m\u001b[39m\u001b[90m 475 |\u001b[39m       roomId\u001b[33m,\u001b[39m\n     \u001b[90m     |\u001b[39m       \u001b[31m\u001b[1m^\u001b[22m\u001b[39m\n     \u001b[90m 476 |\u001b[39m       startDate\u001b[33m,\u001b[39m\n     \u001b[90m 477 |\u001b[39m       endDate\n     \u001b[90m 478 |\u001b[39m     } \u001b[33m=\u001b[39m queryParams\u001b[33m;\u001b[39m\u001b[0m\n\n      \u001b[2mat Object.roomId [as getRoomPaymentStats] (\u001b[22mservices/payment-query-service.js\u001b[2m:475:7)\u001b[22m\n      \u001b[2mat Object.getRoomPaymentStats (\u001b[22mtests/unit/payment-query-service.test.js\u001b[2m:727:40)\u001b[22m","pass":false},"message":"\u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mrejects\u001b[2m.\u001b[22mtoThrow\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m)\u001b[22m\n\nExpected substring: \u001b[32m\"房间ID无效\"\u001b[39m\nReceived message:   \u001b[31m\"Cannot destructure property 'roomId' of 'queryParams' as it is null.\"\u001b[39m\n\n    \u001b[0m \u001b[90m 473 |\u001b[39m     \n     \u001b[90m 474 |\u001b[39m     \u001b[36mconst\u001b[39m {\n    \u001b[31m\u001b[1m>\u001b[22m\u001b[39m\u001b[90m 475 |\u001b[39m       roomId\u001b[33m,\u001b[39m\n     \u001b[90m     |\u001b[39m       \u001b[31m\u001b[1m^\u001b[22m\u001b[39m\n     \u001b[90m 476 |\u001b[39m       startDate\u001b[33m,\u001b[39m\n     \u001b[90m 477 |\u001b[39m       endDate\n     \u001b[90m 478 |\u001b[39m     } \u001b[33m=\u001b[39m queryParams\u001b[33m;\u001b[39m\u001b[0m\n\n      \u001b[2mat Object.roomId [as getRoomPaymentStats] (\u001b[22mservices/payment-query-service.js\u001b[2m:475:7)\u001b[22m\n      \u001b[2mat Object.getRoomPaymentStats (\u001b[22mtests/unit/payment-query-service.test.js\u001b[2m:727:40)\u001b[22m"}],"failureMessages":["Error: \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mrejects\u001b[2m.\u001b[22mtoThrow\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m)\u001b[22m\n\nExpected substring: \u001b[32m\"房间ID无效\"\u001b[39m\nReceived message:   \u001b[31m\"Cannot destructure property 'roomId' of 'queryParams' as it is null.\"\u001b[39m\n\n    \u001b[0m \u001b[90m 473 |\u001b[39m     \n     \u001b[90m 474 |\u001b[39m     \u001b[36mconst\u001b[39m {\n    \u001b[31m\u001b[1m>\u001b[22m\u001b[39m\u001b[90m 475 |\u001b[39m       roomId\u001b[33m,\u001b[39m\n     \u001b[90m     |\u001b[39m       \u001b[31m\u001b[1m^\u001b[22m\u001b[39m\n     \u001b[90m 476 |\u001b[39m       startDate\u001b[33m,\u001b[39m\n     \u001b[90m 477 |\u001b[39m       endDate\n     \u001b[90m 478 |\u001b[39m     } \u001b[33m=\u001b[39m queryParams\u001b[33m;\u001b[39m\u001b[0m\n\n      \u001b[2mat Object.roomId [as getRoomPaymentStats] (\u001b[22mservices/payment-query-service.js\u001b[2m:475:7)\u001b[22m\n      \u001b[2mat Object.getRoomPaymentStats (\u001b[22mtests/unit/payment-query-service.test.js\u001b[2m:727:40)\u001b[22m\n    at Object.toThrow (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\expect\\build\\index.js:218:22)\n    at Object.toThrow (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\payment-query-service.test.js:728:18)\n    at Promise.then.completed (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:444:34)"],"fullName":"支付记录查询服务测试 getRoomPaymentStats 应该在房间ID无效时抛出错误","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该在房间ID无效时抛出错误"}],"endTime":1762159269954,"message":"\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m支付记录查询服务测试 › getPaymentRecords › 应该成功获取支付记录列表\u001b[39m\u001b[22m\n\n    \u001b[2mexpect(\u001b[22m\u001b[31mjest.fn()\u001b[39m\u001b[2m).\u001b[22mtoHaveBeenCalledWith\u001b[2m(\u001b[22m\u001b[32m...expected\u001b[39m\u001b[2m)\u001b[22m\n\n    Expected: \u001b[32mObjectContaining {\"include\": ArrayContaining [ObjectContaining {\"model\": {\"findByPk\": [Function mockConstructor]}}, ObjectContaining {\"model\": {\"findByPk\": [Function mockConstructor]}}], \"limit\": 20, \"offset\": 0, \"order\": [[\"created_at\", \"DESC\"]], \"where\": ObjectContaining {\"bill_id\": 1, \"created_at\": ObjectContaining {\"Any\": Any<Object>}, \"status\": \"completed\", \"user_id\": 1}}\u001b[39m\n    Received: \u001b[31m{\"include\": [{\"as\": \"bill\", \"attributes\": [\"id\", \"title\", \"amount\", \"dueDate\", \"status\"], \"model\": {\"findByPk\": [Function mockConstructor]}}, {\"as\": \"user\", \"attributes\": [\"id\", \"name\", \"email\", \"avatar\"], \"model\": {\"findByPk\": [Function mockConstructor]}}], \"limit\": 10, \"offset\": 0, \"order\": [[\"createdAt\", \"DESC\"]], \"where\": {\"billId\": 1, \"paymentTime\": {Symbol(gte): 2023-01-01T00:00:00.000Z, Symbol(lte): 2023-12-31T15:59:59.000Z}, \"status\": \"completed\", \"userId\": 1}}\u001b[39m\n\n    Number of calls: \u001b[31m1\u001b[39m\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m  98 |\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m  99 |\u001b[39m       \u001b[90m// 验证结果\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 100 |\u001b[39m       expect(\u001b[33mPayment\u001b[39m\u001b[33m.\u001b[39mfindAndCountAll)\u001b[33m.\u001b[39mtoHaveBeenCalledWith(\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                                       \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 101 |\u001b[39m         expect\u001b[33m.\u001b[39mobjectContaining({\u001b[22m\n\u001b[2m     \u001b[90m 102 |\u001b[39m           include\u001b[33m:\u001b[39m expect\u001b[33m.\u001b[39marrayContaining([\u001b[22m\n\u001b[2m     \u001b[90m 103 |\u001b[39m             expect\u001b[33m.\u001b[39mobjectContaining({ model\u001b[33m:\u001b[39m \u001b[33mBill\u001b[39m })\u001b[33m,\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.toHaveBeenCalledWith (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/payment-query-service.test.js\u001b[39m\u001b[0m\u001b[2m:100:39)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m支付记录查询服务测试 › getPaymentRecords › 应该在页码无效时使用默认值\u001b[39m\u001b[22m\n\n    \u001b[2mexpect(\u001b[22m\u001b[31mjest.fn()\u001b[39m\u001b[2m).\u001b[22mtoHaveBeenCalledWith\u001b[2m(\u001b[22m\u001b[32m...expected\u001b[39m\u001b[2m)\u001b[22m\n\n    Expected: \u001b[32mObjectContaining {\"offset\": 0}\u001b[39m\n    Received: \u001b[31m{\"include\": [{\"as\": \"bill\", \"attributes\": [\"id\", \"title\", \"amount\", \"dueDate\", \"status\"], \"model\": {\"findByPk\": [Function mockConstructor]}}, {\"as\": \"user\", \"attributes\": [\"id\", \"name\", \"email\", \"avatar\"], \"model\": {\"findByPk\": [Function mockConstructor]}}], \"limit\": 10, \"offset\": -20, \"order\": [[\"createdAt\", \"DESC\"]], \"where\": {}}\u001b[39m\n\n    Number of calls: \u001b[31m1\u001b[39m\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 187 |\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 188 |\u001b[39m       \u001b[90m// 验证结果\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 189 |\u001b[39m       expect(\u001b[33mPayment\u001b[39m\u001b[33m.\u001b[39mfindAndCountAll)\u001b[33m.\u001b[39mtoHaveBeenCalledWith(\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                                       \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 190 |\u001b[39m         expect\u001b[33m.\u001b[39mobjectContaining({\u001b[22m\n\u001b[2m     \u001b[90m 191 |\u001b[39m           offset\u001b[33m:\u001b[39m \u001b[35m0\u001b[39m \u001b[90m// 应该使用默认页码1，偏移量为0\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 192 |\u001b[39m         })\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.toHaveBeenCalledWith (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/payment-query-service.test.js\u001b[39m\u001b[0m\u001b[2m:189:39)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m支付记录查询服务测试 › getPaymentRecords › 应该在每页数量无效时使用默认值\u001b[39m\u001b[22m\n\n    \u001b[2mexpect(\u001b[22m\u001b[31mjest.fn()\u001b[39m\u001b[2m).\u001b[22mtoHaveBeenCalledWith\u001b[2m(\u001b[22m\u001b[32m...expected\u001b[39m\u001b[2m)\u001b[22m\n\n    Expected: \u001b[32mObjectContaining {\"limit\": 20}\u001b[39m\n    Received: \u001b[31m{\"include\": [{\"as\": \"bill\", \"attributes\": [\"id\", \"title\", \"amount\", \"dueDate\", \"status\"], \"model\": {\"findByPk\": [Function mockConstructor]}}, {\"as\": \"user\", \"attributes\": [\"id\", \"name\", \"email\", \"avatar\"], \"model\": {\"findByPk\": [Function mockConstructor]}}], \"limit\": 10, \"offset\": 0, \"order\": [[\"createdAt\", \"DESC\"]], \"where\": {}}\u001b[39m\n\n    Number of calls: \u001b[31m1\u001b[39m\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 213 |\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 214 |\u001b[39m       \u001b[90m// 验证结果\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 215 |\u001b[39m       expect(\u001b[33mPayment\u001b[39m\u001b[33m.\u001b[39mfindAndCountAll)\u001b[33m.\u001b[39mtoHaveBeenCalledWith(\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                                       \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 216 |\u001b[39m         expect\u001b[33m.\u001b[39mobjectContaining({\u001b[22m\n\u001b[2m     \u001b[90m 217 |\u001b[39m           limit\u001b[33m:\u001b[39m \u001b[35m20\u001b[39m \u001b[90m// 应该使用默认限制20\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 218 |\u001b[39m         })\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.toHaveBeenCalledWith (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/payment-query-service.test.js\u001b[39m\u001b[0m\u001b[2m:215:39)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m支付记录查询服务测试 › getPaymentRecordById › 应该成功获取支付记录详情\u001b[39m\u001b[22m\n\n    \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoEqual\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m) // deep equality\u001b[22m\n\n    \u001b[32m- Expected  - 5\u001b[39m\n    \u001b[31m+ Received  + 5\u001b[39m\n\n    \u001b[33m@@ -8,13 +8,13 @@\u001b[39m\n    \u001b[2m      \"email\": \"test@example.com\",\u001b[22m\n    \u001b[2m      \"id\": 1,\u001b[22m\n    \u001b[2m      \"username\": \"testuser\",\u001b[22m\n    \u001b[2m    },\u001b[22m\n    \u001b[2m    \"amount\": 100.5,\u001b[22m\n    \u001b[32m-   \"billId\": 1,\u001b[39m\n    \u001b[32m-   \"createdAt\": Any<Date>,\u001b[39m\n    \u001b[31m+   \"bill_id\": 1,\u001b[39m\n    \u001b[31m+   \"created_at\": 2023-06-15T00:00:00.000Z,\u001b[39m\n    \u001b[2m    \"id\": 1,\u001b[22m\n    \u001b[32m-   \"paymentMethod\": \"alipay\",\u001b[39m\n    \u001b[31m+   \"payment_method\": \"alipay\",\u001b[39m\n    \u001b[2m    \"status\": \"completed\",\u001b[22m\n    \u001b[32m-   \"updatedAt\": Any<Date>,\u001b[39m\n    \u001b[32m-   \"userId\": 1,\u001b[39m\n    \u001b[31m+   \"updated_at\": 2023-06-15T00:00:00.000Z,\u001b[39m\n    \u001b[31m+   \"user_id\": 1,\u001b[39m\n    \u001b[2m  }\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 279 |\u001b[39m       )\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 280 |\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 281 |\u001b[39m       expect(result)\u001b[33m.\u001b[39mtoEqual({\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                      \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 282 |\u001b[39m         id\u001b[33m:\u001b[39m paymentId\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 283 |\u001b[39m         billId\u001b[33m:\u001b[39m \u001b[35m1\u001b[39m\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 284 |\u001b[39m         userId\u001b[33m:\u001b[39m \u001b[35m1\u001b[39m\u001b[33m,\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.toEqual (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/payment-query-service.test.js\u001b[39m\u001b[0m\u001b[2m:281:22)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m支付记录查询服务测试 › getPaymentRecordById › 应该在支付ID无效时抛出错误\u001b[39m\u001b[22m\n\n    \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mrejects\u001b[2m.\u001b[22mtoThrow\u001b[2m()\u001b[22m\n\n    Received promise resolved instead of rejected\n    Resolved to value: \u001b[31mnull\u001b[39m\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 320 |\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 321 |\u001b[39m       \u001b[90m// 验证函数抛出错误\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 322 |\u001b[39m       \u001b[36mawait\u001b[39m expect(paymentQueryService\u001b[33m.\u001b[39mgetPaymentRecordById(invalidPaymentId))\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m             \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 323 |\u001b[39m         \u001b[33m.\u001b[39mrejects\u001b[33m.\u001b[39mtoThrow(\u001b[32m'支付ID无效'\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 324 |\u001b[39m     })\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 325 |\u001b[39m   })\u001b[33m;\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat expect (\u001b[22m\u001b[2mnode_modules/expect/build/index.js\u001b[2m:113:15)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.expect (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/payment-query-service.test.js\u001b[39m\u001b[0m\u001b[2m:322:13)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m支付记录查询服务测试 › getUserPaymentStats › 应该成功获取用户支付统计\u001b[39m\u001b[22m\n\n    TypeError: Payment.findAll is not a function\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 226 |\u001b[39m     \u001b[22m\n\u001b[2m     \u001b[90m 227 |\u001b[39m     \u001b[90m// 查询支付记录\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 228 |\u001b[39m     \u001b[36mconst\u001b[39m payments \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m \u001b[33mPayment\u001b[39m\u001b[33m.\u001b[39mfindAll({\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                                    \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 229 |\u001b[39m       where\u001b[33m:\u001b[39m whereClause\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 230 |\u001b[39m       include\u001b[33m:\u001b[39m includeConditions\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 231 |\u001b[39m       attributes\u001b[33m:\u001b[39m [\u001b[32m'amount'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'status'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'paymentMethod'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m'paymentTime'\u001b[39m]\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.findAll [as getUserPaymentStats] (\u001b[22m\u001b[2mservices/payment-query-service.js\u001b[2m:228:36)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.getUserPaymentStats (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/payment-query-service.test.js\u001b[39m\u001b[0m\u001b[2m:365:48)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m支付记录查询服务测试 › getUserPaymentStats › 应该在用户ID无效时抛出错误\u001b[39m\u001b[22m\n\n    \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mrejects\u001b[2m.\u001b[22mtoThrow\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m)\u001b[22m\n\n    Expected substring: \u001b[32m\"用户ID无效\"\u001b[39m\n    Received message:   \u001b[31m\"Cannot destructure property 'userId' of 'queryParams' as it is null.\"\u001b[39m\n\n        \u001b[0m \u001b[90m 187 |\u001b[39m     \n         \u001b[90m 188 |\u001b[39m     \u001b[36mconst\u001b[39m {\n        \u001b[31m\u001b[1m>\u001b[22m\u001b[39m\u001b[90m 189 |\u001b[39m       userId\u001b[33m,\u001b[39m\n         \u001b[90m     |\u001b[39m       \u001b[31m\u001b[1m^\u001b[22m\u001b[39m\n         \u001b[90m 190 |\u001b[39m       startDate\u001b[33m,\u001b[39m\n         \u001b[90m 191 |\u001b[39m       endDate\u001b[33m,\u001b[39m\n         \u001b[90m 192 |\u001b[39m       roomId\u001b[0m\n\n          \u001b[2mat Object.userId [as getUserPaymentStats] (\u001b[22mservices/payment-query-service.js\u001b[2m:189:7)\u001b[22m\n          \u001b[2mat Object.getUserPaymentStats (\u001b[22mtests/unit/payment-query-service.test.js\u001b[2m:398:40)\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 397 |\u001b[39m       \u001b[90m// 验证函数抛出错误\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 398 |\u001b[39m       \u001b[36mawait\u001b[39m expect(paymentQueryService\u001b[33m.\u001b[39mgetUserPaymentStats(invalidUserId))\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 399 |\u001b[39m         \u001b[33m.\u001b[39mrejects\u001b[33m.\u001b[39mtoThrow(\u001b[32m'用户ID无效'\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                  \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 400 |\u001b[39m     })\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 401 |\u001b[39m   })\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 402 |\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.toThrow (\u001b[22m\u001b[2mnode_modules/expect/build/index.js\u001b[2m:218:22)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.toThrow (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/payment-query-service.test.js\u001b[39m\u001b[0m\u001b[2m:399:18)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m支付记录查询服务测试 › getBillPayments › 应该成功获取账单支付记录\u001b[39m\u001b[22m\n\n    \u001b[2mexpect(\u001b[22m\u001b[31mjest.fn()\u001b[39m\u001b[2m).\u001b[22mtoHaveBeenCalledWith\u001b[2m(\u001b[22m\u001b[32m...expected\u001b[39m\u001b[2m)\u001b[22m\n\n    Expected: \u001b[32mObjectContaining {\"include\": ArrayContaining [ObjectContaining {\"model\": {\"findByPk\": [Function mockConstructor]}}], \"limit\": 20, \"offset\": 0, \"order\": [[\"created_at\", \"DESC\"]], \"where\": ObjectContaining {\"bill_id\": 1}}\u001b[39m\n    Received: \u001b[31m{\"include\": [{\"as\": \"user\", \"attributes\": [\"id\", \"name\", \"email\", \"avatar\"], \"model\": {\"findByPk\": [Function mockConstructor]}}], \"limit\": 10, \"offset\": 0, \"order\": [[\"paymentTime\", \"DESC\"]], \"where\": {\"billId\": 1}}\u001b[39m\n\n    Number of calls: \u001b[31m1\u001b[39m\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 449 |\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 450 |\u001b[39m       \u001b[90m// 验证结果\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 451 |\u001b[39m       expect(\u001b[33mPayment\u001b[39m\u001b[33m.\u001b[39mfindAndCountAll)\u001b[33m.\u001b[39mtoHaveBeenCalledWith(\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                                       \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 452 |\u001b[39m         expect\u001b[33m.\u001b[39mobjectContaining({\u001b[22m\n\u001b[2m     \u001b[90m 453 |\u001b[39m           include\u001b[33m:\u001b[39m expect\u001b[33m.\u001b[39marrayContaining([\u001b[22m\n\u001b[2m     \u001b[90m 454 |\u001b[39m             expect\u001b[33m.\u001b[39mobjectContaining({ model\u001b[33m:\u001b[39m \u001b[33mUser\u001b[39m })\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.toHaveBeenCalledWith (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/payment-query-service.test.js\u001b[39m\u001b[0m\u001b[2m:451:39)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m支付记录查询服务测试 › getBillPayments › 应该在账单ID无效时抛出错误\u001b[39m\u001b[22m\n\n    \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mrejects\u001b[2m.\u001b[22mtoThrow\u001b[2m()\u001b[22m\n\n    Received promise resolved instead of rejected\n    Resolved to value: \u001b[31m{\"items\": [{\"User\": {\"email\": \"test@example.com\", \"id\": 1, \"username\": \"testuser\"}, \"amount\": 100.5, \"bill_id\": 1, \"created_at\": 2023-06-15T00:00:00.000Z, \"id\": 1, \"payment_method\": \"alipay\", \"status\": \"completed\", \"user_id\": 1}, {\"User\": {\"email\": \"test2@example.com\", \"id\": 2, \"username\": \"testuser2\"}, \"amount\": 50, \"bill_id\": 1, \"created_at\": 2023-06-20T00:00:00.000Z, \"id\": 2, \"payment_method\": \"wechat\", \"status\": \"pending\", \"user_id\": 2}], \"page\": 1, \"pageSize\": 10, \"total\": 2, \"totalPages\": 1}\u001b[39m\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 506 |\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 507 |\u001b[39m       \u001b[90m// 验证函数抛出错误\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 508 |\u001b[39m       \u001b[36mawait\u001b[39m expect(paymentQueryService\u001b[33m.\u001b[39mgetBillPayments(invalidBillId))\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m             \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 509 |\u001b[39m         \u001b[33m.\u001b[39mrejects\u001b[33m.\u001b[39mtoThrow(\u001b[32m'账单ID无效'\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 510 |\u001b[39m     })\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 511 |\u001b[39m   })\u001b[33m;\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat expect (\u001b[22m\u001b[2mnode_modules/expect/build/index.js\u001b[2m:113:15)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.expect (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/payment-query-service.test.js\u001b[39m\u001b[0m\u001b[2m:508:13)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m支付记录查询服务测试 › getUserPaymentTransfers › 应该成功获取用户支付转移记录\u001b[39m\u001b[22m\n\n    \u001b[2mexpect(\u001b[22m\u001b[31mjest.fn()\u001b[39m\u001b[2m).\u001b[22mtoHaveBeenCalledWith\u001b[2m(\u001b[22m\u001b[32m...expected\u001b[39m\u001b[2m)\u001b[22m\n\n    Expected: \u001b[32mObjectContaining {\"include\": ArrayContaining [ObjectContaining {\"as\": \"FromPayment\", \"include\": ArrayContaining [ObjectContaining {\"model\": {\"findByPk\": [Function mockConstructor]}}], \"model\": {\"findAndCountAll\": [Function mockConstructor], \"findByPk\": [Function mockConstructor]}}, ObjectContaining {\"as\": \"ToPayment\", \"include\": ArrayContaining [ObjectContaining {\"model\": {\"findByPk\": [Function mockConstructor]}}], \"model\": {\"findAndCountAll\": [Function mockConstructor], \"findByPk\": [Function mockConstructor]}}], \"limit\": 20, \"offset\": 0, \"order\": [[\"created_at\", \"DESC\"]], \"where\": ObjectContaining {\"Any\": ObjectContaining {\"Any\": 1}}}\u001b[39m\n    Received: \u001b[31m{\"include\": [{\"as\": \"bill\", \"attributes\": [\"id\", \"title\", \"amount\", \"status\"], \"model\": {\"findByPk\": [Function mockConstructor]}}, {\"as\": \"fromUser\", \"attributes\": [\"id\", \"name\", \"email\", \"avatar\"], \"model\": {\"findByPk\": [Function mockConstructor]}}, {\"as\": \"toUser\", \"attributes\": [\"id\", \"name\", \"email\", \"avatar\"], \"model\": {\"findByPk\": [Function mockConstructor]}}], \"limit\": 10, \"offset\": 0, \"order\": [[\"createdAt\", \"DESC\"]], \"where\": {Symbol(or): [{\"fromUserId\": 1}, {\"toUserId\": 1}]}}\u001b[39m\n\n    Number of calls: \u001b[31m1\u001b[39m\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 557 |\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 558 |\u001b[39m       \u001b[90m// 验证结果\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 559 |\u001b[39m       expect(\u001b[33mPaymentTransfer\u001b[39m\u001b[33m.\u001b[39mfindAndCountAll)\u001b[33m.\u001b[39mtoHaveBeenCalledWith(\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                                               \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 560 |\u001b[39m         expect\u001b[33m.\u001b[39mobjectContaining({\u001b[22m\n\u001b[2m     \u001b[90m 561 |\u001b[39m           include\u001b[33m:\u001b[39m expect\u001b[33m.\u001b[39marrayContaining([\u001b[22m\n\u001b[2m     \u001b[90m 562 |\u001b[39m             expect\u001b[33m.\u001b[39mobjectContaining({\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.toHaveBeenCalledWith (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/payment-query-service.test.js\u001b[39m\u001b[0m\u001b[2m:559:47)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m支付记录查询服务测试 › getUserPaymentTransfers › 应该在用户ID无效时抛出错误\u001b[39m\u001b[22m\n\n    \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mrejects\u001b[2m.\u001b[22mtoThrow\u001b[2m()\u001b[22m\n\n    Received promise resolved instead of rejected\n    Resolved to value: \u001b[31m{\"items\": [{\"FromPayment\": {\"Bill\": {\"id\": 1, \"title\": \"测试账单\"}, \"amount\": 100.5, \"bill_id\": 1, \"id\": 1}, \"ToPayment\": {\"Bill\": {\"id\": 2, \"title\": \"测试账单2\"}, \"amount\": 150, \"bill_id\": 2, \"id\": 2}, \"amount\": 50, \"created_at\": 2023-06-15T00:00:00.000Z, \"from_payment_id\": 1, \"id\": 1, \"status\": \"completed\", \"to_payment_id\": 2}], \"page\": 1, \"pageSize\": 10, \"total\": 1, \"totalPages\": 1}\u001b[39m\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 627 |\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 628 |\u001b[39m       \u001b[90m// 验证函数抛出错误\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 629 |\u001b[39m       \u001b[36mawait\u001b[39m expect(paymentQueryService\u001b[33m.\u001b[39mgetUserPaymentTransfers(invalidUserId))\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m             \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 630 |\u001b[39m         \u001b[33m.\u001b[39mrejects\u001b[33m.\u001b[39mtoThrow(\u001b[32m'用户ID无效'\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 631 |\u001b[39m     })\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 632 |\u001b[39m   })\u001b[33m;\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat expect (\u001b[22m\u001b[2mnode_modules/expect/build/index.js\u001b[2m:113:15)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.expect (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/payment-query-service.test.js\u001b[39m\u001b[0m\u001b[2m:629:13)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m支付记录查询服务测试 › getRoomPaymentStats › 应该成功获取房间支付统计\u001b[39m\u001b[22m\n\n    TypeError: Payment.findAll is not a function\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 493 |\u001b[39m     \u001b[22m\n\u001b[2m     \u001b[90m 494 |\u001b[39m     \u001b[90m// 查询支付记录\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 495 |\u001b[39m     \u001b[36mconst\u001b[39m payments \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m \u001b[33mPayment\u001b[39m\u001b[33m.\u001b[39mfindAll({\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                                    \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 496 |\u001b[39m       where\u001b[33m:\u001b[39m whereClause\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 497 |\u001b[39m       include\u001b[33m:\u001b[39m [\u001b[22m\n\u001b[2m     \u001b[90m 498 |\u001b[39m         {\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.findAll [as getRoomPaymentStats] (\u001b[22m\u001b[2mservices/payment-query-service.js\u001b[2m:495:36)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.getRoomPaymentStats (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/payment-query-service.test.js\u001b[39m\u001b[0m\u001b[2m:673:48)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m支付记录查询服务测试 › getRoomPaymentStats › 应该在房间ID无效时抛出错误\u001b[39m\u001b[22m\n\n    \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mrejects\u001b[2m.\u001b[22mtoThrow\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m)\u001b[22m\n\n    Expected substring: \u001b[32m\"房间ID无效\"\u001b[39m\n    Received message:   \u001b[31m\"Cannot destructure property 'roomId' of 'queryParams' as it is null.\"\u001b[39m\n\n        \u001b[0m \u001b[90m 473 |\u001b[39m     \n         \u001b[90m 474 |\u001b[39m     \u001b[36mconst\u001b[39m {\n        \u001b[31m\u001b[1m>\u001b[22m\u001b[39m\u001b[90m 475 |\u001b[39m       roomId\u001b[33m,\u001b[39m\n         \u001b[90m     |\u001b[39m       \u001b[31m\u001b[1m^\u001b[22m\u001b[39m\n         \u001b[90m 476 |\u001b[39m       startDate\u001b[33m,\u001b[39m\n         \u001b[90m 477 |\u001b[39m       endDate\n         \u001b[90m 478 |\u001b[39m     } \u001b[33m=\u001b[39m queryParams\u001b[33m;\u001b[39m\u001b[0m\n\n          \u001b[2mat Object.roomId [as getRoomPaymentStats] (\u001b[22mservices/payment-query-service.js\u001b[2m:475:7)\u001b[22m\n          \u001b[2mat Object.getRoomPaymentStats (\u001b[22mtests/unit/payment-query-service.test.js\u001b[2m:727:40)\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 726 |\u001b[39m       \u001b[90m// 验证函数抛出错误\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 727 |\u001b[39m       \u001b[36mawait\u001b[39m expect(paymentQueryService\u001b[33m.\u001b[39mgetRoomPaymentStats(invalidRoomId))\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 728 |\u001b[39m         \u001b[33m.\u001b[39mrejects\u001b[33m.\u001b[39mtoThrow(\u001b[32m'房间ID无效'\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                  \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 729 |\u001b[39m     })\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 730 |\u001b[39m   })\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 731 |\u001b[39m })\u001b[33m;\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.toThrow (\u001b[22m\u001b[2mnode_modules/expect/build/index.js\u001b[2m:218:22)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.toThrow (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/payment-query-service.test.js\u001b[39m\u001b[0m\u001b[2m:728:18)\u001b[22m\u001b[2m\u001b[22m\n","name":"C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\payment-query-service.test.js","startTime":1762159269493,"status":"failed","summary":""},{"assertionResults":[{"ancestorTitles":["离线支付服务测试","createOfflinePayment"],"duration":16,"failureDetails":[{}],"failureMessages":["TypeError: Cannot read properties of undefined (reading 'create')\n    at Object.create [as createOfflinePayment] (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\services\\offline-payment-service.js:54:49)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at Object.<anonymous> (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\offline-payment-service.test.js:61:22)"],"fullName":"离线支付服务测试 createOfflinePayment 应该成功创建离线支付记录","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该成功创建离线支付记录"},{"ancestorTitles":["离线支付服务测试","createOfflinePayment"],"duration":5,"failureDetails":[],"failureMessages":[],"fullName":"离线支付服务测试 createOfflinePayment 应该在缺少必要参数时抛出错误","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"应该在缺少必要参数时抛出错误"},{"ancestorTitles":["离线支付服务测试","createOfflinePayment"],"duration":4,"failureDetails":[],"failureMessages":[],"fullName":"离线支付服务测试 createOfflinePayment 应该在账单不存在时抛出错误","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"应该在账单不存在时抛出错误"},{"ancestorTitles":["离线支付服务测试","createOfflinePayment"],"duration":2,"failureDetails":[],"failureMessages":[],"fullName":"离线支付服务测试 createOfflinePayment 应该在用户不存在时抛出错误","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"应该在用户不存在时抛出错误"},{"ancestorTitles":["离线支付服务测试","syncOfflinePayment"],"duration":3,"failureDetails":[{}],"failureMessages":["TypeError: Cannot read properties of undefined (reading 'findByPk')\n    at Object.findByPk [as syncOfflinePayment] (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\services\\offline-payment-service.js:86:42)\n    at Object.syncOfflinePayment (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\offline-payment-service.test.js:162:50)\n    at Promise.then.completed (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:444:34)"],"fullName":"离线支付服务测试 syncOfflinePayment 应该成功同步离线支付记录","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该成功同步离线支付记录"},{"ancestorTitles":["离线支付服务测试","syncOfflinePayment"],"duration":5,"failureDetails":[{"matcherResult":{"message":"\u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mrejects\u001b[2m.\u001b[22mtoThrow\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m)\u001b[22m\n\nExpected substring: \u001b[32m\"支付记录不存在\"\u001b[39m\nReceived message:   \u001b[31m\"Cannot read properties of undefined (reading 'findByPk')\"\u001b[39m\n\n    \u001b[0m \u001b[90m 84 |\u001b[39m     \n     \u001b[90m 85 |\u001b[39m     \u001b[90m// 查找离线支付记录\u001b[39m\n    \u001b[31m\u001b[1m>\u001b[22m\u001b[39m\u001b[90m 86 |\u001b[39m     \u001b[36mconst\u001b[39m payment \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m \u001b[33mOfflinePayment\u001b[39m\u001b[33m.\u001b[39mfindByPk(paymentId)\u001b[33m;\u001b[39m\n     \u001b[90m    |\u001b[39m                                          \u001b[31m\u001b[1m^\u001b[22m\u001b[39m\n     \u001b[90m 87 |\u001b[39m     \n     \u001b[90m 88 |\u001b[39m     \u001b[36mif\u001b[39m (\u001b[33m!\u001b[39mpayment) {\n     \u001b[90m 89 |\u001b[39m       \u001b[36mthrow\u001b[39m \u001b[36mnew\u001b[39m \u001b[33mError\u001b[39m(\u001b[32m'支付记录不存在'\u001b[39m)\u001b[33m;\u001b[39m\u001b[0m\n\n      \u001b[2mat Object.findByPk [as syncOfflinePayment] (\u001b[22mservices/offline-payment-service.js\u001b[2m:86:42)\u001b[22m\n      \u001b[2mat Object.syncOfflinePayment (\u001b[22mtests/unit/offline-payment-service.test.js\u001b[2m:189:42)\u001b[22m","pass":false},"message":"\u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mrejects\u001b[2m.\u001b[22mtoThrow\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m)\u001b[22m\n\nExpected substring: \u001b[32m\"支付记录不存在\"\u001b[39m\nReceived message:   \u001b[31m\"Cannot read properties of undefined (reading 'findByPk')\"\u001b[39m\n\n    \u001b[0m \u001b[90m 84 |\u001b[39m     \n     \u001b[90m 85 |\u001b[39m     \u001b[90m// 查找离线支付记录\u001b[39m\n    \u001b[31m\u001b[1m>\u001b[22m\u001b[39m\u001b[90m 86 |\u001b[39m     \u001b[36mconst\u001b[39m payment \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m \u001b[33mOfflinePayment\u001b[39m\u001b[33m.\u001b[39mfindByPk(paymentId)\u001b[33m;\u001b[39m\n     \u001b[90m    |\u001b[39m                                          \u001b[31m\u001b[1m^\u001b[22m\u001b[39m\n     \u001b[90m 87 |\u001b[39m     \n     \u001b[90m 88 |\u001b[39m     \u001b[36mif\u001b[39m (\u001b[33m!\u001b[39mpayment) {\n     \u001b[90m 89 |\u001b[39m       \u001b[36mthrow\u001b[39m \u001b[36mnew\u001b[39m \u001b[33mError\u001b[39m(\u001b[32m'支付记录不存在'\u001b[39m)\u001b[33m;\u001b[39m\u001b[0m\n\n      \u001b[2mat Object.findByPk [as syncOfflinePayment] (\u001b[22mservices/offline-payment-service.js\u001b[2m:86:42)\u001b[22m\n      \u001b[2mat Object.syncOfflinePayment (\u001b[22mtests/unit/offline-payment-service.test.js\u001b[2m:189:42)\u001b[22m"}],"failureMessages":["Error: \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mrejects\u001b[2m.\u001b[22mtoThrow\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m)\u001b[22m\n\nExpected substring: \u001b[32m\"支付记录不存在\"\u001b[39m\nReceived message:   \u001b[31m\"Cannot read properties of undefined (reading 'findByPk')\"\u001b[39m\n\n    \u001b[0m \u001b[90m 84 |\u001b[39m     \n     \u001b[90m 85 |\u001b[39m     \u001b[90m// 查找离线支付记录\u001b[39m\n    \u001b[31m\u001b[1m>\u001b[22m\u001b[39m\u001b[90m 86 |\u001b[39m     \u001b[36mconst\u001b[39m payment \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m \u001b[33mOfflinePayment\u001b[39m\u001b[33m.\u001b[39mfindByPk(paymentId)\u001b[33m;\u001b[39m\n     \u001b[90m    |\u001b[39m                                          \u001b[31m\u001b[1m^\u001b[22m\u001b[39m\n     \u001b[90m 87 |\u001b[39m     \n     \u001b[90m 88 |\u001b[39m     \u001b[36mif\u001b[39m (\u001b[33m!\u001b[39mpayment) {\n     \u001b[90m 89 |\u001b[39m       \u001b[36mthrow\u001b[39m \u001b[36mnew\u001b[39m \u001b[33mError\u001b[39m(\u001b[32m'支付记录不存在'\u001b[39m)\u001b[33m;\u001b[39m\u001b[0m\n\n      \u001b[2mat Object.findByPk [as syncOfflinePayment] (\u001b[22mservices/offline-payment-service.js\u001b[2m:86:42)\u001b[22m\n      \u001b[2mat Object.syncOfflinePayment (\u001b[22mtests/unit/offline-payment-service.test.js\u001b[2m:189:42)\u001b[22m\n    at Object.toThrow (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\expect\\build\\index.js:218:22)\n    at Object.toThrow (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\offline-payment-service.test.js:190:18)\n    at Promise.then.completed (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:444:34)"],"fullName":"离线支付服务测试 syncOfflinePayment 应该在支付记录不存在时抛出错误","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该在支付记录不存在时抛出错误"},{"ancestorTitles":["离线支付服务测试","syncOfflinePayment"],"duration":6,"failureDetails":[{"matcherResult":{"message":"\u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mrejects\u001b[2m.\u001b[22mtoThrow\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m)\u001b[22m\n\nExpected substring: \u001b[32m\"只能同步离线待同步状态的支付记录\"\u001b[39m\nReceived message:   \u001b[31m\"Cannot read properties of undefined (reading 'findByPk')\"\u001b[39m\n\n    \u001b[0m \u001b[90m 84 |\u001b[39m     \n     \u001b[90m 85 |\u001b[39m     \u001b[90m// 查找离线支付记录\u001b[39m\n    \u001b[31m\u001b[1m>\u001b[22m\u001b[39m\u001b[90m 86 |\u001b[39m     \u001b[36mconst\u001b[39m payment \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m \u001b[33mOfflinePayment\u001b[39m\u001b[33m.\u001b[39mfindByPk(paymentId)\u001b[33m;\u001b[39m\n     \u001b[90m    |\u001b[39m                                          \u001b[31m\u001b[1m^\u001b[22m\u001b[39m\n     \u001b[90m 87 |\u001b[39m     \n     \u001b[90m 88 |\u001b[39m     \u001b[36mif\u001b[39m (\u001b[33m!\u001b[39mpayment) {\n     \u001b[90m 89 |\u001b[39m       \u001b[36mthrow\u001b[39m \u001b[36mnew\u001b[39m \u001b[33mError\u001b[39m(\u001b[32m'支付记录不存在'\u001b[39m)\u001b[33m;\u001b[39m\u001b[0m\n\n      \u001b[2mat Object.findByPk [as syncOfflinePayment] (\u001b[22mservices/offline-payment-service.js\u001b[2m:86:42)\u001b[22m\n      \u001b[2mat Object.syncOfflinePayment (\u001b[22mtests/unit/offline-payment-service.test.js\u001b[2m:208:42)\u001b[22m","pass":false},"message":"\u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mrejects\u001b[2m.\u001b[22mtoThrow\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m)\u001b[22m\n\nExpected substring: \u001b[32m\"只能同步离线待同步状态的支付记录\"\u001b[39m\nReceived message:   \u001b[31m\"Cannot read properties of undefined (reading 'findByPk')\"\u001b[39m\n\n    \u001b[0m \u001b[90m 84 |\u001b[39m     \n     \u001b[90m 85 |\u001b[39m     \u001b[90m// 查找离线支付记录\u001b[39m\n    \u001b[31m\u001b[1m>\u001b[22m\u001b[39m\u001b[90m 86 |\u001b[39m     \u001b[36mconst\u001b[39m payment \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m \u001b[33mOfflinePayment\u001b[39m\u001b[33m.\u001b[39mfindByPk(paymentId)\u001b[33m;\u001b[39m\n     \u001b[90m    |\u001b[39m                                          \u001b[31m\u001b[1m^\u001b[22m\u001b[39m\n     \u001b[90m 87 |\u001b[39m     \n     \u001b[90m 88 |\u001b[39m     \u001b[36mif\u001b[39m (\u001b[33m!\u001b[39mpayment) {\n     \u001b[90m 89 |\u001b[39m       \u001b[36mthrow\u001b[39m \u001b[36mnew\u001b[39m \u001b[33mError\u001b[39m(\u001b[32m'支付记录不存在'\u001b[39m)\u001b[33m;\u001b[39m\u001b[0m\n\n      \u001b[2mat Object.findByPk [as syncOfflinePayment] (\u001b[22mservices/offline-payment-service.js\u001b[2m:86:42)\u001b[22m\n      \u001b[2mat Object.syncOfflinePayment (\u001b[22mtests/unit/offline-payment-service.test.js\u001b[2m:208:42)\u001b[22m"}],"failureMessages":["Error: \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mrejects\u001b[2m.\u001b[22mtoThrow\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m)\u001b[22m\n\nExpected substring: \u001b[32m\"只能同步离线待同步状态的支付记录\"\u001b[39m\nReceived message:   \u001b[31m\"Cannot read properties of undefined (reading 'findByPk')\"\u001b[39m\n\n    \u001b[0m \u001b[90m 84 |\u001b[39m     \n     \u001b[90m 85 |\u001b[39m     \u001b[90m// 查找离线支付记录\u001b[39m\n    \u001b[31m\u001b[1m>\u001b[22m\u001b[39m\u001b[90m 86 |\u001b[39m     \u001b[36mconst\u001b[39m payment \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m \u001b[33mOfflinePayment\u001b[39m\u001b[33m.\u001b[39mfindByPk(paymentId)\u001b[33m;\u001b[39m\n     \u001b[90m    |\u001b[39m                                          \u001b[31m\u001b[1m^\u001b[22m\u001b[39m\n     \u001b[90m 87 |\u001b[39m     \n     \u001b[90m 88 |\u001b[39m     \u001b[36mif\u001b[39m (\u001b[33m!\u001b[39mpayment) {\n     \u001b[90m 89 |\u001b[39m       \u001b[36mthrow\u001b[39m \u001b[36mnew\u001b[39m \u001b[33mError\u001b[39m(\u001b[32m'支付记录不存在'\u001b[39m)\u001b[33m;\u001b[39m\u001b[0m\n\n      \u001b[2mat Object.findByPk [as syncOfflinePayment] (\u001b[22mservices/offline-payment-service.js\u001b[2m:86:42)\u001b[22m\n      \u001b[2mat Object.syncOfflinePayment (\u001b[22mtests/unit/offline-payment-service.test.js\u001b[2m:208:42)\u001b[22m\n    at Object.toThrow (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\expect\\build\\index.js:218:22)\n    at Object.toThrow (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\offline-payment-service.test.js:209:18)\n    at Promise.then.completed (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:444:34)"],"fullName":"离线支付服务测试 syncOfflinePayment 应该在支付记录状态不正确时抛出错误","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该在支付记录状态不正确时抛出错误"},{"ancestorTitles":["离线支付服务测试","getUserOfflinePayments"],"duration":2,"failureDetails":[{}],"failureMessages":["TypeError: Cannot read properties of undefined (reading 'findAndCountAll')\n    at Object.findAndCountAll [as getUserOfflinePayments] (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\services\\offline-payment-service.js:145:60)\n    at Object.getUserOfflinePayments (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\offline-payment-service.test.js:253:50)\n    at Promise.then.completed (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:444:34)"],"fullName":"离线支付服务测试 getUserOfflinePayments 应该成功获取用户离线支付记录","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该成功获取用户离线支付记录"},{"ancestorTitles":["离线支付服务测试","getUserOfflinePayments"],"duration":4,"failureDetails":[{"matcherResult":{"message":"\u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mrejects\u001b[2m.\u001b[22mtoThrow\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m)\u001b[22m\n\nExpected substring: \u001b[32m\"Cannot read properties of null (reading 'isOffline')\"\u001b[39m\nReceived message:   \u001b[31m\"Cannot read properties of undefined (reading 'findAndCountAll')\"\u001b[39m\n\n    \u001b[0m \u001b[90m 143 |\u001b[39m     \n     \u001b[90m 144 |\u001b[39m     \u001b[90m// 查询离线支付记录\u001b[39m\n    \u001b[31m\u001b[1m>\u001b[22m\u001b[39m\u001b[90m 145 |\u001b[39m     \u001b[36mconst\u001b[39m { count\u001b[33m,\u001b[39m rows\u001b[33m:\u001b[39m payments } \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m \u001b[33mOfflinePayment\u001b[39m\u001b[33m.\u001b[39mfindAndCountAll({\n     \u001b[90m     |\u001b[39m                                                            \u001b[31m\u001b[1m^\u001b[22m\u001b[39m\n     \u001b[90m 146 |\u001b[39m       where\u001b[33m:\u001b[39m whereClause\u001b[33m,\u001b[39m\n     \u001b[90m 147 |\u001b[39m       include\u001b[33m:\u001b[39m [\n     \u001b[90m 148 |\u001b[39m         {\u001b[0m\n\n      \u001b[2mat Object.findAndCountAll [as getUserOfflinePayments] (\u001b[22mservices/offline-payment-service.js\u001b[2m:145:60)\u001b[22m\n      \u001b[2mat Object.getUserOfflinePayments (\u001b[22mtests/unit/offline-payment-service.test.js\u001b[2m:291:42)\u001b[22m","pass":false},"message":"\u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mrejects\u001b[2m.\u001b[22mtoThrow\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m)\u001b[22m\n\nExpected substring: \u001b[32m\"Cannot read properties of null (reading 'isOffline')\"\u001b[39m\nReceived message:   \u001b[31m\"Cannot read properties of undefined (reading 'findAndCountAll')\"\u001b[39m\n\n    \u001b[0m \u001b[90m 143 |\u001b[39m     \n     \u001b[90m 144 |\u001b[39m     \u001b[90m// 查询离线支付记录\u001b[39m\n    \u001b[31m\u001b[1m>\u001b[22m\u001b[39m\u001b[90m 145 |\u001b[39m     \u001b[36mconst\u001b[39m { count\u001b[33m,\u001b[39m rows\u001b[33m:\u001b[39m payments } \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m \u001b[33mOfflinePayment\u001b[39m\u001b[33m.\u001b[39mfindAndCountAll({\n     \u001b[90m     |\u001b[39m                                                            \u001b[31m\u001b[1m^\u001b[22m\u001b[39m\n     \u001b[90m 146 |\u001b[39m       where\u001b[33m:\u001b[39m whereClause\u001b[33m,\u001b[39m\n     \u001b[90m 147 |\u001b[39m       include\u001b[33m:\u001b[39m [\n     \u001b[90m 148 |\u001b[39m         {\u001b[0m\n\n      \u001b[2mat Object.findAndCountAll [as getUserOfflinePayments] (\u001b[22mservices/offline-payment-service.js\u001b[2m:145:60)\u001b[22m\n      \u001b[2mat Object.getUserOfflinePayments (\u001b[22mtests/unit/offline-payment-service.test.js\u001b[2m:291:42)\u001b[22m"}],"failureMessages":["Error: \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mrejects\u001b[2m.\u001b[22mtoThrow\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m)\u001b[22m\n\nExpected substring: \u001b[32m\"Cannot read properties of null (reading 'isOffline')\"\u001b[39m\nReceived message:   \u001b[31m\"Cannot read properties of undefined (reading 'findAndCountAll')\"\u001b[39m\n\n    \u001b[0m \u001b[90m 143 |\u001b[39m     \n     \u001b[90m 144 |\u001b[39m     \u001b[90m// 查询离线支付记录\u001b[39m\n    \u001b[31m\u001b[1m>\u001b[22m\u001b[39m\u001b[90m 145 |\u001b[39m     \u001b[36mconst\u001b[39m { count\u001b[33m,\u001b[39m rows\u001b[33m:\u001b[39m payments } \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m \u001b[33mOfflinePayment\u001b[39m\u001b[33m.\u001b[39mfindAndCountAll({\n     \u001b[90m     |\u001b[39m                                                            \u001b[31m\u001b[1m^\u001b[22m\u001b[39m\n     \u001b[90m 146 |\u001b[39m       where\u001b[33m:\u001b[39m whereClause\u001b[33m,\u001b[39m\n     \u001b[90m 147 |\u001b[39m       include\u001b[33m:\u001b[39m [\n     \u001b[90m 148 |\u001b[39m         {\u001b[0m\n\n      \u001b[2mat Object.findAndCountAll [as getUserOfflinePayments] (\u001b[22mservices/offline-payment-service.js\u001b[2m:145:60)\u001b[22m\n      \u001b[2mat Object.getUserOfflinePayments (\u001b[22mtests/unit/offline-payment-service.test.js\u001b[2m:291:42)\u001b[22m\n    at Object.toThrow (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\expect\\build\\index.js:218:22)\n    at Object.toThrow (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\offline-payment-service.test.js:292:18)\n    at Promise.then.completed (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:444:34)"],"fullName":"离线支付服务测试 getUserOfflinePayments 应该在用户ID无效时抛出错误","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该在用户ID无效时抛出错误"},{"ancestorTitles":["离线支付服务测试","getPendingSyncPayments"],"duration":3,"failureDetails":[{}],"failureMessages":["TypeError: Cannot read properties of undefined (reading 'findAndCountAll')\n    at Object.findAndCountAll [as getPendingSyncPayments] (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\services\\offline-payment-service.js:195:60)\n    at Object.getPendingSyncPayments (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\offline-payment-service.test.js:326:50)\n    at Promise.then.completed (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:444:34)"],"fullName":"离线支付服务测试 getPendingSyncPayments 应该成功获取待同步的离线支付记录","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该成功获取待同步的离线支付记录"},{"ancestorTitles":["离线支付服务测试","markPaymentSyncFailed"],"duration":2,"failureDetails":[{}],"failureMessages":["TypeError: Cannot read properties of undefined (reading 'findByPk')\n    at Object.findByPk [as markPaymentSyncFailed] (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\services\\offline-payment-service.js:242:42)\n    at Object.markPaymentSyncFailed (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\offline-payment-service.test.js:383:50)\n    at Promise.then.completed (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:444:34)"],"fullName":"离线支付服务测试 markPaymentSyncFailed 应该成功标记支付同步失败","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该成功标记支付同步失败"},{"ancestorTitles":["离线支付服务测试","markPaymentSyncFailed"],"duration":4,"failureDetails":[{"matcherResult":{"message":"\u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mrejects\u001b[2m.\u001b[22mtoThrow\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m)\u001b[22m\n\nExpected substring: \u001b[32m\"支付记录不存在\"\u001b[39m\nReceived message:   \u001b[31m\"Cannot read properties of undefined (reading 'findByPk')\"\u001b[39m\n\n    \u001b[0m \u001b[90m 240 |\u001b[39m     \n     \u001b[90m 241 |\u001b[39m     \u001b[90m// 查找离线支付记录\u001b[39m\n    \u001b[31m\u001b[1m>\u001b[22m\u001b[39m\u001b[90m 242 |\u001b[39m     \u001b[36mconst\u001b[39m payment \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m \u001b[33mOfflinePayment\u001b[39m\u001b[33m.\u001b[39mfindByPk(paymentId)\u001b[33m;\u001b[39m\n     \u001b[90m     |\u001b[39m                                          \u001b[31m\u001b[1m^\u001b[22m\u001b[39m\n     \u001b[90m 243 |\u001b[39m     \n     \u001b[90m 244 |\u001b[39m     \u001b[36mif\u001b[39m (\u001b[33m!\u001b[39mpayment) {\n     \u001b[90m 245 |\u001b[39m       \u001b[36mthrow\u001b[39m \u001b[36mnew\u001b[39m \u001b[33mError\u001b[39m(\u001b[32m'支付记录不存在'\u001b[39m)\u001b[33m;\u001b[39m\u001b[0m\n\n      \u001b[2mat Object.findByPk [as markPaymentSyncFailed] (\u001b[22mservices/offline-payment-service.js\u001b[2m:242:42)\u001b[22m\n      \u001b[2mat Object.markPaymentSyncFailed (\u001b[22mtests/unit/offline-payment-service.test.js\u001b[2m:406:42)\u001b[22m","pass":false},"message":"\u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mrejects\u001b[2m.\u001b[22mtoThrow\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m)\u001b[22m\n\nExpected substring: \u001b[32m\"支付记录不存在\"\u001b[39m\nReceived message:   \u001b[31m\"Cannot read properties of undefined (reading 'findByPk')\"\u001b[39m\n\n    \u001b[0m \u001b[90m 240 |\u001b[39m     \n     \u001b[90m 241 |\u001b[39m     \u001b[90m// 查找离线支付记录\u001b[39m\n    \u001b[31m\u001b[1m>\u001b[22m\u001b[39m\u001b[90m 242 |\u001b[39m     \u001b[36mconst\u001b[39m payment \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m \u001b[33mOfflinePayment\u001b[39m\u001b[33m.\u001b[39mfindByPk(paymentId)\u001b[33m;\u001b[39m\n     \u001b[90m     |\u001b[39m                                          \u001b[31m\u001b[1m^\u001b[22m\u001b[39m\n     \u001b[90m 243 |\u001b[39m     \n     \u001b[90m 244 |\u001b[39m     \u001b[36mif\u001b[39m (\u001b[33m!\u001b[39mpayment) {\n     \u001b[90m 245 |\u001b[39m       \u001b[36mthrow\u001b[39m \u001b[36mnew\u001b[39m \u001b[33mError\u001b[39m(\u001b[32m'支付记录不存在'\u001b[39m)\u001b[33m;\u001b[39m\u001b[0m\n\n      \u001b[2mat Object.findByPk [as markPaymentSyncFailed] (\u001b[22mservices/offline-payment-service.js\u001b[2m:242:42)\u001b[22m\n      \u001b[2mat Object.markPaymentSyncFailed (\u001b[22mtests/unit/offline-payment-service.test.js\u001b[2m:406:42)\u001b[22m"}],"failureMessages":["Error: \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mrejects\u001b[2m.\u001b[22mtoThrow\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m)\u001b[22m\n\nExpected substring: \u001b[32m\"支付记录不存在\"\u001b[39m\nReceived message:   \u001b[31m\"Cannot read properties of undefined (reading 'findByPk')\"\u001b[39m\n\n    \u001b[0m \u001b[90m 240 |\u001b[39m     \n     \u001b[90m 241 |\u001b[39m     \u001b[90m// 查找离线支付记录\u001b[39m\n    \u001b[31m\u001b[1m>\u001b[22m\u001b[39m\u001b[90m 242 |\u001b[39m     \u001b[36mconst\u001b[39m payment \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m \u001b[33mOfflinePayment\u001b[39m\u001b[33m.\u001b[39mfindByPk(paymentId)\u001b[33m;\u001b[39m\n     \u001b[90m     |\u001b[39m                                          \u001b[31m\u001b[1m^\u001b[22m\u001b[39m\n     \u001b[90m 243 |\u001b[39m     \n     \u001b[90m 244 |\u001b[39m     \u001b[36mif\u001b[39m (\u001b[33m!\u001b[39mpayment) {\n     \u001b[90m 245 |\u001b[39m       \u001b[36mthrow\u001b[39m \u001b[36mnew\u001b[39m \u001b[33mError\u001b[39m(\u001b[32m'支付记录不存在'\u001b[39m)\u001b[33m;\u001b[39m\u001b[0m\n\n      \u001b[2mat Object.findByPk [as markPaymentSyncFailed] (\u001b[22mservices/offline-payment-service.js\u001b[2m:242:42)\u001b[22m\n      \u001b[2mat Object.markPaymentSyncFailed (\u001b[22mtests/unit/offline-payment-service.test.js\u001b[2m:406:42)\u001b[22m\n    at Object.toThrow (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\expect\\build\\index.js:218:22)\n    at Object.toThrow (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\offline-payment-service.test.js:407:18)\n    at Promise.then.completed (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:444:34)"],"fullName":"离线支付服务测试 markPaymentSyncFailed 应该在支付记录不存在时抛出错误","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该在支付记录不存在时抛出错误"},{"ancestorTitles":["离线支付服务测试","markPaymentSyncFailed"],"duration":5,"failureDetails":[{"matcherResult":{"message":"\u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mrejects\u001b[2m.\u001b[22mtoThrow\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m)\u001b[22m\n\nExpected substring: \u001b[32m\"只能标记待同步状态的支付记录\"\u001b[39m\nReceived message:   \u001b[31m\"Cannot read properties of undefined (reading 'findByPk')\"\u001b[39m\n\n    \u001b[0m \u001b[90m 240 |\u001b[39m     \n     \u001b[90m 241 |\u001b[39m     \u001b[90m// 查找离线支付记录\u001b[39m\n    \u001b[31m\u001b[1m>\u001b[22m\u001b[39m\u001b[90m 242 |\u001b[39m     \u001b[36mconst\u001b[39m payment \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m \u001b[33mOfflinePayment\u001b[39m\u001b[33m.\u001b[39mfindByPk(paymentId)\u001b[33m;\u001b[39m\n     \u001b[90m     |\u001b[39m                                          \u001b[31m\u001b[1m^\u001b[22m\u001b[39m\n     \u001b[90m 243 |\u001b[39m     \n     \u001b[90m 244 |\u001b[39m     \u001b[36mif\u001b[39m (\u001b[33m!\u001b[39mpayment) {\n     \u001b[90m 245 |\u001b[39m       \u001b[36mthrow\u001b[39m \u001b[36mnew\u001b[39m \u001b[33mError\u001b[39m(\u001b[32m'支付记录不存在'\u001b[39m)\u001b[33m;\u001b[39m\u001b[0m\n\n      \u001b[2mat Object.findByPk [as markPaymentSyncFailed] (\u001b[22mservices/offline-payment-service.js\u001b[2m:242:42)\u001b[22m\n      \u001b[2mat Object.markPaymentSyncFailed (\u001b[22mtests/unit/offline-payment-service.test.js\u001b[2m:425:42)\u001b[22m","pass":false},"message":"\u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mrejects\u001b[2m.\u001b[22mtoThrow\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m)\u001b[22m\n\nExpected substring: \u001b[32m\"只能标记待同步状态的支付记录\"\u001b[39m\nReceived message:   \u001b[31m\"Cannot read properties of undefined (reading 'findByPk')\"\u001b[39m\n\n    \u001b[0m \u001b[90m 240 |\u001b[39m     \n     \u001b[90m 241 |\u001b[39m     \u001b[90m// 查找离线支付记录\u001b[39m\n    \u001b[31m\u001b[1m>\u001b[22m\u001b[39m\u001b[90m 242 |\u001b[39m     \u001b[36mconst\u001b[39m payment \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m \u001b[33mOfflinePayment\u001b[39m\u001b[33m.\u001b[39mfindByPk(paymentId)\u001b[33m;\u001b[39m\n     \u001b[90m     |\u001b[39m                                          \u001b[31m\u001b[1m^\u001b[22m\u001b[39m\n     \u001b[90m 243 |\u001b[39m     \n     \u001b[90m 244 |\u001b[39m     \u001b[36mif\u001b[39m (\u001b[33m!\u001b[39mpayment) {\n     \u001b[90m 245 |\u001b[39m       \u001b[36mthrow\u001b[39m \u001b[36mnew\u001b[39m \u001b[33mError\u001b[39m(\u001b[32m'支付记录不存在'\u001b[39m)\u001b[33m;\u001b[39m\u001b[0m\n\n      \u001b[2mat Object.findByPk [as markPaymentSyncFailed] (\u001b[22mservices/offline-payment-service.js\u001b[2m:242:42)\u001b[22m\n      \u001b[2mat Object.markPaymentSyncFailed (\u001b[22mtests/unit/offline-payment-service.test.js\u001b[2m:425:42)\u001b[22m"}],"failureMessages":["Error: \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mrejects\u001b[2m.\u001b[22mtoThrow\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m)\u001b[22m\n\nExpected substring: \u001b[32m\"只能标记待同步状态的支付记录\"\u001b[39m\nReceived message:   \u001b[31m\"Cannot read properties of undefined (reading 'findByPk')\"\u001b[39m\n\n    \u001b[0m \u001b[90m 240 |\u001b[39m     \n     \u001b[90m 241 |\u001b[39m     \u001b[90m// 查找离线支付记录\u001b[39m\n    \u001b[31m\u001b[1m>\u001b[22m\u001b[39m\u001b[90m 242 |\u001b[39m     \u001b[36mconst\u001b[39m payment \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m \u001b[33mOfflinePayment\u001b[39m\u001b[33m.\u001b[39mfindByPk(paymentId)\u001b[33m;\u001b[39m\n     \u001b[90m     |\u001b[39m                                          \u001b[31m\u001b[1m^\u001b[22m\u001b[39m\n     \u001b[90m 243 |\u001b[39m     \n     \u001b[90m 244 |\u001b[39m     \u001b[36mif\u001b[39m (\u001b[33m!\u001b[39mpayment) {\n     \u001b[90m 245 |\u001b[39m       \u001b[36mthrow\u001b[39m \u001b[36mnew\u001b[39m \u001b[33mError\u001b[39m(\u001b[32m'支付记录不存在'\u001b[39m)\u001b[33m;\u001b[39m\u001b[0m\n\n      \u001b[2mat Object.findByPk [as markPaymentSyncFailed] (\u001b[22mservices/offline-payment-service.js\u001b[2m:242:42)\u001b[22m\n      \u001b[2mat Object.markPaymentSyncFailed (\u001b[22mtests/unit/offline-payment-service.test.js\u001b[2m:425:42)\u001b[22m\n    at Object.toThrow (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\expect\\build\\index.js:218:22)\n    at Object.toThrow (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\offline-payment-service.test.js:426:18)\n    at Promise.then.completed (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:444:34)"],"fullName":"离线支付服务测试 markPaymentSyncFailed 应该在支付记录状态不正确时抛出错误","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该在支付记录状态不正确时抛出错误"},{"ancestorTitles":["离线支付服务测试","retryPaymentSync"],"duration":5,"failureDetails":[{}],"failureMessages":["TypeError: Cannot read properties of undefined (reading 'findByPk')\n    at Object.findByPk [as retryPaymentSync] (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\services\\offline-payment-service.js:277:42)\n    at Object.retryPaymentSync (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\offline-payment-service.test.js:461:50)\n    at Promise.then.completed (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:444:34)"],"fullName":"离线支付服务测试 retryPaymentSync 应该成功重试同步失败的支付记录","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该成功重试同步失败的支付记录"},{"ancestorTitles":["离线支付服务测试","retryPaymentSync"],"duration":4,"failureDetails":[{"matcherResult":{"message":"\u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mrejects\u001b[2m.\u001b[22mtoThrow\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m)\u001b[22m\n\nExpected substring: \u001b[32m\"支付记录不存在\"\u001b[39m\nReceived message:   \u001b[31m\"Cannot read properties of undefined (reading 'findByPk')\"\u001b[39m\n\n    \u001b[0m \u001b[90m 275 |\u001b[39m     \n     \u001b[90m 276 |\u001b[39m     \u001b[90m// 查找离线支付记录\u001b[39m\n    \u001b[31m\u001b[1m>\u001b[22m\u001b[39m\u001b[90m 277 |\u001b[39m     \u001b[36mconst\u001b[39m payment \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m \u001b[33mOfflinePayment\u001b[39m\u001b[33m.\u001b[39mfindByPk(paymentId)\u001b[33m;\u001b[39m\n     \u001b[90m     |\u001b[39m                                          \u001b[31m\u001b[1m^\u001b[22m\u001b[39m\n     \u001b[90m 278 |\u001b[39m     \n     \u001b[90m 279 |\u001b[39m     \u001b[36mif\u001b[39m (\u001b[33m!\u001b[39mpayment) {\n     \u001b[90m 280 |\u001b[39m       \u001b[36mthrow\u001b[39m \u001b[36mnew\u001b[39m \u001b[33mError\u001b[39m(\u001b[32m'支付记录不存在'\u001b[39m)\u001b[33m;\u001b[39m\u001b[0m\n\n      \u001b[2mat Object.findByPk [as retryPaymentSync] (\u001b[22mservices/offline-payment-service.js\u001b[2m:277:42)\u001b[22m\n      \u001b[2mat Object.retryPaymentSync (\u001b[22mtests/unit/offline-payment-service.test.js\u001b[2m:483:42)\u001b[22m","pass":false},"message":"\u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mrejects\u001b[2m.\u001b[22mtoThrow\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m)\u001b[22m\n\nExpected substring: \u001b[32m\"支付记录不存在\"\u001b[39m\nReceived message:   \u001b[31m\"Cannot read properties of undefined (reading 'findByPk')\"\u001b[39m\n\n    \u001b[0m \u001b[90m 275 |\u001b[39m     \n     \u001b[90m 276 |\u001b[39m     \u001b[90m// 查找离线支付记录\u001b[39m\n    \u001b[31m\u001b[1m>\u001b[22m\u001b[39m\u001b[90m 277 |\u001b[39m     \u001b[36mconst\u001b[39m payment \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m \u001b[33mOfflinePayment\u001b[39m\u001b[33m.\u001b[39mfindByPk(paymentId)\u001b[33m;\u001b[39m\n     \u001b[90m     |\u001b[39m                                          \u001b[31m\u001b[1m^\u001b[22m\u001b[39m\n     \u001b[90m 278 |\u001b[39m     \n     \u001b[90m 279 |\u001b[39m     \u001b[36mif\u001b[39m (\u001b[33m!\u001b[39mpayment) {\n     \u001b[90m 280 |\u001b[39m       \u001b[36mthrow\u001b[39m \u001b[36mnew\u001b[39m \u001b[33mError\u001b[39m(\u001b[32m'支付记录不存在'\u001b[39m)\u001b[33m;\u001b[39m\u001b[0m\n\n      \u001b[2mat Object.findByPk [as retryPaymentSync] (\u001b[22mservices/offline-payment-service.js\u001b[2m:277:42)\u001b[22m\n      \u001b[2mat Object.retryPaymentSync (\u001b[22mtests/unit/offline-payment-service.test.js\u001b[2m:483:42)\u001b[22m"}],"failureMessages":["Error: \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mrejects\u001b[2m.\u001b[22mtoThrow\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m)\u001b[22m\n\nExpected substring: \u001b[32m\"支付记录不存在\"\u001b[39m\nReceived message:   \u001b[31m\"Cannot read properties of undefined (reading 'findByPk')\"\u001b[39m\n\n    \u001b[0m \u001b[90m 275 |\u001b[39m     \n     \u001b[90m 276 |\u001b[39m     \u001b[90m// 查找离线支付记录\u001b[39m\n    \u001b[31m\u001b[1m>\u001b[22m\u001b[39m\u001b[90m 277 |\u001b[39m     \u001b[36mconst\u001b[39m payment \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m \u001b[33mOfflinePayment\u001b[39m\u001b[33m.\u001b[39mfindByPk(paymentId)\u001b[33m;\u001b[39m\n     \u001b[90m     |\u001b[39m                                          \u001b[31m\u001b[1m^\u001b[22m\u001b[39m\n     \u001b[90m 278 |\u001b[39m     \n     \u001b[90m 279 |\u001b[39m     \u001b[36mif\u001b[39m (\u001b[33m!\u001b[39mpayment) {\n     \u001b[90m 280 |\u001b[39m       \u001b[36mthrow\u001b[39m \u001b[36mnew\u001b[39m \u001b[33mError\u001b[39m(\u001b[32m'支付记录不存在'\u001b[39m)\u001b[33m;\u001b[39m\u001b[0m\n\n      \u001b[2mat Object.findByPk [as retryPaymentSync] (\u001b[22mservices/offline-payment-service.js\u001b[2m:277:42)\u001b[22m\n      \u001b[2mat Object.retryPaymentSync (\u001b[22mtests/unit/offline-payment-service.test.js\u001b[2m:483:42)\u001b[22m\n    at Object.toThrow (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\expect\\build\\index.js:218:22)\n    at Object.toThrow (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\offline-payment-service.test.js:484:18)\n    at Promise.then.completed (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:444:34)"],"fullName":"离线支付服务测试 retryPaymentSync 应该在支付记录不存在时抛出错误","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该在支付记录不存在时抛出错误"},{"ancestorTitles":["离线支付服务测试","retryPaymentSync"],"duration":4,"failureDetails":[{"matcherResult":{"message":"\u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mrejects\u001b[2m.\u001b[22mtoThrow\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m)\u001b[22m\n\nExpected substring: \u001b[32m\"只能重试同步失败状态的支付记录\"\u001b[39m\nReceived message:   \u001b[31m\"Cannot read properties of undefined (reading 'findByPk')\"\u001b[39m\n\n    \u001b[0m \u001b[90m 275 |\u001b[39m     \n     \u001b[90m 276 |\u001b[39m     \u001b[90m// 查找离线支付记录\u001b[39m\n    \u001b[31m\u001b[1m>\u001b[22m\u001b[39m\u001b[90m 277 |\u001b[39m     \u001b[36mconst\u001b[39m payment \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m \u001b[33mOfflinePayment\u001b[39m\u001b[33m.\u001b[39mfindByPk(paymentId)\u001b[33m;\u001b[39m\n     \u001b[90m     |\u001b[39m                                          \u001b[31m\u001b[1m^\u001b[22m\u001b[39m\n     \u001b[90m 278 |\u001b[39m     \n     \u001b[90m 279 |\u001b[39m     \u001b[36mif\u001b[39m (\u001b[33m!\u001b[39mpayment) {\n     \u001b[90m 280 |\u001b[39m       \u001b[36mthrow\u001b[39m \u001b[36mnew\u001b[39m \u001b[33mError\u001b[39m(\u001b[32m'支付记录不存在'\u001b[39m)\u001b[33m;\u001b[39m\u001b[0m\n\n      \u001b[2mat Object.findByPk [as retryPaymentSync] (\u001b[22mservices/offline-payment-service.js\u001b[2m:277:42)\u001b[22m\n      \u001b[2mat Object.retryPaymentSync (\u001b[22mtests/unit/offline-payment-service.test.js\u001b[2m:501:42)\u001b[22m","pass":false},"message":"\u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mrejects\u001b[2m.\u001b[22mtoThrow\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m)\u001b[22m\n\nExpected substring: \u001b[32m\"只能重试同步失败状态的支付记录\"\u001b[39m\nReceived message:   \u001b[31m\"Cannot read properties of undefined (reading 'findByPk')\"\u001b[39m\n\n    \u001b[0m \u001b[90m 275 |\u001b[39m     \n     \u001b[90m 276 |\u001b[39m     \u001b[90m// 查找离线支付记录\u001b[39m\n    \u001b[31m\u001b[1m>\u001b[22m\u001b[39m\u001b[90m 277 |\u001b[39m     \u001b[36mconst\u001b[39m payment \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m \u001b[33mOfflinePayment\u001b[39m\u001b[33m.\u001b[39mfindByPk(paymentId)\u001b[33m;\u001b[39m\n     \u001b[90m     |\u001b[39m                                          \u001b[31m\u001b[1m^\u001b[22m\u001b[39m\n     \u001b[90m 278 |\u001b[39m     \n     \u001b[90m 279 |\u001b[39m     \u001b[36mif\u001b[39m (\u001b[33m!\u001b[39mpayment) {\n     \u001b[90m 280 |\u001b[39m       \u001b[36mthrow\u001b[39m \u001b[36mnew\u001b[39m \u001b[33mError\u001b[39m(\u001b[32m'支付记录不存在'\u001b[39m)\u001b[33m;\u001b[39m\u001b[0m\n\n      \u001b[2mat Object.findByPk [as retryPaymentSync] (\u001b[22mservices/offline-payment-service.js\u001b[2m:277:42)\u001b[22m\n      \u001b[2mat Object.retryPaymentSync (\u001b[22mtests/unit/offline-payment-service.test.js\u001b[2m:501:42)\u001b[22m"}],"failureMessages":["Error: \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mrejects\u001b[2m.\u001b[22mtoThrow\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m)\u001b[22m\n\nExpected substring: \u001b[32m\"只能重试同步失败状态的支付记录\"\u001b[39m\nReceived message:   \u001b[31m\"Cannot read properties of undefined (reading 'findByPk')\"\u001b[39m\n\n    \u001b[0m \u001b[90m 275 |\u001b[39m     \n     \u001b[90m 276 |\u001b[39m     \u001b[90m// 查找离线支付记录\u001b[39m\n    \u001b[31m\u001b[1m>\u001b[22m\u001b[39m\u001b[90m 277 |\u001b[39m     \u001b[36mconst\u001b[39m payment \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m \u001b[33mOfflinePayment\u001b[39m\u001b[33m.\u001b[39mfindByPk(paymentId)\u001b[33m;\u001b[39m\n     \u001b[90m     |\u001b[39m                                          \u001b[31m\u001b[1m^\u001b[22m\u001b[39m\n     \u001b[90m 278 |\u001b[39m     \n     \u001b[90m 279 |\u001b[39m     \u001b[36mif\u001b[39m (\u001b[33m!\u001b[39mpayment) {\n     \u001b[90m 280 |\u001b[39m       \u001b[36mthrow\u001b[39m \u001b[36mnew\u001b[39m \u001b[33mError\u001b[39m(\u001b[32m'支付记录不存在'\u001b[39m)\u001b[33m;\u001b[39m\u001b[0m\n\n      \u001b[2mat Object.findByPk [as retryPaymentSync] (\u001b[22mservices/offline-payment-service.js\u001b[2m:277:42)\u001b[22m\n      \u001b[2mat Object.retryPaymentSync (\u001b[22mtests/unit/offline-payment-service.test.js\u001b[2m:501:42)\u001b[22m\n    at Object.toThrow (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\expect\\build\\index.js:218:22)\n    at Object.toThrow (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\offline-payment-service.test.js:502:18)\n    at Promise.then.completed (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:444:34)"],"fullName":"离线支付服务测试 retryPaymentSync 应该在支付记录状态不正确时抛出错误","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该在支付记录状态不正确时抛出错误"}],"endTime":1762159270475,"message":"\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m离线支付服务测试 › createOfflinePayment › 应该成功创建离线支付记录\u001b[39m\u001b[22m\n\n    TypeError: Cannot read properties of undefined (reading 'create')\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 52 |\u001b[39m     \u001b[22m\n\u001b[2m     \u001b[90m 53 |\u001b[39m     \u001b[90m// 创建离线支付记录\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 54 |\u001b[39m     \u001b[36mconst\u001b[39m offlinePayment \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m \u001b[33mOfflinePayment\u001b[39m\u001b[33m.\u001b[39mcreate({\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m                                                 \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 55 |\u001b[39m       billId\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 56 |\u001b[39m       userId\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 57 |\u001b[39m       amount\u001b[33m,\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.create [as createOfflinePayment] (\u001b[22m\u001b[2mservices/offline-payment-service.js\u001b[2m:54:49)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous> (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/offline-payment-service.test.js\u001b[39m\u001b[0m\u001b[2m:61:22)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m离线支付服务测试 › syncOfflinePayment › 应该成功同步离线支付记录\u001b[39m\u001b[22m\n\n    TypeError: Cannot read properties of undefined (reading 'findByPk')\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 84 |\u001b[39m     \u001b[22m\n\u001b[2m     \u001b[90m 85 |\u001b[39m     \u001b[90m// 查找离线支付记录\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 86 |\u001b[39m     \u001b[36mconst\u001b[39m payment \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m \u001b[33mOfflinePayment\u001b[39m\u001b[33m.\u001b[39mfindByPk(paymentId)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m                                          \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 87 |\u001b[39m     \u001b[22m\n\u001b[2m     \u001b[90m 88 |\u001b[39m     \u001b[36mif\u001b[39m (\u001b[33m!\u001b[39mpayment) {\u001b[22m\n\u001b[2m     \u001b[90m 89 |\u001b[39m       \u001b[36mthrow\u001b[39m \u001b[36mnew\u001b[39m \u001b[33mError\u001b[39m(\u001b[32m'支付记录不存在'\u001b[39m)\u001b[33m;\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.findByPk [as syncOfflinePayment] (\u001b[22m\u001b[2mservices/offline-payment-service.js\u001b[2m:86:42)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.syncOfflinePayment (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/offline-payment-service.test.js\u001b[39m\u001b[0m\u001b[2m:162:50)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m离线支付服务测试 › syncOfflinePayment › 应该在支付记录不存在时抛出错误\u001b[39m\u001b[22m\n\n    \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mrejects\u001b[2m.\u001b[22mtoThrow\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m)\u001b[22m\n\n    Expected substring: \u001b[32m\"支付记录不存在\"\u001b[39m\n    Received message:   \u001b[31m\"Cannot read properties of undefined (reading 'findByPk')\"\u001b[39m\n\n        \u001b[0m \u001b[90m 84 |\u001b[39m     \n         \u001b[90m 85 |\u001b[39m     \u001b[90m// 查找离线支付记录\u001b[39m\n        \u001b[31m\u001b[1m>\u001b[22m\u001b[39m\u001b[90m 86 |\u001b[39m     \u001b[36mconst\u001b[39m payment \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m \u001b[33mOfflinePayment\u001b[39m\u001b[33m.\u001b[39mfindByPk(paymentId)\u001b[33m;\u001b[39m\n         \u001b[90m    |\u001b[39m                                          \u001b[31m\u001b[1m^\u001b[22m\u001b[39m\n         \u001b[90m 87 |\u001b[39m     \n         \u001b[90m 88 |\u001b[39m     \u001b[36mif\u001b[39m (\u001b[33m!\u001b[39mpayment) {\n         \u001b[90m 89 |\u001b[39m       \u001b[36mthrow\u001b[39m \u001b[36mnew\u001b[39m \u001b[33mError\u001b[39m(\u001b[32m'支付记录不存在'\u001b[39m)\u001b[33m;\u001b[39m\u001b[0m\n\n          \u001b[2mat Object.findByPk [as syncOfflinePayment] (\u001b[22mservices/offline-payment-service.js\u001b[2m:86:42)\u001b[22m\n          \u001b[2mat Object.syncOfflinePayment (\u001b[22mtests/unit/offline-payment-service.test.js\u001b[2m:189:42)\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 188 |\u001b[39m       \u001b[90m// 验证函数抛出错误\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 189 |\u001b[39m       \u001b[36mawait\u001b[39m expect(offlinePaymentService\u001b[33m.\u001b[39msyncOfflinePayment(paymentId\u001b[33m,\u001b[39m syncData))\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 190 |\u001b[39m         \u001b[33m.\u001b[39mrejects\u001b[33m.\u001b[39mtoThrow(\u001b[32m'支付记录不存在'\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                  \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 191 |\u001b[39m     })\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 192 |\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 193 |\u001b[39m     it(\u001b[32m'应该在支付记录状态不正确时抛出错误'\u001b[39m\u001b[33m,\u001b[39m \u001b[36masync\u001b[39m () \u001b[33m=>\u001b[39m {\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.toThrow (\u001b[22m\u001b[2mnode_modules/expect/build/index.js\u001b[2m:218:22)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.toThrow (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/offline-payment-service.test.js\u001b[39m\u001b[0m\u001b[2m:190:18)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m离线支付服务测试 › syncOfflinePayment › 应该在支付记录状态不正确时抛出错误\u001b[39m\u001b[22m\n\n    \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mrejects\u001b[2m.\u001b[22mtoThrow\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m)\u001b[22m\n\n    Expected substring: \u001b[32m\"只能同步离线待同步状态的支付记录\"\u001b[39m\n    Received message:   \u001b[31m\"Cannot read properties of undefined (reading 'findByPk')\"\u001b[39m\n\n        \u001b[0m \u001b[90m 84 |\u001b[39m     \n         \u001b[90m 85 |\u001b[39m     \u001b[90m// 查找离线支付记录\u001b[39m\n        \u001b[31m\u001b[1m>\u001b[22m\u001b[39m\u001b[90m 86 |\u001b[39m     \u001b[36mconst\u001b[39m payment \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m \u001b[33mOfflinePayment\u001b[39m\u001b[33m.\u001b[39mfindByPk(paymentId)\u001b[33m;\u001b[39m\n         \u001b[90m    |\u001b[39m                                          \u001b[31m\u001b[1m^\u001b[22m\u001b[39m\n         \u001b[90m 87 |\u001b[39m     \n         \u001b[90m 88 |\u001b[39m     \u001b[36mif\u001b[39m (\u001b[33m!\u001b[39mpayment) {\n         \u001b[90m 89 |\u001b[39m       \u001b[36mthrow\u001b[39m \u001b[36mnew\u001b[39m \u001b[33mError\u001b[39m(\u001b[32m'支付记录不存在'\u001b[39m)\u001b[33m;\u001b[39m\u001b[0m\n\n          \u001b[2mat Object.findByPk [as syncOfflinePayment] (\u001b[22mservices/offline-payment-service.js\u001b[2m:86:42)\u001b[22m\n          \u001b[2mat Object.syncOfflinePayment (\u001b[22mtests/unit/offline-payment-service.test.js\u001b[2m:208:42)\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 207 |\u001b[39m       \u001b[90m// 验证函数抛出错误\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 208 |\u001b[39m       \u001b[36mawait\u001b[39m expect(offlinePaymentService\u001b[33m.\u001b[39msyncOfflinePayment(paymentId\u001b[33m,\u001b[39m syncData))\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 209 |\u001b[39m         \u001b[33m.\u001b[39mrejects\u001b[33m.\u001b[39mtoThrow(\u001b[32m'只能同步离线待同步状态的支付记录'\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                  \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 210 |\u001b[39m     })\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 211 |\u001b[39m   })\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 212 |\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.toThrow (\u001b[22m\u001b[2mnode_modules/expect/build/index.js\u001b[2m:218:22)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.toThrow (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/offline-payment-service.test.js\u001b[39m\u001b[0m\u001b[2m:209:18)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m离线支付服务测试 › getUserOfflinePayments › 应该成功获取用户离线支付记录\u001b[39m\u001b[22m\n\n    TypeError: Cannot read properties of undefined (reading 'findAndCountAll')\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 143 |\u001b[39m     \u001b[22m\n\u001b[2m     \u001b[90m 144 |\u001b[39m     \u001b[90m// 查询离线支付记录\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 145 |\u001b[39m     \u001b[36mconst\u001b[39m { count\u001b[33m,\u001b[39m rows\u001b[33m:\u001b[39m payments } \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m \u001b[33mOfflinePayment\u001b[39m\u001b[33m.\u001b[39mfindAndCountAll({\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                                                            \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 146 |\u001b[39m       where\u001b[33m:\u001b[39m whereClause\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 147 |\u001b[39m       include\u001b[33m:\u001b[39m [\u001b[22m\n\u001b[2m     \u001b[90m 148 |\u001b[39m         {\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.findAndCountAll [as getUserOfflinePayments] (\u001b[22m\u001b[2mservices/offline-payment-service.js\u001b[2m:145:60)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.getUserOfflinePayments (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/offline-payment-service.test.js\u001b[39m\u001b[0m\u001b[2m:253:50)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m离线支付服务测试 › getUserOfflinePayments › 应该在用户ID无效时抛出错误\u001b[39m\u001b[22m\n\n    \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mrejects\u001b[2m.\u001b[22mtoThrow\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m)\u001b[22m\n\n    Expected substring: \u001b[32m\"Cannot read properties of null (reading 'isOffline')\"\u001b[39m\n    Received message:   \u001b[31m\"Cannot read properties of undefined (reading 'findAndCountAll')\"\u001b[39m\n\n        \u001b[0m \u001b[90m 143 |\u001b[39m     \n         \u001b[90m 144 |\u001b[39m     \u001b[90m// 查询离线支付记录\u001b[39m\n        \u001b[31m\u001b[1m>\u001b[22m\u001b[39m\u001b[90m 145 |\u001b[39m     \u001b[36mconst\u001b[39m { count\u001b[33m,\u001b[39m rows\u001b[33m:\u001b[39m payments } \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m \u001b[33mOfflinePayment\u001b[39m\u001b[33m.\u001b[39mfindAndCountAll({\n         \u001b[90m     |\u001b[39m                                                            \u001b[31m\u001b[1m^\u001b[22m\u001b[39m\n         \u001b[90m 146 |\u001b[39m       where\u001b[33m:\u001b[39m whereClause\u001b[33m,\u001b[39m\n         \u001b[90m 147 |\u001b[39m       include\u001b[33m:\u001b[39m [\n         \u001b[90m 148 |\u001b[39m         {\u001b[0m\n\n          \u001b[2mat Object.findAndCountAll [as getUserOfflinePayments] (\u001b[22mservices/offline-payment-service.js\u001b[2m:145:60)\u001b[22m\n          \u001b[2mat Object.getUserOfflinePayments (\u001b[22mtests/unit/offline-payment-service.test.js\u001b[2m:291:42)\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 290 |\u001b[39m       \u001b[90m// 验证函数抛出错误\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 291 |\u001b[39m       \u001b[36mawait\u001b[39m expect(offlinePaymentService\u001b[33m.\u001b[39mgetUserOfflinePayments(invalidUserId))\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 292 |\u001b[39m         \u001b[33m.\u001b[39mrejects\u001b[33m.\u001b[39mtoThrow(\u001b[32m'Cannot read properties of null (reading \\'isOffline\\')'\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                  \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 293 |\u001b[39m     })\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 294 |\u001b[39m   })\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 295 |\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.toThrow (\u001b[22m\u001b[2mnode_modules/expect/build/index.js\u001b[2m:218:22)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.toThrow (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/offline-payment-service.test.js\u001b[39m\u001b[0m\u001b[2m:292:18)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m离线支付服务测试 › getPendingSyncPayments › 应该成功获取待同步的离线支付记录\u001b[39m\u001b[22m\n\n    TypeError: Cannot read properties of undefined (reading 'findAndCountAll')\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 193 |\u001b[39m     \u001b[22m\n\u001b[2m     \u001b[90m 194 |\u001b[39m     \u001b[90m// 查询待同步的离线支付记录\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 195 |\u001b[39m     \u001b[36mconst\u001b[39m { count\u001b[33m,\u001b[39m rows\u001b[33m:\u001b[39m payments } \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m \u001b[33mOfflinePayment\u001b[39m\u001b[33m.\u001b[39mfindAndCountAll({\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                                                            \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 196 |\u001b[39m       where\u001b[33m:\u001b[39m {\u001b[22m\n\u001b[2m     \u001b[90m 197 |\u001b[39m         status\u001b[33m:\u001b[39m \u001b[32m'pending'\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 198 |\u001b[39m       }\u001b[33m,\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.findAndCountAll [as getPendingSyncPayments] (\u001b[22m\u001b[2mservices/offline-payment-service.js\u001b[2m:195:60)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.getPendingSyncPayments (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/offline-payment-service.test.js\u001b[39m\u001b[0m\u001b[2m:326:50)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m离线支付服务测试 › markPaymentSyncFailed › 应该成功标记支付同步失败\u001b[39m\u001b[22m\n\n    TypeError: Cannot read properties of undefined (reading 'findByPk')\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 240 |\u001b[39m     \u001b[22m\n\u001b[2m     \u001b[90m 241 |\u001b[39m     \u001b[90m// 查找离线支付记录\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 242 |\u001b[39m     \u001b[36mconst\u001b[39m payment \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m \u001b[33mOfflinePayment\u001b[39m\u001b[33m.\u001b[39mfindByPk(paymentId)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                                          \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 243 |\u001b[39m     \u001b[22m\n\u001b[2m     \u001b[90m 244 |\u001b[39m     \u001b[36mif\u001b[39m (\u001b[33m!\u001b[39mpayment) {\u001b[22m\n\u001b[2m     \u001b[90m 245 |\u001b[39m       \u001b[36mthrow\u001b[39m \u001b[36mnew\u001b[39m \u001b[33mError\u001b[39m(\u001b[32m'支付记录不存在'\u001b[39m)\u001b[33m;\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.findByPk [as markPaymentSyncFailed] (\u001b[22m\u001b[2mservices/offline-payment-service.js\u001b[2m:242:42)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.markPaymentSyncFailed (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/offline-payment-service.test.js\u001b[39m\u001b[0m\u001b[2m:383:50)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m离线支付服务测试 › markPaymentSyncFailed › 应该在支付记录不存在时抛出错误\u001b[39m\u001b[22m\n\n    \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mrejects\u001b[2m.\u001b[22mtoThrow\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m)\u001b[22m\n\n    Expected substring: \u001b[32m\"支付记录不存在\"\u001b[39m\n    Received message:   \u001b[31m\"Cannot read properties of undefined (reading 'findByPk')\"\u001b[39m\n\n        \u001b[0m \u001b[90m 240 |\u001b[39m     \n         \u001b[90m 241 |\u001b[39m     \u001b[90m// 查找离线支付记录\u001b[39m\n        \u001b[31m\u001b[1m>\u001b[22m\u001b[39m\u001b[90m 242 |\u001b[39m     \u001b[36mconst\u001b[39m payment \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m \u001b[33mOfflinePayment\u001b[39m\u001b[33m.\u001b[39mfindByPk(paymentId)\u001b[33m;\u001b[39m\n         \u001b[90m     |\u001b[39m                                          \u001b[31m\u001b[1m^\u001b[22m\u001b[39m\n         \u001b[90m 243 |\u001b[39m     \n         \u001b[90m 244 |\u001b[39m     \u001b[36mif\u001b[39m (\u001b[33m!\u001b[39mpayment) {\n         \u001b[90m 245 |\u001b[39m       \u001b[36mthrow\u001b[39m \u001b[36mnew\u001b[39m \u001b[33mError\u001b[39m(\u001b[32m'支付记录不存在'\u001b[39m)\u001b[33m;\u001b[39m\u001b[0m\n\n          \u001b[2mat Object.findByPk [as markPaymentSyncFailed] (\u001b[22mservices/offline-payment-service.js\u001b[2m:242:42)\u001b[22m\n          \u001b[2mat Object.markPaymentSyncFailed (\u001b[22mtests/unit/offline-payment-service.test.js\u001b[2m:406:42)\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 405 |\u001b[39m       \u001b[90m// 验证函数抛出错误\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 406 |\u001b[39m       \u001b[36mawait\u001b[39m expect(offlinePaymentService\u001b[33m.\u001b[39mmarkPaymentSyncFailed(paymentId\u001b[33m,\u001b[39m errorMessage))\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 407 |\u001b[39m         \u001b[33m.\u001b[39mrejects\u001b[33m.\u001b[39mtoThrow(\u001b[32m'支付记录不存在'\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                  \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 408 |\u001b[39m     })\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 409 |\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 410 |\u001b[39m     it(\u001b[32m'应该在支付记录状态不正确时抛出错误'\u001b[39m\u001b[33m,\u001b[39m \u001b[36masync\u001b[39m () \u001b[33m=>\u001b[39m {\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.toThrow (\u001b[22m\u001b[2mnode_modules/expect/build/index.js\u001b[2m:218:22)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.toThrow (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/offline-payment-service.test.js\u001b[39m\u001b[0m\u001b[2m:407:18)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m离线支付服务测试 › markPaymentSyncFailed › 应该在支付记录状态不正确时抛出错误\u001b[39m\u001b[22m\n\n    \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mrejects\u001b[2m.\u001b[22mtoThrow\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m)\u001b[22m\n\n    Expected substring: \u001b[32m\"只能标记待同步状态的支付记录\"\u001b[39m\n    Received message:   \u001b[31m\"Cannot read properties of undefined (reading 'findByPk')\"\u001b[39m\n\n        \u001b[0m \u001b[90m 240 |\u001b[39m     \n         \u001b[90m 241 |\u001b[39m     \u001b[90m// 查找离线支付记录\u001b[39m\n        \u001b[31m\u001b[1m>\u001b[22m\u001b[39m\u001b[90m 242 |\u001b[39m     \u001b[36mconst\u001b[39m payment \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m \u001b[33mOfflinePayment\u001b[39m\u001b[33m.\u001b[39mfindByPk(paymentId)\u001b[33m;\u001b[39m\n         \u001b[90m     |\u001b[39m                                          \u001b[31m\u001b[1m^\u001b[22m\u001b[39m\n         \u001b[90m 243 |\u001b[39m     \n         \u001b[90m 244 |\u001b[39m     \u001b[36mif\u001b[39m (\u001b[33m!\u001b[39mpayment) {\n         \u001b[90m 245 |\u001b[39m       \u001b[36mthrow\u001b[39m \u001b[36mnew\u001b[39m \u001b[33mError\u001b[39m(\u001b[32m'支付记录不存在'\u001b[39m)\u001b[33m;\u001b[39m\u001b[0m\n\n          \u001b[2mat Object.findByPk [as markPaymentSyncFailed] (\u001b[22mservices/offline-payment-service.js\u001b[2m:242:42)\u001b[22m\n          \u001b[2mat Object.markPaymentSyncFailed (\u001b[22mtests/unit/offline-payment-service.test.js\u001b[2m:425:42)\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 424 |\u001b[39m       \u001b[90m// 验证函数抛出错误\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 425 |\u001b[39m       \u001b[36mawait\u001b[39m expect(offlinePaymentService\u001b[33m.\u001b[39mmarkPaymentSyncFailed(paymentId\u001b[33m,\u001b[39m errorMessage))\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 426 |\u001b[39m         \u001b[33m.\u001b[39mrejects\u001b[33m.\u001b[39mtoThrow(\u001b[32m'只能标记待同步状态的支付记录'\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                  \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 427 |\u001b[39m     })\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 428 |\u001b[39m   })\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 429 |\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.toThrow (\u001b[22m\u001b[2mnode_modules/expect/build/index.js\u001b[2m:218:22)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.toThrow (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/offline-payment-service.test.js\u001b[39m\u001b[0m\u001b[2m:426:18)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m离线支付服务测试 › retryPaymentSync › 应该成功重试同步失败的支付记录\u001b[39m\u001b[22m\n\n    TypeError: Cannot read properties of undefined (reading 'findByPk')\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 275 |\u001b[39m     \u001b[22m\n\u001b[2m     \u001b[90m 276 |\u001b[39m     \u001b[90m// 查找离线支付记录\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 277 |\u001b[39m     \u001b[36mconst\u001b[39m payment \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m \u001b[33mOfflinePayment\u001b[39m\u001b[33m.\u001b[39mfindByPk(paymentId)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                                          \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 278 |\u001b[39m     \u001b[22m\n\u001b[2m     \u001b[90m 279 |\u001b[39m     \u001b[36mif\u001b[39m (\u001b[33m!\u001b[39mpayment) {\u001b[22m\n\u001b[2m     \u001b[90m 280 |\u001b[39m       \u001b[36mthrow\u001b[39m \u001b[36mnew\u001b[39m \u001b[33mError\u001b[39m(\u001b[32m'支付记录不存在'\u001b[39m)\u001b[33m;\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.findByPk [as retryPaymentSync] (\u001b[22m\u001b[2mservices/offline-payment-service.js\u001b[2m:277:42)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.retryPaymentSync (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/offline-payment-service.test.js\u001b[39m\u001b[0m\u001b[2m:461:50)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m离线支付服务测试 › retryPaymentSync › 应该在支付记录不存在时抛出错误\u001b[39m\u001b[22m\n\n    \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mrejects\u001b[2m.\u001b[22mtoThrow\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m)\u001b[22m\n\n    Expected substring: \u001b[32m\"支付记录不存在\"\u001b[39m\n    Received message:   \u001b[31m\"Cannot read properties of undefined (reading 'findByPk')\"\u001b[39m\n\n        \u001b[0m \u001b[90m 275 |\u001b[39m     \n         \u001b[90m 276 |\u001b[39m     \u001b[90m// 查找离线支付记录\u001b[39m\n        \u001b[31m\u001b[1m>\u001b[22m\u001b[39m\u001b[90m 277 |\u001b[39m     \u001b[36mconst\u001b[39m payment \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m \u001b[33mOfflinePayment\u001b[39m\u001b[33m.\u001b[39mfindByPk(paymentId)\u001b[33m;\u001b[39m\n         \u001b[90m     |\u001b[39m                                          \u001b[31m\u001b[1m^\u001b[22m\u001b[39m\n         \u001b[90m 278 |\u001b[39m     \n         \u001b[90m 279 |\u001b[39m     \u001b[36mif\u001b[39m (\u001b[33m!\u001b[39mpayment) {\n         \u001b[90m 280 |\u001b[39m       \u001b[36mthrow\u001b[39m \u001b[36mnew\u001b[39m \u001b[33mError\u001b[39m(\u001b[32m'支付记录不存在'\u001b[39m)\u001b[33m;\u001b[39m\u001b[0m\n\n          \u001b[2mat Object.findByPk [as retryPaymentSync] (\u001b[22mservices/offline-payment-service.js\u001b[2m:277:42)\u001b[22m\n          \u001b[2mat Object.retryPaymentSync (\u001b[22mtests/unit/offline-payment-service.test.js\u001b[2m:483:42)\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 482 |\u001b[39m       \u001b[90m// 验证函数抛出错误\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 483 |\u001b[39m       \u001b[36mawait\u001b[39m expect(offlinePaymentService\u001b[33m.\u001b[39mretryPaymentSync(paymentId))\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 484 |\u001b[39m         \u001b[33m.\u001b[39mrejects\u001b[33m.\u001b[39mtoThrow(\u001b[32m'支付记录不存在'\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                  \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 485 |\u001b[39m     })\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 486 |\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 487 |\u001b[39m     it(\u001b[32m'应该在支付记录状态不正确时抛出错误'\u001b[39m\u001b[33m,\u001b[39m \u001b[36masync\u001b[39m () \u001b[33m=>\u001b[39m {\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.toThrow (\u001b[22m\u001b[2mnode_modules/expect/build/index.js\u001b[2m:218:22)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.toThrow (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/offline-payment-service.test.js\u001b[39m\u001b[0m\u001b[2m:484:18)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m离线支付服务测试 › retryPaymentSync › 应该在支付记录状态不正确时抛出错误\u001b[39m\u001b[22m\n\n    \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mrejects\u001b[2m.\u001b[22mtoThrow\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m)\u001b[22m\n\n    Expected substring: \u001b[32m\"只能重试同步失败状态的支付记录\"\u001b[39m\n    Received message:   \u001b[31m\"Cannot read properties of undefined (reading 'findByPk')\"\u001b[39m\n\n        \u001b[0m \u001b[90m 275 |\u001b[39m     \n         \u001b[90m 276 |\u001b[39m     \u001b[90m// 查找离线支付记录\u001b[39m\n        \u001b[31m\u001b[1m>\u001b[22m\u001b[39m\u001b[90m 277 |\u001b[39m     \u001b[36mconst\u001b[39m payment \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m \u001b[33mOfflinePayment\u001b[39m\u001b[33m.\u001b[39mfindByPk(paymentId)\u001b[33m;\u001b[39m\n         \u001b[90m     |\u001b[39m                                          \u001b[31m\u001b[1m^\u001b[22m\u001b[39m\n         \u001b[90m 278 |\u001b[39m     \n         \u001b[90m 279 |\u001b[39m     \u001b[36mif\u001b[39m (\u001b[33m!\u001b[39mpayment) {\n         \u001b[90m 280 |\u001b[39m       \u001b[36mthrow\u001b[39m \u001b[36mnew\u001b[39m \u001b[33mError\u001b[39m(\u001b[32m'支付记录不存在'\u001b[39m)\u001b[33m;\u001b[39m\u001b[0m\n\n          \u001b[2mat Object.findByPk [as retryPaymentSync] (\u001b[22mservices/offline-payment-service.js\u001b[2m:277:42)\u001b[22m\n          \u001b[2mat Object.retryPaymentSync (\u001b[22mtests/unit/offline-payment-service.test.js\u001b[2m:501:42)\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 500 |\u001b[39m       \u001b[90m// 验证函数抛出错误\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 501 |\u001b[39m       \u001b[36mawait\u001b[39m expect(offlinePaymentService\u001b[33m.\u001b[39mretryPaymentSync(paymentId))\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 502 |\u001b[39m         \u001b[33m.\u001b[39mrejects\u001b[33m.\u001b[39mtoThrow(\u001b[32m'只能重试同步失败状态的支付记录'\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                  \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 503 |\u001b[39m     })\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 504 |\u001b[39m   })\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 505 |\u001b[39m })\u001b[33m;\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.toThrow (\u001b[22m\u001b[2mnode_modules/expect/build/index.js\u001b[2m:218:22)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.toThrow (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/offline-payment-service.test.js\u001b[39m\u001b[0m\u001b[2m:502:18)\u001b[22m\u001b[2m\u001b[22m\n","name":"C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\offline-payment-service.test.js","startTime":1762159269970,"status":"failed","summary":""},{"assertionResults":[{"ancestorTitles":["ExpenseTypeController单元测试","createExpenseType"],"duration":0,"failureDetails":[{}],"failureMessages":["TypeError: mockPool.query.mockResolvedValueOnce is not a function\n    at Object.mockResolvedValueOnce (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\expense-type-controller.test.js:69:10)\n    at Promise.then.completed (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:444:34)"],"fullName":"ExpenseTypeController单元测试 createExpenseType 应该成功创建费用类型","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该成功创建费用类型"},{"ancestorTitles":["ExpenseTypeController单元测试","createExpenseType"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"ExpenseTypeController单元测试 createExpenseType 应该在缺少必填字段时返回400错误","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"应该在缺少必填字段时返回400错误"},{"ancestorTitles":["ExpenseTypeController单元测试","createExpenseType"],"duration":0,"failureDetails":[{}],"failureMessages":["TypeError: mockPool.query.mockResolvedValueOnce is not a function\n    at Object.mockResolvedValueOnce (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\expense-type-controller.test.js:132:22)\n    at Promise.then.completed (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:444:34)"],"fullName":"ExpenseTypeController单元测试 createExpenseType 应该在费用类型名称已存在时返回409错误","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该在费用类型名称已存在时返回409错误"},{"ancestorTitles":["ExpenseTypeController单元测试","createExpenseType"],"duration":0,"failureDetails":[{}],"failureMessages":["TypeError: mockPool.query.mockRejectedValueOnce is not a function\n    at Object.mockRejectedValueOnce (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\expense-type-controller.test.js:157:22)\n    at Promise.then.completed (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:444:34)"],"fullName":"ExpenseTypeController单元测试 createExpenseType 应该在数据库错误时返回500错误","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该在数据库错误时返回500错误"},{"ancestorTitles":["ExpenseTypeController单元测试","getExpenseTypes"],"duration":0,"failureDetails":[{}],"failureMessages":["TypeError: mockPool.query.mockResolvedValueOnce is not a function\n    at Object.mockResolvedValueOnce (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\expense-type-controller.test.js:183:10)\n    at Promise.then.completed (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:444:34)"],"fullName":"ExpenseTypeController单元测试 getExpenseTypes 应该成功获取费用类型列表","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该成功获取费用类型列表"},{"ancestorTitles":["ExpenseTypeController单元测试","getExpenseTypes"],"duration":1,"failureDetails":[{}],"failureMessages":["TypeError: mockPool.query.mockResolvedValueOnce is not a function\n    at Object.mockResolvedValueOnce (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\expense-type-controller.test.js:255:10)\n    at Promise.then.completed (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:444:34)"],"fullName":"ExpenseTypeController单元测试 getExpenseTypes 应该支持按名称筛选费用类型","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该支持按名称筛选费用类型"},{"ancestorTitles":["ExpenseTypeController单元测试","getExpenseTypes"],"duration":0,"failureDetails":[{}],"failureMessages":["TypeError: mockPool.query.mockResolvedValueOnce is not a function\n    at Object.mockResolvedValueOnce (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\expense-type-controller.test.js:278:10)\n    at Promise.then.completed (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:444:34)"],"fullName":"ExpenseTypeController单元测试 getExpenseTypes 应该支持按创建者筛选费用类型","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该支持按创建者筛选费用类型"},{"ancestorTitles":["ExpenseTypeController单元测试","getExpenseTypeById"],"duration":1,"failureDetails":[{}],"failureMessages":["TypeError: mockPool.query.mockResolvedValueOnce is not a function\n    at Object.mockResolvedValueOnce (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\expense-type-controller.test.js:298:22)\n    at Promise.then.completed (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:444:34)"],"fullName":"ExpenseTypeController单元测试 getExpenseTypeById 应该成功获取费用类型详情","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该成功获取费用类型详情"},{"ancestorTitles":["ExpenseTypeController单元测试","getExpenseTypeById"],"duration":0,"failureDetails":[{}],"failureMessages":["TypeError: mockPool.query.mockResolvedValueOnce is not a function\n    at Object.mockResolvedValueOnce (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\expense-type-controller.test.js:336:22)\n    at Promise.then.completed (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:444:34)"],"fullName":"ExpenseTypeController单元测试 getExpenseTypeById 应该在费用类型不存在时返回404错误","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该在费用类型不存在时返回404错误"},{"ancestorTitles":["ExpenseTypeController单元测试","updateExpenseType"],"duration":1,"failureDetails":[{}],"failureMessages":["TypeError: mockPool.query.mockResolvedValueOnce is not a function\n    at Object.mockResolvedValueOnce (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\expense-type-controller.test.js:365:10)\n    at Promise.then.completed (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:444:34)"],"fullName":"ExpenseTypeController单元测试 updateExpenseType 应该成功更新费用类型信息","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该成功更新费用类型信息"},{"ancestorTitles":["ExpenseTypeController单元测试","updateExpenseType"],"duration":0,"failureDetails":[{}],"failureMessages":["TypeError: mockPool.query.mockResolvedValueOnce is not a function\n    at Object.mockResolvedValueOnce (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\expense-type-controller.test.js:403:22)\n    at Promise.then.completed (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:444:34)"],"fullName":"ExpenseTypeController单元测试 updateExpenseType 应该在费用类型不存在时返回404错误","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该在费用类型不存在时返回404错误"},{"ancestorTitles":["ExpenseTypeController单元测试","updateExpenseType"],"duration":0,"failureDetails":[{}],"failureMessages":["TypeError: mockPool.query.mockResolvedValueOnce is not a function\n    at Object.mockResolvedValueOnce (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\expense-type-controller.test.js:424:22)\n    at Promise.then.completed (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:444:34)"],"fullName":"ExpenseTypeController单元测试 updateExpenseType 应该在尝试修改系统默认费用类型时返回403错误","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该在尝试修改系统默认费用类型时返回403错误"},{"ancestorTitles":["ExpenseTypeController单元测试","updateExpenseType"],"duration":0,"failureDetails":[{}],"failureMessages":["TypeError: mockPool.query.mockResolvedValueOnce is not a function\n    at Object.mockResolvedValueOnce (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\expense-type-controller.test.js:448:22)\n    at Promise.then.completed (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:444:34)"],"fullName":"ExpenseTypeController单元测试 updateExpenseType 应该在用户不是创建者时返回403错误","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该在用户不是创建者时返回403错误"},{"ancestorTitles":["ExpenseTypeController单元测试","deleteExpenseType"],"duration":0,"failureDetails":[{}],"failureMessages":["TypeError: mockPool.query.mockResolvedValueOnce is not a function\n    at Object.mockResolvedValueOnce (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\expense-type-controller.test.js:473:10)\n    at Promise.then.completed (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:444:34)"],"fullName":"ExpenseTypeController单元测试 deleteExpenseType 应该成功删除费用类型","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该成功删除费用类型"},{"ancestorTitles":["ExpenseTypeController单元测试","deleteExpenseType"],"duration":0,"failureDetails":[{}],"failureMessages":["TypeError: mockPool.query.mockResolvedValueOnce is not a function\n    at Object.mockResolvedValueOnce (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\expense-type-controller.test.js:495:22)\n    at Promise.then.completed (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:444:34)"],"fullName":"ExpenseTypeController单元测试 deleteExpenseType 应该在费用类型不存在时返回404错误","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该在费用类型不存在时返回404错误"},{"ancestorTitles":["ExpenseTypeController单元测试","deleteExpenseType"],"duration":1,"failureDetails":[{}],"failureMessages":["TypeError: mockPool.query.mockResolvedValueOnce is not a function\n    at Object.mockResolvedValueOnce (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\expense-type-controller.test.js:515:22)\n    at Promise.then.completed (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:444:34)"],"fullName":"ExpenseTypeController单元测试 deleteExpenseType 应该在尝试删除系统默认费用类型时返回403错误","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该在尝试删除系统默认费用类型时返回403错误"},{"ancestorTitles":["ExpenseTypeController单元测试","deleteExpenseType"],"duration":0,"failureDetails":[{}],"failureMessages":["TypeError: mockPool.query.mockResolvedValueOnce is not a function\n    at Object.mockResolvedValueOnce (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\expense-type-controller.test.js:538:22)\n    at Promise.then.completed (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:444:34)"],"fullName":"ExpenseTypeController单元测试 deleteExpenseType 应该在用户不是创建者时返回403错误","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该在用户不是创建者时返回403错误"},{"ancestorTitles":["ExpenseTypeController单元测试","deleteExpenseType"],"duration":1,"failureDetails":[{}],"failureMessages":["TypeError: mockPool.query.mockResolvedValueOnce is not a function\n    at Object.mockResolvedValueOnce (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\expense-type-controller.test.js:561:10)\n    at Promise.then.completed (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:444:34)"],"fullName":"ExpenseTypeController单元测试 deleteExpenseType 应该在费用类型被使用时返回409错误","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该在费用类型被使用时返回409错误"},{"ancestorTitles":["ExpenseTypeController单元测试","getDefaultExpenseTypes"],"duration":0,"failureDetails":[{}],"failureMessages":["TypeError: mockPool.query.mockResolvedValueOnce is not a function\n    at Object.mockResolvedValueOnce (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\expense-type-controller.test.js:581:22)\n    at Promise.then.completed (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:444:34)"],"fullName":"ExpenseTypeController单元测试 getDefaultExpenseTypes 应该成功获取默认费用类型列表","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该成功获取默认费用类型列表"}],"endTime":1762159270878,"message":"\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1mExpenseTypeController单元测试 › createExpenseType › 应该成功创建费用类型\u001b[39m\u001b[22m\n\n    TypeError: mockPool.query.mockResolvedValueOnce is not a function\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 67 |\u001b[39m       \u001b[90m// 模拟数据库查询结果\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 68 |\u001b[39m       mockPool\u001b[33m.\u001b[39mquery\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 69 |\u001b[39m         \u001b[33m.\u001b[39mmockResolvedValueOnce({ rows\u001b[33m:\u001b[39m [] }) \u001b[90m// 检查名称是否已存在\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m          \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 70 |\u001b[39m         \u001b[33m.\u001b[39mmockResolvedValueOnce({\u001b[22m\n\u001b[2m     \u001b[90m 71 |\u001b[39m           rows\u001b[33m:\u001b[39m [{\u001b[22m\n\u001b[2m     \u001b[90m 72 |\u001b[39m             id\u001b[33m:\u001b[39m \u001b[35m1\u001b[39m\u001b[33m,\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.mockResolvedValueOnce (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/expense-type-controller.test.js\u001b[39m\u001b[0m\u001b[2m:69:10)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1mExpenseTypeController单元测试 › createExpenseType › 应该在费用类型名称已存在时返回409错误\u001b[39m\u001b[22m\n\n    TypeError: mockPool.query.mockResolvedValueOnce is not a function\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 130 |\u001b[39m       \u001b[22m\n\u001b[2m     \u001b[90m 131 |\u001b[39m       \u001b[90m// 模拟数据库查询结果 - 名称已存在\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 132 |\u001b[39m       mockPool\u001b[33m.\u001b[39mquery\u001b[33m.\u001b[39mmockResolvedValueOnce({\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                      \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 133 |\u001b[39m         rows\u001b[33m:\u001b[39m [{ id\u001b[33m:\u001b[39m \u001b[35m1\u001b[39m\u001b[33m,\u001b[39m name\u001b[33m:\u001b[39m \u001b[32m'餐饮'\u001b[39m }]\u001b[22m\n\u001b[2m     \u001b[90m 134 |\u001b[39m       })\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 135 |\u001b[39m       \u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.mockResolvedValueOnce (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/expense-type-controller.test.js\u001b[39m\u001b[0m\u001b[2m:132:22)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1mExpenseTypeController单元测试 › createExpenseType › 应该在数据库错误时返回500错误\u001b[39m\u001b[22m\n\n    TypeError: mockPool.query.mockRejectedValueOnce is not a function\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 155 |\u001b[39m       \u001b[22m\n\u001b[2m     \u001b[90m 156 |\u001b[39m       \u001b[90m// 模拟数据库错误\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 157 |\u001b[39m       mockPool\u001b[33m.\u001b[39mquery\u001b[33m.\u001b[39mmockRejectedValueOnce(\u001b[36mnew\u001b[39m \u001b[33mError\u001b[39m(\u001b[32m'数据库连接错误'\u001b[39m))\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                      \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 158 |\u001b[39m       \u001b[22m\n\u001b[2m     \u001b[90m 159 |\u001b[39m       \u001b[90m// 调用控制器方法\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 160 |\u001b[39m       \u001b[36mawait\u001b[39m expenseTypeController\u001b[33m.\u001b[39mcreateExpenseType(mockReq\u001b[33m,\u001b[39m mockRes)\u001b[33m;\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.mockRejectedValueOnce (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/expense-type-controller.test.js\u001b[39m\u001b[0m\u001b[2m:157:22)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1mExpenseTypeController单元测试 › getExpenseTypes › 应该成功获取费用类型列表\u001b[39m\u001b[22m\n\n    TypeError: mockPool.query.mockResolvedValueOnce is not a function\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 181 |\u001b[39m       \u001b[90m// 模拟数据库查询结果\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 182 |\u001b[39m       mockPool\u001b[33m.\u001b[39mquery\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 183 |\u001b[39m         \u001b[33m.\u001b[39mmockResolvedValueOnce({\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m          \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 184 |\u001b[39m           rows\u001b[33m:\u001b[39m [\u001b[22m\n\u001b[2m     \u001b[90m 185 |\u001b[39m             {\u001b[22m\n\u001b[2m     \u001b[90m 186 |\u001b[39m               id\u001b[33m:\u001b[39m \u001b[35m1\u001b[39m\u001b[33m,\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.mockResolvedValueOnce (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/expense-type-controller.test.js\u001b[39m\u001b[0m\u001b[2m:183:10)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1mExpenseTypeController单元测试 › getExpenseTypes › 应该支持按名称筛选费用类型\u001b[39m\u001b[22m\n\n    TypeError: mockPool.query.mockResolvedValueOnce is not a function\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 253 |\u001b[39m       \u001b[90m// 模拟数据库查询结果\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 254 |\u001b[39m       mockPool\u001b[33m.\u001b[39mquery\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 255 |\u001b[39m         \u001b[33m.\u001b[39mmockResolvedValueOnce({ rows\u001b[33m:\u001b[39m [] }) \u001b[90m// 获取费用类型列表\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m          \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 256 |\u001b[39m         \u001b[33m.\u001b[39mmockResolvedValueOnce({ rows\u001b[33m:\u001b[39m [{ count\u001b[33m:\u001b[39m \u001b[35m0\u001b[39m }] })\u001b[33m;\u001b[39m \u001b[90m// 获取总数\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 257 |\u001b[39m       \u001b[22m\n\u001b[2m     \u001b[90m 258 |\u001b[39m       \u001b[90m// 调用控制器方法\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.mockResolvedValueOnce (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/expense-type-controller.test.js\u001b[39m\u001b[0m\u001b[2m:255:10)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1mExpenseTypeController单元测试 › getExpenseTypes › 应该支持按创建者筛选费用类型\u001b[39m\u001b[22m\n\n    TypeError: mockPool.query.mockResolvedValueOnce is not a function\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 276 |\u001b[39m       \u001b[90m// 模拟数据库查询结果\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 277 |\u001b[39m       mockPool\u001b[33m.\u001b[39mquery\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 278 |\u001b[39m         \u001b[33m.\u001b[39mmockResolvedValueOnce({ rows\u001b[33m:\u001b[39m [] }) \u001b[90m// 获取费用类型列表\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m          \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 279 |\u001b[39m         \u001b[33m.\u001b[39mmockResolvedValueOnce({ rows\u001b[33m:\u001b[39m [{ count\u001b[33m:\u001b[39m \u001b[35m0\u001b[39m }] })\u001b[33m;\u001b[39m \u001b[90m// 获取总数\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 280 |\u001b[39m       \u001b[22m\n\u001b[2m     \u001b[90m 281 |\u001b[39m       \u001b[90m// 调用控制器方法\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.mockResolvedValueOnce (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/expense-type-controller.test.js\u001b[39m\u001b[0m\u001b[2m:278:10)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1mExpenseTypeController单元测试 › getExpenseTypeById › 应该成功获取费用类型详情\u001b[39m\u001b[22m\n\n    TypeError: mockPool.query.mockResolvedValueOnce is not a function\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 296 |\u001b[39m       \u001b[22m\n\u001b[2m     \u001b[90m 297 |\u001b[39m       \u001b[90m// 模拟数据库查询结果\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 298 |\u001b[39m       mockPool\u001b[33m.\u001b[39mquery\u001b[33m.\u001b[39mmockResolvedValueOnce({\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                      \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 299 |\u001b[39m         rows\u001b[33m:\u001b[39m [{\u001b[22m\n\u001b[2m     \u001b[90m 300 |\u001b[39m           id\u001b[33m:\u001b[39m \u001b[35m1\u001b[39m\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 301 |\u001b[39m           name\u001b[33m:\u001b[39m \u001b[32m'餐饮'\u001b[39m\u001b[33m,\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.mockResolvedValueOnce (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/expense-type-controller.test.js\u001b[39m\u001b[0m\u001b[2m:298:22)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1mExpenseTypeController单元测试 › getExpenseTypeById › 应该在费用类型不存在时返回404错误\u001b[39m\u001b[22m\n\n    TypeError: mockPool.query.mockResolvedValueOnce is not a function\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 334 |\u001b[39m       \u001b[22m\n\u001b[2m     \u001b[90m 335 |\u001b[39m       \u001b[90m// 模拟数据库查询结果 - 费用类型不存在\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 336 |\u001b[39m       mockPool\u001b[33m.\u001b[39mquery\u001b[33m.\u001b[39mmockResolvedValueOnce({ rows\u001b[33m:\u001b[39m [] })\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                      \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 337 |\u001b[39m       \u001b[22m\n\u001b[2m     \u001b[90m 338 |\u001b[39m       \u001b[90m// 调用控制器方法\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 339 |\u001b[39m       \u001b[36mawait\u001b[39m expenseTypeController\u001b[33m.\u001b[39mgetExpenseTypeById(mockReq\u001b[33m,\u001b[39m mockRes)\u001b[33m;\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.mockResolvedValueOnce (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/expense-type-controller.test.js\u001b[39m\u001b[0m\u001b[2m:336:22)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1mExpenseTypeController单元测试 › updateExpenseType › 应该成功更新费用类型信息\u001b[39m\u001b[22m\n\n    TypeError: mockPool.query.mockResolvedValueOnce is not a function\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 363 |\u001b[39m       \u001b[90m// 模拟数据库查询结果\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 364 |\u001b[39m       mockPool\u001b[33m.\u001b[39mquery\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 365 |\u001b[39m         \u001b[33m.\u001b[39mmockResolvedValueOnce({ rows\u001b[33m:\u001b[39m [{ id\u001b[33m:\u001b[39m \u001b[35m1\u001b[39m\u001b[33m,\u001b[39m name\u001b[33m:\u001b[39m \u001b[32m'餐饮'\u001b[39m\u001b[33m,\u001b[39m is_default\u001b[33m:\u001b[39m \u001b[36mfalse\u001b[39m\u001b[33m,\u001b[39m created_by\u001b[33m:\u001b[39m \u001b[35m1\u001b[39m }] }) \u001b[90m// 获取费用类型信息\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m          \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 366 |\u001b[39m         \u001b[33m.\u001b[39mmockResolvedValueOnce({ rows\u001b[33m:\u001b[39m [] }) \u001b[90m// 检查新名称是否与其他费用类型冲突\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 367 |\u001b[39m         \u001b[33m.\u001b[39mmockResolvedValueOnce({\u001b[22m\n\u001b[2m     \u001b[90m 368 |\u001b[39m           rows\u001b[33m:\u001b[39m [{\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.mockResolvedValueOnce (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/expense-type-controller.test.js\u001b[39m\u001b[0m\u001b[2m:365:10)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1mExpenseTypeController单元测试 › updateExpenseType › 应该在费用类型不存在时返回404错误\u001b[39m\u001b[22m\n\n    TypeError: mockPool.query.mockResolvedValueOnce is not a function\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 401 |\u001b[39m       \u001b[22m\n\u001b[2m     \u001b[90m 402 |\u001b[39m       \u001b[90m// 模拟数据库查询结果 - 费用类型不存在\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 403 |\u001b[39m       mockPool\u001b[33m.\u001b[39mquery\u001b[33m.\u001b[39mmockResolvedValueOnce({ rows\u001b[33m:\u001b[39m [] })\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                      \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 404 |\u001b[39m       \u001b[22m\n\u001b[2m     \u001b[90m 405 |\u001b[39m       \u001b[90m// 调用控制器方法\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 406 |\u001b[39m       \u001b[36mawait\u001b[39m expenseTypeController\u001b[33m.\u001b[39mupdateExpenseType(mockReq\u001b[33m,\u001b[39m mockRes)\u001b[33m;\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.mockResolvedValueOnce (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/expense-type-controller.test.js\u001b[39m\u001b[0m\u001b[2m:403:22)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1mExpenseTypeController单元测试 › updateExpenseType › 应该在尝试修改系统默认费用类型时返回403错误\u001b[39m\u001b[22m\n\n    TypeError: mockPool.query.mockResolvedValueOnce is not a function\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 422 |\u001b[39m       \u001b[22m\n\u001b[2m     \u001b[90m 423 |\u001b[39m       \u001b[90m// 模拟数据库查询结果 - 系统默认费用类型\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 424 |\u001b[39m       mockPool\u001b[33m.\u001b[39mquery\u001b[33m.\u001b[39mmockResolvedValueOnce({\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                      \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 425 |\u001b[39m         rows\u001b[33m:\u001b[39m [{ id\u001b[33m:\u001b[39m \u001b[35m1\u001b[39m\u001b[33m,\u001b[39m name\u001b[33m:\u001b[39m \u001b[32m'餐饮'\u001b[39m\u001b[33m,\u001b[39m is_default\u001b[33m:\u001b[39m \u001b[36mtrue\u001b[39m\u001b[33m,\u001b[39m created_by\u001b[33m:\u001b[39m \u001b[36mnull\u001b[39m }]\u001b[22m\n\u001b[2m     \u001b[90m 426 |\u001b[39m       })\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 427 |\u001b[39m       \u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.mockResolvedValueOnce (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/expense-type-controller.test.js\u001b[39m\u001b[0m\u001b[2m:424:22)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1mExpenseTypeController单元测试 › updateExpenseType › 应该在用户不是创建者时返回403错误\u001b[39m\u001b[22m\n\n    TypeError: mockPool.query.mockResolvedValueOnce is not a function\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 446 |\u001b[39m       \u001b[22m\n\u001b[2m     \u001b[90m 447 |\u001b[39m       \u001b[90m// 模拟数据库查询结果 - 费用类型存在但创建者不是当前用户\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 448 |\u001b[39m       mockPool\u001b[33m.\u001b[39mquery\u001b[33m.\u001b[39mmockResolvedValueOnce({\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                      \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 449 |\u001b[39m         rows\u001b[33m:\u001b[39m [{ id\u001b[33m:\u001b[39m \u001b[35m1\u001b[39m\u001b[33m,\u001b[39m name\u001b[33m:\u001b[39m \u001b[32m'餐饮'\u001b[39m\u001b[33m,\u001b[39m is_default\u001b[33m:\u001b[39m \u001b[36mfalse\u001b[39m\u001b[33m,\u001b[39m created_by\u001b[33m:\u001b[39m \u001b[35m1\u001b[39m }]\u001b[22m\n\u001b[2m     \u001b[90m 450 |\u001b[39m       })\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 451 |\u001b[39m       \u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.mockResolvedValueOnce (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/expense-type-controller.test.js\u001b[39m\u001b[0m\u001b[2m:448:22)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1mExpenseTypeController单元测试 › deleteExpenseType › 应该成功删除费用类型\u001b[39m\u001b[22m\n\n    TypeError: mockPool.query.mockResolvedValueOnce is not a function\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 471 |\u001b[39m       \u001b[90m// 模拟数据库查询结果\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 472 |\u001b[39m       mockPool\u001b[33m.\u001b[39mquery\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 473 |\u001b[39m         \u001b[33m.\u001b[39mmockResolvedValueOnce({ rows\u001b[33m:\u001b[39m [{ id\u001b[33m:\u001b[39m \u001b[35m1\u001b[39m\u001b[33m,\u001b[39m name\u001b[33m:\u001b[39m \u001b[32m'餐饮'\u001b[39m\u001b[33m,\u001b[39m is_default\u001b[33m:\u001b[39m \u001b[36mfalse\u001b[39m\u001b[33m,\u001b[39m created_by\u001b[33m:\u001b[39m \u001b[35m1\u001b[39m }] }) \u001b[90m// 获取费用类型信息\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m          \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 474 |\u001b[39m         \u001b[33m.\u001b[39mmockResolvedValueOnce({ rows\u001b[33m:\u001b[39m [] }) \u001b[90m// 检查是否有账单使用此费用类型\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 475 |\u001b[39m         \u001b[33m.\u001b[39mmockResolvedValueOnce({})\u001b[33m;\u001b[39m \u001b[90m// 删除费用类型\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 476 |\u001b[39m       \u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.mockResolvedValueOnce (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/expense-type-controller.test.js\u001b[39m\u001b[0m\u001b[2m:473:10)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1mExpenseTypeController单元测试 › deleteExpenseType › 应该在费用类型不存在时返回404错误\u001b[39m\u001b[22m\n\n    TypeError: mockPool.query.mockResolvedValueOnce is not a function\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 493 |\u001b[39m       \u001b[22m\n\u001b[2m     \u001b[90m 494 |\u001b[39m       \u001b[90m// 模拟数据库查询结果 - 费用类型不存在\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 495 |\u001b[39m       mockPool\u001b[33m.\u001b[39mquery\u001b[33m.\u001b[39mmockResolvedValueOnce({ rows\u001b[33m:\u001b[39m [] })\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                      \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 496 |\u001b[39m       \u001b[22m\n\u001b[2m     \u001b[90m 497 |\u001b[39m       \u001b[90m// 调用控制器方法\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 498 |\u001b[39m       \u001b[36mawait\u001b[39m expenseTypeController\u001b[33m.\u001b[39mdeleteExpenseType(mockReq\u001b[33m,\u001b[39m mockRes)\u001b[33m;\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.mockResolvedValueOnce (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/expense-type-controller.test.js\u001b[39m\u001b[0m\u001b[2m:495:22)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1mExpenseTypeController单元测试 › deleteExpenseType › 应该在尝试删除系统默认费用类型时返回403错误\u001b[39m\u001b[22m\n\n    TypeError: mockPool.query.mockResolvedValueOnce is not a function\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 513 |\u001b[39m       \u001b[22m\n\u001b[2m     \u001b[90m 514 |\u001b[39m       \u001b[90m// 模拟数据库查询结果 - 系统默认费用类型\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 515 |\u001b[39m       mockPool\u001b[33m.\u001b[39mquery\u001b[33m.\u001b[39mmockResolvedValueOnce({\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                      \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 516 |\u001b[39m         rows\u001b[33m:\u001b[39m [{ id\u001b[33m:\u001b[39m \u001b[35m1\u001b[39m\u001b[33m,\u001b[39m name\u001b[33m:\u001b[39m \u001b[32m'餐饮'\u001b[39m\u001b[33m,\u001b[39m is_default\u001b[33m:\u001b[39m \u001b[36mtrue\u001b[39m\u001b[33m,\u001b[39m created_by\u001b[33m:\u001b[39m \u001b[36mnull\u001b[39m }]\u001b[22m\n\u001b[2m     \u001b[90m 517 |\u001b[39m       })\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 518 |\u001b[39m       \u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.mockResolvedValueOnce (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/expense-type-controller.test.js\u001b[39m\u001b[0m\u001b[2m:515:22)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1mExpenseTypeController单元测试 › deleteExpenseType › 应该在用户不是创建者时返回403错误\u001b[39m\u001b[22m\n\n    TypeError: mockPool.query.mockResolvedValueOnce is not a function\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 536 |\u001b[39m       \u001b[22m\n\u001b[2m     \u001b[90m 537 |\u001b[39m       \u001b[90m// 模拟数据库查询结果 - 费用类型存在但创建者不是当前用户\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 538 |\u001b[39m       mockPool\u001b[33m.\u001b[39mquery\u001b[33m.\u001b[39mmockResolvedValueOnce({\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                      \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 539 |\u001b[39m         rows\u001b[33m:\u001b[39m [{ id\u001b[33m:\u001b[39m \u001b[35m1\u001b[39m\u001b[33m,\u001b[39m name\u001b[33m:\u001b[39m \u001b[32m'餐饮'\u001b[39m\u001b[33m,\u001b[39m is_default\u001b[33m:\u001b[39m \u001b[36mfalse\u001b[39m\u001b[33m,\u001b[39m created_by\u001b[33m:\u001b[39m \u001b[35m1\u001b[39m }]\u001b[22m\n\u001b[2m     \u001b[90m 540 |\u001b[39m       })\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 541 |\u001b[39m       \u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.mockResolvedValueOnce (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/expense-type-controller.test.js\u001b[39m\u001b[0m\u001b[2m:538:22)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1mExpenseTypeController单元测试 › deleteExpenseType › 应该在费用类型被使用时返回409错误\u001b[39m\u001b[22m\n\n    TypeError: mockPool.query.mockResolvedValueOnce is not a function\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 559 |\u001b[39m       \u001b[90m// 模拟数据库查询结果\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 560 |\u001b[39m       mockPool\u001b[33m.\u001b[39mquery\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 561 |\u001b[39m         \u001b[33m.\u001b[39mmockResolvedValueOnce({ rows\u001b[33m:\u001b[39m [{ id\u001b[33m:\u001b[39m \u001b[35m1\u001b[39m\u001b[33m,\u001b[39m name\u001b[33m:\u001b[39m \u001b[32m'餐饮'\u001b[39m\u001b[33m,\u001b[39m is_default\u001b[33m:\u001b[39m \u001b[36mfalse\u001b[39m\u001b[33m,\u001b[39m created_by\u001b[33m:\u001b[39m \u001b[35m1\u001b[39m }] }) \u001b[90m// 获取费用类型信息\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m          \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 562 |\u001b[39m         \u001b[33m.\u001b[39mmockResolvedValueOnce({ rows\u001b[33m:\u001b[39m [{ id\u001b[33m:\u001b[39m \u001b[35m1\u001b[39m }] })\u001b[33m;\u001b[39m \u001b[90m// 有账单使用此费用类型\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 563 |\u001b[39m       \u001b[22m\n\u001b[2m     \u001b[90m 564 |\u001b[39m       \u001b[90m// 调用控制器方法\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.mockResolvedValueOnce (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/expense-type-controller.test.js\u001b[39m\u001b[0m\u001b[2m:561:10)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1mExpenseTypeController单元测试 › getDefaultExpenseTypes › 应该成功获取默认费用类型列表\u001b[39m\u001b[22m\n\n    TypeError: mockPool.query.mockResolvedValueOnce is not a function\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 579 |\u001b[39m     it(\u001b[32m'应该成功获取默认费用类型列表'\u001b[39m\u001b[33m,\u001b[39m \u001b[36masync\u001b[39m () \u001b[33m=>\u001b[39m {\u001b[22m\n\u001b[2m     \u001b[90m 580 |\u001b[39m       \u001b[90m// 模拟数据库查询结果\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 581 |\u001b[39m       mockPool\u001b[33m.\u001b[39mquery\u001b[33m.\u001b[39mmockResolvedValueOnce({\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                      \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 582 |\u001b[39m         rows\u001b[33m:\u001b[39m [\u001b[22m\n\u001b[2m     \u001b[90m 583 |\u001b[39m           {\u001b[22m\n\u001b[2m     \u001b[90m 584 |\u001b[39m             id\u001b[33m:\u001b[39m \u001b[35m1\u001b[39m\u001b[33m,\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.mockResolvedValueOnce (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/expense-type-controller.test.js\u001b[39m\u001b[0m\u001b[2m:581:22)\u001b[22m\u001b[2m\u001b[22m\n","name":"C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\expense-type-controller.test.js","startTime":1762159270492,"status":"failed","summary":""},{"assertionResults":[{"ancestorTitles":["UserController单元测试","register"],"duration":0,"failureDetails":[{}],"failureMessages":["TypeError: mockPool.query.mockResolvedValueOnce is not a function\n    at Object.mockResolvedValueOnce (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\user-controller.test.js:86:10)\n    at Promise.then.completed (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:444:34)"],"fullName":"UserController单元测试 register 应该成功注册新用户","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该成功注册新用户"},{"ancestorTitles":["UserController单元测试","register"],"duration":1,"failureDetails":[{}],"failureMessages":["Error: \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mnot\u001b[2m.\u001b[22mtoHaveBeenCalled\u001b[2m()\u001b[22m\n\n\u001b[1mMatcher error\u001b[22m: \u001b[31mreceived\u001b[39m value must be a mock or spy function\n\nReceived has type:  function\nReceived has value: \u001b[31m[Function query]\u001b[39m\n    at Object.toHaveBeenCalled (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\user-controller.test.js:140:34)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)"],"fullName":"UserController单元测试 register 应该在缺少必填字段时返回400错误","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"failed","title":"应该在缺少必填字段时返回400错误"},{"ancestorTitles":["UserController单元测试","register"],"duration":1,"failureDetails":[{}],"failureMessages":["TypeError: mockPool.query.mockResolvedValueOnce is not a function\n    at Object.mockResolvedValueOnce (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\user-controller.test.js:152:22)\n    at Promise.then.completed (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:444:34)"],"fullName":"UserController单元测试 register 应该在用户名已存在时返回409错误","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该在用户名已存在时返回409错误"},{"ancestorTitles":["UserController单元测试","register"],"duration":0,"failureDetails":[{}],"failureMessages":["TypeError: mockPool.query.mockResolvedValueOnce is not a function\n    at Object.mockResolvedValueOnce (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\user-controller.test.js:180:10)\n    at Promise.then.completed (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:444:34)"],"fullName":"UserController单元测试 register 应该在邮箱已存在时返回409错误","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该在邮箱已存在时返回409错误"},{"ancestorTitles":["UserController单元测试","register"],"duration":0,"failureDetails":[{}],"failureMessages":["TypeError: mockPool.query.mockRejectedValueOnce is not a function\n    at Object.mockRejectedValueOnce (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\user-controller.test.js:208:22)\n    at Promise.then.completed (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:444:34)"],"fullName":"UserController单元测试 register 应该在数据库错误时返回500错误","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该在数据库错误时返回500错误"},{"ancestorTitles":["UserController单元测试","login"],"duration":1,"failureDetails":[{}],"failureMessages":["TypeError: mockPool.query.mockResolvedValueOnce is not a function\n    at Object.mockResolvedValueOnce (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\user-controller.test.js:233:22)\n    at Promise.then.completed (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:444:34)"],"fullName":"UserController单元测试 login 应该成功登录并返回token","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该成功登录并返回token"},{"ancestorTitles":["UserController单元测试","login"],"duration":1,"failureDetails":[{}],"failureMessages":["Error: \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mnot\u001b[2m.\u001b[22mtoHaveBeenCalled\u001b[2m()\u001b[22m\n\n\u001b[1mMatcher error\u001b[22m: \u001b[31mreceived\u001b[39m value must be a mock or spy function\n\nReceived has type:  function\nReceived has value: \u001b[31m[Function query]\u001b[39m\n    at Object.toHaveBeenCalled (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\user-controller.test.js:300:34)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)"],"fullName":"UserController单元测试 login 应该在缺少必填字段时返回400错误","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"failed","title":"应该在缺少必填字段时返回400错误"},{"ancestorTitles":["UserController单元测试","login"],"duration":0,"failureDetails":[{}],"failureMessages":["TypeError: mockPool.query.mockResolvedValueOnce is not a function\n    at Object.mockResolvedValueOnce (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\user-controller.test.js:311:22)\n    at Promise.then.completed (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:444:34)"],"fullName":"UserController单元测试 login 应该在用户不存在时返回401错误","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该在用户不存在时返回401错误"},{"ancestorTitles":["UserController单元测试","login"],"duration":0,"failureDetails":[{}],"failureMessages":["TypeError: mockPool.query.mockResolvedValueOnce is not a function\n    at Object.mockResolvedValueOnce (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\user-controller.test.js:340:22)\n    at Promise.then.completed (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:444:34)"],"fullName":"UserController单元测试 login 应该在密码错误时返回401错误","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该在密码错误时返回401错误"},{"ancestorTitles":["UserController单元测试","login"],"duration":0,"failureDetails":[{}],"failureMessages":["TypeError: mockPool.query.mockRejectedValueOnce is not a function\n    at Object.mockRejectedValueOnce (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\user-controller.test.js:378:22)\n    at Promise.then.completed (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:444:34)"],"fullName":"UserController单元测试 login 应该在数据库错误时返回500错误","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该在数据库错误时返回500错误"},{"ancestorTitles":["UserController单元测试","refreshToken"],"duration":0,"failureDetails":[{}],"failureMessages":["TypeError: mockPool.query.mockResolvedValueOnce is not a function\n    at Object.mockResolvedValueOnce (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\user-controller.test.js:406:22)\n    at Promise.then.completed (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:444:34)"],"fullName":"UserController单元测试 refreshToken 应该成功刷新token","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该成功刷新token"},{"ancestorTitles":["UserController单元测试","refreshToken"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"UserController单元测试 refreshToken 应该在缺少刷新token时返回400错误","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"应该在缺少刷新token时返回400错误"},{"ancestorTitles":["UserController单元测试","getProfile"],"duration":0,"failureDetails":[{}],"failureMessages":["TypeError: mockPool.query.mockResolvedValueOnce is not a function\n    at Object.mockResolvedValueOnce (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\user-controller.test.js:473:22)\n    at Promise.then.completed (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:444:34)"],"fullName":"UserController单元测试 getProfile 应该成功获取用户资料","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该成功获取用户资料"},{"ancestorTitles":["UserController单元测试","getProfile"],"duration":1,"failureDetails":[{}],"failureMessages":["TypeError: mockPool.query.mockResolvedValueOnce is not a function\n    at Object.mockResolvedValueOnce (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\user-controller.test.js:512:22)\n    at Promise.then.completed (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:444:34)"],"fullName":"UserController单元测试 getProfile 应该在用户不存在时返回404错误","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该在用户不存在时返回404错误"},{"ancestorTitles":["UserController单元测试","updateProfile"],"duration":0,"failureDetails":[{}],"failureMessages":["TypeError: mockPool.query.mockResolvedValueOnce is not a function\n    at Object.mockResolvedValueOnce (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\user-controller.test.js:540:10)\n    at Promise.then.completed (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:444:34)"],"fullName":"UserController单元测试 updateProfile 应该成功更新用户资料","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该成功更新用户资料"},{"ancestorTitles":["UserController单元测试","updateProfile"],"duration":0,"failureDetails":[{}],"failureMessages":["TypeError: mockPool.query.mockResolvedValueOnce is not a function\n    at Object.mockResolvedValueOnce (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\user-controller.test.js:588:10)\n    at Promise.then.completed (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:444:34)"],"fullName":"UserController单元测试 updateProfile 应该在邮箱已被其他用户使用时返回409错误","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该在邮箱已被其他用户使用时返回409错误"},{"ancestorTitles":["UserController单元测试","changePassword"],"duration":1,"failureDetails":[{}],"failureMessages":["TypeError: mockPool.query.mockResolvedValueOnce is not a function\n    at Object.mockResolvedValueOnce (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\user-controller.test.js:616:10)\n    at Promise.then.completed (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:444:34)"],"fullName":"UserController单元测试 changePassword 应该成功修改密码","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该成功修改密码"},{"ancestorTitles":["UserController单元测试","changePassword"],"duration":0,"failureDetails":[{}],"failureMessages":["TypeError: mockPool.query.mockResolvedValueOnce is not a function\n    at Object.mockResolvedValueOnce (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\user-controller.test.js:655:22)\n    at Promise.then.completed (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:444:34)"],"fullName":"UserController单元测试 changePassword 应该在当前密码错误时返回400错误","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该在当前密码错误时返回400错误"}],"endTime":1762159271255,"message":"\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1mUserController单元测试 › register › 应该成功注册新用户\u001b[39m\u001b[22m\n\n    TypeError: mockPool.query.mockResolvedValueOnce is not a function\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 84 |\u001b[39m       \u001b[90m// 模拟数据库查询结果\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 85 |\u001b[39m       mockPool\u001b[33m.\u001b[39mquery\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 86 |\u001b[39m         \u001b[33m.\u001b[39mmockResolvedValueOnce({ rows\u001b[33m:\u001b[39m [] }) \u001b[90m// 用户名不存在\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m          \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 87 |\u001b[39m         \u001b[33m.\u001b[39mmockResolvedValueOnce({ rows\u001b[33m:\u001b[39m [] }) \u001b[90m// 邮箱不存在\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 88 |\u001b[39m         \u001b[33m.\u001b[39mmockResolvedValueOnce({ rows\u001b[33m:\u001b[39m [{ id\u001b[33m:\u001b[39m \u001b[35m1\u001b[39m }] }) \u001b[90m// 插入用户成功\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 89 |\u001b[39m         \u001b[33m.\u001b[39mmockResolvedValueOnce({ rows\u001b[33m:\u001b[39m [{ id\u001b[33m:\u001b[39m \u001b[35m1\u001b[39m\u001b[33m,\u001b[39m username\u001b[33m:\u001b[39m \u001b[32m'testuser'\u001b[39m\u001b[33m,\u001b[39m email\u001b[33m:\u001b[39m \u001b[32m'test@example.com'\u001b[39m\u001b[33m,\u001b[39m name\u001b[33m:\u001b[39m \u001b[32m'Test User'\u001b[39m }] })\u001b[33m;\u001b[39m \u001b[90m// 获取用户信息\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.mockResolvedValueOnce (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/user-controller.test.js\u001b[39m\u001b[0m\u001b[2m:86:10)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1mUserController单元测试 › register › 应该在缺少必填字段时返回400错误\u001b[39m\u001b[22m\n\n    \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mnot\u001b[2m.\u001b[22mtoHaveBeenCalled\u001b[2m()\u001b[22m\n\n    \u001b[1mMatcher error\u001b[22m: \u001b[31mreceived\u001b[39m value must be a mock or spy function\n\n    Received has type:  function\n    Received has value: \u001b[31m[Function query]\u001b[39m\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 138 |\u001b[39m       \u001b[22m\n\u001b[2m     \u001b[90m 139 |\u001b[39m       \u001b[90m// 验证数据库查询未被调用\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 140 |\u001b[39m       expect(mockPool\u001b[33m.\u001b[39mquery)\u001b[33m.\u001b[39mnot\u001b[33m.\u001b[39mtoHaveBeenCalled()\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                                  \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 141 |\u001b[39m     })\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 142 |\u001b[39m     \u001b[22m\n\u001b[2m     \u001b[90m 143 |\u001b[39m     it(\u001b[32m'应该在用户名已存在时返回409错误'\u001b[39m\u001b[33m,\u001b[39m \u001b[36masync\u001b[39m () \u001b[33m=>\u001b[39m {\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.toHaveBeenCalled (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/user-controller.test.js\u001b[39m\u001b[0m\u001b[2m:140:34)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1mUserController单元测试 › register › 应该在用户名已存在时返回409错误\u001b[39m\u001b[22m\n\n    TypeError: mockPool.query.mockResolvedValueOnce is not a function\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 150 |\u001b[39m       \u001b[22m\n\u001b[2m     \u001b[90m 151 |\u001b[39m       \u001b[90m// 模拟数据库查询结果 - 用户名已存在\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 152 |\u001b[39m       mockPool\u001b[33m.\u001b[39mquery\u001b[33m.\u001b[39mmockResolvedValueOnce({ rows\u001b[33m:\u001b[39m [{ id\u001b[33m:\u001b[39m \u001b[35m1\u001b[39m }] })\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                      \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 153 |\u001b[39m       \u001b[22m\n\u001b[2m     \u001b[90m 154 |\u001b[39m       \u001b[90m// 调用控制器方法\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 155 |\u001b[39m       \u001b[36mawait\u001b[39m userController\u001b[33m.\u001b[39mregister(mockReq\u001b[33m,\u001b[39m mockRes)\u001b[33m;\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.mockResolvedValueOnce (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/user-controller.test.js\u001b[39m\u001b[0m\u001b[2m:152:22)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1mUserController单元测试 › register › 应该在邮箱已存在时返回409错误\u001b[39m\u001b[22m\n\n    TypeError: mockPool.query.mockResolvedValueOnce is not a function\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 178 |\u001b[39m       \u001b[90m// 模拟数据库查询结果\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 179 |\u001b[39m       mockPool\u001b[33m.\u001b[39mquery\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 180 |\u001b[39m         \u001b[33m.\u001b[39mmockResolvedValueOnce({ rows\u001b[33m:\u001b[39m [] }) \u001b[90m// 用户名不存在\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m          \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 181 |\u001b[39m         \u001b[33m.\u001b[39mmockResolvedValueOnce({ rows\u001b[33m:\u001b[39m [{ id\u001b[33m:\u001b[39m \u001b[35m1\u001b[39m }] })\u001b[33m;\u001b[39m \u001b[90m// 邮箱已存在\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 182 |\u001b[39m       \u001b[22m\n\u001b[2m     \u001b[90m 183 |\u001b[39m       \u001b[90m// 调用控制器方法\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.mockResolvedValueOnce (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/user-controller.test.js\u001b[39m\u001b[0m\u001b[2m:180:10)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1mUserController单元测试 › register › 应该在数据库错误时返回500错误\u001b[39m\u001b[22m\n\n    TypeError: mockPool.query.mockRejectedValueOnce is not a function\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 206 |\u001b[39m       \u001b[22m\n\u001b[2m     \u001b[90m 207 |\u001b[39m       \u001b[90m// 模拟数据库错误\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 208 |\u001b[39m       mockPool\u001b[33m.\u001b[39mquery\u001b[33m.\u001b[39mmockRejectedValueOnce(\u001b[36mnew\u001b[39m \u001b[33mError\u001b[39m(\u001b[32m'数据库连接错误'\u001b[39m))\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                      \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 209 |\u001b[39m       \u001b[22m\n\u001b[2m     \u001b[90m 210 |\u001b[39m       \u001b[90m// 调用控制器方法\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 211 |\u001b[39m       \u001b[36mawait\u001b[39m userController\u001b[33m.\u001b[39mregister(mockReq\u001b[33m,\u001b[39m mockRes)\u001b[33m;\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.mockRejectedValueOnce (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/user-controller.test.js\u001b[39m\u001b[0m\u001b[2m:208:22)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1mUserController单元测试 › login › 应该成功登录并返回token\u001b[39m\u001b[22m\n\n    TypeError: mockPool.query.mockResolvedValueOnce is not a function\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 231 |\u001b[39m       \u001b[22m\n\u001b[2m     \u001b[90m 232 |\u001b[39m       \u001b[90m// 模拟数据库查询结果 - 用户存在\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 233 |\u001b[39m       mockPool\u001b[33m.\u001b[39mquery\u001b[33m.\u001b[39mmockResolvedValueOnce({\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                      \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 234 |\u001b[39m         rows\u001b[33m:\u001b[39m [{\u001b[22m\n\u001b[2m     \u001b[90m 235 |\u001b[39m           id\u001b[33m:\u001b[39m \u001b[35m1\u001b[39m\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 236 |\u001b[39m           username\u001b[33m:\u001b[39m \u001b[32m'testuser'\u001b[39m\u001b[33m,\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.mockResolvedValueOnce (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/user-controller.test.js\u001b[39m\u001b[0m\u001b[2m:233:22)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1mUserController单元测试 › login › 应该在缺少必填字段时返回400错误\u001b[39m\u001b[22m\n\n    \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mnot\u001b[2m.\u001b[22mtoHaveBeenCalled\u001b[2m()\u001b[22m\n\n    \u001b[1mMatcher error\u001b[22m: \u001b[31mreceived\u001b[39m value must be a mock or spy function\n\n    Received has type:  function\n    Received has value: \u001b[31m[Function query]\u001b[39m\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 298 |\u001b[39m       \u001b[22m\n\u001b[2m     \u001b[90m 299 |\u001b[39m       \u001b[90m// 验证数据库查询未被调用\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 300 |\u001b[39m       expect(mockPool\u001b[33m.\u001b[39mquery)\u001b[33m.\u001b[39mnot\u001b[33m.\u001b[39mtoHaveBeenCalled()\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                                  \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 301 |\u001b[39m     })\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 302 |\u001b[39m     \u001b[22m\n\u001b[2m     \u001b[90m 303 |\u001b[39m     it(\u001b[32m'应该在用户不存在时返回401错误'\u001b[39m\u001b[33m,\u001b[39m \u001b[36masync\u001b[39m () \u001b[33m=>\u001b[39m {\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.toHaveBeenCalled (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/user-controller.test.js\u001b[39m\u001b[0m\u001b[2m:300:34)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1mUserController单元测试 › login › 应该在用户不存在时返回401错误\u001b[39m\u001b[22m\n\n    TypeError: mockPool.query.mockResolvedValueOnce is not a function\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 309 |\u001b[39m       \u001b[22m\n\u001b[2m     \u001b[90m 310 |\u001b[39m       \u001b[90m// 模拟数据库查询结果 - 用户不存在\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 311 |\u001b[39m       mockPool\u001b[33m.\u001b[39mquery\u001b[33m.\u001b[39mmockResolvedValueOnce({ rows\u001b[33m:\u001b[39m [] })\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                      \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 312 |\u001b[39m       \u001b[22m\n\u001b[2m     \u001b[90m 313 |\u001b[39m       \u001b[90m// 调用控制器方法\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 314 |\u001b[39m       \u001b[36mawait\u001b[39m userController\u001b[33m.\u001b[39mlogin(mockReq\u001b[33m,\u001b[39m mockRes)\u001b[33m;\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.mockResolvedValueOnce (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/user-controller.test.js\u001b[39m\u001b[0m\u001b[2m:311:22)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1mUserController单元测试 › login › 应该在密码错误时返回401错误\u001b[39m\u001b[22m\n\n    TypeError: mockPool.query.mockResolvedValueOnce is not a function\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 338 |\u001b[39m       \u001b[22m\n\u001b[2m     \u001b[90m 339 |\u001b[39m       \u001b[90m// 模拟数据库查询结果 - 用户存在\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 340 |\u001b[39m       mockPool\u001b[33m.\u001b[39mquery\u001b[33m.\u001b[39mmockResolvedValueOnce({\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                      \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 341 |\u001b[39m         rows\u001b[33m:\u001b[39m [{\u001b[22m\n\u001b[2m     \u001b[90m 342 |\u001b[39m           id\u001b[33m:\u001b[39m \u001b[35m1\u001b[39m\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 343 |\u001b[39m           username\u001b[33m:\u001b[39m \u001b[32m'testuser'\u001b[39m\u001b[33m,\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.mockResolvedValueOnce (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/user-controller.test.js\u001b[39m\u001b[0m\u001b[2m:340:22)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1mUserController单元测试 › login › 应该在数据库错误时返回500错误\u001b[39m\u001b[22m\n\n    TypeError: mockPool.query.mockRejectedValueOnce is not a function\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 376 |\u001b[39m       \u001b[22m\n\u001b[2m     \u001b[90m 377 |\u001b[39m       \u001b[90m// 模拟数据库错误\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 378 |\u001b[39m       mockPool\u001b[33m.\u001b[39mquery\u001b[33m.\u001b[39mmockRejectedValueOnce(\u001b[36mnew\u001b[39m \u001b[33mError\u001b[39m(\u001b[32m'数据库连接错误'\u001b[39m))\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                      \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 379 |\u001b[39m       \u001b[22m\n\u001b[2m     \u001b[90m 380 |\u001b[39m       \u001b[90m// 调用控制器方法\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 381 |\u001b[39m       \u001b[36mawait\u001b[39m userController\u001b[33m.\u001b[39mlogin(mockReq\u001b[33m,\u001b[39m mockRes)\u001b[33m;\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.mockRejectedValueOnce (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/user-controller.test.js\u001b[39m\u001b[0m\u001b[2m:378:22)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1mUserController单元测试 › refreshToken › 应该成功刷新token\u001b[39m\u001b[22m\n\n    TypeError: mockPool.query.mockResolvedValueOnce is not a function\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 404 |\u001b[39m       \u001b[22m\n\u001b[2m     \u001b[90m 405 |\u001b[39m       \u001b[90m// 模拟数据库查询结果\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 406 |\u001b[39m       mockPool\u001b[33m.\u001b[39mquery\u001b[33m.\u001b[39mmockResolvedValueOnce({\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                      \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 407 |\u001b[39m         rows\u001b[33m:\u001b[39m [{\u001b[22m\n\u001b[2m     \u001b[90m 408 |\u001b[39m           id\u001b[33m:\u001b[39m \u001b[35m1\u001b[39m\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 409 |\u001b[39m           username\u001b[33m:\u001b[39m \u001b[32m'testuser'\u001b[39m\u001b[33m,\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.mockResolvedValueOnce (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/user-controller.test.js\u001b[39m\u001b[0m\u001b[2m:406:22)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1mUserController单元测试 › getProfile › 应该成功获取用户资料\u001b[39m\u001b[22m\n\n    TypeError: mockPool.query.mockResolvedValueOnce is not a function\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 471 |\u001b[39m       \u001b[22m\n\u001b[2m     \u001b[90m 472 |\u001b[39m       \u001b[90m// 模拟数据库查询结果\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 473 |\u001b[39m       mockPool\u001b[33m.\u001b[39mquery\u001b[33m.\u001b[39mmockResolvedValueOnce({\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                      \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 474 |\u001b[39m         rows\u001b[33m:\u001b[39m [{\u001b[22m\n\u001b[2m     \u001b[90m 475 |\u001b[39m           id\u001b[33m:\u001b[39m \u001b[35m1\u001b[39m\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 476 |\u001b[39m           username\u001b[33m:\u001b[39m \u001b[32m'testuser'\u001b[39m\u001b[33m,\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.mockResolvedValueOnce (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/user-controller.test.js\u001b[39m\u001b[0m\u001b[2m:473:22)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1mUserController单元测试 › getProfile › 应该在用户不存在时返回404错误\u001b[39m\u001b[22m\n\n    TypeError: mockPool.query.mockResolvedValueOnce is not a function\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 510 |\u001b[39m       \u001b[22m\n\u001b[2m     \u001b[90m 511 |\u001b[39m       \u001b[90m// 模拟数据库查询结果 - 用户不存在\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 512 |\u001b[39m       mockPool\u001b[33m.\u001b[39mquery\u001b[33m.\u001b[39mmockResolvedValueOnce({ rows\u001b[33m:\u001b[39m [] })\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                      \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 513 |\u001b[39m       \u001b[22m\n\u001b[2m     \u001b[90m 514 |\u001b[39m       \u001b[90m// 调用控制器方法\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 515 |\u001b[39m       \u001b[36mawait\u001b[39m userController\u001b[33m.\u001b[39mgetProfile(mockReq\u001b[33m,\u001b[39m mockRes)\u001b[33m;\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.mockResolvedValueOnce (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/user-controller.test.js\u001b[39m\u001b[0m\u001b[2m:512:22)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1mUserController单元测试 › updateProfile › 应该成功更新用户资料\u001b[39m\u001b[22m\n\n    TypeError: mockPool.query.mockResolvedValueOnce is not a function\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 538 |\u001b[39m       \u001b[90m// 模拟数据库查询结果\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 539 |\u001b[39m       mockPool\u001b[33m.\u001b[39mquery\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 540 |\u001b[39m         \u001b[33m.\u001b[39mmockResolvedValueOnce({ rows\u001b[33m:\u001b[39m [{ id\u001b[33m:\u001b[39m \u001b[35m1\u001b[39m\u001b[33m,\u001b[39m username\u001b[33m:\u001b[39m \u001b[32m'testuser'\u001b[39m\u001b[33m,\u001b[39m email\u001b[33m:\u001b[39m \u001b[32m'test@example.com'\u001b[39m }] }) \u001b[90m// 用户存在\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m          \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 541 |\u001b[39m         \u001b[33m.\u001b[39mmockResolvedValueOnce({ rows\u001b[33m:\u001b[39m [] }) \u001b[90m// 邮箱未被其他用户使用\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 542 |\u001b[39m         \u001b[33m.\u001b[39mmockResolvedValueOnce({ \u001b[90m// 更新成功，返回更新后的用户信息\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 543 |\u001b[39m           rows\u001b[33m:\u001b[39m [{\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.mockResolvedValueOnce (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/user-controller.test.js\u001b[39m\u001b[0m\u001b[2m:540:10)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1mUserController单元测试 › updateProfile › 应该在邮箱已被其他用户使用时返回409错误\u001b[39m\u001b[22m\n\n    TypeError: mockPool.query.mockResolvedValueOnce is not a function\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 586 |\u001b[39m       \u001b[90m// 模拟数据库查询结果\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 587 |\u001b[39m       mockPool\u001b[33m.\u001b[39mquery\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 588 |\u001b[39m         \u001b[33m.\u001b[39mmockResolvedValueOnce({ rows\u001b[33m:\u001b[39m [{ id\u001b[33m:\u001b[39m \u001b[35m1\u001b[39m }] }) \u001b[90m// 用户存在\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m          \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 589 |\u001b[39m         \u001b[33m.\u001b[39mmockResolvedValueOnce({ rows\u001b[33m:\u001b[39m [{ id\u001b[33m:\u001b[39m \u001b[35m2\u001b[39m }] })\u001b[33m;\u001b[39m \u001b[90m// 邮箱已被其他用户使用\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 590 |\u001b[39m       \u001b[22m\n\u001b[2m     \u001b[90m 591 |\u001b[39m       \u001b[90m// 调用控制器方法\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.mockResolvedValueOnce (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/user-controller.test.js\u001b[39m\u001b[0m\u001b[2m:588:10)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1mUserController单元测试 › changePassword › 应该成功修改密码\u001b[39m\u001b[22m\n\n    TypeError: mockPool.query.mockResolvedValueOnce is not a function\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 614 |\u001b[39m       \u001b[90m// 模拟数据库查询结果\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 615 |\u001b[39m       mockPool\u001b[33m.\u001b[39mquery\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 616 |\u001b[39m         \u001b[33m.\u001b[39mmockResolvedValueOnce({\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m          \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 617 |\u001b[39m           rows\u001b[33m:\u001b[39m [{ id\u001b[33m:\u001b[39m \u001b[35m1\u001b[39m\u001b[33m,\u001b[39m password_hash\u001b[33m:\u001b[39m \u001b[32m'hashedCurrentPassword'\u001b[39m }]\u001b[22m\n\u001b[2m     \u001b[90m 618 |\u001b[39m         }) \u001b[90m// 获取用户当前密码\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 619 |\u001b[39m         \u001b[33m.\u001b[39mmockResolvedValueOnce({ rows\u001b[33m:\u001b[39m [{ id\u001b[33m:\u001b[39m \u001b[35m1\u001b[39m }] })\u001b[33m;\u001b[39m \u001b[90m// 更新密码成功\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.mockResolvedValueOnce (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/user-controller.test.js\u001b[39m\u001b[0m\u001b[2m:616:10)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1mUserController单元测试 › changePassword › 应该在当前密码错误时返回400错误\u001b[39m\u001b[22m\n\n    TypeError: mockPool.query.mockResolvedValueOnce is not a function\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 653 |\u001b[39m       \u001b[22m\n\u001b[2m     \u001b[90m 654 |\u001b[39m       \u001b[90m// 模拟数据库查询结果\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 655 |\u001b[39m       mockPool\u001b[33m.\u001b[39mquery\u001b[33m.\u001b[39mmockResolvedValueOnce({\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                      \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 656 |\u001b[39m         rows\u001b[33m:\u001b[39m [{ id\u001b[33m:\u001b[39m \u001b[35m1\u001b[39m\u001b[33m,\u001b[39m password_hash\u001b[33m:\u001b[39m \u001b[32m'hashedCurrentPassword'\u001b[39m }]\u001b[22m\n\u001b[2m     \u001b[90m 657 |\u001b[39m       })\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 658 |\u001b[39m       \u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.mockResolvedValueOnce (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/user-controller.test.js\u001b[39m\u001b[0m\u001b[2m:655:22)\u001b[22m\u001b[2m\u001b[22m\n","name":"C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\user-controller.test.js","startTime":1762159270894,"status":"failed","summary":""},{"assertionResults":[{"ancestorTitles":["ExpenseController单元测试","createExpense"],"duration":1,"failureDetails":[{}],"failureMessages":["TypeError: mockPool.query.mockResolvedValueOnce is not a function\n    at Object.mockResolvedValueOnce (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\expense-controller.test.js:80:10)\n    at Promise.then.completed (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:444:34)"],"fullName":"ExpenseController单元测试 createExpense 应该成功创建费用记录","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该成功创建费用记录"},{"ancestorTitles":["ExpenseController单元测试","createExpense"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"ExpenseController单元测试 createExpense 应该在缺少必填字段时返回400错误","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"应该在缺少必填字段时返回400错误"},{"ancestorTitles":["ExpenseController单元测试","createExpense"],"duration":1,"failureDetails":[{}],"failureMessages":["TypeError: mockPool.query.mockResolvedValueOnce is not a function\n    at Object.mockResolvedValueOnce (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\expense-controller.test.js:138:22)\n    at Promise.then.completed (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:444:34)"],"fullName":"ExpenseController单元测试 createExpense 应该在用户不是寝室成员时返回403错误","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该在用户不是寝室成员时返回403错误"},{"ancestorTitles":["ExpenseController单元测试","createExpense"],"duration":0,"failureDetails":[{}],"failureMessages":["TypeError: mockPool.query.mockRejectedValueOnce is not a function\n    at Object.mockRejectedValueOnce (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\expense-controller.test.js:164:22)\n    at Promise.then.completed (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:444:34)"],"fullName":"ExpenseController单元测试 createExpense 应该在数据库错误时返回500错误","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该在数据库错误时返回500错误"},{"ancestorTitles":["ExpenseController单元测试","getExpenses"],"duration":0,"failureDetails":[{}],"failureMessages":["TypeError: mockPool.query.mockResolvedValueOnce is not a function\n    at Object.mockResolvedValueOnce (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\expense-controller.test.js:191:10)\n    at Promise.then.completed (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:444:34)"],"fullName":"ExpenseController单元测试 getExpenses 应该成功获取费用列表","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该成功获取费用列表"},{"ancestorTitles":["ExpenseController单元测试","getExpenses"],"duration":0,"failureDetails":[{}],"failureMessages":["TypeError: mockPool.query.mockResolvedValueOnce is not a function\n    at Object.mockResolvedValueOnce (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\expense-controller.test.js:227:22)\n    at Promise.then.completed (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:444:34)"],"fullName":"ExpenseController单元测试 getExpenses 应该在用户不是寝室成员时返回403错误","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该在用户不是寝室成员时返回403错误"},{"ancestorTitles":["ExpenseController单元测试","getExpenseById"],"duration":0,"failureDetails":[{}],"failureMessages":["TypeError: mockPool.query.mockResolvedValueOnce is not a function\n    at Object.mockResolvedValueOnce (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\expense-controller.test.js:250:10)\n    at Promise.then.completed (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:444:34)"],"fullName":"ExpenseController单元测试 getExpenseById 应该成功获取特定费用详情","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该成功获取特定费用详情"},{"ancestorTitles":["ExpenseController单元测试","getExpenseById"],"duration":0,"failureDetails":[{}],"failureMessages":["TypeError: mockPool.query.mockResolvedValueOnce is not a function\n    at Object.mockResolvedValueOnce (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\expense-controller.test.js:280:22)\n    at Promise.then.completed (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:444:34)"],"fullName":"ExpenseController单元测试 getExpenseById 应该在费用不存在时返回404错误","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该在费用不存在时返回404错误"},{"ancestorTitles":["ExpenseController单元测试","updateExpense"],"duration":0,"failureDetails":[{}],"failureMessages":["TypeError: mockPool.query.mockResolvedValueOnce is not a function\n    at Object.mockResolvedValueOnce (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\expense-controller.test.js:308:10)\n    at Promise.then.completed (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:444:34)"],"fullName":"ExpenseController单元测试 updateExpense 应该成功更新费用记录","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该成功更新费用记录"},{"ancestorTitles":["ExpenseController单元测试","updateExpense"],"duration":0,"failureDetails":[{}],"failureMessages":["TypeError: mockPool.query.mockResolvedValueOnce is not a function\n    at Object.mockResolvedValueOnce (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\expense-controller.test.js:335:22)\n    at Promise.then.completed (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:444:34)"],"fullName":"ExpenseController单元测试 updateExpense 应该在费用不存在时返回404错误","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该在费用不存在时返回404错误"},{"ancestorTitles":["ExpenseController单元测试","deleteExpense"],"duration":0,"failureDetails":[{}],"failureMessages":["TypeError: mockPool.query.mockResolvedValueOnce is not a function\n    at Object.mockResolvedValueOnce (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\expense-controller.test.js:358:10)\n    at Promise.then.completed (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:444:34)"],"fullName":"ExpenseController单元测试 deleteExpense 应该成功删除费用记录","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该成功删除费用记录"},{"ancestorTitles":["ExpenseController单元测试","deleteExpense"],"duration":1,"failureDetails":[{}],"failureMessages":["TypeError: mockPool.query.mockResolvedValueOnce is not a function\n    at Object.mockResolvedValueOnce (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\expense-controller.test.js:381:22)\n    at Promise.then.completed (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:444:34)"],"fullName":"ExpenseController单元测试 deleteExpense 应该在费用不存在时返回404错误","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该在费用不存在时返回404错误"},{"ancestorTitles":["ExpenseController单元测试","confirmSplitPayment"],"duration":0,"failureDetails":[{}],"failureMessages":["TypeError: mockPool.query.mockResolvedValueOnce is not a function\n    at Object.mockResolvedValueOnce (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\expense-controller.test.js:405:10)\n    at Promise.then.completed (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:444:34)"],"fullName":"ExpenseController单元测试 confirmSplitPayment 应该成功确认分摊支付","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该成功确认分摊支付"},{"ancestorTitles":["ExpenseController单元测试","confirmSplitPayment"],"duration":0,"failureDetails":[{}],"failureMessages":["TypeError: mockPool.query.mockResolvedValueOnce is not a function\n    at Object.mockResolvedValueOnce (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\expense-controller.test.js:430:10)\n    at Promise.then.completed (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:444:34)"],"fullName":"ExpenseController单元测试 confirmSplitPayment 应该在分摊ID不存在时返回400错误","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该在分摊ID不存在时返回400错误"}],"endTime":1762159271658,"message":"\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1mExpenseController单元测试 › createExpense › 应该成功创建费用记录\u001b[39m\u001b[22m\n\n    TypeError: mockPool.query.mockResolvedValueOnce is not a function\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 78 |\u001b[39m       \u001b[90m// 模拟数据库查询结果\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 79 |\u001b[39m       mockPool\u001b[33m.\u001b[39mquery\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 80 |\u001b[39m         \u001b[33m.\u001b[39mmockResolvedValueOnce({ rows\u001b[33m:\u001b[39m [{ id\u001b[33m:\u001b[39m \u001b[35m1\u001b[39m\u001b[33m,\u001b[39m user_id\u001b[33m:\u001b[39m \u001b[35m1\u001b[39m }] }) \u001b[90m// 检查寝室成员\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m          \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 81 |\u001b[39m         \u001b[33m.\u001b[39mmockResolvedValueOnce({ rows\u001b[33m:\u001b[39m [] }) \u001b[90m// 检查费用类型\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 82 |\u001b[39m         \u001b[33m.\u001b[39mmockResolvedValueOnce({ rows\u001b[33m:\u001b[39m [{ id\u001b[33m:\u001b[39m \u001b[35m1\u001b[39m }] }) \u001b[90m// 插入费用\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 83 |\u001b[39m         \u001b[33m.\u001b[39mmockResolvedValueOnce({ rows\u001b[33m:\u001b[39m [{ id\u001b[33m:\u001b[39m \u001b[35m1\u001b[39m\u001b[33m,\u001b[39m user_id\u001b[33m:\u001b[39m \u001b[35m2\u001b[39m }] }) \u001b[90m// 获取寝室成员\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.mockResolvedValueOnce (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/expense-controller.test.js\u001b[39m\u001b[0m\u001b[2m:80:10)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1mExpenseController单元测试 › createExpense › 应该在用户不是寝室成员时返回403错误\u001b[39m\u001b[22m\n\n    TypeError: mockPool.query.mockResolvedValueOnce is not a function\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 136 |\u001b[39m       \u001b[22m\n\u001b[2m     \u001b[90m 137 |\u001b[39m       \u001b[90m// 模拟数据库查询结果 - 用户不是寝室成员\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 138 |\u001b[39m       mockPool\u001b[33m.\u001b[39mquery\u001b[33m.\u001b[39mmockResolvedValueOnce({ rows\u001b[33m:\u001b[39m [] })\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                      \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 139 |\u001b[39m       \u001b[22m\n\u001b[2m     \u001b[90m 140 |\u001b[39m       \u001b[90m// 调用控制器方法\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 141 |\u001b[39m       \u001b[36mawait\u001b[39m expenseController\u001b[33m.\u001b[39mcreateExpense(mockReq\u001b[33m,\u001b[39m mockRes)\u001b[33m;\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.mockResolvedValueOnce (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/expense-controller.test.js\u001b[39m\u001b[0m\u001b[2m:138:22)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1mExpenseController单元测试 › createExpense › 应该在数据库错误时返回500错误\u001b[39m\u001b[22m\n\n    TypeError: mockPool.query.mockRejectedValueOnce is not a function\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 162 |\u001b[39m       \u001b[22m\n\u001b[2m     \u001b[90m 163 |\u001b[39m       \u001b[90m// 模拟数据库错误\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 164 |\u001b[39m       mockPool\u001b[33m.\u001b[39mquery\u001b[33m.\u001b[39mmockRejectedValueOnce(\u001b[36mnew\u001b[39m \u001b[33mError\u001b[39m(\u001b[32m'数据库连接错误'\u001b[39m))\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                      \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 165 |\u001b[39m       \u001b[22m\n\u001b[2m     \u001b[90m 166 |\u001b[39m       \u001b[90m// 调用控制器方法\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 167 |\u001b[39m       \u001b[36mawait\u001b[39m expenseController\u001b[33m.\u001b[39mcreateExpense(mockReq\u001b[33m,\u001b[39m mockRes)\u001b[33m;\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.mockRejectedValueOnce (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/expense-controller.test.js\u001b[39m\u001b[0m\u001b[2m:164:22)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1mExpenseController单元测试 › getExpenses › 应该成功获取费用列表\u001b[39m\u001b[22m\n\n    TypeError: mockPool.query.mockResolvedValueOnce is not a function\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 189 |\u001b[39m       \u001b[90m// 模拟数据库查询结果\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 190 |\u001b[39m       mockPool\u001b[33m.\u001b[39mquery\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 191 |\u001b[39m         \u001b[33m.\u001b[39mmockResolvedValueOnce({ rows\u001b[33m:\u001b[39m [{ id\u001b[33m:\u001b[39m \u001b[35m1\u001b[39m\u001b[33m,\u001b[39m user_id\u001b[33m:\u001b[39m \u001b[35m1\u001b[39m }] }) \u001b[90m// 检查寝室成员\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m          \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 192 |\u001b[39m         \u001b[33m.\u001b[39mmockResolvedValueOnce({ rows\u001b[33m:\u001b[39m [{ id\u001b[33m:\u001b[39m \u001b[35m1\u001b[39m\u001b[33m,\u001b[39m title\u001b[33m:\u001b[39m \u001b[32m'测试费用'\u001b[39m\u001b[33m,\u001b[39m amount\u001b[33m:\u001b[39m \u001b[35m100.50\u001b[39m }] }) \u001b[90m// 获取费用列表\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 193 |\u001b[39m         \u001b[33m.\u001b[39mmockResolvedValueOnce({ rows\u001b[33m:\u001b[39m [{ count\u001b[33m:\u001b[39m \u001b[35m1\u001b[39m }] })\u001b[33m;\u001b[39m \u001b[90m// 获取总数\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 194 |\u001b[39m       \u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.mockResolvedValueOnce (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/expense-controller.test.js\u001b[39m\u001b[0m\u001b[2m:191:10)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1mExpenseController单元测试 › getExpenses › 应该在用户不是寝室成员时返回403错误\u001b[39m\u001b[22m\n\n    TypeError: mockPool.query.mockResolvedValueOnce is not a function\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 225 |\u001b[39m       \u001b[22m\n\u001b[2m     \u001b[90m 226 |\u001b[39m       \u001b[90m// 模拟数据库查询结果 - 用户不是寝室成员\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 227 |\u001b[39m       mockPool\u001b[33m.\u001b[39mquery\u001b[33m.\u001b[39mmockResolvedValueOnce({ rows\u001b[33m:\u001b[39m [] })\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                      \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 228 |\u001b[39m       \u001b[22m\n\u001b[2m     \u001b[90m 229 |\u001b[39m       \u001b[90m// 调用控制器方法\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 230 |\u001b[39m       \u001b[36mawait\u001b[39m expenseController\u001b[33m.\u001b[39mgetExpenses(mockReq\u001b[33m,\u001b[39m mockRes)\u001b[33m;\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.mockResolvedValueOnce (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/expense-controller.test.js\u001b[39m\u001b[0m\u001b[2m:227:22)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1mExpenseController单元测试 › getExpenseById › 应该成功获取特定费用详情\u001b[39m\u001b[22m\n\n    TypeError: mockPool.query.mockResolvedValueOnce is not a function\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 248 |\u001b[39m       \u001b[90m// 模拟数据库查询结果\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 249 |\u001b[39m       mockPool\u001b[33m.\u001b[39mquery\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 250 |\u001b[39m         \u001b[33m.\u001b[39mmockResolvedValueOnce({ rows\u001b[33m:\u001b[39m [{ id\u001b[33m:\u001b[39m \u001b[35m1\u001b[39m\u001b[33m,\u001b[39m room_id\u001b[33m:\u001b[39m \u001b[35m1\u001b[39m\u001b[33m,\u001b[39m user_id\u001b[33m:\u001b[39m \u001b[35m1\u001b[39m }] }) \u001b[90m// 获取费用\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m          \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 251 |\u001b[39m         \u001b[33m.\u001b[39mmockResolvedValueOnce({ rows\u001b[33m:\u001b[39m [{ id\u001b[33m:\u001b[39m \u001b[35m1\u001b[39m\u001b[33m,\u001b[39m user_id\u001b[33m:\u001b[39m \u001b[35m1\u001b[39m }] }) \u001b[90m// 检查寝室成员\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 252 |\u001b[39m         \u001b[33m.\u001b[39mmockResolvedValueOnce({ rows\u001b[33m:\u001b[39m [{ id\u001b[33m:\u001b[39m \u001b[35m1\u001b[39m\u001b[33m,\u001b[39m user_id\u001b[33m:\u001b[39m \u001b[35m1\u001b[39m\u001b[33m,\u001b[39m amount\u001b[33m:\u001b[39m \u001b[35m50.25\u001b[39m }] })\u001b[33m;\u001b[39m \u001b[90m// 获取分摊详情\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 253 |\u001b[39m       \u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.mockResolvedValueOnce (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/expense-controller.test.js\u001b[39m\u001b[0m\u001b[2m:250:10)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1mExpenseController单元测试 › getExpenseById › 应该在费用不存在时返回404错误\u001b[39m\u001b[22m\n\n    TypeError: mockPool.query.mockResolvedValueOnce is not a function\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 278 |\u001b[39m       \u001b[22m\n\u001b[2m     \u001b[90m 279 |\u001b[39m       \u001b[90m// 模拟数据库查询结果 - 费用不存在\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 280 |\u001b[39m       mockPool\u001b[33m.\u001b[39mquery\u001b[33m.\u001b[39mmockResolvedValueOnce({ rows\u001b[33m:\u001b[39m [] })\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                      \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 281 |\u001b[39m       \u001b[22m\n\u001b[2m     \u001b[90m 282 |\u001b[39m       \u001b[90m// 调用控制器方法\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 283 |\u001b[39m       \u001b[36mawait\u001b[39m expenseController\u001b[33m.\u001b[39mgetExpenseById(mockReq\u001b[33m,\u001b[39m mockRes)\u001b[33m;\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.mockResolvedValueOnce (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/expense-controller.test.js\u001b[39m\u001b[0m\u001b[2m:280:22)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1mExpenseController单元测试 › updateExpense › 应该成功更新费用记录\u001b[39m\u001b[22m\n\n    TypeError: mockPool.query.mockResolvedValueOnce is not a function\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 306 |\u001b[39m       \u001b[90m// 模拟数据库查询结果\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 307 |\u001b[39m       mockPool\u001b[33m.\u001b[39mquery\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 308 |\u001b[39m         \u001b[33m.\u001b[39mmockResolvedValueOnce({ rows\u001b[33m:\u001b[39m [{ id\u001b[33m:\u001b[39m \u001b[35m1\u001b[39m\u001b[33m,\u001b[39m room_id\u001b[33m:\u001b[39m \u001b[35m1\u001b[39m\u001b[33m,\u001b[39m user_id\u001b[33m:\u001b[39m \u001b[35m1\u001b[39m }] }) \u001b[90m// 获取费用\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m          \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 309 |\u001b[39m         \u001b[33m.\u001b[39mmockResolvedValueOnce({ rows\u001b[33m:\u001b[39m [{ id\u001b[33m:\u001b[39m \u001b[35m1\u001b[39m\u001b[33m,\u001b[39m user_id\u001b[33m:\u001b[39m \u001b[35m1\u001b[39m }] }) \u001b[90m// 检查寝室成员\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 310 |\u001b[39m         \u001b[33m.\u001b[39mmockResolvedValueOnce({ rows\u001b[33m:\u001b[39m [{ id\u001b[33m:\u001b[39m \u001b[35m1\u001b[39m\u001b[33m,\u001b[39m title\u001b[33m:\u001b[39m \u001b[32m'更新后的测试费用'\u001b[39m\u001b[33m,\u001b[39m amount\u001b[33m:\u001b[39m \u001b[35m150.75\u001b[39m }] })\u001b[33m;\u001b[39m \u001b[90m// 更新费用\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 311 |\u001b[39m       \u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.mockResolvedValueOnce (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/expense-controller.test.js\u001b[39m\u001b[0m\u001b[2m:308:10)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1mExpenseController单元测试 › updateExpense › 应该在费用不存在时返回404错误\u001b[39m\u001b[22m\n\n    TypeError: mockPool.query.mockResolvedValueOnce is not a function\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 333 |\u001b[39m       \u001b[22m\n\u001b[2m     \u001b[90m 334 |\u001b[39m       \u001b[90m// 模拟数据库查询结果 - 费用不存在\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 335 |\u001b[39m       mockPool\u001b[33m.\u001b[39mquery\u001b[33m.\u001b[39mmockResolvedValueOnce({ rows\u001b[33m:\u001b[39m [] })\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                      \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 336 |\u001b[39m       \u001b[22m\n\u001b[2m     \u001b[90m 337 |\u001b[39m       \u001b[90m// 调用控制器方法\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 338 |\u001b[39m       \u001b[36mawait\u001b[39m expenseController\u001b[33m.\u001b[39mupdateExpense(mockReq\u001b[33m,\u001b[39m mockRes)\u001b[33m;\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.mockResolvedValueOnce (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/expense-controller.test.js\u001b[39m\u001b[0m\u001b[2m:335:22)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1mExpenseController单元测试 › deleteExpense › 应该成功删除费用记录\u001b[39m\u001b[22m\n\n    TypeError: mockPool.query.mockResolvedValueOnce is not a function\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 356 |\u001b[39m       \u001b[90m// 模拟数据库查询结果\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 357 |\u001b[39m       mockPool\u001b[33m.\u001b[39mquery\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 358 |\u001b[39m         \u001b[33m.\u001b[39mmockResolvedValueOnce({ rows\u001b[33m:\u001b[39m [{ id\u001b[33m:\u001b[39m \u001b[35m1\u001b[39m\u001b[33m,\u001b[39m room_id\u001b[33m:\u001b[39m \u001b[35m1\u001b[39m\u001b[33m,\u001b[39m user_id\u001b[33m:\u001b[39m \u001b[35m1\u001b[39m }] }) \u001b[90m// 获取费用\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m          \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 359 |\u001b[39m         \u001b[33m.\u001b[39mmockResolvedValueOnce({ rows\u001b[33m:\u001b[39m [{ id\u001b[33m:\u001b[39m \u001b[35m1\u001b[39m\u001b[33m,\u001b[39m user_id\u001b[33m:\u001b[39m \u001b[35m1\u001b[39m }] }) \u001b[90m// 检查寝室成员\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 360 |\u001b[39m         \u001b[33m.\u001b[39mmockResolvedValueOnce({ rows\u001b[33m:\u001b[39m [] })\u001b[33m;\u001b[39m \u001b[90m// 删除分摊记录\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 361 |\u001b[39m       mockPool\u001b[33m.\u001b[39mquery\u001b[33m.\u001b[39mmockResolvedValueOnce({ rows\u001b[33m:\u001b[39m [] })\u001b[33m;\u001b[39m \u001b[90m// 删除费用\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.mockResolvedValueOnce (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/expense-controller.test.js\u001b[39m\u001b[0m\u001b[2m:358:10)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1mExpenseController单元测试 › deleteExpense › 应该在费用不存在时返回404错误\u001b[39m\u001b[22m\n\n    TypeError: mockPool.query.mockResolvedValueOnce is not a function\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 379 |\u001b[39m       \u001b[22m\n\u001b[2m     \u001b[90m 380 |\u001b[39m       \u001b[90m// 模拟数据库查询结果 - 费用不存在\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 381 |\u001b[39m       mockPool\u001b[33m.\u001b[39mquery\u001b[33m.\u001b[39mmockResolvedValueOnce({ rows\u001b[33m:\u001b[39m [] })\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                      \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 382 |\u001b[39m       \u001b[22m\n\u001b[2m     \u001b[90m 383 |\u001b[39m       \u001b[90m// 调用控制器方法\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 384 |\u001b[39m       \u001b[36mawait\u001b[39m expenseController\u001b[33m.\u001b[39mdeleteExpense(mockReq\u001b[33m,\u001b[39m mockRes)\u001b[33m;\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.mockResolvedValueOnce (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/expense-controller.test.js\u001b[39m\u001b[0m\u001b[2m:381:22)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1mExpenseController单元测试 › confirmSplitPayment › 应该成功确认分摊支付\u001b[39m\u001b[22m\n\n    TypeError: mockPool.query.mockResolvedValueOnce is not a function\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 403 |\u001b[39m       \u001b[90m// 模拟数据库查询结果\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 404 |\u001b[39m       mockPool\u001b[33m.\u001b[39mquery\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 405 |\u001b[39m         \u001b[33m.\u001b[39mmockResolvedValueOnce({ rows\u001b[33m:\u001b[39m [{ id\u001b[33m:\u001b[39m \u001b[35m1\u001b[39m\u001b[33m,\u001b[39m room_id\u001b[33m:\u001b[39m \u001b[35m1\u001b[39m\u001b[33m,\u001b[39m user_id\u001b[33m:\u001b[39m \u001b[35m1\u001b[39m }] }) \u001b[90m// 获取费用\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m          \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 406 |\u001b[39m         \u001b[33m.\u001b[39mmockResolvedValueOnce({ rows\u001b[33m:\u001b[39m [{ id\u001b[33m:\u001b[39m \u001b[35m1\u001b[39m\u001b[33m,\u001b[39m user_id\u001b[33m:\u001b[39m \u001b[35m1\u001b[39m }] }) \u001b[90m// 检查寝室成员\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 407 |\u001b[39m         \u001b[33m.\u001b[39mmockResolvedValueOnce({ rows\u001b[33m:\u001b[39m [{ id\u001b[33m:\u001b[39m \u001b[35m1\u001b[39m\u001b[33m,\u001b[39m user_id\u001b[33m:\u001b[39m \u001b[35m1\u001b[39m\u001b[33m,\u001b[39m is_paid\u001b[33m:\u001b[39m \u001b[36mfalse\u001b[39m }] }) \u001b[90m// 获取分摊记录\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 408 |\u001b[39m         \u001b[33m.\u001b[39mmockResolvedValueOnce({ rows\u001b[33m:\u001b[39m [{ id\u001b[33m:\u001b[39m \u001b[35m1\u001b[39m\u001b[33m,\u001b[39m is_paid\u001b[33m:\u001b[39m \u001b[36mtrue\u001b[39m }] })\u001b[33m;\u001b[39m \u001b[90m// 更新分摊记录\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.mockResolvedValueOnce (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/expense-controller.test.js\u001b[39m\u001b[0m\u001b[2m:405:10)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1mExpenseController单元测试 › confirmSplitPayment › 应该在分摊ID不存在时返回400错误\u001b[39m\u001b[22m\n\n    TypeError: mockPool.query.mockResolvedValueOnce is not a function\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 428 |\u001b[39m       \u001b[90m// 模拟数据库查询结果\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 429 |\u001b[39m       mockPool\u001b[33m.\u001b[39mquery\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 430 |\u001b[39m         \u001b[33m.\u001b[39mmockResolvedValueOnce({ rows\u001b[33m:\u001b[39m [{ id\u001b[33m:\u001b[39m \u001b[35m1\u001b[39m\u001b[33m,\u001b[39m room_id\u001b[33m:\u001b[39m \u001b[35m1\u001b[39m\u001b[33m,\u001b[39m user_id\u001b[33m:\u001b[39m \u001b[35m1\u001b[39m }] }) \u001b[90m// 获取费用\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m          \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 431 |\u001b[39m         \u001b[33m.\u001b[39mmockResolvedValueOnce({ rows\u001b[33m:\u001b[39m [{ id\u001b[33m:\u001b[39m \u001b[35m1\u001b[39m\u001b[33m,\u001b[39m user_id\u001b[33m:\u001b[39m \u001b[35m1\u001b[39m }] }) \u001b[90m// 检查寝室成员\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 432 |\u001b[39m         \u001b[33m.\u001b[39mmockResolvedValueOnce({ rows\u001b[33m:\u001b[39m [] })\u001b[33m;\u001b[39m \u001b[90m// 分摊记录不存在\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 433 |\u001b[39m       \u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.mockResolvedValueOnce (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/expense-controller.test.js\u001b[39m\u001b[0m\u001b[2m:430:10)\u001b[22m\u001b[2m\u001b[22m\n","name":"C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\expense-controller.test.js","startTime":1762159271270,"status":"failed","summary":""},{"assertionResults":[{"ancestorTitles":["通知服务测试","sendEmail"],"duration":14,"failureDetails":[{}],"failureMessages":["TypeError: nodemailer.createTransporter is not a function\n    at Object.createTransporter [as sendEmail] (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\utils\\notification-service.js:50:32)\n    at Object.sendEmail (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\notification-service.test.js:40:48)\n    at Promise.then.completed (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:444:34)"],"fullName":"通知服务测试 sendEmail 应该在开发环境下模拟发送邮件","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该在开发环境下模拟发送邮件"},{"ancestorTitles":["通知服务测试","sendEmail"],"duration":3,"failureDetails":[{}],"failureMessages":["TypeError: nodemailer.createTransporter is not a function\n    at Object.createTransporter [as sendEmail] (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\utils\\notification-service.js:50:32)\n    at Object.sendEmail (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\notification-service.test.js:75:48)\n    at Promise.then.completed (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:444:34)"],"fullName":"通知服务测试 sendEmail 应该在生产环境下真实发送邮件","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该在生产环境下真实发送邮件"},{"ancestorTitles":["通知服务测试","sendEmail"],"duration":3,"failureDetails":[{}],"failureMessages":["Error: 缺少必要的邮件参数\n    at Object.sendEmail (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\utils\\notification-service.js:30:13)\n    at Object.sendEmail (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\notification-service.test.js:116:48)\n    at Promise.then.completed (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:444:34)"],"fullName":"通知服务测试 sendEmail 应该在邮件发送失败时返回错误信息","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该在邮件发送失败时返回错误信息"},{"ancestorTitles":["通知服务测试","sendEmail"],"duration":7,"failureDetails":[{"matcherResult":{"message":"\u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mrejects\u001b[2m.\u001b[22mtoThrow\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m)\u001b[22m\n\nExpected substring: \u001b[32m\"缺少必要参数\"\u001b[39m\nReceived message:   \u001b[31m\"缺少必要的邮件参数\"\u001b[39m\n\n    \u001b[0m \u001b[90m 28 |\u001b[39m     \u001b[90m// 检查必要参数\u001b[39m\n     \u001b[90m 29 |\u001b[39m     \u001b[36mif\u001b[39m (\u001b[33m!\u001b[39mto \u001b[33m||\u001b[39m \u001b[33m!\u001b[39msubject \u001b[33m||\u001b[39m (\u001b[33m!\u001b[39mmessage \u001b[33m&&\u001b[39m \u001b[33m!\u001b[39mhtml)) {\n    \u001b[31m\u001b[1m>\u001b[22m\u001b[39m\u001b[90m 30 |\u001b[39m       \u001b[36mthrow\u001b[39m \u001b[36mnew\u001b[39m \u001b[33mError\u001b[39m(\u001b[32m'缺少必要的邮件参数'\u001b[39m)\u001b[33m;\u001b[39m\n     \u001b[90m    |\u001b[39m             \u001b[31m\u001b[1m^\u001b[22m\u001b[39m\n     \u001b[90m 31 |\u001b[39m     }\n     \u001b[90m 32 |\u001b[39m     \n     \u001b[90m 33 |\u001b[39m     \u001b[90m// 创建邮件传输器\u001b[39m\u001b[0m\n\n      \u001b[2mat Object.sendEmail (\u001b[22mutils/notification-service.js\u001b[2m:30:13)\u001b[22m\n      \u001b[2mat Object.sendEmail (\u001b[22mtests/unit/notification-service.test.js\u001b[2m:137:40)\u001b[22m","pass":false},"message":"\u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mrejects\u001b[2m.\u001b[22mtoThrow\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m)\u001b[22m\n\nExpected substring: \u001b[32m\"缺少必要参数\"\u001b[39m\nReceived message:   \u001b[31m\"缺少必要的邮件参数\"\u001b[39m\n\n    \u001b[0m \u001b[90m 28 |\u001b[39m     \u001b[90m// 检查必要参数\u001b[39m\n     \u001b[90m 29 |\u001b[39m     \u001b[36mif\u001b[39m (\u001b[33m!\u001b[39mto \u001b[33m||\u001b[39m \u001b[33m!\u001b[39msubject \u001b[33m||\u001b[39m (\u001b[33m!\u001b[39mmessage \u001b[33m&&\u001b[39m \u001b[33m!\u001b[39mhtml)) {\n    \u001b[31m\u001b[1m>\u001b[22m\u001b[39m\u001b[90m 30 |\u001b[39m       \u001b[36mthrow\u001b[39m \u001b[36mnew\u001b[39m \u001b[33mError\u001b[39m(\u001b[32m'缺少必要的邮件参数'\u001b[39m)\u001b[33m;\u001b[39m\n     \u001b[90m    |\u001b[39m             \u001b[31m\u001b[1m^\u001b[22m\u001b[39m\n     \u001b[90m 31 |\u001b[39m     }\n     \u001b[90m 32 |\u001b[39m     \n     \u001b[90m 33 |\u001b[39m     \u001b[90m// 创建邮件传输器\u001b[39m\u001b[0m\n\n      \u001b[2mat Object.sendEmail (\u001b[22mutils/notification-service.js\u001b[2m:30:13)\u001b[22m\n      \u001b[2mat Object.sendEmail (\u001b[22mtests/unit/notification-service.test.js\u001b[2m:137:40)\u001b[22m"}],"failureMessages":["Error: \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mrejects\u001b[2m.\u001b[22mtoThrow\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m)\u001b[22m\n\nExpected substring: \u001b[32m\"缺少必要参数\"\u001b[39m\nReceived message:   \u001b[31m\"缺少必要的邮件参数\"\u001b[39m\n\n    \u001b[0m \u001b[90m 28 |\u001b[39m     \u001b[90m// 检查必要参数\u001b[39m\n     \u001b[90m 29 |\u001b[39m     \u001b[36mif\u001b[39m (\u001b[33m!\u001b[39mto \u001b[33m||\u001b[39m \u001b[33m!\u001b[39msubject \u001b[33m||\u001b[39m (\u001b[33m!\u001b[39mmessage \u001b[33m&&\u001b[39m \u001b[33m!\u001b[39mhtml)) {\n    \u001b[31m\u001b[1m>\u001b[22m\u001b[39m\u001b[90m 30 |\u001b[39m       \u001b[36mthrow\u001b[39m \u001b[36mnew\u001b[39m \u001b[33mError\u001b[39m(\u001b[32m'缺少必要的邮件参数'\u001b[39m)\u001b[33m;\u001b[39m\n     \u001b[90m    |\u001b[39m             \u001b[31m\u001b[1m^\u001b[22m\u001b[39m\n     \u001b[90m 31 |\u001b[39m     }\n     \u001b[90m 32 |\u001b[39m     \n     \u001b[90m 33 |\u001b[39m     \u001b[90m// 创建邮件传输器\u001b[39m\u001b[0m\n\n      \u001b[2mat Object.sendEmail (\u001b[22mutils/notification-service.js\u001b[2m:30:13)\u001b[22m\n      \u001b[2mat Object.sendEmail (\u001b[22mtests/unit/notification-service.test.js\u001b[2m:137:40)\u001b[22m\n    at Object.toThrow (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\expect\\build\\index.js:218:22)\n    at Object.toThrow (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\notification-service.test.js:138:18)\n    at Promise.then.completed (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:444:34)"],"fullName":"通知服务测试 sendEmail 应该在缺少必要参数时抛出错误","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该在缺少必要参数时抛出错误"},{"ancestorTitles":["通知服务测试","sendSMS"],"duration":1,"failureDetails":[{"matcherResult":{"actual":{"success":true,"sid":"dev-sid-1762159272014","status":"simulated"},"expected":{"success":true,"message":"短信发送成功(开发环境模拟)"},"message":"\u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoEqual\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m) // deep equality\u001b[22m\n\n\u001b[32m- Expected  - 1\u001b[39m\n\u001b[31m+ Received  + 2\u001b[39m\n\n\u001b[2m  Object {\u001b[22m\n\u001b[32m-   \"message\": \"短信发送成功(开发环境模拟)\",\u001b[39m\n\u001b[31m+   \"sid\": \"dev-sid-1762159272014\",\u001b[39m\n\u001b[31m+   \"status\": \"simulated\",\u001b[39m\n\u001b[2m    \"success\": true,\u001b[22m\n\u001b[2m  }\u001b[22m","name":"toEqual","pass":false}}],"failureMessages":["Error: \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoEqual\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m) // deep equality\u001b[22m\n\n\u001b[32m- Expected  - 1\u001b[39m\n\u001b[31m+ Received  + 2\u001b[39m\n\n\u001b[2m  Object {\u001b[22m\n\u001b[32m-   \"message\": \"短信发送成功(开发环境模拟)\",\u001b[39m\n\u001b[31m+   \"sid\": \"dev-sid-1762159272014\",\u001b[39m\n\u001b[31m+   \"status\": \"simulated\",\u001b[39m\n\u001b[2m    \"success\": true,\u001b[22m\n\u001b[2m  }\u001b[22m\n    at Object.toEqual (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\notification-service.test.js:158:22)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)"],"fullName":"通知服务测试 sendSMS 应该在开发环境下模拟发送短信","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该在开发环境下模拟发送短信"},{"ancestorTitles":["通知服务测试","sendSMS"],"duration":1,"failureDetails":[{"matcherResult":{"message":"\u001b[2mexpect(\u001b[22m\u001b[31mjest.fn()\u001b[39m\u001b[2m).\u001b[22mtoHaveBeenCalledWith\u001b[2m(\u001b[22m\u001b[32m...expected\u001b[39m\u001b[2m)\u001b[22m\n\nExpected: \u001b[32m{\"body\": \"这是一条测试短信\", \"from\": Any<String>, \"to\": \"+1234567890\"}\u001b[39m\n\nNumber of calls: \u001b[31m0\u001b[39m","pass":false}}],"failureMessages":["Error: \u001b[2mexpect(\u001b[22m\u001b[31mjest.fn()\u001b[39m\u001b[2m).\u001b[22mtoHaveBeenCalledWith\u001b[2m(\u001b[22m\u001b[32m...expected\u001b[39m\u001b[2m)\u001b[22m\n\nExpected: \u001b[32m{\"body\": \"这是一条测试短信\", \"from\": Any<String>, \"to\": \"+1234567890\"}\u001b[39m\n\nNumber of calls: \u001b[31m0\u001b[39m\n    at Object.toHaveBeenCalledWith (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\notification-service.test.js:191:26)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)"],"fullName":"通知服务测试 sendSMS 应该在生产环境下真实发送短信","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"failed","title":"应该在生产环境下真实发送短信"},{"ancestorTitles":["通知服务测试","sendSMS"],"duration":0,"failureDetails":[{"matcherResult":{"actual":{"success":true,"sid":"dev-sid-1762159272016","status":"simulated"},"expected":{"success":false,"message":"短信发送失败: 短信发送失败"},"message":"\u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoEqual\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m) // deep equality\u001b[22m\n\n\u001b[32m- Expected  - 2\u001b[39m\n\u001b[31m+ Received  + 3\u001b[39m\n\n\u001b[2m  Object {\u001b[22m\n\u001b[32m-   \"message\": \"短信发送失败: 短信发送失败\",\u001b[39m\n\u001b[32m-   \"success\": false,\u001b[39m\n\u001b[31m+   \"sid\": \"dev-sid-1762159272016\",\u001b[39m\n\u001b[31m+   \"status\": \"simulated\",\u001b[39m\n\u001b[31m+   \"success\": true,\u001b[39m\n\u001b[2m  }\u001b[22m","name":"toEqual","pass":false}}],"failureMessages":["Error: \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoEqual\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m) // deep equality\u001b[22m\n\n\u001b[32m- Expected  - 2\u001b[39m\n\u001b[31m+ Received  + 3\u001b[39m\n\n\u001b[2m  Object {\u001b[22m\n\u001b[32m-   \"message\": \"短信发送失败: 短信发送失败\",\u001b[39m\n\u001b[32m-   \"success\": false,\u001b[39m\n\u001b[31m+   \"sid\": \"dev-sid-1762159272016\",\u001b[39m\n\u001b[31m+   \"status\": \"simulated\",\u001b[39m\n\u001b[31m+   \"success\": true,\u001b[39m\n\u001b[2m  }\u001b[22m\n    at Object.toEqual (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\notification-service.test.js:227:22)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)"],"fullName":"通知服务测试 sendSMS 应该在短信发送失败时返回错误信息","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该在短信发送失败时返回错误信息"},{"ancestorTitles":["通知服务测试","sendSMS"],"duration":5,"failureDetails":[{"matcherResult":{"message":"\u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mrejects\u001b[2m.\u001b[22mtoThrow\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m)\u001b[22m\n\nExpected substring: \u001b[32m\"缺少必要参数\"\u001b[39m\nReceived message:   \u001b[31m\"缺少必要的短信参数\"\u001b[39m\n\n    \u001b[0m \u001b[90m 107 |\u001b[39m     \u001b[90m// 检查必要参数\u001b[39m\n     \u001b[90m 108 |\u001b[39m     \u001b[36mif\u001b[39m (\u001b[33m!\u001b[39mto \u001b[33m||\u001b[39m \u001b[33m!\u001b[39mmessage) {\n    \u001b[31m\u001b[1m>\u001b[22m\u001b[39m\u001b[90m 109 |\u001b[39m       \u001b[36mthrow\u001b[39m \u001b[36mnew\u001b[39m \u001b[33mError\u001b[39m(\u001b[32m'缺少必要的短信参数'\u001b[39m)\u001b[33m;\u001b[39m\n     \u001b[90m     |\u001b[39m             \u001b[31m\u001b[1m^\u001b[22m\u001b[39m\n     \u001b[90m 110 |\u001b[39m     }\n     \u001b[90m 111 |\u001b[39m     \n     \u001b[90m 112 |\u001b[39m     \u001b[90m// 在开发环境中，只记录日志而不实际发送短信\u001b[39m\u001b[0m\n\n      \u001b[2mat Object.sendSMS (\u001b[22mutils/notification-service.js\u001b[2m:109:13)\u001b[22m\n      \u001b[2mat Object.sendSMS (\u001b[22mtests/unit/notification-service.test.js\u001b[2m:244:40)\u001b[22m","pass":false},"message":"\u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mrejects\u001b[2m.\u001b[22mtoThrow\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m)\u001b[22m\n\nExpected substring: \u001b[32m\"缺少必要参数\"\u001b[39m\nReceived message:   \u001b[31m\"缺少必要的短信参数\"\u001b[39m\n\n    \u001b[0m \u001b[90m 107 |\u001b[39m     \u001b[90m// 检查必要参数\u001b[39m\n     \u001b[90m 108 |\u001b[39m     \u001b[36mif\u001b[39m (\u001b[33m!\u001b[39mto \u001b[33m||\u001b[39m \u001b[33m!\u001b[39mmessage) {\n    \u001b[31m\u001b[1m>\u001b[22m\u001b[39m\u001b[90m 109 |\u001b[39m       \u001b[36mthrow\u001b[39m \u001b[36mnew\u001b[39m \u001b[33mError\u001b[39m(\u001b[32m'缺少必要的短信参数'\u001b[39m)\u001b[33m;\u001b[39m\n     \u001b[90m     |\u001b[39m             \u001b[31m\u001b[1m^\u001b[22m\u001b[39m\n     \u001b[90m 110 |\u001b[39m     }\n     \u001b[90m 111 |\u001b[39m     \n     \u001b[90m 112 |\u001b[39m     \u001b[90m// 在开发环境中，只记录日志而不实际发送短信\u001b[39m\u001b[0m\n\n      \u001b[2mat Object.sendSMS (\u001b[22mutils/notification-service.js\u001b[2m:109:13)\u001b[22m\n      \u001b[2mat Object.sendSMS (\u001b[22mtests/unit/notification-service.test.js\u001b[2m:244:40)\u001b[22m"}],"failureMessages":["Error: \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mrejects\u001b[2m.\u001b[22mtoThrow\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m)\u001b[22m\n\nExpected substring: \u001b[32m\"缺少必要参数\"\u001b[39m\nReceived message:   \u001b[31m\"缺少必要的短信参数\"\u001b[39m\n\n    \u001b[0m \u001b[90m 107 |\u001b[39m     \u001b[90m// 检查必要参数\u001b[39m\n     \u001b[90m 108 |\u001b[39m     \u001b[36mif\u001b[39m (\u001b[33m!\u001b[39mto \u001b[33m||\u001b[39m \u001b[33m!\u001b[39mmessage) {\n    \u001b[31m\u001b[1m>\u001b[22m\u001b[39m\u001b[90m 109 |\u001b[39m       \u001b[36mthrow\u001b[39m \u001b[36mnew\u001b[39m \u001b[33mError\u001b[39m(\u001b[32m'缺少必要的短信参数'\u001b[39m)\u001b[33m;\u001b[39m\n     \u001b[90m     |\u001b[39m             \u001b[31m\u001b[1m^\u001b[22m\u001b[39m\n     \u001b[90m 110 |\u001b[39m     }\n     \u001b[90m 111 |\u001b[39m     \n     \u001b[90m 112 |\u001b[39m     \u001b[90m// 在开发环境中，只记录日志而不实际发送短信\u001b[39m\u001b[0m\n\n      \u001b[2mat Object.sendSMS (\u001b[22mutils/notification-service.js\u001b[2m:109:13)\u001b[22m\n      \u001b[2mat Object.sendSMS (\u001b[22mtests/unit/notification-service.test.js\u001b[2m:244:40)\u001b[22m\n    at Object.toThrow (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\expect\\build\\index.js:218:22)\n    at Object.toThrow (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\notification-service.test.js:245:18)\n    at Promise.then.completed (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:444:34)"],"fullName":"通知服务测试 sendSMS 应该在缺少必要参数时抛出错误","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该在缺少必要参数时抛出错误"},{"ancestorTitles":["通知服务测试","sendPaymentReminderEmail"],"duration":3,"failureDetails":[{}],"failureMessages":["Error: 缺少必要的邮件参数\n    at sendEmail (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\utils\\notification-service.js:30:13)\n    at Object.sendEmail [as sendPaymentReminderEmail] (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\utils\\notification-service.js:246:16)\n    at Object.sendPaymentReminderEmail (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\notification-service.test.js:263:48)\n    at Promise.then.completed (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:444:34)"],"fullName":"通知服务测试 sendPaymentReminderEmail 应该成功发送支付提醒邮件","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该成功发送支付提醒邮件"},{"ancestorTitles":["通知服务测试","sendPaymentReminderEmail"],"duration":3,"failureDetails":[{}],"failureMessages":["Error: 缺少必要的邮件参数\n    at sendEmail (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\utils\\notification-service.js:30:13)\n    at Object.sendEmail [as sendPaymentReminderEmail] (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\utils\\notification-service.js:246:16)\n    at Object.sendPaymentReminderEmail (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\notification-service.test.js:295:48)\n    at Promise.then.completed (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:444:34)"],"fullName":"通知服务测试 sendPaymentReminderEmail 应该在邮件发送失败时返回错误信息","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该在邮件发送失败时返回错误信息"},{"ancestorTitles":["通知服务测试","sendPaymentConfirmationEmail"],"duration":2,"failureDetails":[{}],"failureMessages":["Error: 缺少必要的邮件参数\n    at sendEmail (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\utils\\notification-service.js:30:13)\n    at Object.sendEmail [as sendPaymentConfirmationEmail] (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\utils\\notification-service.js:291:16)\n    at Object.sendPaymentConfirmationEmail (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\notification-service.test.js:322:48)\n    at Promise.then.completed (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:444:34)"],"fullName":"通知服务测试 sendPaymentConfirmationEmail 应该成功发送支付确认邮件","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该成功发送支付确认邮件"},{"ancestorTitles":["通知服务测试","sendPaymentConfirmationEmail"],"duration":5,"failureDetails":[{}],"failureMessages":["Error: 缺少必要的邮件参数\n    at sendEmail (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\utils\\notification-service.js:30:13)\n    at Object.sendEmail [as sendPaymentConfirmationEmail] (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\utils\\notification-service.js:291:16)\n    at Object.sendPaymentConfirmationEmail (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\notification-service.test.js:355:48)\n    at Promise.then.completed (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:444:34)"],"fullName":"通知服务测试 sendPaymentConfirmationEmail 应该在邮件发送失败时返回错误信息","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该在邮件发送失败时返回错误信息"},{"ancestorTitles":["通知服务测试","sendBillShareEmail"],"duration":3,"failureDetails":[{}],"failureMessages":["Error: 缺少必要的邮件参数\n    at sendEmail (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\utils\\notification-service.js:30:13)\n    at Object.sendEmail [as sendBillShareEmail] (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\utils\\notification-service.js:328:16)\n    at Object.sendBillShareEmail (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\notification-service.test.js:382:48)\n    at Promise.then.completed (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:444:34)"],"fullName":"通知服务测试 sendBillShareEmail 应该成功发送账单分享邮件","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该成功发送账单分享邮件"},{"ancestorTitles":["通知服务测试","sendBillShareEmail"],"duration":3,"failureDetails":[{}],"failureMessages":["Error: 缺少必要的邮件参数\n    at sendEmail (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\utils\\notification-service.js:30:13)\n    at Object.sendEmail [as sendBillShareEmail] (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\utils\\notification-service.js:328:16)\n    at Object.sendBillShareEmail (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\notification-service.test.js:415:48)\n    at Promise.then.completed (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:444:34)"],"fullName":"通知服务测试 sendBillShareEmail 应该在邮件发送失败时返回错误信息","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该在邮件发送失败时返回错误信息"}],"endTime":1762159272070,"message":"\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m通知服务测试 › sendEmail › 应该在开发环境下模拟发送邮件\u001b[39m\u001b[22m\n\n    TypeError: nodemailer.createTransporter is not a function\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 48 |\u001b[39m     } \u001b[36melse\u001b[39m {\u001b[22m\n\u001b[2m     \u001b[90m 49 |\u001b[39m       \u001b[90m// 开发环境使用测试账户\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 50 |\u001b[39m       transporter \u001b[33m=\u001b[39m nodemailer\u001b[33m.\u001b[39mcreateTransporter({\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m                                \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 51 |\u001b[39m         host\u001b[33m:\u001b[39m \u001b[32m'smtp.ethereal.email'\u001b[39m\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 52 |\u001b[39m         port\u001b[33m:\u001b[39m \u001b[35m587\u001b[39m\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 53 |\u001b[39m         secure\u001b[33m:\u001b[39m \u001b[36mfalse\u001b[39m\u001b[33m,\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.createTransporter [as sendEmail] (\u001b[22m\u001b[2mutils/notification-service.js\u001b[2m:50:32)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.sendEmail (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/notification-service.test.js\u001b[39m\u001b[0m\u001b[2m:40:48)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m通知服务测试 › sendEmail › 应该在生产环境下真实发送邮件\u001b[39m\u001b[22m\n\n    TypeError: nodemailer.createTransporter is not a function\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 48 |\u001b[39m     } \u001b[36melse\u001b[39m {\u001b[22m\n\u001b[2m     \u001b[90m 49 |\u001b[39m       \u001b[90m// 开发环境使用测试账户\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 50 |\u001b[39m       transporter \u001b[33m=\u001b[39m nodemailer\u001b[33m.\u001b[39mcreateTransporter({\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m                                \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 51 |\u001b[39m         host\u001b[33m:\u001b[39m \u001b[32m'smtp.ethereal.email'\u001b[39m\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 52 |\u001b[39m         port\u001b[33m:\u001b[39m \u001b[35m587\u001b[39m\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 53 |\u001b[39m         secure\u001b[33m:\u001b[39m \u001b[36mfalse\u001b[39m\u001b[33m,\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.createTransporter [as sendEmail] (\u001b[22m\u001b[2mutils/notification-service.js\u001b[2m:50:32)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.sendEmail (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/notification-service.test.js\u001b[39m\u001b[0m\u001b[2m:75:48)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m通知服务测试 › sendEmail › 应该在邮件发送失败时返回错误信息\u001b[39m\u001b[22m\n\n    缺少必要的邮件参数\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 28 |\u001b[39m     \u001b[90m// 检查必要参数\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 29 |\u001b[39m     \u001b[36mif\u001b[39m (\u001b[33m!\u001b[39mto \u001b[33m||\u001b[39m \u001b[33m!\u001b[39msubject \u001b[33m||\u001b[39m (\u001b[33m!\u001b[39mmessage \u001b[33m&&\u001b[39m \u001b[33m!\u001b[39mhtml)) {\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 30 |\u001b[39m       \u001b[36mthrow\u001b[39m \u001b[36mnew\u001b[39m \u001b[33mError\u001b[39m(\u001b[32m'缺少必要的邮件参数'\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m             \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 31 |\u001b[39m     }\u001b[22m\n\u001b[2m     \u001b[90m 32 |\u001b[39m     \u001b[22m\n\u001b[2m     \u001b[90m 33 |\u001b[39m     \u001b[90m// 创建邮件传输器\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.sendEmail (\u001b[22m\u001b[2mutils/notification-service.js\u001b[2m:30:13)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.sendEmail (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/notification-service.test.js\u001b[39m\u001b[0m\u001b[2m:116:48)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m通知服务测试 › sendEmail › 应该在缺少必要参数时抛出错误\u001b[39m\u001b[22m\n\n    \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mrejects\u001b[2m.\u001b[22mtoThrow\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m)\u001b[22m\n\n    Expected substring: \u001b[32m\"缺少必要参数\"\u001b[39m\n    Received message:   \u001b[31m\"缺少必要的邮件参数\"\u001b[39m\n\n        \u001b[0m \u001b[90m 28 |\u001b[39m     \u001b[90m// 检查必要参数\u001b[39m\n         \u001b[90m 29 |\u001b[39m     \u001b[36mif\u001b[39m (\u001b[33m!\u001b[39mto \u001b[33m||\u001b[39m \u001b[33m!\u001b[39msubject \u001b[33m||\u001b[39m (\u001b[33m!\u001b[39mmessage \u001b[33m&&\u001b[39m \u001b[33m!\u001b[39mhtml)) {\n        \u001b[31m\u001b[1m>\u001b[22m\u001b[39m\u001b[90m 30 |\u001b[39m       \u001b[36mthrow\u001b[39m \u001b[36mnew\u001b[39m \u001b[33mError\u001b[39m(\u001b[32m'缺少必要的邮件参数'\u001b[39m)\u001b[33m;\u001b[39m\n         \u001b[90m    |\u001b[39m             \u001b[31m\u001b[1m^\u001b[22m\u001b[39m\n         \u001b[90m 31 |\u001b[39m     }\n         \u001b[90m 32 |\u001b[39m     \n         \u001b[90m 33 |\u001b[39m     \u001b[90m// 创建邮件传输器\u001b[39m\u001b[0m\n\n          \u001b[2mat Object.sendEmail (\u001b[22mutils/notification-service.js\u001b[2m:30:13)\u001b[22m\n          \u001b[2mat Object.sendEmail (\u001b[22mtests/unit/notification-service.test.js\u001b[2m:137:40)\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 136 |\u001b[39m       \u001b[90m// 验证函数抛出错误\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 137 |\u001b[39m       \u001b[36mawait\u001b[39m expect(notificationService\u001b[33m.\u001b[39msendEmail(incompleteOptions))\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 138 |\u001b[39m         \u001b[33m.\u001b[39mrejects\u001b[33m.\u001b[39mtoThrow(\u001b[32m'缺少必要参数'\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                  \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 139 |\u001b[39m     })\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 140 |\u001b[39m   })\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 141 |\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.toThrow (\u001b[22m\u001b[2mnode_modules/expect/build/index.js\u001b[2m:218:22)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.toThrow (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/notification-service.test.js\u001b[39m\u001b[0m\u001b[2m:138:18)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m通知服务测试 › sendSMS › 应该在开发环境下模拟发送短信\u001b[39m\u001b[22m\n\n    \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoEqual\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m) // deep equality\u001b[22m\n\n    \u001b[32m- Expected  - 1\u001b[39m\n    \u001b[31m+ Received  + 2\u001b[39m\n\n    \u001b[2m  Object {\u001b[22m\n    \u001b[32m-   \"message\": \"短信发送成功(开发环境模拟)\",\u001b[39m\n    \u001b[31m+   \"sid\": \"dev-sid-1762159272014\",\u001b[39m\n    \u001b[31m+   \"status\": \"simulated\",\u001b[39m\n    \u001b[2m    \"success\": true,\u001b[22m\n    \u001b[2m  }\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 156 |\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 157 |\u001b[39m       \u001b[90m// 验证结果\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 158 |\u001b[39m       expect(result)\u001b[33m.\u001b[39mtoEqual({\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                      \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 159 |\u001b[39m         success\u001b[33m:\u001b[39m \u001b[36mtrue\u001b[39m\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 160 |\u001b[39m         message\u001b[33m:\u001b[39m \u001b[32m'短信发送成功(开发环境模拟)'\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 161 |\u001b[39m       })\u001b[33m;\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.toEqual (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/notification-service.test.js\u001b[39m\u001b[0m\u001b[2m:158:22)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m通知服务测试 › sendSMS › 应该在生产环境下真实发送短信\u001b[39m\u001b[22m\n\n    \u001b[2mexpect(\u001b[22m\u001b[31mjest.fn()\u001b[39m\u001b[2m).\u001b[22mtoHaveBeenCalledWith\u001b[2m(\u001b[22m\u001b[32m...expected\u001b[39m\u001b[2m)\u001b[22m\n\n    Expected: \u001b[32m{\"body\": \"这是一条测试短信\", \"from\": Any<String>, \"to\": \"+1234567890\"}\u001b[39m\n\n    Number of calls: \u001b[31m0\u001b[39m\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 189 |\u001b[39m       \u001b[90m// 验证结果\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 190 |\u001b[39m       expect(twilio)\u001b[33m.\u001b[39mtoHaveBeenCalled()\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 191 |\u001b[39m       expect(mockCreate)\u001b[33m.\u001b[39mtoHaveBeenCalledWith({\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                          \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 192 |\u001b[39m         body\u001b[33m:\u001b[39m smsOptions\u001b[33m.\u001b[39mmessage\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 193 |\u001b[39m         \u001b[36mfrom\u001b[39m\u001b[33m:\u001b[39m expect\u001b[33m.\u001b[39many(\u001b[33mString\u001b[39m)\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 194 |\u001b[39m         to\u001b[33m:\u001b[39m smsOptions\u001b[33m.\u001b[39mto\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.toHaveBeenCalledWith (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/notification-service.test.js\u001b[39m\u001b[0m\u001b[2m:191:26)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m通知服务测试 › sendSMS › 应该在短信发送失败时返回错误信息\u001b[39m\u001b[22m\n\n    \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoEqual\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m) // deep equality\u001b[22m\n\n    \u001b[32m- Expected  - 2\u001b[39m\n    \u001b[31m+ Received  + 3\u001b[39m\n\n    \u001b[2m  Object {\u001b[22m\n    \u001b[32m-   \"message\": \"短信发送失败: 短信发送失败\",\u001b[39m\n    \u001b[32m-   \"success\": false,\u001b[39m\n    \u001b[31m+   \"sid\": \"dev-sid-1762159272016\",\u001b[39m\n    \u001b[31m+   \"status\": \"simulated\",\u001b[39m\n    \u001b[31m+   \"success\": true,\u001b[39m\n    \u001b[2m  }\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 225 |\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 226 |\u001b[39m       \u001b[90m// 验证结果\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 227 |\u001b[39m       expect(result)\u001b[33m.\u001b[39mtoEqual({\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                      \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 228 |\u001b[39m         success\u001b[33m:\u001b[39m \u001b[36mfalse\u001b[39m\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 229 |\u001b[39m         message\u001b[33m:\u001b[39m \u001b[32m'短信发送失败: 短信发送失败'\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 230 |\u001b[39m       })\u001b[33m;\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.toEqual (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/notification-service.test.js\u001b[39m\u001b[0m\u001b[2m:227:22)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m通知服务测试 › sendSMS › 应该在缺少必要参数时抛出错误\u001b[39m\u001b[22m\n\n    \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mrejects\u001b[2m.\u001b[22mtoThrow\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m)\u001b[22m\n\n    Expected substring: \u001b[32m\"缺少必要参数\"\u001b[39m\n    Received message:   \u001b[31m\"缺少必要的短信参数\"\u001b[39m\n\n        \u001b[0m \u001b[90m 107 |\u001b[39m     \u001b[90m// 检查必要参数\u001b[39m\n         \u001b[90m 108 |\u001b[39m     \u001b[36mif\u001b[39m (\u001b[33m!\u001b[39mto \u001b[33m||\u001b[39m \u001b[33m!\u001b[39mmessage) {\n        \u001b[31m\u001b[1m>\u001b[22m\u001b[39m\u001b[90m 109 |\u001b[39m       \u001b[36mthrow\u001b[39m \u001b[36mnew\u001b[39m \u001b[33mError\u001b[39m(\u001b[32m'缺少必要的短信参数'\u001b[39m)\u001b[33m;\u001b[39m\n         \u001b[90m     |\u001b[39m             \u001b[31m\u001b[1m^\u001b[22m\u001b[39m\n         \u001b[90m 110 |\u001b[39m     }\n         \u001b[90m 111 |\u001b[39m     \n         \u001b[90m 112 |\u001b[39m     \u001b[90m// 在开发环境中，只记录日志而不实际发送短信\u001b[39m\u001b[0m\n\n          \u001b[2mat Object.sendSMS (\u001b[22mutils/notification-service.js\u001b[2m:109:13)\u001b[22m\n          \u001b[2mat Object.sendSMS (\u001b[22mtests/unit/notification-service.test.js\u001b[2m:244:40)\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 243 |\u001b[39m       \u001b[90m// 验证函数抛出错误\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 244 |\u001b[39m       \u001b[36mawait\u001b[39m expect(notificationService\u001b[33m.\u001b[39msendSMS(incompleteOptions))\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 245 |\u001b[39m         \u001b[33m.\u001b[39mrejects\u001b[33m.\u001b[39mtoThrow(\u001b[32m'缺少必要参数'\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                  \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 246 |\u001b[39m     })\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 247 |\u001b[39m   })\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 248 |\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.toThrow (\u001b[22m\u001b[2mnode_modules/expect/build/index.js\u001b[2m:218:22)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.toThrow (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/notification-service.test.js\u001b[39m\u001b[0m\u001b[2m:245:18)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m通知服务测试 › sendPaymentReminderEmail › 应该成功发送支付提醒邮件\u001b[39m\u001b[22m\n\n    缺少必要的邮件参数\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 28 |\u001b[39m     \u001b[90m// 检查必要参数\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 29 |\u001b[39m     \u001b[36mif\u001b[39m (\u001b[33m!\u001b[39mto \u001b[33m||\u001b[39m \u001b[33m!\u001b[39msubject \u001b[33m||\u001b[39m (\u001b[33m!\u001b[39mmessage \u001b[33m&&\u001b[39m \u001b[33m!\u001b[39mhtml)) {\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 30 |\u001b[39m       \u001b[36mthrow\u001b[39m \u001b[36mnew\u001b[39m \u001b[33mError\u001b[39m(\u001b[32m'缺少必要的邮件参数'\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m             \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 31 |\u001b[39m     }\u001b[22m\n\u001b[2m     \u001b[90m 32 |\u001b[39m     \u001b[22m\n\u001b[2m     \u001b[90m 33 |\u001b[39m     \u001b[90m// 创建邮件传输器\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat sendEmail (\u001b[22m\u001b[2mutils/notification-service.js\u001b[2m:30:13)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.sendEmail [as sendPaymentReminderEmail] (\u001b[22m\u001b[2mutils/notification-service.js\u001b[2m:246:16)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.sendPaymentReminderEmail (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/notification-service.test.js\u001b[39m\u001b[0m\u001b[2m:263:48)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m通知服务测试 › sendPaymentReminderEmail › 应该在邮件发送失败时返回错误信息\u001b[39m\u001b[22m\n\n    缺少必要的邮件参数\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 28 |\u001b[39m     \u001b[90m// 检查必要参数\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 29 |\u001b[39m     \u001b[36mif\u001b[39m (\u001b[33m!\u001b[39mto \u001b[33m||\u001b[39m \u001b[33m!\u001b[39msubject \u001b[33m||\u001b[39m (\u001b[33m!\u001b[39mmessage \u001b[33m&&\u001b[39m \u001b[33m!\u001b[39mhtml)) {\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 30 |\u001b[39m       \u001b[36mthrow\u001b[39m \u001b[36mnew\u001b[39m \u001b[33mError\u001b[39m(\u001b[32m'缺少必要的邮件参数'\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m             \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 31 |\u001b[39m     }\u001b[22m\n\u001b[2m     \u001b[90m 32 |\u001b[39m     \u001b[22m\n\u001b[2m     \u001b[90m 33 |\u001b[39m     \u001b[90m// 创建邮件传输器\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat sendEmail (\u001b[22m\u001b[2mutils/notification-service.js\u001b[2m:30:13)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.sendEmail [as sendPaymentReminderEmail] (\u001b[22m\u001b[2mutils/notification-service.js\u001b[2m:246:16)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.sendPaymentReminderEmail (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/notification-service.test.js\u001b[39m\u001b[0m\u001b[2m:295:48)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m通知服务测试 › sendPaymentConfirmationEmail › 应该成功发送支付确认邮件\u001b[39m\u001b[22m\n\n    缺少必要的邮件参数\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 28 |\u001b[39m     \u001b[90m// 检查必要参数\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 29 |\u001b[39m     \u001b[36mif\u001b[39m (\u001b[33m!\u001b[39mto \u001b[33m||\u001b[39m \u001b[33m!\u001b[39msubject \u001b[33m||\u001b[39m (\u001b[33m!\u001b[39mmessage \u001b[33m&&\u001b[39m \u001b[33m!\u001b[39mhtml)) {\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 30 |\u001b[39m       \u001b[36mthrow\u001b[39m \u001b[36mnew\u001b[39m \u001b[33mError\u001b[39m(\u001b[32m'缺少必要的邮件参数'\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m             \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 31 |\u001b[39m     }\u001b[22m\n\u001b[2m     \u001b[90m 32 |\u001b[39m     \u001b[22m\n\u001b[2m     \u001b[90m 33 |\u001b[39m     \u001b[90m// 创建邮件传输器\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat sendEmail (\u001b[22m\u001b[2mutils/notification-service.js\u001b[2m:30:13)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.sendEmail [as sendPaymentConfirmationEmail] (\u001b[22m\u001b[2mutils/notification-service.js\u001b[2m:291:16)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.sendPaymentConfirmationEmail (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/notification-service.test.js\u001b[39m\u001b[0m\u001b[2m:322:48)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m通知服务测试 › sendPaymentConfirmationEmail › 应该在邮件发送失败时返回错误信息\u001b[39m\u001b[22m\n\n    缺少必要的邮件参数\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 28 |\u001b[39m     \u001b[90m// 检查必要参数\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 29 |\u001b[39m     \u001b[36mif\u001b[39m (\u001b[33m!\u001b[39mto \u001b[33m||\u001b[39m \u001b[33m!\u001b[39msubject \u001b[33m||\u001b[39m (\u001b[33m!\u001b[39mmessage \u001b[33m&&\u001b[39m \u001b[33m!\u001b[39mhtml)) {\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 30 |\u001b[39m       \u001b[36mthrow\u001b[39m \u001b[36mnew\u001b[39m \u001b[33mError\u001b[39m(\u001b[32m'缺少必要的邮件参数'\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m             \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 31 |\u001b[39m     }\u001b[22m\n\u001b[2m     \u001b[90m 32 |\u001b[39m     \u001b[22m\n\u001b[2m     \u001b[90m 33 |\u001b[39m     \u001b[90m// 创建邮件传输器\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat sendEmail (\u001b[22m\u001b[2mutils/notification-service.js\u001b[2m:30:13)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.sendEmail [as sendPaymentConfirmationEmail] (\u001b[22m\u001b[2mutils/notification-service.js\u001b[2m:291:16)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.sendPaymentConfirmationEmail (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/notification-service.test.js\u001b[39m\u001b[0m\u001b[2m:355:48)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m通知服务测试 › sendBillShareEmail › 应该成功发送账单分享邮件\u001b[39m\u001b[22m\n\n    缺少必要的邮件参数\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 28 |\u001b[39m     \u001b[90m// 检查必要参数\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 29 |\u001b[39m     \u001b[36mif\u001b[39m (\u001b[33m!\u001b[39mto \u001b[33m||\u001b[39m \u001b[33m!\u001b[39msubject \u001b[33m||\u001b[39m (\u001b[33m!\u001b[39mmessage \u001b[33m&&\u001b[39m \u001b[33m!\u001b[39mhtml)) {\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 30 |\u001b[39m       \u001b[36mthrow\u001b[39m \u001b[36mnew\u001b[39m \u001b[33mError\u001b[39m(\u001b[32m'缺少必要的邮件参数'\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m             \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 31 |\u001b[39m     }\u001b[22m\n\u001b[2m     \u001b[90m 32 |\u001b[39m     \u001b[22m\n\u001b[2m     \u001b[90m 33 |\u001b[39m     \u001b[90m// 创建邮件传输器\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat sendEmail (\u001b[22m\u001b[2mutils/notification-service.js\u001b[2m:30:13)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.sendEmail [as sendBillShareEmail] (\u001b[22m\u001b[2mutils/notification-service.js\u001b[2m:328:16)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.sendBillShareEmail (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/notification-service.test.js\u001b[39m\u001b[0m\u001b[2m:382:48)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m通知服务测试 › sendBillShareEmail › 应该在邮件发送失败时返回错误信息\u001b[39m\u001b[22m\n\n    缺少必要的邮件参数\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 28 |\u001b[39m     \u001b[90m// 检查必要参数\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 29 |\u001b[39m     \u001b[36mif\u001b[39m (\u001b[33m!\u001b[39mto \u001b[33m||\u001b[39m \u001b[33m!\u001b[39msubject \u001b[33m||\u001b[39m (\u001b[33m!\u001b[39mmessage \u001b[33m&&\u001b[39m \u001b[33m!\u001b[39mhtml)) {\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 30 |\u001b[39m       \u001b[36mthrow\u001b[39m \u001b[36mnew\u001b[39m \u001b[33mError\u001b[39m(\u001b[32m'缺少必要的邮件参数'\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m             \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 31 |\u001b[39m     }\u001b[22m\n\u001b[2m     \u001b[90m 32 |\u001b[39m     \u001b[22m\n\u001b[2m     \u001b[90m 33 |\u001b[39m     \u001b[90m// 创建邮件传输器\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat sendEmail (\u001b[22m\u001b[2mutils/notification-service.js\u001b[2m:30:13)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.sendEmail [as sendBillShareEmail] (\u001b[22m\u001b[2mutils/notification-service.js\u001b[2m:328:16)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.sendBillShareEmail (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/notification-service.test.js\u001b[39m\u001b[0m\u001b[2m:415:48)\u001b[22m\u001b[2m\u001b[22m\n","name":"C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\notification-service.test.js","startTime":1762159271671,"status":"failed","summary":""},{"assertionResults":[{"ancestorTitles":["StatsController单元测试","getUserStats"],"duration":0,"failureDetails":[{}],"failureMessages":["TypeError: mockPool.query.mockResolvedValueOnce is not a function\n    at Object.mockResolvedValueOnce (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\stats-controller.test.js:67:10)\n    at Promise.then.completed (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:444:34)"],"fullName":"StatsController单元测试 getUserStats 应该成功获取用户统计信息","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该成功获取用户统计信息"},{"ancestorTitles":["StatsController单元测试","getUserStats"],"duration":0,"failureDetails":[{}],"failureMessages":["TypeError: mockPool.query.mockRejectedValueOnce is not a function\n    at Object.mockRejectedValueOnce (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\stats-controller.test.js:132:22)\n    at Promise.then.completed (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:444:34)"],"fullName":"StatsController单元测试 getUserStats 应该在数据库错误时返回500错误","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该在数据库错误时返回500错误"},{"ancestorTitles":["StatsController单元测试","getExpenseTypeDistribution"],"duration":1,"failureDetails":[{}],"failureMessages":["TypeError: mockPool.query.mockResolvedValueOnce is not a function\n    at Object.mockResolvedValueOnce (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\stats-controller.test.js:157:22)\n    at Promise.then.completed (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:444:34)"],"fullName":"StatsController单元测试 getExpenseTypeDistribution 应该成功获取费用类型分布","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该成功获取费用类型分布"},{"ancestorTitles":["StatsController单元测试","getExpenseTypeDistribution"],"duration":0,"failureDetails":[{}],"failureMessages":["TypeError: mockPool.query.mockResolvedValueOnce is not a function\n    at Object.mockResolvedValueOnce (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\stats-controller.test.js:222:22)\n    at Promise.then.completed (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:444:34)"],"fullName":"StatsController单元测试 getExpenseTypeDistribution 应该在无数据时返回空数组","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该在无数据时返回空数组"},{"ancestorTitles":["StatsController单元测试","getDailyExpenseTrend"],"duration":0,"failureDetails":[{}],"failureMessages":["TypeError: mockPool.query.mockResolvedValueOnce is not a function\n    at Object.mockResolvedValueOnce (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\stats-controller.test.js:248:22)\n    at Promise.then.completed (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:444:34)"],"fullName":"StatsController单元测试 getDailyExpenseTrend 应该成功获取每日费用趋势","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该成功获取每日费用趋势"},{"ancestorTitles":["StatsController单元测试","getDailyExpenseTrend"],"duration":0,"failureDetails":[{}],"failureMessages":["TypeError: statsController.getDailyExpenseTrend is not a function\n    at Object.getDailyExpenseTrend (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\stats-controller.test.js:319:29)\n    at Promise.then.completed (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:444:34)"],"fullName":"StatsController单元测试 getDailyExpenseTrend 应该在日期范围过大时返回400错误","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该在日期范围过大时返回400错误"},{"ancestorTitles":["StatsController单元测试","getMonthlyExpenseTrend"],"duration":1,"failureDetails":[{}],"failureMessages":["TypeError: mockPool.query.mockResolvedValueOnce is not a function\n    at Object.mockResolvedValueOnce (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\stats-controller.test.js:344:22)\n    at Promise.then.completed (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:444:34)"],"fullName":"StatsController单元测试 getMonthlyExpenseTrend 应该成功获取每月费用趋势","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该成功获取每月费用趋势"},{"ancestorTitles":["StatsController单元测试","getMonthlyExpenseTrend"],"duration":0,"failureDetails":[{}],"failureMessages":["TypeError: statsController.getMonthlyExpenseTrend is not a function\n    at Object.getMonthlyExpenseTrend (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\stats-controller.test.js:395:29)\n    at Promise.then.completed (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:444:34)"],"fullName":"StatsController单元测试 getMonthlyExpenseTrend 应该在日期范围过大时返回400错误","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该在日期范围过大时返回400错误"},{"ancestorTitles":["StatsController单元测试","getRoomStats"],"duration":0,"failureDetails":[{}],"failureMessages":["TypeError: mockPool.query.mockResolvedValueOnce is not a function\n    at Object.mockResolvedValueOnce (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\stats-controller.test.js:422:10)\n    at Promise.then.completed (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:444:34)"],"fullName":"StatsController单元测试 getRoomStats 应该成功获取寝室统计信息","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该成功获取寝室统计信息"},{"ancestorTitles":["StatsController单元测试","getRoomStats"],"duration":0,"failureDetails":[{}],"failureMessages":["TypeError: mockPool.query.mockResolvedValueOnce is not a function\n    at Object.mockResolvedValueOnce (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\stats-controller.test.js:497:22)\n    at Promise.then.completed (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:444:34)"],"fullName":"StatsController单元测试 getRoomStats 应该在用户不是寝室成员时返回403错误","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该在用户不是寝室成员时返回403错误"},{"ancestorTitles":["StatsController单元测试","getRoomExpenseTypeDistribution"],"duration":0,"failureDetails":[{}],"failureMessages":["TypeError: mockPool.query.mockResolvedValueOnce is not a function\n    at Object.mockResolvedValueOnce (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\stats-controller.test.js:524:10)\n    at Promise.then.completed (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:444:34)"],"fullName":"StatsController单元测试 getRoomExpenseTypeDistribution 应该成功获取寝室费用类型分布","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该成功获取寝室费用类型分布"},{"ancestorTitles":["StatsController单元测试","getRoomMonthlyTrend"],"duration":1,"failureDetails":[{}],"failureMessages":["TypeError: mockPool.query.mockResolvedValueOnce is not a function\n    at Object.mockResolvedValueOnce (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\stats-controller.test.js:603:10)\n    at Promise.then.completed (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:444:34)"],"fullName":"StatsController单元测试 getRoomMonthlyTrend 应该成功获取寝室每月费用趋势","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该成功获取寝室每月费用趋势"}],"endTime":1762159272473,"message":"\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1mStatsController单元测试 › getUserStats › 应该成功获取用户统计信息\u001b[39m\u001b[22m\n\n    TypeError: mockPool.query.mockResolvedValueOnce is not a function\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 65 |\u001b[39m       \u001b[90m// 模拟数据库查询结果\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 66 |\u001b[39m       mockPool\u001b[33m.\u001b[39mquery\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 67 |\u001b[39m         \u001b[33m.\u001b[39mmockResolvedValueOnce({\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m          \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 68 |\u001b[39m           rows\u001b[33m:\u001b[39m [{\u001b[22m\n\u001b[2m     \u001b[90m 69 |\u001b[39m             total_paid\u001b[33m:\u001b[39m \u001b[35m1000.50\u001b[39m\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 70 |\u001b[39m             total_owed\u001b[33m:\u001b[39m \u001b[35m500.25\u001b[39m\u001b[33m,\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.mockResolvedValueOnce (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/stats-controller.test.js\u001b[39m\u001b[0m\u001b[2m:67:10)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1mStatsController单元测试 › getUserStats › 应该在数据库错误时返回500错误\u001b[39m\u001b[22m\n\n    TypeError: mockPool.query.mockRejectedValueOnce is not a function\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 130 |\u001b[39m       \u001b[22m\n\u001b[2m     \u001b[90m 131 |\u001b[39m       \u001b[90m// 模拟数据库错误\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 132 |\u001b[39m       mockPool\u001b[33m.\u001b[39mquery\u001b[33m.\u001b[39mmockRejectedValueOnce(\u001b[36mnew\u001b[39m \u001b[33mError\u001b[39m(\u001b[32m'数据库连接错误'\u001b[39m))\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                      \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 133 |\u001b[39m       \u001b[22m\n\u001b[2m     \u001b[90m 134 |\u001b[39m       \u001b[90m// 调用控制器方法\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 135 |\u001b[39m       \u001b[36mawait\u001b[39m statsController\u001b[33m.\u001b[39mgetUserStats(mockReq\u001b[33m,\u001b[39m mockRes)\u001b[33m;\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.mockRejectedValueOnce (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/stats-controller.test.js\u001b[39m\u001b[0m\u001b[2m:132:22)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1mStatsController单元测试 › getExpenseTypeDistribution › 应该成功获取费用类型分布\u001b[39m\u001b[22m\n\n    TypeError: mockPool.query.mockResolvedValueOnce is not a function\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 155 |\u001b[39m       \u001b[22m\n\u001b[2m     \u001b[90m 156 |\u001b[39m       \u001b[90m// 模拟数据库查询结果\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 157 |\u001b[39m       mockPool\u001b[33m.\u001b[39mquery\u001b[33m.\u001b[39mmockResolvedValueOnce({\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                      \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 158 |\u001b[39m         rows\u001b[33m:\u001b[39m [\u001b[22m\n\u001b[2m     \u001b[90m 159 |\u001b[39m           {\u001b[22m\n\u001b[2m     \u001b[90m 160 |\u001b[39m             expense_type_id\u001b[33m:\u001b[39m \u001b[35m1\u001b[39m\u001b[33m,\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.mockResolvedValueOnce (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/stats-controller.test.js\u001b[39m\u001b[0m\u001b[2m:157:22)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1mStatsController单元测试 › getExpenseTypeDistribution › 应该在无数据时返回空数组\u001b[39m\u001b[22m\n\n    TypeError: mockPool.query.mockResolvedValueOnce is not a function\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 220 |\u001b[39m       \u001b[22m\n\u001b[2m     \u001b[90m 221 |\u001b[39m       \u001b[90m// 模拟数据库查询结果 - 无数据\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 222 |\u001b[39m       mockPool\u001b[33m.\u001b[39mquery\u001b[33m.\u001b[39mmockResolvedValueOnce({ rows\u001b[33m:\u001b[39m [] })\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                      \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 223 |\u001b[39m       \u001b[22m\n\u001b[2m     \u001b[90m 224 |\u001b[39m       \u001b[90m// 调用控制器方法\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 225 |\u001b[39m       \u001b[36mawait\u001b[39m statsController\u001b[33m.\u001b[39mgetExpenseTypeDistribution(mockReq\u001b[33m,\u001b[39m mockRes)\u001b[33m;\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.mockResolvedValueOnce (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/stats-controller.test.js\u001b[39m\u001b[0m\u001b[2m:222:22)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1mStatsController单元测试 › getDailyExpenseTrend › 应该成功获取每日费用趋势\u001b[39m\u001b[22m\n\n    TypeError: mockPool.query.mockResolvedValueOnce is not a function\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 246 |\u001b[39m       \u001b[22m\n\u001b[2m     \u001b[90m 247 |\u001b[39m       \u001b[90m// 模拟数据库查询结果\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 248 |\u001b[39m       mockPool\u001b[33m.\u001b[39mquery\u001b[33m.\u001b[39mmockResolvedValueOnce({\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                      \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 249 |\u001b[39m         rows\u001b[33m:\u001b[39m [\u001b[22m\n\u001b[2m     \u001b[90m 250 |\u001b[39m           {\u001b[22m\n\u001b[2m     \u001b[90m 251 |\u001b[39m             date\u001b[33m:\u001b[39m \u001b[32m'2023-01-01'\u001b[39m\u001b[33m,\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.mockResolvedValueOnce (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/stats-controller.test.js\u001b[39m\u001b[0m\u001b[2m:248:22)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1mStatsController单元测试 › getDailyExpenseTrend › 应该在日期范围过大时返回400错误\u001b[39m\u001b[22m\n\n    TypeError: statsController.getDailyExpenseTrend is not a function\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 317 |\u001b[39m       \u001b[22m\n\u001b[2m     \u001b[90m 318 |\u001b[39m       \u001b[90m// 调用控制器方法\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 319 |\u001b[39m       \u001b[36mawait\u001b[39m statsController\u001b[33m.\u001b[39mgetDailyExpenseTrend(mockReq\u001b[33m,\u001b[39m mockRes)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                             \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 320 |\u001b[39m       \u001b[22m\n\u001b[2m     \u001b[90m 321 |\u001b[39m       \u001b[90m// 验证响应\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 322 |\u001b[39m       expect(mockRes\u001b[33m.\u001b[39mstatus)\u001b[33m.\u001b[39mtoHaveBeenCalledWith(\u001b[35m400\u001b[39m)\u001b[33m;\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.getDailyExpenseTrend (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/stats-controller.test.js\u001b[39m\u001b[0m\u001b[2m:319:29)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1mStatsController单元测试 › getMonthlyExpenseTrend › 应该成功获取每月费用趋势\u001b[39m\u001b[22m\n\n    TypeError: mockPool.query.mockResolvedValueOnce is not a function\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 342 |\u001b[39m       \u001b[22m\n\u001b[2m     \u001b[90m 343 |\u001b[39m       \u001b[90m// 模拟数据库查询结果\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 344 |\u001b[39m       mockPool\u001b[33m.\u001b[39mquery\u001b[33m.\u001b[39mmockResolvedValueOnce({\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                      \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 345 |\u001b[39m         rows\u001b[33m:\u001b[39m [\u001b[22m\n\u001b[2m     \u001b[90m 346 |\u001b[39m           {\u001b[22m\n\u001b[2m     \u001b[90m 347 |\u001b[39m             month\u001b[33m:\u001b[39m \u001b[32m'2023-01'\u001b[39m\u001b[33m,\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.mockResolvedValueOnce (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/stats-controller.test.js\u001b[39m\u001b[0m\u001b[2m:344:22)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1mStatsController单元测试 › getMonthlyExpenseTrend › 应该在日期范围过大时返回400错误\u001b[39m\u001b[22m\n\n    TypeError: statsController.getMonthlyExpenseTrend is not a function\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 393 |\u001b[39m       \u001b[22m\n\u001b[2m     \u001b[90m 394 |\u001b[39m       \u001b[90m// 调用控制器方法\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 395 |\u001b[39m       \u001b[36mawait\u001b[39m statsController\u001b[33m.\u001b[39mgetMonthlyExpenseTrend(mockReq\u001b[33m,\u001b[39m mockRes)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                             \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 396 |\u001b[39m       \u001b[22m\n\u001b[2m     \u001b[90m 397 |\u001b[39m       \u001b[90m// 验证响应\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 398 |\u001b[39m       expect(mockRes\u001b[33m.\u001b[39mstatus)\u001b[33m.\u001b[39mtoHaveBeenCalledWith(\u001b[35m400\u001b[39m)\u001b[33m;\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.getMonthlyExpenseTrend (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/stats-controller.test.js\u001b[39m\u001b[0m\u001b[2m:395:29)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1mStatsController单元测试 › getRoomStats › 应该成功获取寝室统计信息\u001b[39m\u001b[22m\n\n    TypeError: mockPool.query.mockResolvedValueOnce is not a function\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 420 |\u001b[39m       \u001b[90m// 模拟数据库查询结果\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 421 |\u001b[39m       mockPool\u001b[33m.\u001b[39mquery\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 422 |\u001b[39m         \u001b[33m.\u001b[39mmockResolvedValueOnce({ rows\u001b[33m:\u001b[39m [{ id\u001b[33m:\u001b[39m \u001b[35m1\u001b[39m\u001b[33m,\u001b[39m creator_id\u001b[33m:\u001b[39m \u001b[35m1\u001b[39m }] }) \u001b[90m// 检查用户是否是寝室成员\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m          \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 423 |\u001b[39m         \u001b[33m.\u001b[39mmockResolvedValueOnce({\u001b[22m\n\u001b[2m     \u001b[90m 424 |\u001b[39m           rows\u001b[33m:\u001b[39m [{\u001b[22m\n\u001b[2m     \u001b[90m 425 |\u001b[39m             total_amount\u001b[33m:\u001b[39m \u001b[35m5000.00\u001b[39m\u001b[33m,\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.mockResolvedValueOnce (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/stats-controller.test.js\u001b[39m\u001b[0m\u001b[2m:422:10)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1mStatsController单元测试 › getRoomStats › 应该在用户不是寝室成员时返回403错误\u001b[39m\u001b[22m\n\n    TypeError: mockPool.query.mockResolvedValueOnce is not a function\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 495 |\u001b[39m       \u001b[22m\n\u001b[2m     \u001b[90m 496 |\u001b[39m       \u001b[90m// 模拟数据库查询结果 - 用户不是寝室成员\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 497 |\u001b[39m       mockPool\u001b[33m.\u001b[39mquery\u001b[33m.\u001b[39mmockResolvedValueOnce({ rows\u001b[33m:\u001b[39m [] })\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                      \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 498 |\u001b[39m       \u001b[22m\n\u001b[2m     \u001b[90m 499 |\u001b[39m       \u001b[90m// 调用控制器方法\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 500 |\u001b[39m       \u001b[36mawait\u001b[39m statsController\u001b[33m.\u001b[39mgetRoomStats(mockReq\u001b[33m,\u001b[39m mockRes)\u001b[33m;\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.mockResolvedValueOnce (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/stats-controller.test.js\u001b[39m\u001b[0m\u001b[2m:497:22)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1mStatsController单元测试 › getRoomExpenseTypeDistribution › 应该成功获取寝室费用类型分布\u001b[39m\u001b[22m\n\n    TypeError: mockPool.query.mockResolvedValueOnce is not a function\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 522 |\u001b[39m       \u001b[90m// 模拟数据库查询结果\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 523 |\u001b[39m       mockPool\u001b[33m.\u001b[39mquery\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 524 |\u001b[39m         \u001b[33m.\u001b[39mmockResolvedValueOnce({ rows\u001b[33m:\u001b[39m [{ id\u001b[33m:\u001b[39m \u001b[35m1\u001b[39m }] }) \u001b[90m// 检查用户是否是寝室成员\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m          \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 525 |\u001b[39m         \u001b[33m.\u001b[39mmockResolvedValueOnce({\u001b[22m\n\u001b[2m     \u001b[90m 526 |\u001b[39m           rows\u001b[33m:\u001b[39m [\u001b[22m\n\u001b[2m     \u001b[90m 527 |\u001b[39m             {\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.mockResolvedValueOnce (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/stats-controller.test.js\u001b[39m\u001b[0m\u001b[2m:524:10)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1mStatsController单元测试 › getRoomMonthlyTrend › 应该成功获取寝室每月费用趋势\u001b[39m\u001b[22m\n\n    TypeError: mockPool.query.mockResolvedValueOnce is not a function\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 601 |\u001b[39m       \u001b[90m// 模拟数据库查询结果\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 602 |\u001b[39m       mockPool\u001b[33m.\u001b[39mquery\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 603 |\u001b[39m         \u001b[33m.\u001b[39mmockResolvedValueOnce({ rows\u001b[33m:\u001b[39m [{ id\u001b[33m:\u001b[39m \u001b[35m1\u001b[39m }] }) \u001b[90m// 检查用户是否是寝室成员\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m          \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 604 |\u001b[39m         \u001b[33m.\u001b[39mmockResolvedValueOnce({\u001b[22m\n\u001b[2m     \u001b[90m 605 |\u001b[39m           rows\u001b[33m:\u001b[39m [\u001b[22m\n\u001b[2m     \u001b[90m 606 |\u001b[39m             {\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.mockResolvedValueOnce (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/stats-controller.test.js\u001b[39m\u001b[0m\u001b[2m:603:10)\u001b[22m\u001b[2m\u001b[22m\n","name":"C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\stats-controller.test.js","startTime":1762159272084,"status":"failed","summary":""},{"assertionResults":[{"ancestorTitles":["支付提醒服务测试","createPaymentReminder"],"duration":0,"failureDetails":[{}],"failureMessages":["TypeError: Cannot read properties of undefined (reading 'connect')\n    at connect (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\setup\\test-database.js:40:31)\n    at Object.initTestDatabase (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\setup\\jest.setup.js:44:9)\n    at Promise.then.completed (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusHook (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:281:40)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:95:7)\n    at run (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:444:34)"],"fullName":"支付提醒服务测试 createPaymentReminder 应该成功创建支付提醒","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该成功创建支付提醒"},{"ancestorTitles":["支付提醒服务测试","createPaymentReminder"],"duration":1,"failureDetails":[{}],"failureMessages":["TypeError: Cannot read properties of undefined (reading 'connect')\n    at connect (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\setup\\test-database.js:40:31)\n    at Object.initTestDatabase (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\setup\\jest.setup.js:44:9)\n    at Promise.then.completed (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusHook (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:281:40)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:95:7)\n    at run (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:444:34)"],"fullName":"支付提醒服务测试 createPaymentReminder 应该在缺少必要参数时抛出错误","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该在缺少必要参数时抛出错误"},{"ancestorTitles":["支付提醒服务测试","createPaymentReminder"],"duration":0,"failureDetails":[{}],"failureMessages":["TypeError: Cannot read properties of undefined (reading 'connect')\n    at connect (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\setup\\test-database.js:40:31)\n    at Object.initTestDatabase (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\setup\\jest.setup.js:44:9)\n    at Promise.then.completed (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusHook (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:281:40)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:95:7)\n    at run (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:444:34)"],"fullName":"支付提醒服务测试 createPaymentReminder 应该在数据库查询失败时抛出错误","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该在数据库查询失败时抛出错误"},{"ancestorTitles":["支付提醒服务测试","sendPaymentReminder"],"duration":0,"failureDetails":[{}],"failureMessages":["TypeError: Cannot read properties of undefined (reading 'connect')\n    at connect (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\setup\\test-database.js:40:31)\n    at Object.initTestDatabase (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\setup\\jest.setup.js:44:9)\n    at Promise.then.completed (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusHook (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:281:40)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:95:7)\n    at run (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:444:34)"],"fullName":"支付提醒服务测试 sendPaymentReminder 应该成功发送邮件提醒","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该成功发送邮件提醒"},{"ancestorTitles":["支付提醒服务测试","sendPaymentReminder"],"duration":0,"failureDetails":[{}],"failureMessages":["TypeError: Cannot read properties of undefined (reading 'connect')\n    at connect (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\setup\\test-database.js:40:31)\n    at Object.initTestDatabase (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\setup\\jest.setup.js:44:9)\n    at Promise.then.completed (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusHook (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:281:40)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:95:7)\n    at run (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:444:34)"],"fullName":"支付提醒服务测试 sendPaymentReminder 应该成功发送短信提醒","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该成功发送短信提醒"},{"ancestorTitles":["支付提醒服务测试","sendPaymentReminder"],"duration":0,"failureDetails":[{}],"failureMessages":["TypeError: Cannot read properties of undefined (reading 'connect')\n    at connect (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\setup\\test-database.js:40:31)\n    at Object.initTestDatabase (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\setup\\jest.setup.js:44:9)\n    at Promise.then.completed (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusHook (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:281:40)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:95:7)\n    at run (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:444:34)"],"fullName":"支付提醒服务测试 sendPaymentReminder 应该在提醒记录不存在时抛出错误","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该在提醒记录不存在时抛出错误"},{"ancestorTitles":["支付提醒服务测试","sendPaymentReminder"],"duration":0,"failureDetails":[{}],"failureMessages":["TypeError: Cannot read properties of undefined (reading 'connect')\n    at connect (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\setup\\test-database.js:40:31)\n    at Object.initTestDatabase (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\setup\\jest.setup.js:44:9)\n    at Promise.then.completed (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusHook (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:281:40)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:95:7)\n    at run (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:444:34)"],"fullName":"支付提醒服务测试 sendPaymentReminder 应该在提醒已发送时返回相应消息","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该在提醒已发送时返回相应消息"},{"ancestorTitles":["支付提醒服务测试","sendPaymentReminder"],"duration":0,"failureDetails":[{}],"failureMessages":["TypeError: Cannot read properties of undefined (reading 'connect')\n    at connect (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\setup\\test-database.js:40:31)\n    at Object.initTestDatabase (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\setup\\jest.setup.js:44:9)\n    at Promise.then.completed (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusHook (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:281:40)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:95:7)\n    at run (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:444:34)"],"fullName":"支付提醒服务测试 sendPaymentReminder 应该在邮件发送失败时标记提醒状态为失败","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该在邮件发送失败时标记提醒状态为失败"},{"ancestorTitles":["支付提醒服务测试","getUserPaymentReminders"],"duration":0,"failureDetails":[{}],"failureMessages":["TypeError: Cannot read properties of undefined (reading 'connect')\n    at connect (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\setup\\test-database.js:40:31)\n    at Object.initTestDatabase (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\setup\\jest.setup.js:44:9)\n    at Promise.then.completed (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusHook (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:281:40)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:95:7)\n    at run (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:444:34)"],"fullName":"支付提醒服务测试 getUserPaymentReminders 应该成功获取用户支付提醒列表","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该成功获取用户支付提醒列表"},{"ancestorTitles":["支付提醒服务测试","getUserPaymentReminders"],"duration":0,"failureDetails":[{}],"failureMessages":["TypeError: Cannot read properties of undefined (reading 'connect')\n    at connect (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\setup\\test-database.js:40:31)\n    at Object.initTestDatabase (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\setup\\jest.setup.js:44:9)\n    at Promise.then.completed (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusHook (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:281:40)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:95:7)\n    at run (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:444:34)"],"fullName":"支付提醒服务测试 getUserPaymentReminders 应该在用户ID无效时抛出错误","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该在用户ID无效时抛出错误"},{"ancestorTitles":["支付提醒服务测试","getPendingReminders"],"duration":0,"failureDetails":[{}],"failureMessages":["TypeError: Cannot read properties of undefined (reading 'connect')\n    at connect (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\setup\\test-database.js:40:31)\n    at Object.initTestDatabase (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\setup\\jest.setup.js:44:9)\n    at Promise.then.completed (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusHook (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:281:40)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:95:7)\n    at run (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:444:34)"],"fullName":"支付提醒服务测试 getPendingReminders 应该成功获取待发送的提醒","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该成功获取待发送的提醒"},{"ancestorTitles":["支付提醒服务测试","sendPendingReminders"],"duration":0,"failureDetails":[{}],"failureMessages":["TypeError: Cannot read properties of undefined (reading 'connect')\n    at connect (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\setup\\test-database.js:40:31)\n    at Object.initTestDatabase (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\setup\\jest.setup.js:44:9)\n    at Promise.then.completed (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusHook (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:281:40)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:95:7)\n    at run (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:444:34)"],"fullName":"支付提醒服务测试 sendPendingReminders 应该成功批量发送待发送的提醒","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该成功批量发送待发送的提醒"},{"ancestorTitles":["支付提醒服务测试","sendPendingReminders"],"duration":0,"failureDetails":[{}],"failureMessages":["TypeError: Cannot read properties of undefined (reading 'connect')\n    at connect (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\setup\\test-database.js:40:31)\n    at Object.initTestDatabase (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\setup\\jest.setup.js:44:9)\n    at Promise.then.completed (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusHook (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:281:40)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:95:7)\n    at run (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:444:34)"],"fullName":"支付提醒服务测试 sendPendingReminders 应该处理部分发送失败的情况","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该处理部分发送失败的情况"},{"ancestorTitles":["支付提醒服务测试","createAutoReminders"],"duration":0,"failureDetails":[{}],"failureMessages":["TypeError: Cannot read properties of undefined (reading 'connect')\n    at connect (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\setup\\test-database.js:40:31)\n    at Object.initTestDatabase (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\setup\\jest.setup.js:44:9)\n    at Promise.then.completed (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusHook (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:281:40)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:95:7)\n    at run (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:444:34)"],"fullName":"支付提醒服务测试 createAutoReminders 应该为账单创建自动提醒","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该为账单创建自动提醒"},{"ancestorTitles":["支付提醒服务测试","createAutoReminders"],"duration":0,"failureDetails":[{}],"failureMessages":["TypeError: Cannot read properties of undefined (reading 'connect')\n    at connect (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\setup\\test-database.js:40:31)\n    at Object.initTestDatabase (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\setup\\jest.setup.js:44:9)\n    at Promise.then.completed (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusHook (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:281:40)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:95:7)\n    at run (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:444:34)"],"fullName":"支付提醒服务测试 createAutoReminders 应该在账单不存在时抛出错误","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该在账单不存在时抛出错误"},{"ancestorTitles":["支付提醒服务测试","createAutoReminders"],"duration":0,"failureDetails":[{}],"failureMessages":["TypeError: Cannot read properties of undefined (reading 'connect')\n    at connect (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\setup\\test-database.js:40:31)\n    at Object.initTestDatabase (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\setup\\jest.setup.js:44:9)\n    at Promise.then.completed (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusHook (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:281:40)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:95:7)\n    at run (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:444:34)"],"fullName":"支付提醒服务测试 createAutoReminders 应该在账单即将到期时创建即时提醒","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该在账单即将到期时创建即时提醒"}],"coverage":{},"endTime":1762159288876,"message":"\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m支付提醒服务测试 › createPaymentReminder › 应该成功创建支付提醒\u001b[39m\u001b[22m\n\n    TypeError: Cannot read properties of undefined (reading 'connect')\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 38 |\u001b[39m   \u001b[90m// 简要连通性检查\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 39 |\u001b[39m   \u001b[36mtry\u001b[39m {\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 40 |\u001b[39m     \u001b[36mconst\u001b[39m client \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m pool\u001b[33m.\u001b[39mconnect()\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m                               \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 41 |\u001b[39m     \u001b[36mawait\u001b[39m client\u001b[33m.\u001b[39mquery(\u001b[32m'SELECT 1'\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 42 |\u001b[39m     client\u001b[33m.\u001b[39mrelease()\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 43 |\u001b[39m   } \u001b[36mcatch\u001b[39m (e) {\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat connect (\u001b[22m\u001b[2mtests/setup/test-database.js\u001b[2m:40:31)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.initTestDatabase (\u001b[22m\u001b[2mtests/setup/jest.setup.js\u001b[2m:44:9)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m支付提醒服务测试 › createPaymentReminder › 应该在缺少必要参数时抛出错误\u001b[39m\u001b[22m\n\n    TypeError: Cannot read properties of undefined (reading 'connect')\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 38 |\u001b[39m   \u001b[90m// 简要连通性检查\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 39 |\u001b[39m   \u001b[36mtry\u001b[39m {\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 40 |\u001b[39m     \u001b[36mconst\u001b[39m client \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m pool\u001b[33m.\u001b[39mconnect()\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m                               \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 41 |\u001b[39m     \u001b[36mawait\u001b[39m client\u001b[33m.\u001b[39mquery(\u001b[32m'SELECT 1'\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 42 |\u001b[39m     client\u001b[33m.\u001b[39mrelease()\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 43 |\u001b[39m   } \u001b[36mcatch\u001b[39m (e) {\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat connect (\u001b[22m\u001b[2mtests/setup/test-database.js\u001b[2m:40:31)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.initTestDatabase (\u001b[22m\u001b[2mtests/setup/jest.setup.js\u001b[2m:44:9)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m支付提醒服务测试 › createPaymentReminder › 应该在数据库查询失败时抛出错误\u001b[39m\u001b[22m\n\n    TypeError: Cannot read properties of undefined (reading 'connect')\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 38 |\u001b[39m   \u001b[90m// 简要连通性检查\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 39 |\u001b[39m   \u001b[36mtry\u001b[39m {\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 40 |\u001b[39m     \u001b[36mconst\u001b[39m client \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m pool\u001b[33m.\u001b[39mconnect()\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m                               \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 41 |\u001b[39m     \u001b[36mawait\u001b[39m client\u001b[33m.\u001b[39mquery(\u001b[32m'SELECT 1'\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 42 |\u001b[39m     client\u001b[33m.\u001b[39mrelease()\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 43 |\u001b[39m   } \u001b[36mcatch\u001b[39m (e) {\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat connect (\u001b[22m\u001b[2mtests/setup/test-database.js\u001b[2m:40:31)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.initTestDatabase (\u001b[22m\u001b[2mtests/setup/jest.setup.js\u001b[2m:44:9)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m支付提醒服务测试 › sendPaymentReminder › 应该成功发送邮件提醒\u001b[39m\u001b[22m\n\n    TypeError: Cannot read properties of undefined (reading 'connect')\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 38 |\u001b[39m   \u001b[90m// 简要连通性检查\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 39 |\u001b[39m   \u001b[36mtry\u001b[39m {\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 40 |\u001b[39m     \u001b[36mconst\u001b[39m client \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m pool\u001b[33m.\u001b[39mconnect()\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m                               \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 41 |\u001b[39m     \u001b[36mawait\u001b[39m client\u001b[33m.\u001b[39mquery(\u001b[32m'SELECT 1'\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 42 |\u001b[39m     client\u001b[33m.\u001b[39mrelease()\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 43 |\u001b[39m   } \u001b[36mcatch\u001b[39m (e) {\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat connect (\u001b[22m\u001b[2mtests/setup/test-database.js\u001b[2m:40:31)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.initTestDatabase (\u001b[22m\u001b[2mtests/setup/jest.setup.js\u001b[2m:44:9)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m支付提醒服务测试 › sendPaymentReminder › 应该成功发送短信提醒\u001b[39m\u001b[22m\n\n    TypeError: Cannot read properties of undefined (reading 'connect')\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 38 |\u001b[39m   \u001b[90m// 简要连通性检查\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 39 |\u001b[39m   \u001b[36mtry\u001b[39m {\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 40 |\u001b[39m     \u001b[36mconst\u001b[39m client \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m pool\u001b[33m.\u001b[39mconnect()\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m                               \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 41 |\u001b[39m     \u001b[36mawait\u001b[39m client\u001b[33m.\u001b[39mquery(\u001b[32m'SELECT 1'\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 42 |\u001b[39m     client\u001b[33m.\u001b[39mrelease()\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 43 |\u001b[39m   } \u001b[36mcatch\u001b[39m (e) {\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat connect (\u001b[22m\u001b[2mtests/setup/test-database.js\u001b[2m:40:31)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.initTestDatabase (\u001b[22m\u001b[2mtests/setup/jest.setup.js\u001b[2m:44:9)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m支付提醒服务测试 › sendPaymentReminder › 应该在提醒记录不存在时抛出错误\u001b[39m\u001b[22m\n\n    TypeError: Cannot read properties of undefined (reading 'connect')\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 38 |\u001b[39m   \u001b[90m// 简要连通性检查\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 39 |\u001b[39m   \u001b[36mtry\u001b[39m {\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 40 |\u001b[39m     \u001b[36mconst\u001b[39m client \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m pool\u001b[33m.\u001b[39mconnect()\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m                               \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 41 |\u001b[39m     \u001b[36mawait\u001b[39m client\u001b[33m.\u001b[39mquery(\u001b[32m'SELECT 1'\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 42 |\u001b[39m     client\u001b[33m.\u001b[39mrelease()\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 43 |\u001b[39m   } \u001b[36mcatch\u001b[39m (e) {\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat connect (\u001b[22m\u001b[2mtests/setup/test-database.js\u001b[2m:40:31)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.initTestDatabase (\u001b[22m\u001b[2mtests/setup/jest.setup.js\u001b[2m:44:9)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m支付提醒服务测试 › sendPaymentReminder › 应该在提醒已发送时返回相应消息\u001b[39m\u001b[22m\n\n    TypeError: Cannot read properties of undefined (reading 'connect')\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 38 |\u001b[39m   \u001b[90m// 简要连通性检查\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 39 |\u001b[39m   \u001b[36mtry\u001b[39m {\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 40 |\u001b[39m     \u001b[36mconst\u001b[39m client \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m pool\u001b[33m.\u001b[39mconnect()\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m                               \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 41 |\u001b[39m     \u001b[36mawait\u001b[39m client\u001b[33m.\u001b[39mquery(\u001b[32m'SELECT 1'\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 42 |\u001b[39m     client\u001b[33m.\u001b[39mrelease()\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 43 |\u001b[39m   } \u001b[36mcatch\u001b[39m (e) {\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat connect (\u001b[22m\u001b[2mtests/setup/test-database.js\u001b[2m:40:31)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.initTestDatabase (\u001b[22m\u001b[2mtests/setup/jest.setup.js\u001b[2m:44:9)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m支付提醒服务测试 › sendPaymentReminder › 应该在邮件发送失败时标记提醒状态为失败\u001b[39m\u001b[22m\n\n    TypeError: Cannot read properties of undefined (reading 'connect')\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 38 |\u001b[39m   \u001b[90m// 简要连通性检查\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 39 |\u001b[39m   \u001b[36mtry\u001b[39m {\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 40 |\u001b[39m     \u001b[36mconst\u001b[39m client \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m pool\u001b[33m.\u001b[39mconnect()\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m                               \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 41 |\u001b[39m     \u001b[36mawait\u001b[39m client\u001b[33m.\u001b[39mquery(\u001b[32m'SELECT 1'\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 42 |\u001b[39m     client\u001b[33m.\u001b[39mrelease()\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 43 |\u001b[39m   } \u001b[36mcatch\u001b[39m (e) {\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat connect (\u001b[22m\u001b[2mtests/setup/test-database.js\u001b[2m:40:31)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.initTestDatabase (\u001b[22m\u001b[2mtests/setup/jest.setup.js\u001b[2m:44:9)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m支付提醒服务测试 › getUserPaymentReminders › 应该成功获取用户支付提醒列表\u001b[39m\u001b[22m\n\n    TypeError: Cannot read properties of undefined (reading 'connect')\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 38 |\u001b[39m   \u001b[90m// 简要连通性检查\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 39 |\u001b[39m   \u001b[36mtry\u001b[39m {\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 40 |\u001b[39m     \u001b[36mconst\u001b[39m client \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m pool\u001b[33m.\u001b[39mconnect()\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m                               \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 41 |\u001b[39m     \u001b[36mawait\u001b[39m client\u001b[33m.\u001b[39mquery(\u001b[32m'SELECT 1'\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 42 |\u001b[39m     client\u001b[33m.\u001b[39mrelease()\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 43 |\u001b[39m   } \u001b[36mcatch\u001b[39m (e) {\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat connect (\u001b[22m\u001b[2mtests/setup/test-database.js\u001b[2m:40:31)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.initTestDatabase (\u001b[22m\u001b[2mtests/setup/jest.setup.js\u001b[2m:44:9)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m支付提醒服务测试 › getUserPaymentReminders › 应该在用户ID无效时抛出错误\u001b[39m\u001b[22m\n\n    TypeError: Cannot read properties of undefined (reading 'connect')\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 38 |\u001b[39m   \u001b[90m// 简要连通性检查\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 39 |\u001b[39m   \u001b[36mtry\u001b[39m {\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 40 |\u001b[39m     \u001b[36mconst\u001b[39m client \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m pool\u001b[33m.\u001b[39mconnect()\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m                               \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 41 |\u001b[39m     \u001b[36mawait\u001b[39m client\u001b[33m.\u001b[39mquery(\u001b[32m'SELECT 1'\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 42 |\u001b[39m     client\u001b[33m.\u001b[39mrelease()\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 43 |\u001b[39m   } \u001b[36mcatch\u001b[39m (e) {\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat connect (\u001b[22m\u001b[2mtests/setup/test-database.js\u001b[2m:40:31)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.initTestDatabase (\u001b[22m\u001b[2mtests/setup/jest.setup.js\u001b[2m:44:9)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m支付提醒服务测试 › getPendingReminders › 应该成功获取待发送的提醒\u001b[39m\u001b[22m\n\n    TypeError: Cannot read properties of undefined (reading 'connect')\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 38 |\u001b[39m   \u001b[90m// 简要连通性检查\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 39 |\u001b[39m   \u001b[36mtry\u001b[39m {\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 40 |\u001b[39m     \u001b[36mconst\u001b[39m client \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m pool\u001b[33m.\u001b[39mconnect()\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m                               \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 41 |\u001b[39m     \u001b[36mawait\u001b[39m client\u001b[33m.\u001b[39mquery(\u001b[32m'SELECT 1'\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 42 |\u001b[39m     client\u001b[33m.\u001b[39mrelease()\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 43 |\u001b[39m   } \u001b[36mcatch\u001b[39m (e) {\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat connect (\u001b[22m\u001b[2mtests/setup/test-database.js\u001b[2m:40:31)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.initTestDatabase (\u001b[22m\u001b[2mtests/setup/jest.setup.js\u001b[2m:44:9)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m支付提醒服务测试 › sendPendingReminders › 应该成功批量发送待发送的提醒\u001b[39m\u001b[22m\n\n    TypeError: Cannot read properties of undefined (reading 'connect')\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 38 |\u001b[39m   \u001b[90m// 简要连通性检查\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 39 |\u001b[39m   \u001b[36mtry\u001b[39m {\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 40 |\u001b[39m     \u001b[36mconst\u001b[39m client \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m pool\u001b[33m.\u001b[39mconnect()\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m                               \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 41 |\u001b[39m     \u001b[36mawait\u001b[39m client\u001b[33m.\u001b[39mquery(\u001b[32m'SELECT 1'\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 42 |\u001b[39m     client\u001b[33m.\u001b[39mrelease()\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 43 |\u001b[39m   } \u001b[36mcatch\u001b[39m (e) {\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat connect (\u001b[22m\u001b[2mtests/setup/test-database.js\u001b[2m:40:31)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.initTestDatabase (\u001b[22m\u001b[2mtests/setup/jest.setup.js\u001b[2m:44:9)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m支付提醒服务测试 › sendPendingReminders › 应该处理部分发送失败的情况\u001b[39m\u001b[22m\n\n    TypeError: Cannot read properties of undefined (reading 'connect')\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 38 |\u001b[39m   \u001b[90m// 简要连通性检查\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 39 |\u001b[39m   \u001b[36mtry\u001b[39m {\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 40 |\u001b[39m     \u001b[36mconst\u001b[39m client \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m pool\u001b[33m.\u001b[39mconnect()\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m                               \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 41 |\u001b[39m     \u001b[36mawait\u001b[39m client\u001b[33m.\u001b[39mquery(\u001b[32m'SELECT 1'\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 42 |\u001b[39m     client\u001b[33m.\u001b[39mrelease()\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 43 |\u001b[39m   } \u001b[36mcatch\u001b[39m (e) {\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat connect (\u001b[22m\u001b[2mtests/setup/test-database.js\u001b[2m:40:31)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.initTestDatabase (\u001b[22m\u001b[2mtests/setup/jest.setup.js\u001b[2m:44:9)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m支付提醒服务测试 › createAutoReminders › 应该为账单创建自动提醒\u001b[39m\u001b[22m\n\n    TypeError: Cannot read properties of undefined (reading 'connect')\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 38 |\u001b[39m   \u001b[90m// 简要连通性检查\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 39 |\u001b[39m   \u001b[36mtry\u001b[39m {\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 40 |\u001b[39m     \u001b[36mconst\u001b[39m client \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m pool\u001b[33m.\u001b[39mconnect()\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m                               \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 41 |\u001b[39m     \u001b[36mawait\u001b[39m client\u001b[33m.\u001b[39mquery(\u001b[32m'SELECT 1'\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 42 |\u001b[39m     client\u001b[33m.\u001b[39mrelease()\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 43 |\u001b[39m   } \u001b[36mcatch\u001b[39m (e) {\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat connect (\u001b[22m\u001b[2mtests/setup/test-database.js\u001b[2m:40:31)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.initTestDatabase (\u001b[22m\u001b[2mtests/setup/jest.setup.js\u001b[2m:44:9)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m支付提醒服务测试 › createAutoReminders › 应该在账单不存在时抛出错误\u001b[39m\u001b[22m\n\n    TypeError: Cannot read properties of undefined (reading 'connect')\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 38 |\u001b[39m   \u001b[90m// 简要连通性检查\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 39 |\u001b[39m   \u001b[36mtry\u001b[39m {\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 40 |\u001b[39m     \u001b[36mconst\u001b[39m client \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m pool\u001b[33m.\u001b[39mconnect()\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m                               \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 41 |\u001b[39m     \u001b[36mawait\u001b[39m client\u001b[33m.\u001b[39mquery(\u001b[32m'SELECT 1'\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 42 |\u001b[39m     client\u001b[33m.\u001b[39mrelease()\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 43 |\u001b[39m   } \u001b[36mcatch\u001b[39m (e) {\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat connect (\u001b[22m\u001b[2mtests/setup/test-database.js\u001b[2m:40:31)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.initTestDatabase (\u001b[22m\u001b[2mtests/setup/jest.setup.js\u001b[2m:44:9)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1m支付提醒服务测试 › createAutoReminders › 应该在账单即将到期时创建即时提醒\u001b[39m\u001b[22m\n\n    TypeError: Cannot read properties of undefined (reading 'connect')\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 38 |\u001b[39m   \u001b[90m// 简要连通性检查\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 39 |\u001b[39m   \u001b[36mtry\u001b[39m {\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 40 |\u001b[39m     \u001b[36mconst\u001b[39m client \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m pool\u001b[33m.\u001b[39mconnect()\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m                               \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 41 |\u001b[39m     \u001b[36mawait\u001b[39m client\u001b[33m.\u001b[39mquery(\u001b[32m'SELECT 1'\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 42 |\u001b[39m     client\u001b[33m.\u001b[39mrelease()\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 43 |\u001b[39m   } \u001b[36mcatch\u001b[39m (e) {\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat connect (\u001b[22m\u001b[2mtests/setup/test-database.js\u001b[2m:40:31)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.initTestDatabase (\u001b[22m\u001b[2mtests/setup/jest.setup.js\u001b[2m:44:9)\u001b[22m\u001b[2m\u001b[22m\n\n\n  \u001b[1m● \u001b[22mTest suite failed to run\n\n    TypeError: Cannot read properties of undefined (reading 'end')\n\n    \u001b[0m \u001b[90m 81 |\u001b[39m \u001b[36masync\u001b[39m \u001b[36mfunction\u001b[39m closeTestDatabase() {\n     \u001b[90m 82 |\u001b[39m   \u001b[36mtry\u001b[39m {\n    \u001b[31m\u001b[1m>\u001b[22m\u001b[39m\u001b[90m 83 |\u001b[39m     \u001b[36mawait\u001b[39m pool\u001b[33m.\u001b[39mend()\u001b[33m;\u001b[39m\n     \u001b[90m    |\u001b[39m                \u001b[31m\u001b[1m^\u001b[22m\u001b[39m\n     \u001b[90m 84 |\u001b[39m     console\u001b[33m.\u001b[39mlog(\u001b[32m'测试数据库连接池已关闭'\u001b[39m)\u001b[33m;\u001b[39m\n     \u001b[90m 85 |\u001b[39m   } \u001b[36mcatch\u001b[39m (e) {\n     \u001b[90m 86 |\u001b[39m     console\u001b[33m.\u001b[39merror(\u001b[32m'关闭测试数据库连接池失败:'\u001b[39m\u001b[33m,\u001b[39m e\u001b[33m.\u001b[39mmessage)\u001b[33m;\u001b[39m\u001b[0m\n\n      \u001b[2mat end (\u001b[22mtests/setup/test-database.js\u001b[2m:83:16)\u001b[22m\n      \u001b[2mat Object.closeTestDatabase (\u001b[22mtests/setup/jest.setup.js\u001b[2m:58:9)\u001b[22m\n","name":"C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\payment-reminder-service.test.js","startTime":1762159288876,"status":"failed","summary":""},{"assertionResults":[{"ancestorTitles":["RoomController单元测试","createRoom"],"duration":0,"failureDetails":[{}],"failureMessages":["TypeError: Cannot read properties of undefined (reading 'mockResolvedValueOnce')\n    at Object.mockResolvedValueOnce (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\room-controller.test.js:86:10)\n    at Promise.then.completed (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at _runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:444:34)"],"fullName":"RoomController单元测试 createRoom 应该成功创建寝室","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该成功创建寝室"},{"ancestorTitles":["RoomController单元测试","createRoom"],"duration":1,"failureDetails":[{"matcherResult":{"message":"\u001b[2mexpect(\u001b[22m\u001b[31mjest.fn()\u001b[39m\u001b[2m).\u001b[22mnot\u001b[2m.\u001b[22mtoHaveBeenCalled\u001b[2m()\u001b[22m\n\nExpected number of calls: \u001b[32m0\u001b[39m\nReceived number of calls: \u001b[31m1\u001b[39m\n\n1: called with 0 arguments","pass":true}}],"failureMessages":["Error: \u001b[2mexpect(\u001b[22m\u001b[31mjest.fn()\u001b[39m\u001b[2m).\u001b[22mnot\u001b[2m.\u001b[22mtoHaveBeenCalled\u001b[2m()\u001b[22m\n\nExpected number of calls: \u001b[32m0\u001b[39m\nReceived number of calls: \u001b[31m1\u001b[39m\n\n1: called with 0 arguments\n    at Object.toHaveBeenCalled (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\room-controller.test.js:150:36)"],"fullName":"RoomController单元测试 createRoom 应该在缺少必填字段时返回400错误","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"failed","title":"应该在缺少必填字段时返回400错误"},{"ancestorTitles":["RoomController单元测试","createRoom"],"duration":0,"failureDetails":[{}],"failureMessages":["TypeError: Cannot read properties of undefined (reading 'mockResolvedValueOnce')\n    at Object.mockResolvedValueOnce (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\room-controller.test.js:162:10)\n    at Promise.then.completed (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at _runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:444:34)"],"fullName":"RoomController单元测试 createRoom 应该在数据库错误时回滚事务并返回500错误","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该在数据库错误时回滚事务并返回500错误"},{"ancestorTitles":["RoomController单元测试","getRooms"],"duration":0,"failureDetails":[],"failureMessages":[],"fullName":"RoomController单元测试 getRooms 应该成功获取寝室列表","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"应该成功获取寝室列表"},{"ancestorTitles":["RoomController单元测试","getRooms"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"RoomController单元测试 getRooms 应该支持按状态筛选寝室","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"应该支持按状态筛选寝室"},{"ancestorTitles":["RoomController单元测试","getRoomById"],"duration":1,"failureDetails":[{"matcherResult":{"message":"\u001b[2mexpect(\u001b[22m\u001b[31mjest.fn()\u001b[39m\u001b[2m).\u001b[22mtoHaveBeenCalledWith\u001b[2m(\u001b[22m\u001b[32m...expected\u001b[39m\u001b[2m)\u001b[22m\n\nExpected: \u001b[32m200\u001b[39m\nReceived: \u001b[31m500\u001b[39m\n\nNumber of calls: \u001b[31m1\u001b[39m","pass":false}}],"failureMessages":["Error: \u001b[2mexpect(\u001b[22m\u001b[31mjest.fn()\u001b[39m\u001b[2m).\u001b[22mtoHaveBeenCalledWith\u001b[2m(\u001b[22m\u001b[32m...expected\u001b[39m\u001b[2m)\u001b[22m\n\nExpected: \u001b[32m200\u001b[39m\nReceived: \u001b[31m500\u001b[39m\n\nNumber of calls: \u001b[31m1\u001b[39m\n    at Object.toHaveBeenCalledWith (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\room-controller.test.js:305:30)"],"fullName":"RoomController单元测试 getRoomById 应该成功获取寝室详情","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该成功获取寝室详情"},{"ancestorTitles":["RoomController单元测试","getRoomById"],"duration":0,"failureDetails":[],"failureMessages":[],"fullName":"RoomController单元测试 getRoomById 应该在寝室不存在时返回404错误","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"应该在寝室不存在时返回404错误"},{"ancestorTitles":["RoomController单元测试","updateRoom"],"duration":0,"failureDetails":[{"matcherResult":{"message":"\u001b[2mexpect(\u001b[22m\u001b[31mjest.fn()\u001b[39m\u001b[2m).\u001b[22mtoHaveBeenCalledWith\u001b[2m(\u001b[22m\u001b[32m...expected\u001b[39m\u001b[2m)\u001b[22m\n\nExpected: \u001b[32m200\u001b[39m\nReceived: \u001b[31m403\u001b[39m\n\nNumber of calls: \u001b[31m1\u001b[39m","pass":false}}],"failureMessages":["Error: \u001b[2mexpect(\u001b[22m\u001b[31mjest.fn()\u001b[39m\u001b[2m).\u001b[22mtoHaveBeenCalledWith\u001b[2m(\u001b[22m\u001b[32m...expected\u001b[39m\u001b[2m)\u001b[22m\n\nExpected: \u001b[32m200\u001b[39m\nReceived: \u001b[31m403\u001b[39m\n\nNumber of calls: \u001b[31m1\u001b[39m\n    at Object.toHaveBeenCalledWith (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\room-controller.test.js:358:30)"],"fullName":"RoomController单元测试 updateRoom 应该成功更新寝室信息","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该成功更新寝室信息"},{"ancestorTitles":["RoomController单元测试","updateRoom"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"RoomController单元测试 updateRoom 应该在寝室不存在时返回404错误","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"应该在寝室不存在时返回404错误"},{"ancestorTitles":["RoomController单元测试","updateRoom"],"duration":0,"failureDetails":[{"matcherResult":{"message":"\u001b[2mexpect(\u001b[22m\u001b[31mjest.fn()\u001b[39m\u001b[2m).\u001b[22mtoHaveBeenCalledWith\u001b[2m(\u001b[22m\u001b[32m...expected\u001b[39m\u001b[2m)\u001b[22m\n\nExpected: \u001b[32m403\u001b[39m\nReceived: \u001b[31m500\u001b[39m\n\nNumber of calls: \u001b[31m1\u001b[39m","pass":false}}],"failureMessages":["Error: \u001b[2mexpect(\u001b[22m\u001b[31mjest.fn()\u001b[39m\u001b[2m).\u001b[22mtoHaveBeenCalledWith\u001b[2m(\u001b[22m\u001b[32m...expected\u001b[39m\u001b[2m)\u001b[22m\n\nExpected: \u001b[32m403\u001b[39m\nReceived: \u001b[31m500\u001b[39m\n\nNumber of calls: \u001b[31m1\u001b[39m\n    at Object.toHaveBeenCalledWith (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\room-controller.test.js:405:30)"],"fullName":"RoomController单元测试 updateRoom 应该在用户不是寝室创建者时返回403错误","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该在用户不是寝室创建者时返回403错误"},{"ancestorTitles":["RoomController单元测试","joinRoom"],"duration":1,"failureDetails":[{"matcherResult":{"message":"\u001b[2mexpect(\u001b[22m\u001b[31mjest.fn()\u001b[39m\u001b[2m).\u001b[22mtoHaveBeenCalledWith\u001b[2m(\u001b[22m\u001b[32m...expected\u001b[39m\u001b[2m)\u001b[22m\n\nExpected: \u001b[32mObjectContaining {\"message\": \"成功加入寝室\", \"success\": true}\u001b[39m\nReceived: \u001b[31m{\"data\": {\"roomId\": 1, \"roomName\": \"测试寝室\"}, \"message\": \"加入寝室成功\", \"success\": true}\u001b[39m\n\nNumber of calls: \u001b[31m1\u001b[39m","pass":false}}],"failureMessages":["Error: \u001b[2mexpect(\u001b[22m\u001b[31mjest.fn()\u001b[39m\u001b[2m).\u001b[22mtoHaveBeenCalledWith\u001b[2m(\u001b[22m\u001b[32m...expected\u001b[39m\u001b[2m)\u001b[22m\n\nExpected: \u001b[32mObjectContaining {\"message\": \"成功加入寝室\", \"success\": true}\u001b[39m\nReceived: \u001b[31m{\"data\": {\"roomId\": 1, \"roomName\": \"测试寝室\"}, \"message\": \"加入寝室成功\", \"success\": true}\u001b[39m\n\nNumber of calls: \u001b[31m1\u001b[39m\n    at Object.toHaveBeenCalledWith (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\room-controller.test.js:433:28)"],"fullName":"RoomController单元测试 joinRoom 应该成功通过邀请码加入寝室","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"failed","title":"应该成功通过邀请码加入寝室"},{"ancestorTitles":["RoomController单元测试","joinRoom"],"duration":0,"failureDetails":[],"failureMessages":[],"fullName":"RoomController单元测试 joinRoom 应该在邀请码无效时返回404错误","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"应该在邀请码无效时返回404错误"},{"ancestorTitles":["RoomController单元测试","joinRoom"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"RoomController单元测试 joinRoom 应该在用户已加入寝室时返回409错误","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"应该在用户已加入寝室时返回409错误"},{"ancestorTitles":["RoomController单元测试","joinRoom"],"duration":0,"failureDetails":[{"matcherResult":{"message":"\u001b[2mexpect(\u001b[22m\u001b[31mjest.fn()\u001b[39m\u001b[2m).\u001b[22mtoHaveBeenCalledWith\u001b[2m(\u001b[22m\u001b[32m...expected\u001b[39m\u001b[2m)\u001b[22m\n\nExpected: \u001b[32mObjectContaining {\"message\": \"寝室成员已满\", \"success\": false}\u001b[39m\nReceived: \u001b[31m{\"message\": \"寝室已满员\", \"success\": false}\u001b[39m\n\nNumber of calls: \u001b[31m1\u001b[39m","pass":false}}],"failureMessages":["Error: \u001b[2mexpect(\u001b[22m\u001b[31mjest.fn()\u001b[39m\u001b[2m).\u001b[22mtoHaveBeenCalledWith\u001b[2m(\u001b[22m\u001b[32m...expected\u001b[39m\u001b[2m)\u001b[22m\n\nExpected: \u001b[32mObjectContaining {\"message\": \"寝室成员已满\", \"success\": false}\u001b[39m\nReceived: \u001b[31m{\"message\": \"寝室已满员\", \"success\": false}\u001b[39m\n\nNumber of calls: \u001b[31m1\u001b[39m\n    at Object.toHaveBeenCalledWith (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\room-controller.test.js:500:28)"],"fullName":"RoomController单元测试 joinRoom 应该在寝室成员已满时返回409错误","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"failed","title":"应该在寝室成员已满时返回409错误"},{"ancestorTitles":["RoomController单元测试","leaveRoom"],"duration":1,"failureDetails":[{"matcherResult":{"message":"\u001b[2mexpect(\u001b[22m\u001b[31mjest.fn()\u001b[39m\u001b[2m).\u001b[22mtoHaveBeenCalledWith\u001b[2m(\u001b[22m\u001b[32m...expected\u001b[39m\u001b[2m)\u001b[22m\n\nExpected: \u001b[32mObjectContaining {\"message\": \"成功退出寝室\", \"success\": true}\u001b[39m\nReceived: \u001b[31m{\"message\": \"离开寝室成功\", \"success\": true}\u001b[39m\n\nNumber of calls: \u001b[31m1\u001b[39m","pass":false}}],"failureMessages":["Error: \u001b[2mexpect(\u001b[22m\u001b[31mjest.fn()\u001b[39m\u001b[2m).\u001b[22mtoHaveBeenCalledWith\u001b[2m(\u001b[22m\u001b[32m...expected\u001b[39m\u001b[2m)\u001b[22m\n\nExpected: \u001b[32mObjectContaining {\"message\": \"成功退出寝室\", \"success\": true}\u001b[39m\nReceived: \u001b[31m{\"message\": \"离开寝室成功\", \"success\": true}\u001b[39m\n\nNumber of calls: \u001b[31m1\u001b[39m\n    at Object.toHaveBeenCalledWith (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\room-controller.test.js:526:28)"],"fullName":"RoomController单元测试 leaveRoom 应该成功退出寝室","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"failed","title":"应该成功退出寝室"},{"ancestorTitles":["RoomController单元测试","leaveRoom"],"duration":0,"failureDetails":[],"failureMessages":[],"fullName":"RoomController单元测试 leaveRoom 应该在寝室不存在时返回404错误","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"应该在寝室不存在时返回404错误"},{"ancestorTitles":["RoomController单元测试","leaveRoom"],"duration":0,"failureDetails":[{"matcherResult":{"message":"\u001b[2mexpect(\u001b[22m\u001b[31mjest.fn()\u001b[39m\u001b[2m).\u001b[22mtoHaveBeenCalledWith\u001b[2m(\u001b[22m\u001b[32m...expected\u001b[39m\u001b[2m)\u001b[22m\n\nExpected: \u001b[32m400\u001b[39m\nReceived: \u001b[31m409\u001b[39m\n\nNumber of calls: \u001b[31m1\u001b[39m","pass":false}}],"failureMessages":["Error: \u001b[2mexpect(\u001b[22m\u001b[31mjest.fn()\u001b[39m\u001b[2m).\u001b[22mtoHaveBeenCalledWith\u001b[2m(\u001b[22m\u001b[32m...expected\u001b[39m\u001b[2m)\u001b[22m\n\nExpected: \u001b[32m400\u001b[39m\nReceived: \u001b[31m409\u001b[39m\n\nNumber of calls: \u001b[31m1\u001b[39m\n    at Object.toHaveBeenCalledWith (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\room-controller.test.js:568:30)"],"fullName":"RoomController单元测试 leaveRoom 应该在用户不是寝室成员时返回400错误","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该在用户不是寝室成员时返回400错误"},{"ancestorTitles":["RoomController单元测试","leaveRoom"],"duration":1,"failureDetails":[{"matcherResult":{"message":"\u001b[2mexpect(\u001b[22m\u001b[31mjest.fn()\u001b[39m\u001b[2m).\u001b[22mtoHaveBeenCalledWith\u001b[2m(\u001b[22m\u001b[32m...expected\u001b[39m\u001b[2m)\u001b[22m\n\nExpected: \u001b[32m400\u001b[39m\nReceived: \u001b[31m200\u001b[39m\n\nNumber of calls: \u001b[31m1\u001b[39m","pass":false}}],"failureMessages":["Error: \u001b[2mexpect(\u001b[22m\u001b[31mjest.fn()\u001b[39m\u001b[2m).\u001b[22mtoHaveBeenCalledWith\u001b[2m(\u001b[22m\u001b[32m...expected\u001b[39m\u001b[2m)\u001b[22m\n\nExpected: \u001b[32m400\u001b[39m\nReceived: \u001b[31m200\u001b[39m\n\nNumber of calls: \u001b[31m1\u001b[39m\n    at Object.toHaveBeenCalledWith (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\room-controller.test.js:591:30)"],"fullName":"RoomController单元测试 leaveRoom 应该在用户是寝室创建者时返回400错误","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该在用户是寝室创建者时返回400错误"},{"ancestorTitles":["RoomController单元测试","getRoomMembers"],"duration":0,"failureDetails":[{}],"failureMessages":["TypeError: roomController.getRoomMembers is not a function\n    at Object.getRoomMembers (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\room-controller.test.js:633:28)\n    at Promise.then.completed (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at _runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:444:34)"],"fullName":"RoomController单元测试 getRoomMembers 应该成功获取寝室成员列表","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该成功获取寝室成员列表"},{"ancestorTitles":["RoomController单元测试","getRoomMembers"],"duration":0,"failureDetails":[{}],"failureMessages":["TypeError: roomController.getRoomMembers is not a function\n    at Object.getRoomMembers (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\room-controller.test.js:663:28)\n    at Promise.then.completed (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at _runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:444:34)"],"fullName":"RoomController单元测试 getRoomMembers 应该在用户不是寝室成员时返回403错误","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该在用户不是寝室成员时返回403错误"},{"ancestorTitles":["RoomController单元测试","removeMember"],"duration":0,"failureDetails":[{}],"failureMessages":["TypeError: roomController.removeMember is not a function\n    at Object.removeMember (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\room-controller.test.js:689:28)\n    at Promise.then.completed (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at _runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:444:34)"],"fullName":"RoomController单元测试 removeMember 应该成功移除寝室成员","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该成功移除寝室成员"},{"ancestorTitles":["RoomController单元测试","removeMember"],"duration":0,"failureDetails":[{}],"failureMessages":["TypeError: roomController.removeMember is not a function\n    at Object.removeMember (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\room-controller.test.js:710:28)\n    at Promise.then.completed (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at _runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:444:34)"],"fullName":"RoomController单元测试 removeMember 应该在用户不是寝室创建者时返回403错误","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该在用户不是寝室创建者时返回403错误"},{"ancestorTitles":["RoomController单元测试","removeMember"],"duration":1,"failureDetails":[{}],"failureMessages":["TypeError: roomController.removeMember is not a function\n    at Object.removeMember (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\room-controller.test.js:731:28)\n    at Promise.then.completed (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at _runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\node_modules\\jest-runner\\build\\runTest.js:444:34)"],"fullName":"RoomController单元测试 removeMember 应该在尝试移除创建者时返回400错误","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"应该在尝试移除创建者时返回400错误"}],"coverage":{},"endTime":1762159288876,"message":"\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1mRoomController单元测试 › createRoom › 应该成功创建寝室\u001b[39m\u001b[22m\n\n    TypeError: Cannot read properties of undefined (reading 'mockResolvedValueOnce')\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 84 |\u001b[39m       \u001b[90m// 模拟数据库查询结果\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 85 |\u001b[39m       mockClient\u001b[33m.\u001b[39mquery\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 86 |\u001b[39m         \u001b[33m.\u001b[39mmockResolvedValueOnce({}) \u001b[90m// BEGIN\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m          \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 87 |\u001b[39m         \u001b[33m.\u001b[39mmockResolvedValueOnce({ rows\u001b[33m:\u001b[39m [{ id\u001b[33m:\u001b[39m \u001b[35m1\u001b[39m\u001b[33m,\u001b[39m name\u001b[33m:\u001b[39m \u001b[32m'测试寝室'\u001b[39m }] }) \u001b[90m// 插入寝室\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 88 |\u001b[39m         \u001b[33m.\u001b[39mmockResolvedValueOnce({}) \u001b[90m// 插入用户寝室关系\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 89 |\u001b[39m         \u001b[33m.\u001b[39mmockResolvedValueOnce({}) \u001b[90m// 更新用户角色\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.mockResolvedValueOnce (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/room-controller.test.js\u001b[39m\u001b[0m\u001b[2m:86:10)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1mRoomController单元测试 › createRoom › 应该在缺少必填字段时返回400错误\u001b[39m\u001b[22m\n\n    \u001b[2mexpect(\u001b[22m\u001b[31mjest.fn()\u001b[39m\u001b[2m).\u001b[22mnot\u001b[2m.\u001b[22mtoHaveBeenCalled\u001b[2m()\u001b[22m\n\n    Expected number of calls: \u001b[32m0\u001b[39m\n    Received number of calls: \u001b[31m1\u001b[39m\n\n    1: called with 0 arguments\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 148 |\u001b[39m       \u001b[22m\n\u001b[2m     \u001b[90m 149 |\u001b[39m       \u001b[90m// 验证数据库连接未被调用\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 150 |\u001b[39m       expect(mockPool\u001b[33m.\u001b[39mconnect)\u001b[33m.\u001b[39mnot\u001b[33m.\u001b[39mtoHaveBeenCalled()\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                                    \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 151 |\u001b[39m     })\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 152 |\u001b[39m     \u001b[22m\n\u001b[2m     \u001b[90m 153 |\u001b[39m     it(\u001b[32m'应该在数据库错误时回滚事务并返回500错误'\u001b[39m\u001b[33m,\u001b[39m \u001b[36masync\u001b[39m () \u001b[33m=>\u001b[39m {\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.toHaveBeenCalled (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/room-controller.test.js\u001b[39m\u001b[0m\u001b[2m:150:36)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1mRoomController单元测试 › createRoom › 应该在数据库错误时回滚事务并返回500错误\u001b[39m\u001b[22m\n\n    TypeError: Cannot read properties of undefined (reading 'mockResolvedValueOnce')\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 160 |\u001b[39m       \u001b[90m// 模拟数据库错误\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 161 |\u001b[39m       mockClient\u001b[33m.\u001b[39mquery\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 162 |\u001b[39m         \u001b[33m.\u001b[39mmockResolvedValueOnce({}) \u001b[90m// BEGIN\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m          \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 163 |\u001b[39m         \u001b[33m.\u001b[39mmockRejectedValueOnce(\u001b[36mnew\u001b[39m \u001b[33mError\u001b[39m(\u001b[32m'数据库连接错误'\u001b[39m))\u001b[33m;\u001b[39m \u001b[90m// 插入寝室失败\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 164 |\u001b[39m       \u001b[22m\n\u001b[2m     \u001b[90m 165 |\u001b[39m       \u001b[90m// 模拟ROLLBACK\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.mockResolvedValueOnce (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/room-controller.test.js\u001b[39m\u001b[0m\u001b[2m:162:10)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1mRoomController单元测试 › getRoomById › 应该成功获取寝室详情\u001b[39m\u001b[22m\n\n    \u001b[2mexpect(\u001b[22m\u001b[31mjest.fn()\u001b[39m\u001b[2m).\u001b[22mtoHaveBeenCalledWith\u001b[2m(\u001b[22m\u001b[32m...expected\u001b[39m\u001b[2m)\u001b[22m\n\n    Expected: \u001b[32m200\u001b[39m\n    Received: \u001b[31m500\u001b[39m\n\n    Number of calls: \u001b[31m1\u001b[39m\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 303 |\u001b[39m       \u001b[22m\n\u001b[2m     \u001b[90m 304 |\u001b[39m       \u001b[90m// 验证响应\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 305 |\u001b[39m       expect(mockRes\u001b[33m.\u001b[39mstatus)\u001b[33m.\u001b[39mtoHaveBeenCalledWith(\u001b[35m200\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                              \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 306 |\u001b[39m       expect(mockRes\u001b[33m.\u001b[39mjson)\u001b[33m.\u001b[39mtoHaveBeenCalledWith(\u001b[22m\n\u001b[2m     \u001b[90m 307 |\u001b[39m         expect\u001b[33m.\u001b[39mobjectContaining({\u001b[22m\n\u001b[2m     \u001b[90m 308 |\u001b[39m           success\u001b[33m:\u001b[39m \u001b[36mtrue\u001b[39m\u001b[33m,\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.toHaveBeenCalledWith (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/room-controller.test.js\u001b[39m\u001b[0m\u001b[2m:305:30)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1mRoomController单元测试 › updateRoom › 应该成功更新寝室信息\u001b[39m\u001b[22m\n\n    \u001b[2mexpect(\u001b[22m\u001b[31mjest.fn()\u001b[39m\u001b[2m).\u001b[22mtoHaveBeenCalledWith\u001b[2m(\u001b[22m\u001b[32m...expected\u001b[39m\u001b[2m)\u001b[22m\n\n    Expected: \u001b[32m200\u001b[39m\n    Received: \u001b[31m403\u001b[39m\n\n    Number of calls: \u001b[31m1\u001b[39m\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 356 |\u001b[39m       \u001b[22m\n\u001b[2m     \u001b[90m 357 |\u001b[39m       \u001b[90m// 验证响应\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 358 |\u001b[39m       expect(mockRes\u001b[33m.\u001b[39mstatus)\u001b[33m.\u001b[39mtoHaveBeenCalledWith(\u001b[35m200\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                              \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 359 |\u001b[39m       expect(mockRes\u001b[33m.\u001b[39mjson)\u001b[33m.\u001b[39mtoHaveBeenCalledWith(\u001b[22m\n\u001b[2m     \u001b[90m 360 |\u001b[39m         expect\u001b[33m.\u001b[39mobjectContaining({\u001b[22m\n\u001b[2m     \u001b[90m 361 |\u001b[39m           success\u001b[33m:\u001b[39m \u001b[36mtrue\u001b[39m\u001b[33m,\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.toHaveBeenCalledWith (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/room-controller.test.js\u001b[39m\u001b[0m\u001b[2m:358:30)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1mRoomController单元测试 › updateRoom › 应该在用户不是寝室创建者时返回403错误\u001b[39m\u001b[22m\n\n    \u001b[2mexpect(\u001b[22m\u001b[31mjest.fn()\u001b[39m\u001b[2m).\u001b[22mtoHaveBeenCalledWith\u001b[2m(\u001b[22m\u001b[32m...expected\u001b[39m\u001b[2m)\u001b[22m\n\n    Expected: \u001b[32m403\u001b[39m\n    Received: \u001b[31m500\u001b[39m\n\n    Number of calls: \u001b[31m1\u001b[39m\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 403 |\u001b[39m       \u001b[22m\n\u001b[2m     \u001b[90m 404 |\u001b[39m       \u001b[90m// 验证响应\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 405 |\u001b[39m       expect(mockRes\u001b[33m.\u001b[39mstatus)\u001b[33m.\u001b[39mtoHaveBeenCalledWith(\u001b[35m403\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                              \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 406 |\u001b[39m       expect(mockRes\u001b[33m.\u001b[39mjson)\u001b[33m.\u001b[39mtoHaveBeenCalledWith(\u001b[22m\n\u001b[2m     \u001b[90m 407 |\u001b[39m         expect\u001b[33m.\u001b[39mobjectContaining({\u001b[22m\n\u001b[2m     \u001b[90m 408 |\u001b[39m           success\u001b[33m:\u001b[39m \u001b[36mfalse\u001b[39m\u001b[33m,\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.toHaveBeenCalledWith (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/room-controller.test.js\u001b[39m\u001b[0m\u001b[2m:405:30)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1mRoomController单元测试 › joinRoom › 应该成功通过邀请码加入寝室\u001b[39m\u001b[22m\n\n    \u001b[2mexpect(\u001b[22m\u001b[31mjest.fn()\u001b[39m\u001b[2m).\u001b[22mtoHaveBeenCalledWith\u001b[2m(\u001b[22m\u001b[32m...expected\u001b[39m\u001b[2m)\u001b[22m\n\n    Expected: \u001b[32mObjectContaining {\"message\": \"成功加入寝室\", \"success\": true}\u001b[39m\n    Received: \u001b[31m{\"data\": {\"roomId\": 1, \"roomName\": \"测试寝室\"}, \"message\": \"加入寝室成功\", \"success\": true}\u001b[39m\n\n    Number of calls: \u001b[31m1\u001b[39m\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 431 |\u001b[39m       \u001b[90m// 验证响应\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 432 |\u001b[39m       expect(mockRes\u001b[33m.\u001b[39mstatus)\u001b[33m.\u001b[39mtoHaveBeenCalledWith(\u001b[35m200\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 433 |\u001b[39m       expect(mockRes\u001b[33m.\u001b[39mjson)\u001b[33m.\u001b[39mtoHaveBeenCalledWith(\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                            \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 434 |\u001b[39m         expect\u001b[33m.\u001b[39mobjectContaining({\u001b[22m\n\u001b[2m     \u001b[90m 435 |\u001b[39m           success\u001b[33m:\u001b[39m \u001b[36mtrue\u001b[39m\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 436 |\u001b[39m           message\u001b[33m:\u001b[39m \u001b[32m'成功加入寝室'\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.toHaveBeenCalledWith (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/room-controller.test.js\u001b[39m\u001b[0m\u001b[2m:433:28)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1mRoomController单元测试 › joinRoom › 应该在寝室成员已满时返回409错误\u001b[39m\u001b[22m\n\n    \u001b[2mexpect(\u001b[22m\u001b[31mjest.fn()\u001b[39m\u001b[2m).\u001b[22mtoHaveBeenCalledWith\u001b[2m(\u001b[22m\u001b[32m...expected\u001b[39m\u001b[2m)\u001b[22m\n\n    Expected: \u001b[32mObjectContaining {\"message\": \"寝室成员已满\", \"success\": false}\u001b[39m\n    Received: \u001b[31m{\"message\": \"寝室已满员\", \"success\": false}\u001b[39m\n\n    Number of calls: \u001b[31m1\u001b[39m\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 498 |\u001b[39m       \u001b[90m// 验证响应\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 499 |\u001b[39m       expect(mockRes\u001b[33m.\u001b[39mstatus)\u001b[33m.\u001b[39mtoHaveBeenCalledWith(\u001b[35m409\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 500 |\u001b[39m       expect(mockRes\u001b[33m.\u001b[39mjson)\u001b[33m.\u001b[39mtoHaveBeenCalledWith(\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                            \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 501 |\u001b[39m         expect\u001b[33m.\u001b[39mobjectContaining({\u001b[22m\n\u001b[2m     \u001b[90m 502 |\u001b[39m           success\u001b[33m:\u001b[39m \u001b[36mfalse\u001b[39m\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 503 |\u001b[39m           message\u001b[33m:\u001b[39m \u001b[32m'寝室成员已满'\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.toHaveBeenCalledWith (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/room-controller.test.js\u001b[39m\u001b[0m\u001b[2m:500:28)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1mRoomController单元测试 › leaveRoom › 应该成功退出寝室\u001b[39m\u001b[22m\n\n    \u001b[2mexpect(\u001b[22m\u001b[31mjest.fn()\u001b[39m\u001b[2m).\u001b[22mtoHaveBeenCalledWith\u001b[2m(\u001b[22m\u001b[32m...expected\u001b[39m\u001b[2m)\u001b[22m\n\n    Expected: \u001b[32mObjectContaining {\"message\": \"成功退出寝室\", \"success\": true}\u001b[39m\n    Received: \u001b[31m{\"message\": \"离开寝室成功\", \"success\": true}\u001b[39m\n\n    Number of calls: \u001b[31m1\u001b[39m\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 524 |\u001b[39m       \u001b[90m// 验证响应\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 525 |\u001b[39m       expect(mockRes\u001b[33m.\u001b[39mstatus)\u001b[33m.\u001b[39mtoHaveBeenCalledWith(\u001b[35m200\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 526 |\u001b[39m       expect(mockRes\u001b[33m.\u001b[39mjson)\u001b[33m.\u001b[39mtoHaveBeenCalledWith(\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                            \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 527 |\u001b[39m         expect\u001b[33m.\u001b[39mobjectContaining({\u001b[22m\n\u001b[2m     \u001b[90m 528 |\u001b[39m           success\u001b[33m:\u001b[39m \u001b[36mtrue\u001b[39m\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 529 |\u001b[39m           message\u001b[33m:\u001b[39m \u001b[32m'成功退出寝室'\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.toHaveBeenCalledWith (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/room-controller.test.js\u001b[39m\u001b[0m\u001b[2m:526:28)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1mRoomController单元测试 › leaveRoom › 应该在用户不是寝室成员时返回400错误\u001b[39m\u001b[22m\n\n    \u001b[2mexpect(\u001b[22m\u001b[31mjest.fn()\u001b[39m\u001b[2m).\u001b[22mtoHaveBeenCalledWith\u001b[2m(\u001b[22m\u001b[32m...expected\u001b[39m\u001b[2m)\u001b[22m\n\n    Expected: \u001b[32m400\u001b[39m\n    Received: \u001b[31m409\u001b[39m\n\n    Number of calls: \u001b[31m1\u001b[39m\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 566 |\u001b[39m       \u001b[22m\n\u001b[2m     \u001b[90m 567 |\u001b[39m       \u001b[90m// 验证响应\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 568 |\u001b[39m       expect(mockRes\u001b[33m.\u001b[39mstatus)\u001b[33m.\u001b[39mtoHaveBeenCalledWith(\u001b[35m400\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                              \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 569 |\u001b[39m       expect(mockRes\u001b[33m.\u001b[39mjson)\u001b[33m.\u001b[39mtoHaveBeenCalledWith(\u001b[22m\n\u001b[2m     \u001b[90m 570 |\u001b[39m         expect\u001b[33m.\u001b[39mobjectContaining({\u001b[22m\n\u001b[2m     \u001b[90m 571 |\u001b[39m           success\u001b[33m:\u001b[39m \u001b[36mfalse\u001b[39m\u001b[33m,\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.toHaveBeenCalledWith (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/room-controller.test.js\u001b[39m\u001b[0m\u001b[2m:568:30)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1mRoomController单元测试 › leaveRoom › 应该在用户是寝室创建者时返回400错误\u001b[39m\u001b[22m\n\n    \u001b[2mexpect(\u001b[22m\u001b[31mjest.fn()\u001b[39m\u001b[2m).\u001b[22mtoHaveBeenCalledWith\u001b[2m(\u001b[22m\u001b[32m...expected\u001b[39m\u001b[2m)\u001b[22m\n\n    Expected: \u001b[32m400\u001b[39m\n    Received: \u001b[31m200\u001b[39m\n\n    Number of calls: \u001b[31m1\u001b[39m\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 589 |\u001b[39m       \u001b[22m\n\u001b[2m     \u001b[90m 590 |\u001b[39m       \u001b[90m// 验证响应\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 591 |\u001b[39m       expect(mockRes\u001b[33m.\u001b[39mstatus)\u001b[33m.\u001b[39mtoHaveBeenCalledWith(\u001b[35m400\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                              \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 592 |\u001b[39m       expect(mockRes\u001b[33m.\u001b[39mjson)\u001b[33m.\u001b[39mtoHaveBeenCalledWith(\u001b[22m\n\u001b[2m     \u001b[90m 593 |\u001b[39m         expect\u001b[33m.\u001b[39mobjectContaining({\u001b[22m\n\u001b[2m     \u001b[90m 594 |\u001b[39m           success\u001b[33m:\u001b[39m \u001b[36mfalse\u001b[39m\u001b[33m,\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.toHaveBeenCalledWith (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/room-controller.test.js\u001b[39m\u001b[0m\u001b[2m:591:30)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1mRoomController单元测试 › getRoomMembers › 应该成功获取寝室成员列表\u001b[39m\u001b[22m\n\n    TypeError: roomController.getRoomMembers is not a function\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 631 |\u001b[39m       \u001b[22m\n\u001b[2m     \u001b[90m 632 |\u001b[39m       \u001b[90m// 调用控制器方法\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 633 |\u001b[39m       \u001b[36mawait\u001b[39m roomController\u001b[33m.\u001b[39mgetRoomMembers(mockReq\u001b[33m,\u001b[39m mockRes)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                            \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 634 |\u001b[39m       \u001b[22m\n\u001b[2m     \u001b[90m 635 |\u001b[39m       \u001b[90m// 验证响应\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 636 |\u001b[39m       expect(mockRes\u001b[33m.\u001b[39mstatus)\u001b[33m.\u001b[39mtoHaveBeenCalledWith(\u001b[35m200\u001b[39m)\u001b[33m;\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.getRoomMembers (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/room-controller.test.js\u001b[39m\u001b[0m\u001b[2m:633:28)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1mRoomController单元测试 › getRoomMembers › 应该在用户不是寝室成员时返回403错误\u001b[39m\u001b[22m\n\n    TypeError: roomController.getRoomMembers is not a function\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 661 |\u001b[39m       \u001b[22m\n\u001b[2m     \u001b[90m 662 |\u001b[39m       \u001b[90m// 调用控制器方法\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 663 |\u001b[39m       \u001b[36mawait\u001b[39m roomController\u001b[33m.\u001b[39mgetRoomMembers(mockReq\u001b[33m,\u001b[39m mockRes)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                            \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 664 |\u001b[39m       \u001b[22m\n\u001b[2m     \u001b[90m 665 |\u001b[39m       \u001b[90m// 验证响应\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 666 |\u001b[39m       expect(mockRes\u001b[33m.\u001b[39mstatus)\u001b[33m.\u001b[39mtoHaveBeenCalledWith(\u001b[35m403\u001b[39m)\u001b[33m;\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.getRoomMembers (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/room-controller.test.js\u001b[39m\u001b[0m\u001b[2m:663:28)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1mRoomController单元测试 › removeMember › 应该成功移除寝室成员\u001b[39m\u001b[22m\n\n    TypeError: roomController.removeMember is not a function\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 687 |\u001b[39m       \u001b[22m\n\u001b[2m     \u001b[90m 688 |\u001b[39m       \u001b[90m// 调用控制器方法\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 689 |\u001b[39m       \u001b[36mawait\u001b[39m roomController\u001b[33m.\u001b[39mremoveMember(mockReq\u001b[33m,\u001b[39m mockRes)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                            \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 690 |\u001b[39m       \u001b[22m\n\u001b[2m     \u001b[90m 691 |\u001b[39m       \u001b[90m// 验证响应\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 692 |\u001b[39m       expect(mockRes\u001b[33m.\u001b[39mstatus)\u001b[33m.\u001b[39mtoHaveBeenCalledWith(\u001b[35m200\u001b[39m)\u001b[33m;\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.removeMember (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/room-controller.test.js\u001b[39m\u001b[0m\u001b[2m:689:28)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1mRoomController单元测试 › removeMember › 应该在用户不是寝室创建者时返回403错误\u001b[39m\u001b[22m\n\n    TypeError: roomController.removeMember is not a function\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 708 |\u001b[39m       \u001b[22m\n\u001b[2m     \u001b[90m 709 |\u001b[39m       \u001b[90m// 调用控制器方法\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 710 |\u001b[39m       \u001b[36mawait\u001b[39m roomController\u001b[33m.\u001b[39mremoveMember(mockReq\u001b[33m,\u001b[39m mockRes)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                            \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 711 |\u001b[39m       \u001b[22m\n\u001b[2m     \u001b[90m 712 |\u001b[39m       \u001b[90m// 验证响应\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 713 |\u001b[39m       expect(mockRes\u001b[33m.\u001b[39mstatus)\u001b[33m.\u001b[39mtoHaveBeenCalledWith(\u001b[35m403\u001b[39m)\u001b[33m;\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.removeMember (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/room-controller.test.js\u001b[39m\u001b[0m\u001b[2m:710:28)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1mRoomController单元测试 › removeMember › 应该在尝试移除创建者时返回400错误\u001b[39m\u001b[22m\n\n    TypeError: roomController.removeMember is not a function\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 729 |\u001b[39m       \u001b[22m\n\u001b[2m     \u001b[90m 730 |\u001b[39m       \u001b[90m// 调用控制器方法\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 731 |\u001b[39m       \u001b[36mawait\u001b[39m roomController\u001b[33m.\u001b[39mremoveMember(mockReq\u001b[33m,\u001b[39m mockRes)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                            \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 732 |\u001b[39m       \u001b[22m\n\u001b[2m     \u001b[90m 733 |\u001b[39m       \u001b[90m// 验证响应\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 734 |\u001b[39m       expect(mockRes\u001b[33m.\u001b[39mstatus)\u001b[33m.\u001b[39mtoHaveBeenCalledWith(\u001b[35m400\u001b[39m)\u001b[33m;\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.removeMember (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/unit/room-controller.test.js\u001b[39m\u001b[0m\u001b[2m:731:28)\u001b[22m\u001b[2m\u001b[22m\n\n\n  \u001b[1m● \u001b[22mTest suite failed to run\n\n    TypeError: pool.end is not a function\n\n    \u001b[0m \u001b[90m 81 |\u001b[39m \u001b[36masync\u001b[39m \u001b[36mfunction\u001b[39m closeTestDatabase() {\n     \u001b[90m 82 |\u001b[39m   \u001b[36mtry\u001b[39m {\n    \u001b[31m\u001b[1m>\u001b[22m\u001b[39m\u001b[90m 83 |\u001b[39m     \u001b[36mawait\u001b[39m pool\u001b[33m.\u001b[39mend()\u001b[33m;\u001b[39m\n     \u001b[90m    |\u001b[39m                \u001b[31m\u001b[1m^\u001b[22m\u001b[39m\n     \u001b[90m 84 |\u001b[39m     console\u001b[33m.\u001b[39mlog(\u001b[32m'测试数据库连接池已关闭'\u001b[39m)\u001b[33m;\u001b[39m\n     \u001b[90m 85 |\u001b[39m   } \u001b[36mcatch\u001b[39m (e) {\n     \u001b[90m 86 |\u001b[39m     console\u001b[33m.\u001b[39merror(\u001b[32m'关闭测试数据库连接池失败:'\u001b[39m\u001b[33m,\u001b[39m e\u001b[33m.\u001b[39mmessage)\u001b[33m;\u001b[39m\u001b[0m\n\n      \u001b[2mat end (\u001b[22mtests/setup/test-database.js\u001b[2m:83:16)\u001b[22m\n      \u001b[2mat Object.closeTestDatabase (\u001b[22mtests/setup/jest.setup.js\u001b[2m:58:9)\u001b[22m\n","name":"C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\room-controller.test.js","startTime":1762159288876,"status":"failed","summary":""},{"assertionResults":[{"ancestorTitles":["UserController API测试","POST /api/users/register"],"duration":200,"failureDetails":[],"failureMessages":[],"fullName":"UserController API测试 POST /api/users/register 应该成功注册新用户","invocations":1,"location":null,"numPassingAsserts":5,"retryReasons":[],"status":"passed","title":"应该成功注册新用户"},{"ancestorTitles":["UserController API测试","POST /api/users/register"],"duration":129,"failureDetails":[],"failureMessages":[],"fullName":"UserController API测试 POST /api/users/register 应该在缺少必填字段时返回400错误","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"应该在缺少必填字段时返回400错误"},{"ancestorTitles":["UserController API测试","POST /api/users/register"],"duration":140,"failureDetails":[],"failureMessages":[],"fullName":"UserController API测试 POST /api/users/register 应该在用户名已存在时返回409错误","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"应该在用户名已存在时返回409错误"},{"ancestorTitles":["UserController API测试","POST /api/auth/login"],"duration":209,"failureDetails":[],"failureMessages":[],"fullName":"UserController API测试 POST /api/auth/login 应该成功登录并返回token","invocations":1,"location":null,"numPassingAsserts":6,"retryReasons":[],"status":"passed","title":"应该成功登录并返回token"},{"ancestorTitles":["UserController API测试","POST /api/auth/login"],"duration":183,"failureDetails":[],"failureMessages":[],"fullName":"UserController API测试 POST /api/auth/login 应该在密码错误时返回401错误","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"应该在密码错误时返回401错误"},{"ancestorTitles":["UserController API测试","GET /api/users/profile"],"duration":127,"failureDetails":[],"failureMessages":[],"fullName":"UserController API测试 GET /api/users/profile 应该成功获取用户资料","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"应该成功获取用户资料"},{"ancestorTitles":["UserController API测试","GET /api/users/profile"],"duration":124,"failureDetails":[],"failureMessages":[],"fullName":"UserController API测试 GET /api/users/profile 应该在未授权时返回401错误","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"应该在未授权时返回401错误"},{"ancestorTitles":["UserController API测试","PUT /api/users/profile"],"duration":127,"failureDetails":[],"failureMessages":[],"fullName":"UserController API测试 PUT /api/users/profile 应该成功更新用户资料","invocations":1,"location":null,"numPassingAsserts":5,"retryReasons":[],"status":"passed","title":"应该成功更新用户资料"},{"ancestorTitles":["UserController API测试","PUT /api/users/profile"],"duration":123,"failureDetails":[],"failureMessages":[],"fullName":"UserController API测试 PUT /api/users/profile 没有token时应该无法更新用户资料","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"没有token时应该无法更新用户资料"},{"ancestorTitles":["UserController API测试","POST /api/auth/refresh"],"duration":127,"failureDetails":[],"failureMessages":[],"fullName":"UserController API测试 POST /api/auth/refresh 应该成功刷新token","invocations":1,"location":null,"numPassingAsserts":4,"retryReasons":[],"status":"passed","title":"应该成功刷新token"}],"endTime":1762159274994,"message":"","name":"C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\integration\\user-api.test.js","startTime":1762159273017,"status":"passed","summary":""},{"assertionResults":[{"ancestorTitles":["费用类型管理API集成测试","POST /api/expense-types"],"duration":6,"failureDetails":[],"failureMessages":[],"fullName":"费用类型管理API集成测试 POST /api/expense-types 应该成功创建费用类型","invocations":1,"location":null,"numPassingAsserts":9,"retryReasons":[],"status":"passed","title":"应该成功创建费用类型"},{"ancestorTitles":["费用类型管理API集成测试","POST /api/expense-types"],"duration":3,"failureDetails":[],"failureMessages":[],"fullName":"费用类型管理API集成测试 POST /api/expense-types 应该在未认证时返回401错误","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"应该在未认证时返回401错误"},{"ancestorTitles":["费用类型管理API集成测试","POST /api/expense-types"],"duration":3,"failureDetails":[],"failureMessages":[],"fullName":"费用类型管理API集成测试 POST /api/expense-types 应该在缺少必填字段时返回400错误","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"应该在缺少必填字段时返回400错误"},{"ancestorTitles":["费用类型管理API集成测试","POST /api/expense-types"],"duration":3,"failureDetails":[],"failureMessages":[],"fullName":"费用类型管理API集成测试 POST /api/expense-types 应该在费用类型名称已存在时返回409错误","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"应该在费用类型名称已存在时返回409错误"},{"ancestorTitles":["费用类型管理API集成测试","GET /api/expense-types"],"duration":72,"failureDetails":[],"failureMessages":[],"fullName":"费用类型管理API集成测试 GET /api/expense-types 应该成功获取费用类型列表","invocations":1,"location":null,"numPassingAsserts":11,"retryReasons":[],"status":"passed","title":"应该成功获取费用类型列表"},{"ancestorTitles":["费用类型管理API集成测试","GET /api/expense-types"],"duration":5,"failureDetails":[],"failureMessages":[],"fullName":"费用类型管理API集成测试 GET /api/expense-types 应该支持分页查询","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"应该支持分页查询"},{"ancestorTitles":["费用类型管理API集成测试","GET /api/expense-types"],"duration":3,"failureDetails":[],"failureMessages":[],"fullName":"费用类型管理API集成测试 GET /api/expense-types 应该支持按名称筛选","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"应该支持按名称筛选"},{"ancestorTitles":["费用类型管理API集成测试","GET /api/expense-types"],"duration":4,"failureDetails":[],"failureMessages":[],"fullName":"费用类型管理API集成测试 GET /api/expense-types 应该支持按创建者筛选","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"应该支持按创建者筛选"},{"ancestorTitles":["费用类型管理API集成测试","GET /api/expense-types/default"],"duration":4,"failureDetails":[],"failureMessages":[],"fullName":"费用类型管理API集成测试 GET /api/expense-types/default 应该成功获取默认费用类型列表","invocations":1,"location":null,"numPassingAsserts":14,"retryReasons":[],"status":"passed","title":"应该成功获取默认费用类型列表"},{"ancestorTitles":["费用类型管理API集成测试","GET /api/expense-types/:id"],"duration":4,"failureDetails":[],"failureMessages":[],"fullName":"费用类型管理API集成测试 GET /api/expense-types/:id 应该成功获取费用类型详情","invocations":1,"location":null,"numPassingAsserts":8,"retryReasons":[],"status":"passed","title":"应该成功获取费用类型详情"},{"ancestorTitles":["费用类型管理API集成测试","GET /api/expense-types/:id"],"duration":3,"failureDetails":[],"failureMessages":[],"fullName":"费用类型管理API集成测试 GET /api/expense-types/:id 应该在费用类型不存在时返回404错误","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"应该在费用类型不存在时返回404错误"},{"ancestorTitles":["费用类型管理API集成测试","PUT /api/expense-types/:id"],"duration":5,"failureDetails":[],"failureMessages":[],"fullName":"费用类型管理API集成测试 PUT /api/expense-types/:id 应该成功更新费用类型信息","invocations":1,"location":null,"numPassingAsserts":7,"retryReasons":[],"status":"passed","title":"应该成功更新费用类型信息"},{"ancestorTitles":["费用类型管理API集成测试","PUT /api/expense-types/:id"],"duration":3,"failureDetails":[],"failureMessages":[],"fullName":"费用类型管理API集成测试 PUT /api/expense-types/:id 应该在费用类型不存在时返回404错误","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"应该在费用类型不存在时返回404错误"},{"ancestorTitles":["费用类型管理API集成测试","PUT /api/expense-types/:id"],"duration":15,"failureDetails":[],"failureMessages":[],"fullName":"费用类型管理API集成测试 PUT /api/expense-types/:id 应该在费用类型名称已存在时返回409错误","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"应该在费用类型名称已存在时返回409错误"},{"ancestorTitles":["费用类型管理API集成测试","DELETE /api/expense-types/:id"],"duration":8,"failureDetails":[],"failureMessages":[],"fullName":"费用类型管理API集成测试 DELETE /api/expense-types/:id 应该成功删除费用类型","invocations":1,"location":null,"numPassingAsserts":5,"retryReasons":[],"status":"passed","title":"应该成功删除费用类型"},{"ancestorTitles":["费用类型管理API集成测试","DELETE /api/expense-types/:id"],"duration":3,"failureDetails":[],"failureMessages":[],"fullName":"费用类型管理API集成测试 DELETE /api/expense-types/:id 应该在费用类型不存在时返回404错误","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"应该在费用类型不存在时返回404错误"},{"ancestorTitles":["费用类型管理API集成测试","DELETE /api/expense-types/:id"],"duration":7,"failureDetails":[],"failureMessages":[],"fullName":"费用类型管理API集成测试 DELETE /api/expense-types/:id 应该在尝试删除系统默认费用类型时返回403错误","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"应该在尝试删除系统默认费用类型时返回403错误"},{"ancestorTitles":["费用类型管理API集成测试","权限测试"],"duration":4,"failureDetails":[],"failureMessages":[],"fullName":"费用类型管理API集成测试 权限测试 应该在非创建者尝试更新费用类型时返回403错误","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"应该在非创建者尝试更新费用类型时返回403错误"},{"ancestorTitles":["费用类型管理API集成测试","权限测试"],"duration":3,"failureDetails":[],"failureMessages":[],"fullName":"费用类型管理API集成测试 权限测试 应该在非创建者尝试删除费用类型时返回403错误","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"应该在非创建者尝试删除费用类型时返回403错误"}],"endTime":1762159276141,"message":"","name":"C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\integration\\expense-types.test.js","startTime":1762159275005,"status":"passed","summary":""},{"assertionResults":[{"ancestorTitles":["最小测试","变量初始化测试"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"最小测试 变量初始化测试 应该正确初始化testUser变量","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"应该正确初始化testUser变量"}],"endTime":1762159276849,"message":"","name":"C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\integration\\minimal.test.js","startTime":1762159276153,"status":"passed","summary":""},{"assertionResults":[{"ancestorTitles":["Rooms API - integration"],"duration":164,"failureDetails":[],"failureMessages":[],"fullName":"Rooms API - integration create room, list rooms, get detail, second user joins","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"create room, list rooms, get detail, second user joins"}],"endTime":1762159277519,"message":"","name":"C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\integration\\rooms.test.js","startTime":1762159276857,"status":"passed","summary":""},{"assertionResults":[{"ancestorTitles":["Bills API - basic flows"],"duration":177,"failureDetails":[],"failureMessages":[],"fullName":"Bills API - basic flows create bill (optional), list bills, get one, review/payment guarded","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"create bill (optional), list bills, get one, review/payment guarded"}],"endTime":1762159278209,"message":"","name":"C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\integration\\bills-basic.test.js","startTime":1762159277529,"status":"passed","summary":""},{"assertionResults":[{"ancestorTitles":["定时任务服务测试","startAllTasks"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"定时任务服务测试 startAllTasks 应该成功启动所有定时任务","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"应该成功启动所有定时任务"},{"ancestorTitles":["定时任务服务测试","startAllTasks"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"定时任务服务测试 startAllTasks 应该在任务已启动时返回相应消息","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"应该在任务已启动时返回相应消息"},{"ancestorTitles":["定时任务服务测试","stopAllTasks"],"duration":0,"failureDetails":[],"failureMessages":[],"fullName":"定时任务服务测试 stopAllTasks 应该成功停止所有定时任务","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"应该成功停止所有定时任务"},{"ancestorTitles":["定时任务服务测试","stopAllTasks"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"定时任务服务测试 stopAllTasks 应该在任务未启动时返回相应消息","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"应该在任务未启动时返回相应消息"},{"ancestorTitles":["定时任务服务测试","checkPaymentReminders"],"duration":0,"failureDetails":[],"failureMessages":[],"fullName":"定时任务服务测试 checkPaymentReminders 应该成功检查并发送支付提醒","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"应该成功检查并发送支付提醒"},{"ancestorTitles":["定时任务服务测试","checkPaymentReminders"],"duration":0,"failureDetails":[],"failureMessages":[],"fullName":"定时任务服务测试 checkPaymentReminders 应该处理没有待发送提醒的情况","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"应该处理没有待发送提醒的情况"},{"ancestorTitles":["定时任务服务测试","checkPaymentReminders"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"定时任务服务测试 checkPaymentReminders 应该处理发送提醒失败的情况","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"应该处理发送提醒失败的情况"},{"ancestorTitles":["定时任务服务测试","checkPaymentReminders"],"duration":0,"failureDetails":[],"failureMessages":[],"fullName":"定时任务服务测试 checkPaymentReminders 应该处理获取提醒失败的情况","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"应该处理获取提醒失败的情况"},{"ancestorTitles":["定时任务服务测试","syncOfflinePayments"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"定时任务服务测试 syncOfflinePayments 应该成功同步离线支付","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"应该成功同步离线支付"},{"ancestorTitles":["定时任务服务测试","syncOfflinePayments"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"定时任务服务测试 syncOfflinePayments 应该处理没有待同步支付的情况","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"应该处理没有待同步支付的情况"},{"ancestorTitles":["定时任务服务测试","syncOfflinePayments"],"duration":0,"failureDetails":[],"failureMessages":[],"fullName":"定时任务服务测试 syncOfflinePayments 应该处理部分同步失败的情况","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"应该处理部分同步失败的情况"},{"ancestorTitles":["定时任务服务测试","syncOfflinePayments"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"定时任务服务测试 syncOfflinePayments 应该处理获取待同步支付失败的情况","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"应该处理获取待同步支付失败的情况"},{"ancestorTitles":["定时任务服务测试","cleanupExpiredReminders"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"定时任务服务测试 cleanupExpiredReminders 应该成功清理过期提醒","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"应该成功清理过期提醒"},{"ancestorTitles":["定时任务服务测试","cleanupExpiredReminders"],"duration":0,"failureDetails":[],"failureMessages":[],"fullName":"定时任务服务测试 cleanupExpiredReminders 应该处理没有过期提醒的情况","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"应该处理没有过期提醒的情况"},{"ancestorTitles":["定时任务服务测试","cleanupExpiredReminders"],"duration":0,"failureDetails":[],"failureMessages":[],"fullName":"定时任务服务测试 cleanupExpiredReminders 应该处理清理过期提醒失败的情况","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"应该处理清理过期提醒失败的情况"},{"ancestorTitles":["定时任务服务测试","generatePaymentStats"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"定时任务服务测试 generatePaymentStats 应该成功生成支付统计报告","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"应该成功生成支付统计报告"},{"ancestorTitles":["定时任务服务测试","generatePaymentStats"],"duration":0,"failureDetails":[],"failureMessages":[],"fullName":"定时任务服务测试 generatePaymentStats 应该处理没有支付记录的情况","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"应该处理没有支付记录的情况"},{"ancestorTitles":["定时任务服务测试","generatePaymentStats"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"定时任务服务测试 generatePaymentStats 应该处理生成支付统计失败的情况","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"应该处理生成支付统计失败的情况"},{"ancestorTitles":["定时任务服务测试","getTaskStatus"],"duration":0,"failureDetails":[],"failureMessages":[],"fullName":"定时任务服务测试 getTaskStatus 应该返回所有任务状态","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"应该返回所有任务状态"},{"ancestorTitles":["定时任务服务测试","getTaskStatus"],"duration":0,"failureDetails":[],"failureMessages":[],"fullName":"定时任务服务测试 getTaskStatus 应该在任务未启动时返回相应状态","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"应该在任务未启动时返回相应状态"},{"ancestorTitles":["定时任务服务测试","triggerTask"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"定时任务服务测试 triggerTask 应该成功触发指定任务","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"应该成功触发指定任务"},{"ancestorTitles":["定时任务服务测试","triggerTask"],"duration":0,"failureDetails":[],"failureMessages":[],"fullName":"定时任务服务测试 triggerTask 应该在任务不存在时返回错误","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"应该在任务不存在时返回错误"},{"ancestorTitles":["定时任务服务测试","triggerTask"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"定时任务服务测试 triggerTask 应该处理任务执行失败的情况","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"应该处理任务执行失败的情况"}],"endTime":1762159278960,"message":"","name":"C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\scheduler.test.js","startTime":1762159278216,"status":"passed","summary":""},{"assertionResults":[{"ancestorTitles":["Payments Bill Flow"],"duration":0,"failureDetails":[],"failureMessages":[],"fullName":"Payments Bill Flow should get bill qr-code info and confirm payment","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"passed","title":"should get bill qr-code info and confirm payment"}],"endTime":1762159279604,"message":"","name":"C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\integration\\payments-bill-flow.test.js","startTime":1762159278973,"status":"passed","summary":""},{"assertionResults":[{"ancestorTitles":["支付流程优化控制器测试","createOfflinePayment"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"支付流程优化控制器测试 createOfflinePayment 应该成功创建离线支付","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"应该成功创建离线支付"},{"ancestorTitles":["支付流程优化控制器测试","createOfflinePayment"],"duration":0,"failureDetails":[],"failureMessages":[],"fullName":"支付流程优化控制器测试 createOfflinePayment 应该在缺少必要参数时返回错误","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"应该在缺少必要参数时返回错误"},{"ancestorTitles":["支付流程优化控制器测试","createOfflinePayment"],"duration":19,"failureDetails":[],"failureMessages":[],"fullName":"支付流程优化控制器测试 createOfflinePayment 应该在服务失败时返回错误","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"应该在服务失败时返回错误"},{"ancestorTitles":["支付流程优化控制器测试","syncOfflinePayment"],"duration":0,"failureDetails":[],"failureMessages":[],"fullName":"支付流程优化控制器测试 syncOfflinePayment 应该成功同步离线支付","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"应该成功同步离线支付"},{"ancestorTitles":["支付流程优化控制器测试","syncOfflinePayment"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"支付流程优化控制器测试 syncOfflinePayment 应该在ID无效时返回错误","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"应该在ID无效时返回错误"},{"ancestorTitles":["支付流程优化控制器测试","syncOfflinePayment"],"duration":0,"failureDetails":[],"failureMessages":[],"fullName":"支付流程优化控制器测试 syncOfflinePayment 应该在支付记录不存在时返回错误","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"应该在支付记录不存在时返回错误"},{"ancestorTitles":["支付流程优化控制器测试","getUserOfflinePayments"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"支付流程优化控制器测试 getUserOfflinePayments 应该成功获取用户离线支付记录","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"应该成功获取用户离线支付记录"},{"ancestorTitles":["支付流程优化控制器测试","getUserOfflinePayments"],"duration":0,"failureDetails":[],"failureMessages":[],"fullName":"支付流程优化控制器测试 getUserOfflinePayments 应该在用户ID无效时返回错误","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"应该在用户ID无效时返回错误"},{"ancestorTitles":["支付流程优化控制器测试","getPendingSyncPayments"],"duration":0,"failureDetails":[],"failureMessages":[],"fullName":"支付流程优化控制器测试 getPendingSyncPayments 应该成功获取待同步的离线支付记录","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"应该成功获取待同步的离线支付记录"},{"ancestorTitles":["支付流程优化控制器测试","createPaymentReminder"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"支付流程优化控制器测试 createPaymentReminder 应该成功创建支付提醒","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"应该成功创建支付提醒"},{"ancestorTitles":["支付流程优化控制器测试","createPaymentReminder"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"支付流程优化控制器测试 createPaymentReminder 应该在缺少必要参数时返回错误","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"应该在缺少必要参数时返回错误"},{"ancestorTitles":["支付流程优化控制器测试","getUserPaymentReminders"],"duration":0,"failureDetails":[],"failureMessages":[],"fullName":"支付流程优化控制器测试 getUserPaymentReminders 应该成功获取用户支付提醒列表","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"应该成功获取用户支付提醒列表"},{"ancestorTitles":["支付流程优化控制器测试","getPaymentRecords"],"duration":0,"failureDetails":[],"failureMessages":[],"fullName":"支付流程优化控制器测试 getPaymentRecords 应该成功获取支付记录列表","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"应该成功获取支付记录列表"},{"ancestorTitles":["支付流程优化控制器测试","getPaymentRecordById"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"支付流程优化控制器测试 getPaymentRecordById 应该成功获取支付记录详情","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"应该成功获取支付记录详情"},{"ancestorTitles":["支付流程优化控制器测试","getPaymentRecordById"],"duration":0,"failureDetails":[],"failureMessages":[],"fullName":"支付流程优化控制器测试 getPaymentRecordById 应该在支付记录不存在时返回404","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"应该在支付记录不存在时返回404"},{"ancestorTitles":["支付流程优化控制器测试","getUserPaymentStats"],"duration":0,"failureDetails":[],"failureMessages":[],"fullName":"支付流程优化控制器测试 getUserPaymentStats 应该成功获取用户支付统计","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"应该成功获取用户支付统计"},{"ancestorTitles":["支付流程优化控制器测试","getRoomPaymentStats"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"支付流程优化控制器测试 getRoomPaymentStats 应该成功获取房间支付统计","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"应该成功获取房间支付统计"},{"ancestorTitles":["支付流程优化控制器测试","triggerTask"],"duration":0,"failureDetails":[],"failureMessages":[],"fullName":"支付流程优化控制器测试 triggerTask 应该成功触发定时任务","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"应该成功触发定时任务"},{"ancestorTitles":["支付流程优化控制器测试","triggerTask"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"支付流程优化控制器测试 triggerTask 应该在任务不存在时返回错误","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"应该在任务不存在时返回错误"},{"ancestorTitles":["支付流程优化控制器测试","getTaskStatus"],"duration":0,"failureDetails":[],"failureMessages":[],"fullName":"支付流程优化控制器测试 getTaskStatus 应该成功获取任务状态","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"应该成功获取任务状态"}],"endTime":1762159280292,"message":"","name":"C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\payment-optimization-controller.test.js","startTime":1762159279612,"status":"passed","summary":""},{"assertionResults":[{"ancestorTitles":["Expenses API - basic flows"],"duration":197,"failureDetails":[],"failureMessages":[],"fullName":"Expenses API - basic flows list expenses empty, calculate split works, create expense guarded","invocations":1,"location":null,"numPassingAsserts":4,"retryReasons":[],"status":"passed","title":"list expenses empty, calculate split works, create expense guarded"}],"endTime":1762159280973,"message":"","name":"C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\integration\\expenses-basic.test.js","startTime":1762159280305,"status":"passed","summary":""},{"assertionResults":[{"ancestorTitles":["QR Codes API"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"QR Codes API should upload and list qr codes","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"passed","title":"should upload and list qr codes"}],"endTime":1762159281747,"message":"","name":"C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\integration\\qr-codes.test.js","startTime":1762159280983,"status":"passed","summary":""},{"assertionResults":[{"ancestorTitles":["BillController单元测试","createBill"],"duration":null,"failureDetails":[],"failureMessages":[],"fullName":"BillController单元测试 createBill 应该成功创建账单","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"pending","title":"应该成功创建账单"},{"ancestorTitles":["BillController单元测试","createBill"],"duration":null,"failureDetails":[],"failureMessages":[],"fullName":"BillController单元测试 createBill 应该在缺少必填字段时返回500错误","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"pending","title":"应该在缺少必填字段时返回500错误"},{"ancestorTitles":["BillController单元测试","createBill"],"duration":null,"failureDetails":[],"failureMessages":[],"fullName":"BillController单元测试 createBill 应该在用户不是寝室成员时返回403错误","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"pending","title":"应该在用户不是寝室成员时返回403错误"},{"ancestorTitles":["BillController单元测试","getBills"],"duration":null,"failureDetails":[],"failureMessages":[],"fullName":"BillController单元测试 getBills 应该成功获取账单列表","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"pending","title":"应该成功获取账单列表"},{"ancestorTitles":["BillController单元测试","getBillById"],"duration":null,"failureDetails":[],"failureMessages":[],"fullName":"BillController单元测试 getBillById 应该成功获取特定账单详情","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"pending","title":"应该成功获取特定账单详情"},{"ancestorTitles":["BillController单元测试","getBillById"],"duration":null,"failureDetails":[],"failureMessages":[],"fullName":"BillController单元测试 getBillById 应该在账单不存在时返回403错误","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"pending","title":"应该在账单不存在时返回403错误"},{"ancestorTitles":["BillController单元测试","reviewBill"],"duration":null,"failureDetails":[],"failureMessages":[],"fullName":"BillController单元测试 reviewBill 应该成功审核账单","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"pending","title":"应该成功审核账单"},{"ancestorTitles":["BillController单元测试","reviewBill"],"duration":null,"failureDetails":[],"failureMessages":[],"fullName":"BillController单元测试 reviewBill 应该在账单不存在时返回403错误","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"pending","title":"应该在账单不存在时返回403错误"},{"ancestorTitles":["BillController单元测试","confirmBillPayment"],"duration":null,"failureDetails":[],"failureMessages":[],"fullName":"BillController单元测试 confirmBillPayment 应该成功确认账单支付","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"pending","title":"应该成功确认账单支付"},{"ancestorTitles":["BillController单元测试","confirmBillPayment"],"duration":null,"failureDetails":[],"failureMessages":[],"fullName":"BillController单元测试 confirmBillPayment 应该在分摊ID不存在时返回403错误","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"pending","title":"应该在分摊ID不存在时返回403错误"}],"coverage":{},"endTime":1762159288876,"message":"","name":"C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\unit\\bill-controller.test.js","startTime":1762159288876,"status":"skipped","summary":""},{"assertionResults":[{"ancestorTitles":["BillController 真实数据库集成测试"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"BillController 真实数据库集成测试 should connect to real DB and run a simple query","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should connect to real DB and run a simple query"},{"ancestorTitles":["BillController 真实数据库集成测试"],"duration":3,"failureDetails":[],"failureMessages":[],"fullName":"BillController 真实数据库集成测试 should not throw when calling getBills with empty data","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should not throw when calling getBills with empty data"}],"endTime":1762159282172,"message":"","name":"C:\\Users\\MH\\Desktop\\记账系统\\Server-side\\tests\\integration\\bill-controller-real-db.test.js","startTime":1762159281855,"status":"passed","summary":""}],"wasInterrupted":false}
