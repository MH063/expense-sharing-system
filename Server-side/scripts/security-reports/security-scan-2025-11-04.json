{
  "timestamp": "2025-11-04T05:05:03.095Z",
  "scanDuration": 1074,
  "totalTests": 56,
  "passedTests": 43,
  "failedTests": 13,
  "vulnerabilities": [
    {
      "testName": "CSRF保护测试",
      "details": {},
      "message": "未检测到CSRF保护机制",
      "severity": "medium",
      "timestamp": "2025-11-04T05:05:03.337Z"
    },
    {
      "testName": "认证绕过测试",
      "details": {
        "endpoint": "/api/transactions"
      },
      "message": "测试过程中发生错误: Request failed with status code 404",
      "severity": "high",
      "timestamp": "2025-11-04T05:05:03.340Z"
    },
    {
      "testName": "认证绕过测试",
      "details": {
        "endpoint": "/api/categories"
      },
      "message": "测试过程中发生错误: Request failed with status code 404",
      "severity": "high",
      "timestamp": "2025-11-04T05:05:03.342Z"
    },
    {
      "testName": "认证绕过测试",
      "details": {
        "endpoint": "/api/accounts"
      },
      "message": "测试过程中发生错误: Request failed with status code 404",
      "severity": "high",
      "timestamp": "2025-11-04T05:05:03.344Z"
    },
    {
      "testName": "限流测试",
      "details": {},
      "message": "未检测到限流机制",
      "severity": "low",
      "timestamp": "2025-11-04T05:05:04.140Z"
    },
    {
      "testName": "输入验证测试",
      "details": {
        "input": {
          "username": "a",
          "password": "test",
          "expectedStatus": 400
        }
      },
      "message": "输入验证可能存在问题: Request failed with status code 401",
      "severity": "low",
      "timestamp": "2025-11-04T05:05:04.148Z"
    },
    {
      "testName": "输入验证测试",
      "details": {
        "input": {
          "username": "test",
          "password": "123",
          "expectedStatus": 400
        }
      },
      "message": "输入验证可能存在问题: Request failed with status code 401",
      "severity": "low",
      "timestamp": "2025-11-04T05:05:04.151Z"
    },
    {
      "testName": "输入验证测试",
      "details": {
        "input": {
          "username": "test@test.com",
          "password": "test",
          "expectedStatus": 400
        }
      },
      "message": "输入验证可能存在问题: Request failed with status code 401",
      "severity": "low",
      "timestamp": "2025-11-04T05:05:04.155Z"
    },
    {
      "testName": "安全头测试",
      "details": {
        "endpoint": "/api/users/login"
      },
      "message": "测试过程中发生错误: Request failed with status code 401",
      "severity": "low",
      "timestamp": "2025-11-04T05:05:04.160Z"
    },
    {
      "testName": "安全头测试",
      "details": {
        "endpoint": "/api/users/register"
      },
      "message": "测试过程中发生错误: Request failed with status code 401",
      "severity": "low",
      "timestamp": "2025-11-04T05:05:04.162Z"
    },
    {
      "testName": "安全头测试",
      "details": {
        "endpoint": "/api/transactions"
      },
      "message": "测试过程中发生错误: Request failed with status code 404",
      "severity": "low",
      "timestamp": "2025-11-04T05:05:04.165Z"
    },
    {
      "testName": "安全头测试",
      "details": {
        "endpoint": "/api/categories"
      },
      "message": "测试过程中发生错误: Request failed with status code 404",
      "severity": "low",
      "timestamp": "2025-11-04T05:05:04.167Z"
    },
    {
      "testName": "安全头测试",
      "details": {
        "endpoint": "/api/accounts"
      },
      "message": "测试过程中发生错误: Request failed with status code 404",
      "severity": "low",
      "timestamp": "2025-11-04T05:05:04.169Z"
    }
  ],
  "testResults": [
    {
      "testName": "SQL注入测试",
      "details": {
        "endpoint": "/api/users/login",
        "payload": "' OR '1'='1"
      },
      "passed": true,
      "status": 401,
      "message": "正确处理了恶意输入",
      "timestamp": "2025-11-04T05:05:03.231Z"
    },
    {
      "testName": "SQL注入测试",
      "details": {
        "endpoint": "/api/users/login",
        "payload": "'; DROP TABLE users; --"
      },
      "passed": true,
      "status": 401,
      "message": "正确处理了恶意输入",
      "timestamp": "2025-11-04T05:05:03.237Z"
    },
    {
      "testName": "SQL注入测试",
      "details": {
        "endpoint": "/api/users/login",
        "payload": "' UNION SELECT * FROM users --"
      },
      "passed": true,
      "status": 401,
      "message": "正确处理了恶意输入",
      "timestamp": "2025-11-04T05:05:03.241Z"
    },
    {
      "testName": "SQL注入测试",
      "details": {
        "endpoint": "/api/users/login",
        "payload": "1' AND (SELECT COUNT(*) FROM users) > 0 --"
      },
      "passed": true,
      "status": 401,
      "message": "正确处理了恶意输入",
      "timestamp": "2025-11-04T05:05:03.245Z"
    },
    {
      "testName": "SQL注入测试",
      "details": {
        "endpoint": "/api/users/register",
        "payload": "' OR '1'='1"
      },
      "passed": true,
      "status": 400,
      "message": "正确处理了恶意输入",
      "timestamp": "2025-11-04T05:05:03.248Z"
    },
    {
      "testName": "SQL注入测试",
      "details": {
        "endpoint": "/api/users/register",
        "payload": "'; DROP TABLE users; --"
      },
      "passed": true,
      "status": 400,
      "message": "正确处理了恶意输入",
      "timestamp": "2025-11-04T05:05:03.251Z"
    },
    {
      "testName": "SQL注入测试",
      "details": {
        "endpoint": "/api/users/register",
        "payload": "' UNION SELECT * FROM users --"
      },
      "passed": true,
      "status": 400,
      "message": "正确处理了恶意输入",
      "timestamp": "2025-11-04T05:05:03.253Z"
    },
    {
      "testName": "SQL注入测试",
      "details": {
        "endpoint": "/api/users/register",
        "payload": "1' AND (SELECT COUNT(*) FROM users) > 0 --"
      },
      "passed": true,
      "status": 400,
      "message": "正确处理了恶意输入",
      "timestamp": "2025-11-04T05:05:03.255Z"
    },
    {
      "testName": "SQL注入测试",
      "details": {
        "endpoint": "/api/transactions",
        "payload": "' OR '1'='1"
      },
      "passed": true,
      "status": 404,
      "message": "正确处理了恶意输入",
      "timestamp": "2025-11-04T05:05:03.259Z"
    },
    {
      "testName": "SQL注入测试",
      "details": {
        "endpoint": "/api/transactions",
        "payload": "'; DROP TABLE users; --"
      },
      "passed": true,
      "status": 404,
      "message": "正确处理了恶意输入",
      "timestamp": "2025-11-04T05:05:03.263Z"
    },
    {
      "testName": "SQL注入测试",
      "details": {
        "endpoint": "/api/transactions",
        "payload": "' UNION SELECT * FROM users --"
      },
      "passed": true,
      "status": 404,
      "message": "正确处理了恶意输入",
      "timestamp": "2025-11-04T05:05:03.265Z"
    },
    {
      "testName": "SQL注入测试",
      "details": {
        "endpoint": "/api/transactions",
        "payload": "1' AND (SELECT COUNT(*) FROM users) > 0 --"
      },
      "passed": true,
      "status": 404,
      "message": "正确处理了恶意输入",
      "timestamp": "2025-11-04T05:05:03.268Z"
    },
    {
      "testName": "SQL注入测试",
      "details": {
        "endpoint": "/api/categories",
        "payload": "' OR '1'='1"
      },
      "passed": true,
      "status": 404,
      "message": "正确处理了恶意输入",
      "timestamp": "2025-11-04T05:05:03.271Z"
    },
    {
      "testName": "SQL注入测试",
      "details": {
        "endpoint": "/api/categories",
        "payload": "'; DROP TABLE users; --"
      },
      "passed": true,
      "status": 404,
      "message": "正确处理了恶意输入",
      "timestamp": "2025-11-04T05:05:03.274Z"
    },
    {
      "testName": "SQL注入测试",
      "details": {
        "endpoint": "/api/categories",
        "payload": "' UNION SELECT * FROM users --"
      },
      "passed": true,
      "status": 404,
      "message": "正确处理了恶意输入",
      "timestamp": "2025-11-04T05:05:03.276Z"
    },
    {
      "testName": "SQL注入测试",
      "details": {
        "endpoint": "/api/categories",
        "payload": "1' AND (SELECT COUNT(*) FROM users) > 0 --"
      },
      "passed": true,
      "status": 404,
      "message": "正确处理了恶意输入",
      "timestamp": "2025-11-04T05:05:03.278Z"
    },
    {
      "testName": "SQL注入测试",
      "details": {
        "endpoint": "/api/accounts",
        "payload": "' OR '1'='1"
      },
      "passed": true,
      "status": 404,
      "message": "正确处理了恶意输入",
      "timestamp": "2025-11-04T05:05:03.281Z"
    },
    {
      "testName": "SQL注入测试",
      "details": {
        "endpoint": "/api/accounts",
        "payload": "'; DROP TABLE users; --"
      },
      "passed": true,
      "status": 404,
      "message": "正确处理了恶意输入",
      "timestamp": "2025-11-04T05:05:03.283Z"
    },
    {
      "testName": "SQL注入测试",
      "details": {
        "endpoint": "/api/accounts",
        "payload": "' UNION SELECT * FROM users --"
      },
      "passed": true,
      "status": 404,
      "message": "正确处理了恶意输入",
      "timestamp": "2025-11-04T05:05:03.285Z"
    },
    {
      "testName": "SQL注入测试",
      "details": {
        "endpoint": "/api/accounts",
        "payload": "1' AND (SELECT COUNT(*) FROM users) > 0 --"
      },
      "passed": true,
      "status": 404,
      "message": "正确处理了恶意输入",
      "timestamp": "2025-11-04T05:05:03.287Z"
    },
    {
      "testName": "XSS测试",
      "details": {
        "endpoint": "/api/users/login",
        "payload": "<script>alert(\"XSS\")</script>"
      },
      "passed": true,
      "status": 401,
      "message": "正确处理了恶意输入",
      "timestamp": "2025-11-04T05:05:03.291Z"
    },
    {
      "testName": "XSS测试",
      "details": {
        "endpoint": "/api/users/login",
        "payload": "<img src=x onerror=alert(\"XSS\")>"
      },
      "passed": true,
      "status": 401,
      "message": "正确处理了恶意输入",
      "timestamp": "2025-11-04T05:05:03.293Z"
    },
    {
      "testName": "XSS测试",
      "details": {
        "endpoint": "/api/users/login",
        "payload": "javascript:alert(\"XSS\")"
      },
      "passed": true,
      "status": 401,
      "message": "正确处理了恶意输入",
      "timestamp": "2025-11-04T05:05:03.296Z"
    },
    {
      "testName": "XSS测试",
      "details": {
        "endpoint": "/api/users/login",
        "payload": "<svg onload=alert(\"XSS\")>"
      },
      "passed": true,
      "status": 401,
      "message": "正确处理了恶意输入",
      "timestamp": "2025-11-04T05:05:03.299Z"
    },
    {
      "testName": "XSS测试",
      "details": {
        "endpoint": "/api/users/register",
        "payload": "<script>alert(\"XSS\")</script>"
      },
      "passed": true,
      "status": 400,
      "message": "正确处理了恶意输入",
      "timestamp": "2025-11-04T05:05:03.301Z"
    },
    {
      "testName": "XSS测试",
      "details": {
        "endpoint": "/api/users/register",
        "payload": "<img src=x onerror=alert(\"XSS\")>"
      },
      "passed": true,
      "status": 400,
      "message": "正确处理了恶意输入",
      "timestamp": "2025-11-04T05:05:03.303Z"
    },
    {
      "testName": "XSS测试",
      "details": {
        "endpoint": "/api/users/register",
        "payload": "javascript:alert(\"XSS\")"
      },
      "passed": true,
      "status": 400,
      "message": "正确处理了恶意输入",
      "timestamp": "2025-11-04T05:05:03.305Z"
    },
    {
      "testName": "XSS测试",
      "details": {
        "endpoint": "/api/users/register",
        "payload": "<svg onload=alert(\"XSS\")>"
      },
      "passed": true,
      "status": 400,
      "message": "正确处理了恶意输入",
      "timestamp": "2025-11-04T05:05:03.307Z"
    },
    {
      "testName": "XSS测试",
      "details": {
        "endpoint": "/api/transactions",
        "payload": "<script>alert(\"XSS\")</script>"
      },
      "passed": true,
      "status": 404,
      "message": "正确处理了恶意输入",
      "timestamp": "2025-11-04T05:05:03.309Z"
    },
    {
      "testName": "XSS测试",
      "details": {
        "endpoint": "/api/transactions",
        "payload": "<img src=x onerror=alert(\"XSS\")>"
      },
      "passed": true,
      "status": 404,
      "message": "正确处理了恶意输入",
      "timestamp": "2025-11-04T05:05:03.311Z"
    },
    {
      "testName": "XSS测试",
      "details": {
        "endpoint": "/api/transactions",
        "payload": "javascript:alert(\"XSS\")"
      },
      "passed": true,
      "status": 404,
      "message": "正确处理了恶意输入",
      "timestamp": "2025-11-04T05:05:03.313Z"
    },
    {
      "testName": "XSS测试",
      "details": {
        "endpoint": "/api/transactions",
        "payload": "<svg onload=alert(\"XSS\")>"
      },
      "passed": true,
      "status": 404,
      "message": "正确处理了恶意输入",
      "timestamp": "2025-11-04T05:05:03.315Z"
    },
    {
      "testName": "XSS测试",
      "details": {
        "endpoint": "/api/categories",
        "payload": "<script>alert(\"XSS\")</script>"
      },
      "passed": true,
      "status": 404,
      "message": "正确处理了恶意输入",
      "timestamp": "2025-11-04T05:05:03.317Z"
    },
    {
      "testName": "XSS测试",
      "details": {
        "endpoint": "/api/categories",
        "payload": "<img src=x onerror=alert(\"XSS\")>"
      },
      "passed": true,
      "status": 404,
      "message": "正确处理了恶意输入",
      "timestamp": "2025-11-04T05:05:03.319Z"
    },
    {
      "testName": "XSS测试",
      "details": {
        "endpoint": "/api/categories",
        "payload": "javascript:alert(\"XSS\")"
      },
      "passed": true,
      "status": 404,
      "message": "正确处理了恶意输入",
      "timestamp": "2025-11-04T05:05:03.321Z"
    },
    {
      "testName": "XSS测试",
      "details": {
        "endpoint": "/api/categories",
        "payload": "<svg onload=alert(\"XSS\")>"
      },
      "passed": true,
      "status": 404,
      "message": "正确处理了恶意输入",
      "timestamp": "2025-11-04T05:05:03.322Z"
    },
    {
      "testName": "XSS测试",
      "details": {
        "endpoint": "/api/accounts",
        "payload": "<script>alert(\"XSS\")</script>"
      },
      "passed": true,
      "status": 404,
      "message": "正确处理了恶意输入",
      "timestamp": "2025-11-04T05:05:03.325Z"
    },
    {
      "testName": "XSS测试",
      "details": {
        "endpoint": "/api/accounts",
        "payload": "<img src=x onerror=alert(\"XSS\")>"
      },
      "passed": true,
      "status": 404,
      "message": "正确处理了恶意输入",
      "timestamp": "2025-11-04T05:05:03.327Z"
    },
    {
      "testName": "XSS测试",
      "details": {
        "endpoint": "/api/accounts",
        "payload": "javascript:alert(\"XSS\")"
      },
      "passed": true,
      "status": 404,
      "message": "正确处理了恶意输入",
      "timestamp": "2025-11-04T05:05:03.328Z"
    },
    {
      "testName": "XSS测试",
      "details": {
        "endpoint": "/api/accounts",
        "payload": "<svg onload=alert(\"XSS\")>"
      },
      "passed": true,
      "status": 404,
      "message": "正确处理了恶意输入",
      "timestamp": "2025-11-04T05:05:03.331Z"
    },
    {
      "testName": "CSRF保护测试",
      "details": {},
      "passed": false,
      "status": 401,
      "message": "未检测到CSRF保护机制",
      "timestamp": "2025-11-04T05:05:03.337Z"
    },
    {
      "testName": "认证绕过测试",
      "details": {
        "endpoint": "/api/transactions"
      },
      "passed": false,
      "status": 404,
      "message": "测试过程中发生错误: Request failed with status code 404",
      "timestamp": "2025-11-04T05:05:03.340Z"
    },
    {
      "testName": "认证绕过测试",
      "details": {
        "endpoint": "/api/categories"
      },
      "passed": false,
      "status": 404,
      "message": "测试过程中发生错误: Request failed with status code 404",
      "timestamp": "2025-11-04T05:05:03.342Z"
    },
    {
      "testName": "认证绕过测试",
      "details": {
        "endpoint": "/api/accounts"
      },
      "passed": false,
      "status": 404,
      "message": "测试过程中发生错误: Request failed with status code 404",
      "timestamp": "2025-11-04T05:05:03.344Z"
    },
    {
      "testName": "限流测试",
      "details": {},
      "passed": false,
      "message": "未检测到限流机制",
      "timestamp": "2025-11-04T05:05:04.140Z"
    },
    {
      "testName": "输入验证测试",
      "details": {
        "input": {
          "username": "",
          "password": "test",
          "expectedStatus": 400
        }
      },
      "passed": true,
      "status": 400,
      "message": "正确验证了输入",
      "timestamp": "2025-11-04T05:05:04.143Z"
    },
    {
      "testName": "输入验证测试",
      "details": {
        "input": {
          "username": "test",
          "password": "",
          "expectedStatus": 400
        }
      },
      "passed": true,
      "status": 400,
      "message": "正确验证了输入",
      "timestamp": "2025-11-04T05:05:04.145Z"
    },
    {
      "testName": "输入验证测试",
      "details": {
        "input": {
          "username": "a",
          "password": "test",
          "expectedStatus": 400
        }
      },
      "passed": false,
      "status": 401,
      "message": "输入验证可能存在问题: Request failed with status code 401",
      "timestamp": "2025-11-04T05:05:04.148Z"
    },
    {
      "testName": "输入验证测试",
      "details": {
        "input": {
          "username": "test",
          "password": "123",
          "expectedStatus": 400
        }
      },
      "passed": false,
      "status": 401,
      "message": "输入验证可能存在问题: Request failed with status code 401",
      "timestamp": "2025-11-04T05:05:04.151Z"
    },
    {
      "testName": "输入验证测试",
      "details": {
        "input": {
          "username": "test@test.com",
          "password": "test",
          "expectedStatus": 400
        }
      },
      "passed": false,
      "status": 401,
      "message": "输入验证可能存在问题: Request failed with status code 401",
      "timestamp": "2025-11-04T05:05:04.155Z"
    },
    {
      "testName": "敏感数据泄露测试",
      "details": {},
      "passed": true,
      "status": 401,
      "message": "错误信息未泄露敏感信息",
      "timestamp": "2025-11-04T05:05:04.158Z"
    },
    {
      "testName": "安全头测试",
      "details": {
        "endpoint": "/api/users/login"
      },
      "passed": false,
      "status": 401,
      "message": "测试过程中发生错误: Request failed with status code 401",
      "timestamp": "2025-11-04T05:05:04.160Z"
    },
    {
      "testName": "安全头测试",
      "details": {
        "endpoint": "/api/users/register"
      },
      "passed": false,
      "status": 401,
      "message": "测试过程中发生错误: Request failed with status code 401",
      "timestamp": "2025-11-04T05:05:04.162Z"
    },
    {
      "testName": "安全头测试",
      "details": {
        "endpoint": "/api/transactions"
      },
      "passed": false,
      "status": 404,
      "message": "测试过程中发生错误: Request failed with status code 404",
      "timestamp": "2025-11-04T05:05:04.165Z"
    },
    {
      "testName": "安全头测试",
      "details": {
        "endpoint": "/api/categories"
      },
      "passed": false,
      "status": 404,
      "message": "测试过程中发生错误: Request failed with status code 404",
      "timestamp": "2025-11-04T05:05:04.167Z"
    },
    {
      "testName": "安全头测试",
      "details": {
        "endpoint": "/api/accounts"
      },
      "passed": false,
      "status": 404,
      "message": "测试过程中发生错误: Request failed with status code 404",
      "timestamp": "2025-11-04T05:05:04.169Z"
    }
  ],
  "securityScore": 24,
  "summary": {
    "scanDate": "2025-11-04T05:05:04.169Z",
    "totalTests": 56,
    "passedTests": 43,
    "failedTests": 13,
    "securityScore": 24,
    "vulnerabilitiesBySeverity": {
      "high": 3,
      "medium": 1,
      "low": 9
    },
    "recommendations": [
      {
        "priority": "high",
        "issue": "认证绕过漏洞",
        "recommendation": "确保所有受保护的端点都有适当的身份验证和授权检查",
        "resources": [
          "https://owasp.org/www-project-top-ten/2017/A2_2017-Broken_Authentication",
          "https://expressjs.com/en/advanced/best-practice-security.html"
        ]
      },
      {
        "priority": "medium",
        "issue": "CSRF漏洞",
        "recommendation": "实施CSRF令牌验证机制，使用SameSite cookie属性",
        "resources": [
          "https://owasp.org/www-community/attacks/csrf",
          "https://github.com/expressjs/csurf"
        ]
      },
      {
        "priority": "medium",
        "issue": "输入验证不足",
        "recommendation": "实施严格的输入验证机制，使用验证库如Joi或express-validator",
        "resources": [
          "https://owasp.org/www-project-top-ten/2017/A1_2017-Injection",
          "https://github.com/express-validator/express-validator"
        ]
      },
      {
        "priority": "low",
        "issue": "安全头缺失",
        "recommendation": "添加必要的安全响应头，如X-Content-Type-Options、X-Frame-Options等",
        "resources": [
          "https://owasp.org/www-project-secure-headers/",
          "https://github.com/helmetjs/helmet"
        ]
      },
      {
        "priority": "medium",
        "issue": "限流机制缺失",
        "recommendation": "实施API限流机制，防止暴力破解和DDoS攻击",
        "resources": [
          "https://github.com/express-rate-limit/express-rate-limit",
          "https://owasp.org/www-project-top-ten/2017/A7_2017-Identification_and_Authentication_Failures"
        ]
      }
    ]
  }
}