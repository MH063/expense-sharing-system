# 记账系统开发提示词

## 前端应用开发（基于现有项目状态）

### 1. 项目现状分析
**当前项目状态：**
- 项目已创建：`Client application` 目录
- 技术栈：Vue 3.3.4 + Vite 4.4.5 + Element Plus 2.3.8
- 已安装依赖：vue, vue-router, element-plus, axios, qrcode
- 端口配置：默认端口8000
- 项目结构：已包含基础框架和部分组件

### 2. 现有文件结构
- `src/App.vue` - 基础应用组件，包含通用样式
- `src/main.js` - 应用入口文件
- `src/views/Home.vue` - 首页组件（已开发）
- `src/views/NotFound.vue` - 404页面
- `src/router/index.js` - 路由配置
- `src/components/` - 组件目录（包含部分功能组件）
- `src/utils/` - 工具函数目录

### 3. 下一步开发重点
**基于现有代码继续开发：**
- 完善路由配置，添加更多页面路由
- 开发费用管理、账单管理、统计分析等核心功能页面
- 集成后端API接口
- 完善组件库和工具函数

### 4. 基于现有代码的下一步开发
**当前已完成：**
- 基础项目框架搭建
- 首页组件开发
- 通用样式和布局
- 路由配置基础

**下一步开发重点：**
- 完善路由配置，添加更多页面路由
- 开发费用管理、账单管理、统计分析等核心功能页面
- 集成后端API接口
- 完善组件库和工具函数
- 添加echarts数据可视化依赖

## 管理端应用开发（基于现有项目状态）

### 1. 项目现状分析
**当前项目状态：**
- 项目已创建：`Admin panel` 目录
- 技术栈：Vue 3.3.4 + Vite 4.4.5 + Element Plus 2.3.8
- 已安装依赖：vue, vue-router, element-plus, axios
- 端口配置：预览端口8100
- 项目结构：已包含基础框架和部分页面

### 2. 现有文件结构
- `src/App.vue` - 基础应用组件
- `src/main.js` - 应用入口文件
- `src/views/AdminHome.vue` - 管理端首页（已开发部分）
- `src/views/NotFound.vue` - 404页面
- `src/router/index.js` - 路由配置

### 3. 管理端功能开发重点
**基于现有代码继续开发：**
- 完善管理端布局和菜单系统
- 开发用户管理、费用监控、统计分析等管理功能
- 集成后端管理API接口
- 实现权限控制和数据可视化

### 4. 基于现有代码的下一步开发
**当前已完成：**
- 基础项目框架搭建
- 管理端首页布局开发
- Element Plus组件集成
- 基础路由配置

**下一步开发重点：**
- 完善管理端布局和菜单系统
- 开发用户管理、费用监控、统计分析等管理功能
- 集成后端管理API接口
- 实现权限控制和数据可视化
- 添加echarts数据可视化依赖

## 后台服务端开发（基于现有项目状态）

### 1. 项目现状分析
**当前项目状态：**
- 项目已创建：`Server-side` 目录
- 技术栈：Node.js + Express + PostgreSQL + Redis + JWT
- 已安装依赖：express, pg, bcryptjs, jsonwebtoken, redis, cors, helmet, winston, ws
- 端口配置：默认端口4000
- 环境配置：已配置开发环境和生产环境
- 项目结构：已包含基础服务器框架和配置

### 2. 现有文件结构
- `server.js` - 主服务器文件（已开发）
- `package.json` - 项目配置和依赖
- `.env.development` - 开发环境配置
- `.env.production` - 生产环境配置
- `config/db.js` - 数据库配置（已开发）
- `config/websocket.js` - WebSocket配置（已开发）
- `controllers/` - 控制器目录（待开发）
- `services/` - 服务层目录（待开发）
- `scripts/` - 数据库脚本目录（待开发）

### 2. 框架集成以下功能（基于需求文档11.2.2）
- **错误处理**：标准化的错误码和错误信息
- **日志记录(Winston)**：关键位置加日志打印方便调试
- **文件上传(Multer)**：支持收款码图片上传
- **安全头部设置(Helmet)**：安全防护
- **WebSocket实时通信**：基于需求文档11.2.3的WebSocket服务器实现
- **数据库连接池管理**：PostgreSQL 14+数据库操作
- **JWT Token认证机制**：用户认证和权限管理
- **跨域资源共享(CORS)**：允许所有来源网站的跨域请求

### 3. 特殊处理，防止token过长导致AI对话中断影响效果
- API速率限制，同一个接口1分钟内最多10次，开发测试环境不限制
- 后台接口返回的请求成功状态码必须是200
- 新增.env配置文件，区分当前运行环境，包括开发、测试、生产环境，运行npm run dev时，需要指定当前env的环境

## 写后台接口（基于需求文档11.2.1和API接口设计文档）

### 1. 新建用户注册接口（基于需求文档11.2.1用户服务）
新增一个注册接口，post方法，接口写完后，告诉我四大元素，接口地址、请求方法、请求参数、返回结果，数据结构用json，并且json里需要加上业务字段的注释。

### 2. 新建用户登录接口（基于需求文档11.2.1用户服务）
新增一个登录接口，post方法，支持用户名/邮箱/手机号登录

### 3. 寝室管理相关接口（基于需求文档11.2.1寝室服务）
- 获取寝室列表接口
- 创建寝室接口
- 更新寝室信息接口
- 删除寝室接口
- 获取寝室详情接口
- 寝室成员管理接口

### 4. 费用管理相关接口（基于需求文档11.2.1费用服务）
- 获取费用列表接口
- 添加费用记录接口
- 更新费用记录接口
- 删除费用记录接口
- 费用分摊计算接口
- 费用审核流程接口

### 5. 账单管理相关接口（基于需求文档11.2.1账单服务）
- 生成账单接口
- 获取账单列表接口
- 账单详情接口
- 账单支付状态更新接口
- 支付记录处理接口

### 6. 审核服务相关接口（基于需求文档11.2.1审核服务）
- 多级审核流程接口
- 审核状态管理接口
- 审核记录追踪接口

### 7. 争议服务相关接口（基于需求文档11.2.1争议服务）
- 争议提交与处理接口
- 证据管理接口
- 争议解决流程接口

### 8. 统计服务相关接口（基于需求文档11.2.1统计服务）
- 支出统计计算接口
- 数据分析接口
- 报表生成接口

### 9. WebSocket实时通信接口（基于需求文档11.2.3）
- WebSocket服务器实现
- 客户端连接管理
- 消息订阅/发布机制
- 支持事件类型：expense_created/expense_updated, bill_created, payment_created, review_status_updated, dispute_processed, notification, system_status_updated


## 开发页面

### 1. 前端应用页面开发（基于需求文档11.1.1）
根据需求文档开发以下页面：
- **首页**：展示费用概览、最近账单、统计图表
- **实时通知系统页面**：WebSocket客户端连接管理、事件订阅与消息处理、通知展示组件、自动重连机制
- **用户认证与权限管理页面**：用户登录/注册界面、角色权限控制、个人资料管理页面
- **寝室管理页面**：寝室创建/加入界面、寝室成员管理、寝室信息展示
- **费用管理页面**：费用记录创建/编辑界面、费用分摊详情展示、费用列表页面、费用详情页面
- **账单管理页面**：账单创建界面、账单支付界面、账单列表与详情页面
- **审核流程页面**：费用审核界面、审核状态跟踪、多级审核展示
- **争议处理页面**：争议提交界面、争议处理进度跟踪、证据上传功能
- **统计分析页面**：支出统计图表展示、成员消费对比、费用趋势分析

### 2. 管理端页面开发（基于需求文档11.3.2）
根据需求文档开发以下页面：
- **管理首页**：系统概览、关键指标
- **文档管理页面**：需求文档维护、数据库设计文档管理（基于需求文档11.3.1）
- **用户管理页面**：用户信息查看/编辑、角色分配管理、权限配置
- **寝室管理页面**：寝室信息查看、成员关系管理、寝室状态监控
- **费用监控页面**：费用记录审计、分摊结果验证、异常费用识别
- **审核管理页面**：审核流程监控、审核记录查询、审核统计分析
- **争议处理页面**：争议案件管理、处理进度跟踪、争议统计分析
- **系统配置页面**：系统参数配置、分摊规则管理、通知模板配置
- **数据统计页面**：系统使用统计、业务数据报表、性能监控指标
- **安全与审计页面**：操作审计、数据备份（基于需求文档11.3.3）

### 3. 页面开发流程
1. 根据需求文档分析页面功能（明确参考需求文档11.1、11.2、11.3的具体章节）
2. 设计页面布局和交互流程
3. 开发页面组件和业务逻辑
4. 集成后端API接口
5. 测试页面功能和用户体验

## 项目部署配置

### 1. 环境配置
- 开发环境：端口8000（前端）、4000（后端）、8100（管理端）
- 生产环境：端口配置保持一致
- 数据库环境：开发环境使用test_expense_system，生产环境使用prod_expense_system

### 2. 部署脚本
- 前端构建脚本：npm run build
- 后端启动脚本：npm start / npm run dev
- 管理端构建脚本：npm run build

### 3. 健康检查
- 后端健康检查接口：/health
- 前端路由检查
- 数据库连接状态检查

## 开发注意事项

### 1. 技术规范
- 使用Vue 3 Composition API和`<script setup>`语法
- 遵循Element Plus组件使用规范
- 后端API遵循RESTful设计原则
- 数据库设计遵循规范化原则

### 2. 代码质量
- 使用ESLint进行代码检查
- Prettier自动格式化代码
- 编写清晰的注释和文档
- 进行单元测试和集成测试

### 3. 安全考虑
- 密码加密存储（bcryptjs）
- JWT token安全传输
- SQL注入防护
- XSS攻击防护
- CSRF防护

## 常见问题处理

### 1. 端口占用问题
如果端口被占用，可以修改配置文件：
- 前端端口修改：vite.config.js中的server.port
- 后端端口修改：.env文件中的PORT配置

### 2. 数据库连接问题
- 检查PostgreSQL服务状态
- 验证数据库连接配置
- 检查用户权限设置

### 3. 依赖安装问题
- 清除npm缓存：npm cache clean --force
- 重新安装依赖：删除node_modules和package-lock.json后重新npm install

## 版本控制

### 1. Git分支策略
- main分支：生产环境代码
- develop分支：开发环境代码
- feature分支：功能开发分支
- hotfix分支：紧急修复分支

### 2. 提交规范
- feat: 新功能
- fix: 修复bug
- docs: 文档更新
- style: 代码格式调整
- refactor: 代码重构
- test: 测试相关
- chore: 构建过程或辅助工具变动

---

**最后更新**: 2025-11-02  
**版本**: 1.0.0  
**适用项目**: 寝室费用分摊记账系统