# 页面接口需求文档

## Dashboard页面 (仪表盘)

### 1. 用户统计数据接口
- **接口名称**: 获取用户统计数据
- **请求方式**: GET
- **接口路径**: `/stats/user`
- **请求参数**: 
  - startDate (可选): 开始日期
  - endDate (可选): 结束日期
- **返回数据结构**: 
  ```json
  {
    "success": true,
    "data": {
      "totalExpense": "0.00",  // 本月总支出
      "myExpense": "0.00",      // 我的支出
      "owedAmount": "0.00",     // 待收金额
      "owingAmount": "0.00"    // 待付金额
    }
  }
  ```

### 2. 房间统计数据接口
- **接口名称**: 获取房间统计数据
- **请求方式**: GET
- **接口路径**: `/stats/room`
- **请求参数**: 
  - roomId (可选): 房间ID
  - startDate: 开始日期
  - endDate: 结束日期
- **返回数据结构**: 
  ```json
  {
    "success": true,
    "data": {
      "weeklyData": [0, 0, 0, 0, 0, 0, 0],  // 周数据(7天)
      "monthlyData": [0, 0, 0, 0],           // 月数据(4周)
      "yearlyData": [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]  // 年数据(12月)
    }
  }
  ```

### 3. 通知列表接口
- **接口名称**: 获取通知列表
- **请求方式**: GET
- **接口路径**: `/notifications`
- **请求参数**: 
  - page (可选): 页码
  - limit (可选): 每页数量
  - type (可选): 通知类型
  - isRead (可选): 是否已读
- **返回数据结构**: 
  ```json
  {
    "success": true,
    "data": [
      {
        "id": "通知ID",
        "title": "通知标题",
        "content": "通知内容",
        "type": "通知类型",
        "isRead": false,
        "createdAt": "2023-01-01T00:00:00.000Z"
      }
    ]
  }
  ```

### 4. 待处理账单接口
- **接口名称**: 获取账单列表
- **请求方式**: GET
- **接口路径**: `/bills`
- **请求参数**: 
  - status: "pending" (待处理状态)
  - limit: 5 (限制数量)
- **返回数据结构**: 
  ```json
  {
    "success": true,
    "data": [
      {
        "id": "账单ID",
        "title": "账单标题",
        "amount": "100.00",
        "status": "pending",
        "dueDate": "2023-01-01"
      }
    ]
  }
  ```

### 5. 未读通知数量接口
- **接口名称**: 获取未读通知数量
- **请求方式**: GET
- **接口路径**: `/notifications/unread-count`
- **请求参数**: 无
- **返回数据结构**: 
  ```json
  {
    "success": true,
    "data": {
      "count": 5
    }
  }
  ```

### 6. 系统统计数据接口 (可选)
- **接口名称**: 获取系统统计数据
- **请求方式**: GET
- **接口路径**: `/stats/system`
- **请求参数**: 无
- **返回数据结构**: 
  ```json
  {
    "success": true,
    "data": {
      "totalUsers": 100,
      "totalRooms": 20,
      "totalExpenses": 10000.00,
      "activeUsers": 50
    }
  }
  ```

### 7. 预测统计数据接口 (可选)
- **接口名称**: 获取预测统计数据
- **请求方式**: GET
- **接口路径**: `/stats/forecast`
- **请求参数**: 
  - type: 预测类型
  - period: 预测周期
- **返回数据结构**: 
  ```json
  {
    "success": true,
    "data": {
      "forecast": [100.00, 120.00, 90.00, 110.00],
      "accuracy": 0.85
    }
  }
  ```

## Expenses页面 (费用管理)

### 1. 费用列表接口
- **接口名称**: 获取费用列表
- **请求方式**: GET
- **接口路径**: `/expenses`
- **请求参数**: 
  - page (可选): 页码
  - limit (可选): 每页数量
  - roomId (可选): 房间ID
  - categoryId (可选): 分类ID
  - memberId (可选): 成员ID
  - startDate (可选): 开始日期
  - endDate (可选): 结束日期
  - status (可选): 状态
  - sortBy (可选): 排序字段
  - sortOrder (可选): 排序方向
- **返回数据结构**: 
  ```json
  {
    "success": true,
    "data": {
      "expenses": [
        {
          "id": "费用ID",
          "title": "费用标题",
          "amount": "100.00",
          "category": "费用分类",
          "payer": "支付人",
          "date": "2023-01-01",
          "status": "pending",
          "splitDetails": []
        }
      ],
      "pagination": {
        "page": 1,
        "limit": 20,
        "total": 100,
        "totalPages": 5
      }
    }
  }
  ```

### 2. 费用详情接口
- **接口名称**: 获取费用详情
- **请求方式**: GET
- **接口路径**: `/expenses/{expenseId}`
- **请求参数**: 
  - expenseId (必填): 费用ID
- **返回数据结构**: 
  ```json
  {
    "success": true,
    "data": {
      "id": "费用ID",
      "title": "费用标题",
      "amount": "100.00",
      "description": "费用描述",
      "category": {
        "id": "分类ID",
        "name": "分类名称"
      },
      "payer": {
        "id": "用户ID",
        "name": "用户名"
      },
      "date": "2023-01-01",
      "status": "pending",
      "paymentMethod": "支付方式",
      "splitType": "分摊类型",
      "splitDetails": [
        {
          "member": {
            "id": "成员ID",
            "name": "成员名"
          },
          "amount": "50.00",
          "isPaid": false
        }
      ],
      "receipts": [],
      "comments": []
    }
  }
  ```

### 3. 创建费用记录接口
- **接口名称**: 创建费用记录
- **请求方式**: POST
- **接口路径**: `/expenses`
- **请求参数**: 
  - title (必填): 费用标题
  - amount (必填): 金额
  - categoryId (必填): 分类ID
  - roomId (必填): 房间ID
  - payerId (必填): 支付人ID
  - date (必填): 费用日期
  - description (可选): 费用描述
  - paymentMethod (可选): 支付方式
  - splitType (必填): 分摊类型
  - splitDetails (必填): 分摊详情
  - receipts (可选): 凭证图片
- **返回数据结构**: 
  ```json
  {
    "success": true,
    "data": {
      "id": "新创建的费用ID",
      "message": "费用创建成功"
    }
  }
  ```

### 4. 更新费用记录接口
- **接口名称**: 更新费用记录
- **请求方式**: PUT
- **接口路径**: `/expenses/{expenseId}`
- **请求参数**: 
  - expenseId (必填): 费用ID
  - title (可选): 费用标题
  - amount (可选): 金额
  - categoryId (可选): 分类ID
  - description (可选): 费用描述
  - paymentMethod (可选): 支付方式
  - splitType (可选): 分摊类型
  - splitDetails (可选): 分摊详情
- **返回数据结构**: 
  ```json
  {
    "success": true,
    "data": {
      "id": "费用ID",
      "message": "费用更新成功"
    }
  }
  ```

### 5. 删除费用记录接口
- **接口名称**: 删除费用记录
- **请求方式**: DELETE
- **接口路径**: `/expenses/{expenseId}`
- **请求参数**: 
  - expenseId (必填): 费用ID
- **返回数据结构**: 
  ```json
  {
    "success": true,
    "data": {
      "message": "费用删除成功"
    }
  }
  ```

### 6. 批量删除费用记录接口
- **接口名称**: 批量删除费用记录
- **请求方式**: POST
- **接口路径**: `/expenses/batch-delete`
- **请求参数**: 
  - expenseIds (必填): 费用ID数组
- **返回数据结构**: 
  ```json
  {
    "success": true,
    "data": {
      "deletedCount": 5,
      "message": "批量删除成功"
    }
  }
  ```

### 7. 费用分类列表接口
- **接口名称**: 获取费用分类列表
- **请求方式**: GET
- **接口路径**: `/expenses/categories`
- **请求参数**: 
  - roomId (可选): 房间ID
- **返回数据结构**: 
  ```json
  {
    "success": true,
    "data": [
      {
        "id": "分类ID",
        "name": "分类名称",
        "icon": "分类图标",
        "color": "分类颜色"
      }
    ]
  }
  ```

### 8. 创建费用分类接口
- **接口名称**: 创建费用分类
- **请求方式**: POST
- **接口路径**: `/expenses/categories`
- **请求参数**: 
  - name (必填): 分类名称
  - icon (可选): 分类图标
  - color (可选): 分类颜色
  - roomId (必填): 房间ID
- **返回数据结构**: 
  ```json
  {
    "success": true,
    "data": {
      "id": "新创建的分类ID",
      "message": "分类创建成功"
    }
  }
  ```

### 9. 更新费用分类接口
- **接口名称**: 更新费用分类
- **请求方式**: PUT
- **接口路径**: `/expenses/categories/{categoryId}`
- **请求参数**: 
  - categoryId (必填): 分类ID
  - name (可选): 分类名称
  - icon (可选): 分类图标
  - color (可选): 分类颜色
- **返回数据结构**: 
  ```json
  {
    "success": true,
    "data": {
      "id": "分类ID",
      "message": "分类更新成功"
    }
  }
  ```

### 10. 删除费用分类接口
- **接口名称**: 删除费用分类
- **请求方式**: DELETE
- **接口路径**: `/expenses/categories/{categoryId}`
- **请求参数**: 
  - categoryId (必填): 分类ID
- **返回数据结构**: 
  ```json
  {
    "success": true,
    "data": {
      "message": "分类删除成功"
    }
  }
  ```

### 11. 费用统计接口
- **接口名称**: 获取费用统计数据
- **请求方式**: GET
- **接口路径**: `/expenses/statistics`
- **请求参数**: 
  - roomId (必填): 房间ID
  - startDate (可选): 开始日期
  - endDate (可选): 结束日期
  - type (可选): 统计类型 (total, personal, owed, owing)
- **返回数据结构**: 
  ```json
  {
    "success": true,
    "data": {
      "totalExpense": "1000.00",
      "myExpense": "500.00",
      "owedAmount": "300.00",
      "owingAmount": "200.00",
      "expenseCount": 25,
      "settledCount": 20,
      "pendingCount": 5
    }
  }
  ```

### 12. 费用分类统计接口
- **接口名称**: 获取费用分类统计数据
- **请求方式**: GET
- **接口路径**: `/expenses/category-stats`
- **请求参数**: 
  - roomId (必填): 房间ID
  - startDate (可选): 开始日期
  - endDate (可选): 结束日期
- **返回数据结构**: 
  ```json
  {
    "success": true,
    "data": [
      {
        "categoryId": "分类ID",
        "categoryName": "分类名称",
        "totalAmount": "500.00",
        "percentage": 50.0,
        "count": 10
      }
    ]
  }
  ```

### 13. 费用趋势数据接口
- **接口名称**: 获取费用趋势数据
- **请求方式**: GET
- **接口路径**: `/expenses/trends`
- **请求参数**: 
  - roomId (必填): 房间ID
  - startDate (可选): 开始日期
  - endDate (可选): 结束日期
  - period (可选): 时间周期 (daily, weekly, monthly)
- **返回数据结构**: 
  ```json
  {
    "success": true,
    "data": {
      "labels": ["2023-01-01", "2023-01-02", "2023-01-03"],
      "datasets": [
        {
          "label": "每日支出",
          "data": [100.00, 150.00, 120.00]
        }
      ]
    }
  }
  ```

### 14. 成员消费对比接口
- **接口名称**: 获取成员消费对比数据
- **请求方式**: GET
- **接口路径**: `/expenses/comparison`
- **请求参数**: 
  - roomId (必填): 房间ID
  - startDate (可选): 开始日期
  - endDate (可选): 结束日期
- **返回数据结构**: 
  ```json
  {
    "success": true,
    "data": [
      {
        "memberId": "成员ID",
        "memberName": "成员名",
        "totalPaid": "500.00",
        "totalOwed": "300.00",
        "totalOwing": "200.00",
        "expenseCount": 15
      }
    ]
  }
  ```

### 15. 费用分摊详情接口
- **接口名称**: 获取费用分摊详情
- **请求方式**: GET
- **接口路径**: `/expenses/{expenseId}/split`
- **请求参数**: 
  - expenseId (必填): 费用ID
- **返回数据结构**: 
  ```json
  {
    "success": true,
    "data": {
      "splitType": "分摊类型",
      "totalAmount": "100.00",
      "splitDetails": [
        {
          "member": {
            "id": "成员ID",
            "name": "成员名"
          },
          "amount": "50.00",
          "percentage": 50.0,
          "isPaid": false
        }
      ]
    }
  }
  ```

### 16. 更新费用分摊接口
- **接口名称**: 更新费用分摊
- **请求方式**: PUT
- **接口路径**: `/expenses/{expenseId}/split`
- **请求参数**: 
  - expenseId (必填): 费用ID
  - splitType (必填): 分摊类型
  - splitDetails (必填): 分摊详情
- **返回数据结构**: 
  ```json
  {
    "success": true,
    "data": {
      "message": "费用分摊更新成功"
    }
  }
  ```

### 17. 结算费用分摊接口
- **接口名称**: 结算费用分摊
- **请求方式**: POST
- **接口路径**: `/expenses/{expenseId}/settle`
- **请求参数**: 
  - expenseId (必填): 费用ID
  - paymentMethod (可选): 支付方式
- **返回数据结构**: 
  ```json
  {
    "success": true,
    "data": {
      "message": "费用结算成功",
      "settlementId": "结算ID"
    }
  }
  ```

### 18. 导出费用记录接口
- **接口名称**: 导出费用记录
- **请求方式**: GET
- **接口路径**: `/expenses/export`
- **请求参数**: 
  - roomId (必填): 房间ID
  - startDate (可选): 开始日期
  - endDate (可选): 结束日期
  - format (可选): 导出格式 (excel, csv)
- **返回数据结构**: 
  ```json
  {
    "success": true,
    "data": {
      "downloadUrl": "下载链接",
      "filename": "导出文件名"
    }
  }
  ```

### 19. 上传费用凭证接口
- **接口名称**: 上传费用凭证
- **请求方式**: POST
- **接口路径**: `/expenses/{expenseId}/receipt`
- **请求参数**: 
  - expenseId (必填): 费用ID
  - file (必填): 凭证文件 (FormData)
- **返回数据结构**: 
  ```json
  {
    "success": true,
    "data": {
      "receiptId": "凭证ID",
      "url": "凭证URL",
      "message": "凭证上传成功"
    }
  }
  ```

### 20. 删除费用凭证接口
- **接口名称**: 删除费用凭证
- **请求方式**: DELETE
- **接口路径**: `/expenses/{expenseId}/receipt/{receiptId}`
- **请求参数**: 
  - expenseId (必填): 费用ID
  - receiptId (必填): 凭证ID
- **返回数据结构**: 
  ```json
  {
    "success": true,
    "data": {
      "message": "凭证删除成功"
    }
  }
  ```

### 21. 费用评论列表接口
- **接口名称**: 获取费用评论列表
- **请求方式**: GET
- **接口路径**: `/expenses/{expenseId}/comments`
- **请求参数**: 
  - expenseId (必填): 费用ID
  - page (可选): 页码
  - limit (可选): 每页数量
- **返回数据结构**: 
  ```json
  {
    "success": true,
    "data": [
      {
        "id": "评论ID",
        "content": "评论内容",
        "author": {
          "id": "用户ID",
          "name": "用户名"
        },
        "createdAt": "2023-01-01T00:00:00.000Z"
      }
    ]
  }
  ```

### 22. 添加费用评论接口
- **接口名称**: 添加费用评论
- **请求方式**: POST
- **接口路径**: `/expenses/{expenseId}/comments`
- **请求参数**: 
  - expenseId (必填): 费用ID
  - content (必填): 评论内容
- **返回数据结构**: 
  ```json
  {
    "success": true,
    "data": {
      "id": "新评论ID",
      "message": "评论添加成功"
    }
  }
  ```

### 23. 获取用户房间列表接口
- **接口名称**: 获取用户房间列表
- **请求方式**: GET
- **接口路径**: `/rooms`
- **请求参数**: 
  - userId (可选): 用户ID
- **返回数据结构**: 
  ```json
  {
    "success": true,
    "data": [
      {
        "id": "房间ID",
        "name": "房间名称",
        "description": "房间描述",
        "memberCount": 5,
        "createdAt": "2023-01-01T00:00:00.000Z"
      }
    ]
  }
  ```

### 24. 获取房间详情接口
- **接口名称**: 获取房间详情
- **请求方式**: GET
- **接口路径**: `/rooms/{roomId}`
- **请求参数**: 
  - roomId (必填): 房间ID
- **返回数据结构**: 
  ```json
  {
    "success": true,
    "data": {
      "id": "房间ID",
      "name": "房间名称",
      "description": "房间描述",
      "members": [
        {
          "id": "成员ID",
          "name": "成员名",
          "avatar": "头像URL",
          "role": "角色"
        }
      ],
      "createdAt": "2023-01-01T00:00:00.000Z"
    }
  }
  ```

  